Namespace(dataset='dummy', input_len=2, output_len=4, target_model='facebook/opt-125m', draft_model='facebook/opt-125m', draft_size=2, collocate=False, chunked_prefill=False, tokenizer='facebook/opt-125m', quantization=None, tensor_parallel_size=1, n=1, use_beam_search=False, num_prompts=2, seed=0, hf_max_batch_size=None, trust_remote_code=False, max_model_len=None, dtype='auto', enforce_eager=True)
---------------  -----------------
target_model     facebook/opt-125m
draft_model      facebook/opt-125m
draft_size       2
collocate        False
chunked_prefill  False
dataset          dummy
input_len        2
output_len       4
num_prompts      2
---------------  -----------------
INFO 06-19 06:42:54 spec_decode_llm_engine.py:74] Initializing an LLM engine with config: model='facebook/opt-125m', tokenizer='facebook/opt-125m', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.float16, max_seq_len=2048, download_dir='/mnt/sda/download', load_format=auto, tensor_parallel_size=1, quantization=None, enforce_eager=True, seed=0)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[-1.6260,  0.4993, -0.2871,  ...,  0.4329,  0.5200, -0.1644],
          [ 0.8247,  0.0592,  0.9082,  ...,  0.1791, -1.1787,  0.4768],
          [ 0.5986, -0.1289,  0.9312,  ..., -0.7847,  0.4971,  0.3882],
          ...,
          [ 0.0853,  0.9248,  0.7852,  ...,  0.2979, -0.8096,  0.1062],
          [ 0.2537, -0.5552, -0.4539,  ..., -0.8345,  0.2305, -0.0236],
          [-0.1442,  0.4285, -0.6772,  ...,  0.0404, -0.0705, -0.4312]],

         [[-1.4619, -0.0763,  1.6533,  ...,  0.4409,  0.1360,  0.4399],
          [-0.1043,  1.9102,  0.1460,  ...,  0.8506, -1.4238, -0.0406],
          [ 1.2109, -2.2754,  1.3252,  ..., -0.4868,  0.5205, -1.0576],
          ...,
          [ 0.7388,  0.9634, -0.1700,  ...,  1.9004,  0.6123, -1.3545],
          [ 0.6206, -0.7837, -0.8833,  ..., -1.4658,  0.6035, -0.8296],
          [-0.1725,  0.1719,  0.8872,  ...,  0.1214,  0.2673,  0.4424]],

         [[-1.7432,  0.2634,  1.3555,  ...,  0.4375,  0.3608,  0.4062],
          [-0.5288,  1.6113,  0.2031,  ...,  0.9912, -2.2617,  0.0698],
          [ 0.8335, -1.3867,  0.7739,  ..., -0.7612, -0.2859, -1.0908],
          ...,
          [ 0.5332,  0.4387, -0.0323,  ...,  1.8975,  0.1223, -1.4326],
          [ 0.4404, -0.8354, -0.7495,  ..., -1.5381,  0.5830, -0.6626],
          [-0.3899,  0.2067,  0.5376,  ...,  0.0699,  0.1886,  0.3250]],

         ...,

         [[-2.0840, -0.4746,  2.1641,  ...,  1.0625,  0.0732,  0.3999],
          [ 0.3198,  1.5479,  0.1843,  ...,  0.2051, -2.1992,  0.5327],
          [ 1.1836, -2.9199,  2.1465,  ..., -0.5825,  0.7070, -0.8833],
          ...,
          [ 1.2422,  0.3499, -0.5684,  ...,  1.4893, -0.2830, -0.8135],
          [ 0.4412, -0.6431, -0.7124,  ..., -1.5049,  0.3291, -0.8071],
          [-0.6548,  0.0698,  0.7656,  ..., -0.0250, -0.0928,  0.1605]],

         [[-2.0723, -0.5688,  1.7324,  ...,  0.8877,  0.1465,  0.5605],
          [ 0.2281,  0.9868,  0.0424,  ...,  0.0530, -2.4023,  0.5552],
          [ 1.1367, -3.4902,  2.0156,  ..., -1.0146,  0.6426, -1.1592],
          ...,
          [ 1.1592,  0.4492, -0.5513,  ...,  1.3047, -0.1583, -1.5811],
          [ 0.4700, -0.6377, -0.6646,  ..., -1.4307,  0.2939, -0.7153],
          [-0.6704,  0.1004,  0.7510,  ...,  0.0037, -0.0823,  0.2142]],

         [[-1.8262, -0.3086,  0.9224,  ...,  0.1875,  0.2462,  0.6851],
          [-0.1077,  0.7041, -0.0898,  ...,  0.3550, -2.4902,  0.4749],
          [ 1.0361, -3.2129,  1.6064,  ..., -1.5225,  0.1573, -1.4580],
          ...,
          [ 0.8682,  0.1957, -0.3538,  ...,  1.4092, -0.0848, -2.2461],
          [ 0.4312, -0.7510, -0.6548,  ..., -1.3379,  0.3560, -0.5195],
          [-0.6270,  0.1531,  0.6328,  ...,  0.0298, -0.0687,  0.2622]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[ 0.6929, -0.4084,  1.0312,  ...,  0.8857, -0.8062, -0.1281],
          [-1.0234,  1.5664,  0.6963,  ...,  0.7905,  0.7974, -0.2710],
          [ 0.2052, -0.4028,  0.9141,  ...,  0.3652, -1.6719, -2.4043],
          ...,
          [ 0.4294,  1.0674, -0.2443,  ...,  1.0752, -1.2734, -0.5566],
          [-0.3560, -0.6211, -1.3203,  ..., -0.7271, -0.3994, -0.9951],
          [ 0.7456,  1.1377,  0.1748,  ..., -0.0867, -0.1804,  0.5337]],

         [[ 0.5508, -0.6504,  0.2512,  ...,  0.6860, -1.6289, -0.3799],
          [-1.7246,  0.9478,  0.7319,  ...,  1.6299,  0.0597,  0.1758],
          [-0.4175,  0.2917, -0.0219,  ...,  0.7900, -1.7090, -2.6328],
          ...,
          [-0.5659,  0.6494,  0.0557,  ...,  1.5977, -2.1250, -1.1973],
          [-1.0557, -0.7739, -0.8750,  ..., -0.3721, -0.6143, -0.8018],
          [-1.6602,  0.5254,  0.1387,  ..., -0.5820, -2.2324,  0.7148]],

         [[ 0.4155, -0.6064,  0.1375,  ...,  0.7280, -1.5840, -0.7168],
          [-0.9517,  0.9106,  0.3916,  ...,  1.0508,  0.3179,  0.3953],
          [ 0.3098,  0.1237,  0.5044,  ...,  0.8838, -1.5205, -2.3965],
          ...,
          [-0.4412,  0.9023, -0.1299,  ...,  1.2646, -2.1113, -1.2705],
          [-0.7856, -0.7466, -0.8452,  ..., -0.5400, -0.7192, -0.9385],
          [-1.2461, -0.0417,  0.1792,  ..., -0.7720, -1.8857, -0.1777]],

         ...,

         [[ 0.1709, -0.9160, -0.0039,  ...,  0.6870, -2.1855, -0.7109],
          [-1.6631,  0.4446, -0.0154,  ...,  1.2871,  0.1681,  0.1018],
          [ 0.5830, -1.1592,  0.9712,  ...,  0.4971, -1.2148, -2.4961],
          ...,
          [-0.9062,  0.8110, -0.1214,  ...,  0.9268, -2.0078, -1.8594],
          [-0.9692, -0.9805, -1.0918,  ..., -0.3206, -0.9238, -0.9688],
          [-0.9473, -0.0482,  0.8955,  ..., -0.5571, -3.4941,  0.0946]],

         [[ 0.2810, -0.6885, -0.5015,  ...,  0.1423, -2.1289, -0.6592],
          [-1.6514,  1.0498,  0.0311,  ...,  1.4131,  0.2668,  0.1550],
          [ 0.7690, -0.1698,  0.6211,  ...,  0.2976, -1.6973, -2.6465],
          ...,
          [-1.0205,  0.6265, -0.1276,  ...,  1.0176, -2.1660, -1.6875],
          [-0.9863, -1.0352, -1.0322,  ..., -0.3066, -1.0283, -0.8140],
          [-1.3721,  0.9180,  0.5176,  ..., -0.0365, -3.3652,  0.5830]],

         [[ 0.6270, -0.4570, -1.0986,  ..., -0.4583, -2.0508, -0.6401],
          [-1.4492,  1.4062,  0.1493,  ...,  1.2578,  0.4089,  0.2930],
          [ 0.8022,  0.4834,  0.6567,  ..., -0.0153, -1.9404, -2.6133],
          ...,
          [-0.9741,  0.4939, -0.3726,  ...,  0.9946, -2.1855, -1.3076],
          [-0.9614, -0.9546, -0.8398,  ..., -0.2759, -1.1572, -0.7036],
          [-1.3379,  1.3408, -0.1826,  ...,  0.0970, -3.1309, -0.1011]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[-6.3538e-02,  1.4214e-02,  3.2440e-02,  ..., -5.9891e-04,
            2.4843e-04, -2.1591e-02],
          [ 3.2898e-02,  1.7380e-02,  4.6234e-02,  ..., -5.6549e-02,
            6.9733e-03,  5.7861e-02],
          [-1.7380e-02,  1.1816e-03, -5.7892e-02,  ..., -3.5278e-02,
           -5.3772e-02,  2.9007e-02],
          ...,
          [ 1.0178e-02, -1.1517e-01, -7.9250e-04,  ..., -3.3722e-03,
            3.9886e-02,  1.3367e-02],
          [-5.5389e-02, -8.7585e-02, -8.7402e-02,  ..., -3.4308e-04,
            3.5126e-02,  3.8574e-02],
          [ 1.9806e-02, -3.1708e-02,  5.1231e-03,  ...,  1.7033e-03,
           -3.3783e-02,  4.9164e-02]],

         [[-1.3721e-01,  5.7281e-02,  6.5186e-02,  ...,  1.8097e-02,
            6.0043e-03, -2.4002e-02],
          [ 7.4341e-02,  4.9652e-02,  8.0566e-02,  ..., -6.5552e-02,
            6.0852e-02,  1.1859e-01],
          [-4.6265e-02, -2.3403e-03, -6.9641e-02,  ..., -2.6962e-02,
           -5.0720e-02,  6.3721e-02],
          ...,
          [-1.1421e-02, -1.9080e-01, -1.3745e-04,  ..., -2.3880e-02,
            9.1125e-02,  1.0696e-02],
          [-2.2690e-02, -3.3423e-01, -9.2285e-02,  ..., -1.0999e-01,
            1.1084e-01,  2.8152e-02],
          [ 3.9215e-02, -6.3049e-02,  1.4786e-02,  ..., -4.3091e-02,
           -9.2041e-02,  2.7222e-01]],

         [[-1.3733e-01,  8.6792e-02,  5.8441e-02,  ...,  2.6764e-02,
           -1.8585e-02, -3.1647e-02],
          [ 6.7261e-02,  3.3508e-02,  9.2102e-02,  ..., -8.3069e-02,
            5.0018e-02,  1.2238e-01],
          [-5.6854e-02, -2.1561e-02, -8.6182e-02,  ..., -5.4077e-02,
           -8.0444e-02,  6.0913e-02],
          ...,
          [ 5.6534e-03, -1.8970e-01,  3.5610e-03,  ..., -1.0956e-02,
            8.5693e-02,  1.2579e-03],
          [-2.1988e-02, -3.3667e-01, -5.9998e-02,  ..., -7.1411e-02,
            8.8745e-02,  4.5807e-02],
          [ 3.9124e-02, -8.1848e-02,  2.7161e-02,  ..., -8.0719e-03,
           -2.4506e-02,  3.1836e-01]],

         ...,

         [[-1.4441e-01,  7.3792e-02,  5.3772e-02,  ...,  1.5297e-02,
           -1.5640e-02, -3.0899e-02],
          [ 7.1350e-02,  3.0701e-02,  9.9365e-02,  ..., -6.8726e-02,
            4.6600e-02,  1.3525e-01],
          [-6.4209e-02,  1.0204e-03, -1.0199e-01,  ..., -7.2815e-02,
           -8.1848e-02,  7.0801e-02],
          ...,
          [ 1.6098e-02, -1.9458e-01, -1.1658e-02,  ..., -6.0234e-03,
            8.6853e-02, -1.2283e-02],
          [ 2.9739e-02, -2.5000e-01, -1.1395e-01,  ..., -1.3318e-01,
            6.1188e-02,  4.6021e-02],
          [-9.6655e-04, -9.0820e-02,  7.0740e-02,  ..., -4.4739e-02,
           -6.3171e-02, -2.8833e-01]],

         [[-1.3416e-01,  6.9336e-02,  6.1646e-02,  ...,  1.7365e-02,
           -1.7334e-02, -2.7985e-02],
          [ 7.9773e-02,  3.7994e-02,  9.5276e-02,  ..., -6.7810e-02,
            4.6478e-02,  1.4233e-01],
          [-7.2388e-02, -7.7362e-03, -1.0815e-01,  ..., -8.2153e-02,
           -7.3486e-02,  8.2581e-02],
          ...,
          [ 1.1673e-02, -2.0276e-01, -7.7343e-04,  ..., -8.4763e-03,
            8.0017e-02, -2.1393e-02],
          [ 4.4189e-02, -2.2546e-01, -1.1230e-01,  ..., -1.6284e-01,
            8.8989e-02,  5.4291e-02],
          [ 1.6022e-02, -1.1908e-01,  4.6692e-02,  ..., -8.1177e-02,
           -1.1694e-01, -1.6321e-01]],

         [[-1.4331e-01,  6.4148e-02,  5.0476e-02,  ...,  2.9083e-02,
           -7.8583e-03, -3.3752e-02],
          [ 7.5623e-02,  3.4760e-02,  9.4177e-02,  ..., -6.7932e-02,
            4.4830e-02,  1.5002e-01],
          [-6.8542e-02, -1.3855e-02, -1.0492e-01,  ..., -8.2336e-02,
           -8.3496e-02,  7.9834e-02],
          ...,
          [ 1.0414e-03, -2.1130e-01, -1.1101e-03,  ..., -1.4687e-02,
            8.7219e-02, -9.9716e-03],
          [ 7.2205e-02, -2.2351e-01, -9.9304e-02,  ..., -1.8579e-01,
            1.0339e-01,  4.6509e-02],
          [ 3.5095e-02, -1.3403e-01,  2.3529e-02,  ..., -6.6528e-02,
           -1.0889e-01,  8.3130e-02]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[-1.3770e-01,  7.2205e-02,  5.4932e-02,  ...,  2.3056e-02,
          -1.1665e-02, -3.2074e-02],
         [ 6.8176e-02,  3.3203e-02,  8.8501e-02,  ..., -7.0862e-02,
           4.3457e-02,  1.2488e-01],
         [-6.3416e-02, -4.7340e-03, -9.7046e-02,  ..., -6.9275e-02,
          -7.9224e-02,  7.1899e-02],
         ...,
         [ 6.8283e-03, -1.9678e-01, -3.0746e-03,  ..., -1.0201e-02,
           8.4534e-02, -8.7738e-03],
         [ 6.8512e-03, -2.7588e-01, -9.3384e-02,  ..., -1.1096e-01,
           8.0566e-02,  4.3823e-02],
         [ 2.0508e-02, -8.1238e-02,  3.8788e-02,  ..., -2.2751e-02,
          -5.0507e-02,  7.0190e-02]],

        [[-1.3342e-01,  6.9275e-02,  5.3314e-02,  ...,  2.1927e-02,
          -1.1269e-02, -3.1738e-02],
         [ 5.3009e-02,  2.6855e-02,  6.9946e-02,  ..., -6.4514e-02,
           2.8183e-02,  9.5398e-02],
         [-4.5410e-02, -1.4839e-03, -8.2642e-02,  ..., -5.6702e-02,
          -6.8237e-02,  5.5267e-02],
         ...,
         [ 7.4806e-03, -1.7688e-01, -2.7218e-03,  ..., -8.6365e-03,
           7.4280e-02, -3.0880e-03],
         [-1.1810e-02, -2.2449e-01, -9.1553e-02,  ..., -7.9102e-02,
           6.8237e-02,  4.1992e-02],
         [ 2.0599e-02, -5.8289e-02,  2.0828e-02,  ..., -1.7105e-02,
          -5.0568e-02,  4.0497e-02]],

        [[-1.3721e-01,  7.2083e-02,  5.4535e-02,  ...,  2.3239e-02,
          -1.1642e-02, -3.2288e-02],
         [ 6.2683e-02,  3.2196e-02,  8.0078e-02,  ..., -6.7444e-02,
           3.8666e-02,  1.1230e-01],
         [-6.3049e-02, -7.3509e-03, -9.7351e-02,  ..., -6.9641e-02,
          -7.4280e-02,  7.3669e-02],
         ...,
         [ 6.9733e-03, -1.9055e-01, -3.0441e-03,  ..., -9.8801e-03,
           8.1177e-02, -7.3090e-03],
         [-7.8812e-03, -2.3535e-01, -9.1858e-02,  ..., -8.6182e-02,
           7.1472e-02,  4.2236e-02],
         [ 2.2202e-02, -6.6528e-02,  2.5726e-02,  ..., -2.1988e-02,
          -5.4688e-02,  6.3721e-02]],

        ...,

        [[-1.3989e-01,  7.4707e-02,  5.4718e-02,  ...,  2.3148e-02,
          -1.3260e-02, -3.2471e-02],
         [ 6.6040e-02,  3.3478e-02,  8.4961e-02,  ..., -7.0129e-02,
           4.2847e-02,  1.1926e-01],
         [-6.1035e-02, -1.0386e-03, -9.3689e-02,  ..., -6.6345e-02,
          -8.2520e-02,  6.7993e-02],
         ...,
         [ 6.6452e-03, -1.9495e-01, -2.8362e-03,  ..., -1.0231e-02,
           8.3496e-02, -7.7820e-03],
         [-3.7994e-03, -2.5000e-01, -9.2346e-02,  ..., -9.3384e-02,
           7.3853e-02,  4.2725e-02],
         [ 1.8890e-02, -7.2876e-02,  3.6835e-02,  ..., -2.2461e-02,
          -5.1300e-02,  4.0619e-02]],

        [[-1.3916e-01,  7.2693e-02,  5.5023e-02,  ...,  2.2125e-02,
          -1.3351e-02, -3.1738e-02],
         [ 6.6345e-02,  3.2990e-02,  8.6182e-02,  ..., -7.0618e-02,
           4.2664e-02,  1.2048e-01],
         [-6.4392e-02,  3.8207e-05, -9.9792e-02,  ..., -7.1411e-02,
          -8.1421e-02,  7.1594e-02],
         ...,
         [ 7.3700e-03, -1.9507e-01, -3.3684e-03,  ..., -9.6283e-03,
           8.3679e-02, -8.7357e-03],
         [-3.7327e-03, -2.4792e-01, -9.2529e-02,  ..., -9.3079e-02,
           7.3486e-02,  4.2786e-02],
         [ 1.9302e-02, -7.3486e-02,  3.5553e-02,  ..., -2.4338e-02,
          -5.3986e-02,  3.6896e-02]],

        [[-1.3794e-01,  6.9946e-02,  5.4871e-02,  ...,  2.2110e-02,
          -1.2558e-02, -3.1342e-02],
         [ 6.7017e-02,  3.3203e-02,  8.6792e-02,  ..., -7.0435e-02,
           4.2908e-02,  1.2170e-01],
         [-6.7505e-02, -4.2686e-03, -1.0364e-01,  ..., -7.6477e-02,
          -7.8308e-02,  7.6294e-02],
         ...,
         [ 7.7324e-03, -1.9556e-01, -3.6087e-03,  ..., -9.4604e-03,
           8.3679e-02, -9.6512e-03],
         [-4.0169e-03, -2.4585e-01, -9.2529e-02,  ..., -9.2529e-02,
           7.3303e-02,  4.2725e-02],
         [ 1.9974e-02, -7.3792e-02,  3.3234e-02,  ..., -2.6245e-02,
          -5.7098e-02,  3.3936e-02]]], device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[-0.5181, -0.0325, -0.2019,  ..., -0.1226,  0.1266, -0.1266],
          [-0.1675, -0.2871,  0.2406,  ..., -0.4253, -0.2252,  0.2240],
          [ 0.3618, -0.1884, -0.2661,  ..., -0.5005,  0.6616, -0.6016],
          ...,
          [ 0.4314, -0.3250, -0.5020,  ...,  0.2898, -0.9136, -0.5229],
          [-0.4692, -0.5220,  0.4355,  ...,  0.6440,  0.0385, -0.0142],
          [ 0.8936, -0.4395,  0.3955,  ..., -0.4888, -0.1870, -0.0492]],

         [[ 0.4695, -1.5166,  0.4294,  ...,  0.4180,  1.1758,  1.4102],
          [ 0.7832, -0.2377, -1.3701,  ...,  0.4751,  1.3457, -1.3438],
          [-1.4473, -1.8125, -0.5161,  ..., -0.4102,  1.1328,  0.9399],
          ...,
          [-0.2644, -0.7471, -1.8945,  ..., -1.7451,  1.8574,  1.6631],
          [ 0.2605, -0.1516,  0.3074,  ...,  0.0490,  0.0990, -0.0338],
          [-1.7715, -1.5508, -1.4658,  ..., -0.5366, -1.9189,  1.7334]],

         [[ 0.3047, -1.3330,  0.2712,  ...,  0.2069,  1.1396,  1.3711],
          [ 0.7324, -0.1141, -1.2744,  ...,  0.4836,  1.2480, -1.2480],
          [-1.6768, -1.7988, -0.4734,  ..., -0.7944,  1.2227,  0.7222],
          ...,
          [-0.2377, -0.7197, -1.5645,  ..., -1.6504,  2.1191,  1.6250],
          [ 0.2859, -0.2153,  0.2788,  ..., -0.0729, -0.0684,  0.1019],
          [-1.6514, -1.9053, -1.8203,  ..., -0.2773, -1.9717,  1.6270]],

         ...,

         [[ 0.1936, -1.1865,  0.2001,  ...,  0.2499,  0.9365,  1.3438],
          [ 0.7480, -0.1009, -1.1895,  ...,  0.4434,  1.1641, -1.1631],
          [-1.7930, -1.7764, -0.6719,  ..., -0.7925,  1.3213,  0.7139],
          ...,
          [-0.4446, -0.6167, -1.6074,  ..., -1.6045,  2.0488,  1.5635],
          [ 0.2416, -0.1002,  0.2996,  ..., -0.1357, -0.1263,  0.0393],
          [-1.6885, -2.3281, -2.1191,  ..., -0.3755, -2.0977,  1.4385]],

         [[ 0.1578, -1.1631,  0.1737,  ...,  0.2458,  0.8833,  1.3486],
          [ 0.7393, -0.0927, -1.1514,  ...,  0.4150,  1.1260, -1.1260],
          [-1.9307, -1.8770, -0.8188,  ..., -0.8384,  1.3096,  0.7207],
          ...,
          [-0.5078, -0.5718, -1.6299,  ..., -1.6670,  2.1738,  1.5400],
          [ 0.1730, -0.1124,  0.3037,  ..., -0.2158, -0.1111,  0.0495],
          [-1.8018, -2.4316, -2.1445,  ..., -0.4443, -2.0410,  1.3945]],

         [[ 0.1450, -1.1621,  0.1715,  ...,  0.2522,  0.8599,  1.3291],
          [ 0.6851, -0.0566, -1.1260,  ...,  0.3899,  1.1016, -1.1006],
          [-2.0098, -1.8887, -0.8306,  ..., -0.8228,  1.2891,  0.6343],
          ...,
          [-0.5518, -0.6499, -1.5137,  ..., -1.6562,  2.2129,  1.4629],
          [ 0.1885, -0.1666,  0.3123,  ..., -0.2224, -0.0502,  0.0582],
          [-2.1074, -2.4531, -1.9453,  ..., -0.4971, -1.9658,  1.3389]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[ 0.9746,  0.3232, -0.8262,  ..., -0.3037, -0.1205,  0.2300],
          [ 0.7412,  1.4697, -0.4409,  ...,  0.9922,  0.4287, -0.4290],
          [-0.0912,  0.5303,  0.5332,  ...,  0.0781, -1.4893,  1.4463],
          ...,
          [ 1.9385, -0.0842, -0.7549,  ...,  0.7432,  1.7852,  1.1807],
          [ 0.7656,  0.3152, -1.7764,  ..., -1.3330, -1.3584,  1.0986],
          [-1.0566,  2.0625, -1.3838,  ...,  2.1777,  1.0820, -0.5874]],

         [[-1.1895, -1.3506,  0.6919,  ..., -1.5371,  0.5586, -2.3223],
          [ 0.3428, -1.8389,  0.7485,  ...,  0.1992, -0.7266,  0.7300],
          [ 1.1758, -0.0517, -0.8828,  ..., -0.3450,  0.0105, -0.6343],
          ...,
          [ 0.5742, -1.8682, -3.4199,  ..., -1.3721, -0.6211, -0.0118],
          [-2.6445, -2.7891,  0.6050,  ...,  1.5869, -0.4397, -1.2539],
          [ 1.3398,  0.4983,  0.0175,  ...,  0.9463, -0.7349, -0.2812]],

         [[-1.0244, -1.5830,  0.5444,  ..., -1.2969,  0.8408, -1.9375],
          [ 0.3452, -1.5596,  0.6758,  ...,  0.2427, -0.6538,  0.6567],
          [ 1.1865, -0.3066, -0.8999,  ..., -0.5552,  0.0666, -0.5972],
          ...,
          [ 0.5239, -1.8555, -3.2148,  ..., -1.4648, -0.4470, -0.0961],
          [-2.6523, -2.4961,  0.5566,  ...,  1.5078, -0.6147, -1.2031],
          [ 1.2305,  0.2059,  0.0755,  ...,  0.8330, -0.7466,  0.0076]],

         ...,

         [[-1.0371, -1.5303,  0.4185,  ..., -0.9883,  0.9536, -1.7275],
          [ 0.3174, -1.0664,  0.5728,  ...,  0.6216, -0.5562,  0.5581],
          [ 1.0420, -0.1996, -1.0752,  ..., -0.5264, -0.0423, -0.5361],
          ...,
          [ 0.4375, -1.7959, -3.3086,  ..., -1.3555, -0.5562, -0.2812],
          [-2.2910, -2.3047,  0.6118,  ...,  1.4199, -0.5830, -1.2383],
          [ 0.7925, -0.2690, -0.2413,  ...,  0.7974, -0.7334, -0.2267]],

         [[-1.1475, -1.4980,  0.4136,  ..., -0.9214,  0.9688, -1.7080],
          [ 0.2729, -0.8286,  0.5693,  ...,  0.6182, -0.5508,  0.5522],
          [ 1.0342, -0.2869, -1.2070,  ..., -0.5376, -0.0381, -0.5981],
          ...,
          [ 0.4277, -1.7158, -3.3730,  ..., -1.3955, -0.5610, -0.3000],
          [-2.0508, -2.3066,  0.6733,  ...,  1.3955, -0.5293, -1.3887],
          [ 0.6235, -0.3943, -0.1953,  ...,  0.7197, -0.7681, -0.3208]],

         [[-1.1787, -1.5410,  0.4131,  ..., -0.9453,  0.9839, -1.6992],
          [ 0.1771, -0.8682,  0.5918,  ...,  0.3887, -0.5762,  0.5771],
          [ 1.0273, -0.2642, -1.0967,  ..., -0.4336, -0.0703, -0.5859],
          ...,
          [ 0.4932, -1.7627, -3.3223,  ..., -1.3779, -0.6069, -0.3655],
          [-2.1055, -2.3613,  0.7515,  ...,  1.3438, -0.4509, -1.4111],
          [ 0.5425, -0.3992, -0.1328,  ...,  0.5767, -0.6934, -0.5542]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[-0.0047,  0.0018, -0.0048,  ...,  0.0020, -0.0023, -0.0008],
          [ 0.0015, -0.0071, -0.0045,  ..., -0.0029,  0.0026,  0.0012],
          [ 0.0020,  0.0037,  0.0049,  ...,  0.0020, -0.0053,  0.0087],
          ...,
          [-0.0039, -0.0077, -0.0082,  ...,  0.0014,  0.0050, -0.0032],
          [-0.0024,  0.0015,  0.0019,  ..., -0.0051,  0.0149,  0.0062],
          [ 0.0097, -0.0152,  0.0011,  ..., -0.0084, -0.0014,  0.0015]],

         [[-0.1154,  0.0028,  0.0737,  ...,  0.0844, -0.1586, -0.0774],
          [-0.0221, -0.0503,  0.0430,  ...,  0.0436, -0.0495, -0.1109],
          [ 0.0502, -0.0085,  0.1060,  ...,  0.1176, -0.2815, -0.2864],
          ...,
          [ 0.0296, -0.0064,  0.1141,  ...,  0.0876,  0.0418, -0.0252],
          [-0.0825, -0.2505,  0.0739,  ..., -0.1394,  0.3621,  0.0656],
          [ 0.1171,  0.0112, -0.1218,  ...,  0.0212, -0.0209, -0.0203]],

         [[-0.1111,  0.0127,  0.0421,  ...,  0.0709, -0.1525, -0.0395],
          [-0.0329, -0.0266,  0.0526,  ...,  0.0594, -0.0594, -0.0869],
          [-0.0202,  0.0161,  0.1086,  ...,  0.1290, -0.2517, -0.2517],
          ...,
          [ 0.0063, -0.0050,  0.1074,  ...,  0.0903,  0.0571,  0.0352],
          [-0.0089, -0.2429,  0.0775,  ..., -0.1411,  0.3032,  0.0683],
          [ 0.0888, -0.0128, -0.1279,  ...,  0.0186,  0.0313, -0.0605]],

         ...,

         [[-0.1005,  0.0135,  0.0331,  ...,  0.0249, -0.1998, -0.0038],
          [-0.0273, -0.0333,  0.0375,  ...,  0.0353, -0.0632, -0.0934],
          [-0.0309,  0.0762,  0.0912,  ...,  0.1306, -0.2603, -0.2471],
          ...,
          [-0.0009, -0.0072,  0.1049,  ...,  0.0997,  0.0624,  0.0443],
          [ 0.0361, -0.2396,  0.0435,  ..., -0.1492,  0.2722,  0.0643],
          [ 0.0565, -0.0232, -0.1132,  ...,  0.0086,  0.0330, -0.0784]],

         [[-0.1110,  0.0291,  0.0378,  ..., -0.0055, -0.2036, -0.0010],
          [-0.0311, -0.0358,  0.0345,  ...,  0.0307, -0.0593, -0.0917],
          [-0.0153,  0.0881,  0.0980,  ...,  0.1426, -0.2622, -0.2607],
          ...,
          [-0.0049,  0.0017,  0.1094,  ...,  0.1078,  0.0642,  0.0416],
          [ 0.0487, -0.2329,  0.0476,  ..., -0.1610,  0.2773,  0.0642],
          [ 0.0626, -0.0097, -0.1118,  ...,  0.0101,  0.0310, -0.0669]],

         [[-0.1118,  0.0177,  0.0292,  ..., -0.0081, -0.1980, -0.0017],
          [-0.0286, -0.0396,  0.0304,  ...,  0.0304, -0.0605, -0.0936],
          [-0.0165,  0.0670,  0.1077,  ...,  0.1313, -0.2539, -0.2732],
          ...,
          [ 0.0015,  0.0092,  0.1147,  ...,  0.1097,  0.0696,  0.0446],
          [ 0.0463, -0.2145,  0.0474,  ..., -0.1522,  0.2654,  0.0808],
          [ 0.0602, -0.0156, -0.1236,  ...,  0.0179,  0.0339, -0.0590]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[-0.1073,  0.0151,  0.0425,  ...,  0.0369, -0.1744, -0.0246],
         [-0.0289, -0.0352,  0.0405,  ...,  0.0417, -0.0594, -0.0915],
         [-0.0126,  0.0437,  0.1022,  ...,  0.1302, -0.2622, -0.2583],
         ...,
         [ 0.0061, -0.0013,  0.1074,  ...,  0.0975,  0.0589,  0.0321],
         [ 0.0075, -0.2389,  0.0579,  ..., -0.1461,  0.2905,  0.0656],
         [ 0.0726, -0.0124, -0.1207,  ...,  0.0156,  0.0266, -0.0595]],

        [[-0.0887,  0.0143,  0.0307,  ...,  0.0235, -0.1483, -0.0134],
         [-0.0220, -0.0280,  0.0293,  ...,  0.0302, -0.0454, -0.0686],
         [ 0.0007,  0.0075,  0.0151,  ...,  0.0153, -0.0321, -0.0191],
         ...,
         [ 0.0090, -0.0033,  0.0978,  ...,  0.0862,  0.0510,  0.0214],
         [ 0.0039, -0.0598,  0.0154,  ..., -0.0419,  0.0831,  0.0216],
         [ 0.0640, -0.0151, -0.1169,  ...,  0.0137,  0.0313, -0.0635]],

        [[-0.0903,  0.0145,  0.0315,  ...,  0.0242, -0.1509, -0.0139],
         [-0.0197, -0.0258,  0.0260,  ...,  0.0270, -0.0408, -0.0617],
         [ 0.0011,  0.0061,  0.0112,  ...,  0.0103, -0.0220, -0.0087],
         ...,
         [ 0.0084, -0.0033,  0.0965,  ...,  0.0855,  0.0509,  0.0224],
         [ 0.0041, -0.0615,  0.0157,  ..., -0.0428,  0.0850,  0.0220],
         [ 0.0637, -0.0151, -0.1174,  ...,  0.0136,  0.0317, -0.0643]],

        ...,

        [[-0.0870,  0.0140,  0.0300,  ...,  0.0229, -0.1454, -0.0132],
         [-0.0209, -0.0268,  0.0277,  ...,  0.0287, -0.0432, -0.0650],
         [ 0.0006,  0.0074,  0.0143,  ...,  0.0144, -0.0301, -0.0170],
         ...,
         [ 0.0083, -0.0030,  0.0994,  ...,  0.0883,  0.0526,  0.0242],
         [ 0.0045, -0.0674,  0.0171,  ..., -0.0464,  0.0917,  0.0234],
         [ 0.0624, -0.0153, -0.1174,  ...,  0.0133,  0.0325, -0.0654]],

        [[-0.0846,  0.0137,  0.0289,  ...,  0.0221, -0.1414, -0.0128],
         [-0.0195, -0.0255,  0.0257,  ...,  0.0267, -0.0403, -0.0608],
         [ 0.0006,  0.0073,  0.0140,  ...,  0.0140, -0.0294, -0.0162],
         ...,
         [ 0.0083, -0.0030,  0.1005,  ...,  0.0892,  0.0531,  0.0246],
         [ 0.0042, -0.0642,  0.0164,  ..., -0.0444,  0.0880,  0.0226],
         [ 0.0621, -0.0153, -0.1174,  ...,  0.0133,  0.0327, -0.0655]],

        [[-0.0833,  0.0135,  0.0283,  ...,  0.0217, -0.1389, -0.0125],
         [-0.0175, -0.0238,  0.0228,  ...,  0.0239, -0.0363, -0.0549],
         [ 0.0008,  0.0069,  0.0130,  ...,  0.0126, -0.0267, -0.0134],
         ...,
         [ 0.0081, -0.0030,  0.0992,  ...,  0.0883,  0.0527,  0.0246],
         [ 0.0041, -0.0630,  0.0161,  ..., -0.0437,  0.0867,  0.0223],
         [ 0.0619, -0.0153, -0.1172,  ...,  0.0133,  0.0326, -0.0652]]],
       device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[ 2.7856e-01,  2.6562e-01,  4.8755e-01,  ...,  3.6450e-01,
            3.7549e-01, -3.5693e-01],
          [-3.0005e-01,  4.2700e-01, -1.5898e-03,  ...,  1.9373e-01,
           -2.4829e-01,  6.4014e-01],
          [ 3.0298e-01,  1.2622e-01,  4.3628e-01,  ..., -3.1372e-01,
            1.3672e-02,  9.2468e-02],
          ...,
          [-8.2397e-02,  1.4661e-01,  8.8989e-02,  ...,  1.6125e-01,
           -4.9622e-02,  7.5928e-02],
          [ 1.5601e-01, -1.2769e-01, -1.0895e-01,  ...,  4.1504e-02,
           -2.6440e-01, -1.4389e-04],
          [ 2.2522e-01, -1.5234e-01,  1.1157e-01,  ...,  4.2383e-01,
            2.0447e-01, -2.2595e-01]],

         [[-3.8501e-01,  2.0508e+00,  3.0029e-01,  ..., -2.2617e+00,
           -4.6924e-01,  9.1650e-01],
          [ 2.8290e-02, -2.9082e+00, -6.5137e-01,  ..., -2.1582e+00,
            1.6650e+00, -7.0459e-01],
          [-1.0029e+00,  1.3555e+00, -4.0137e-01,  ...,  4.7583e-01,
           -1.8530e-01, -3.7402e-01],
          ...,
          [-2.2449e-01,  5.9912e-01,  1.8713e-01,  ...,  6.0889e-01,
           -6.9434e-01, -1.3066e+00],
          [ 1.2469e-01, -3.5205e-01,  9.7900e-01,  ..., -1.8379e+00,
           -2.5952e-01,  1.0146e+00],
          [-1.4541e+00, -1.4785e+00,  1.3757e-01,  ..., -6.4746e-01,
            3.7476e-01,  2.3901e-01]],

         [[-2.1826e-01,  2.5098e+00,  2.9150e-01,  ..., -2.2520e+00,
           -6.2012e-01,  9.7510e-01],
          [-9.6741e-02, -2.9316e+00, -5.6543e-01,  ..., -2.0137e+00,
            1.2490e+00, -6.4258e-01],
          [-9.2578e-01,  1.5205e+00, -4.7778e-01,  ...,  5.7227e-01,
           -1.7566e-01, -9.4531e-01],
          ...,
          [-2.9468e-01,  6.0742e-01,  2.7075e-01,  ...,  7.9639e-01,
           -5.8594e-01, -1.3018e+00],
          [ 2.6831e-01, -3.1128e-01,  8.9941e-01,  ..., -1.9697e+00,
           -3.2324e-01,  8.8525e-01],
          [-1.3252e+00, -1.9141e+00,  3.3350e-01,  ..., -4.3164e-01,
            7.6660e-01,  2.2083e-01]],

         ...,

         [[-4.4312e-01,  2.4414e+00,  3.0493e-01,  ..., -2.5117e+00,
           -7.8223e-01,  9.2676e-01],
          [-5.0586e-01, -2.9355e+00, -5.0928e-01,  ..., -2.1914e+00,
            9.4043e-01, -6.5918e-01],
          [-9.0820e-01,  1.6113e+00, -8.1445e-01,  ...,  9.5459e-01,
           -6.4209e-01, -1.4473e+00],
          ...,
          [-3.1934e-01,  4.5703e-01,  3.0078e-01,  ...,  8.1934e-01,
           -7.0068e-01, -1.2812e+00],
          [ 3.6182e-01, -4.4482e-01,  9.5410e-01,  ..., -2.0176e+00,
           -2.7124e-01,  1.1377e+00],
          [-1.7354e+00, -2.1445e+00,  4.9561e-01,  ..., -2.9639e-01,
            8.8525e-01,  1.5808e-01]],

         [[-4.9341e-01,  2.3613e+00,  2.8076e-01,  ..., -2.3770e+00,
           -8.3105e-01,  9.1406e-01],
          [-4.4629e-01, -2.8145e+00, -3.8745e-01,  ..., -2.2617e+00,
            9.1260e-01, -7.6318e-01],
          [-9.5117e-01,  1.8428e+00, -8.3789e-01,  ...,  8.0127e-01,
           -8.0566e-01, -1.6025e+00],
          ...,
          [-3.2935e-01,  3.7720e-01,  3.1470e-01,  ...,  7.3193e-01,
           -7.4561e-01, -1.2607e+00],
          [ 4.2041e-01, -4.6582e-01,  9.2969e-01,  ..., -1.9834e+00,
           -2.8711e-01,  1.1904e+00],
          [-1.6211e+00, -2.1465e+00,  4.5874e-01,  ..., -2.8760e-01,
            8.6572e-01,  2.3230e-01]],

         [[-4.0283e-01,  2.3652e+00,  2.8052e-01,  ..., -2.4062e+00,
           -8.7646e-01,  8.9307e-01],
          [-4.1602e-01, -2.6973e+00, -3.6719e-01,  ..., -2.1992e+00,
            8.9014e-01, -6.0010e-01],
          [-9.6875e-01,  1.8076e+00, -1.0361e+00,  ...,  8.0811e-01,
           -9.1113e-01, -1.6250e+00],
          ...,
          [-3.4009e-01,  4.5801e-01,  3.2178e-01,  ...,  7.6562e-01,
           -6.5332e-01, -1.1992e+00],
          [ 5.4199e-01, -5.3857e-01,  8.8818e-01,  ..., -1.9854e+00,
           -2.8394e-01,  1.2344e+00],
          [-1.6465e+00, -2.2090e+00,  4.7656e-01,  ..., -3.3887e-01,
            8.8623e-01,  2.6050e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[-7.2656e-01, -8.3545e-01, -1.3936e+00,  ..., -5.0146e-01,
           -6.5479e-01,  2.1753e-01],
          [ 1.4434e+00, -1.3789e+00, -5.1318e-01,  ..., -1.1738e+00,
            3.9575e-01, -1.3887e+00],
          [-1.1133e+00, -2.2314e-01, -9.6973e-01,  ...,  5.6641e-01,
           -2.8784e-01,  2.5366e-01],
          ...,
          [ 3.9673e-01, -1.8689e-01, -4.4702e-01,  ..., -3.0176e-01,
            8.2825e-02,  1.8738e-01],
          [-5.9570e-02, -4.6997e-02, -3.2532e-02,  ..., -4.9377e-02,
            5.3418e-01,  3.5492e-02],
          [-3.0884e-01,  3.4570e-01, -8.6865e-01,  ..., -7.8125e-01,
           -5.8252e-01,  5.3320e-01]],

         [[ 1.2363e+00,  1.4658e+00,  2.6465e+00,  ...,  1.9629e+00,
            1.0742e+00,  1.4185e-01],
          [-1.0898e+00, -9.7595e-02, -2.5439e-01,  ..., -3.8794e-01,
            1.1094e+00,  5.2344e-01],
          [ 1.1250e+00,  3.0391e+00,  9.7852e-01,  ..., -3.4351e-01,
            1.7002e+00, -5.1270e-01],
          ...,
          [-7.3047e-01,  1.5498e+00,  6.7676e-01,  ...,  1.0322e+00,
           -1.4929e-01, -1.5303e+00],
          [-6.4795e-01, -2.1622e-02, -3.4570e-01,  ..., -2.5977e-01,
           -2.4688e+00, -1.2012e+00],
          [ 1.4238e+00, -3.0640e-02, -7.5073e-02,  ...,  1.8652e+00,
            4.6875e-01,  2.9639e-01]],

         [[ 1.1357e+00,  1.2246e+00,  2.5508e+00,  ...,  1.9844e+00,
            1.0332e+00,  1.6937e-02],
          [-1.2256e+00, -3.0176e-01, -2.5879e-01,  ..., -2.1252e-01,
            8.5400e-01,  5.6592e-01],
          [ 9.7070e-01,  3.2148e+00,  9.4580e-01,  ...,  7.4768e-02,
            1.4658e+00, -8.7207e-01],
          ...,
          [-8.4424e-01,  1.5166e+00,  7.9932e-01,  ...,  9.1016e-01,
            9.7595e-02, -1.3096e+00],
          [-6.8652e-01, -1.6270e-03, -3.9722e-01,  ..., -3.3911e-01,
           -2.5527e+00, -1.1201e+00],
          [ 1.4824e+00, -2.7319e-01, -6.1340e-02,  ...,  1.6182e+00,
            7.0020e-01,  1.5906e-01]],

         ...,

         [[ 1.0205e+00,  1.0107e+00,  2.5859e+00,  ...,  1.7500e+00,
            5.3418e-01, -5.2704e-02],
          [-1.3340e+00, -2.8442e-01, -3.7305e-01,  ..., -4.4312e-01,
            8.6816e-01,  4.1113e-01],
          [ 9.8096e-01,  3.8164e+00,  6.4697e-01,  ...,  5.1758e-01,
            1.2041e+00, -1.3691e+00],
          ...,
          [-9.2285e-01,  1.3252e+00,  8.7793e-01,  ...,  1.0244e+00,
            1.0162e-01, -1.2256e+00],
          [-8.1006e-01, -1.9058e-02, -3.9307e-01,  ..., -2.7759e-01,
           -2.5801e+00, -1.1748e+00],
          [ 1.5439e+00, -5.8447e-01, -3.8239e-02,  ...,  1.5420e+00,
            9.3994e-01, -9.2834e-02]],

         [[ 1.0488e+00,  9.1113e-01,  2.6250e+00,  ...,  1.7676e+00,
            4.0503e-01, -1.6797e-01],
          [-1.3096e+00, -1.3208e-01, -2.9077e-01,  ..., -4.3823e-01,
            9.5117e-01,  3.4229e-01],
          [ 1.0332e+00,  4.0117e+00,  5.9619e-01,  ...,  5.1172e-01,
            1.1719e+00, -1.4414e+00],
          ...,
          [-9.8877e-01,  1.0996e+00,  9.3799e-01,  ...,  9.8389e-01,
            1.1456e-01, -1.3193e+00],
          [-7.6318e-01, -5.3314e-02, -4.1895e-01,  ..., -1.7542e-01,
           -2.5898e+00, -1.2715e+00],
          [ 1.4922e+00, -4.9829e-01, -1.2711e-02,  ...,  1.5352e+00,
            1.0596e+00, -1.8799e-01]],

         [[ 1.0195e+00,  7.9736e-01,  2.6641e+00,  ...,  1.7412e+00,
            3.9746e-01, -1.8640e-01],
          [-1.3271e+00, -2.6875e-03, -2.5781e-01,  ..., -3.5059e-01,
            9.8486e-01,  4.5630e-01],
          [ 1.0352e+00,  3.9883e+00,  5.4443e-01,  ...,  5.4248e-01,
            1.0596e+00, -1.6201e+00],
          ...,
          [-1.0010e+00,  1.0166e+00,  9.5850e-01,  ...,  9.7900e-01,
            2.3010e-01, -1.2568e+00],
          [-7.7588e-01,  7.5317e-02, -4.2334e-01,  ..., -1.5869e-01,
           -2.6191e+00, -1.3623e+00],
          [ 1.3828e+00, -4.7437e-01, -1.3687e-02,  ...,  1.4648e+00,
            1.1865e+00, -1.0394e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[-1.4055e-04,  7.7009e-04,  1.5278e-03,  ...,  7.8049e-03,
            7.0333e-04, -5.0850e-03],
          [ 7.8735e-03,  4.0936e-04,  1.1740e-03,  ...,  3.7174e-03,
           -1.8406e-03,  2.4338e-03],
          [ 3.5667e-04,  8.0490e-04,  4.6768e-03,  ...,  1.2474e-03,
            6.2752e-03,  4.3793e-03],
          ...,
          [-3.5343e-03, -3.1643e-03, -6.7215e-03,  ..., -2.5711e-03,
           -1.0063e-02, -3.2463e-03],
          [-4.9934e-03,  1.9274e-03, -1.3237e-02,  ...,  3.5114e-03,
           -5.8365e-03, -1.1330e-03],
          [ 1.0843e-03,  9.6464e-04, -2.5043e-03,  ...,  2.3117e-03,
           -2.1820e-03,  2.1267e-03]],

         [[ 9.0485e-03,  2.2961e-01,  6.7810e-02,  ...,  5.6839e-03,
            2.2339e-01, -4.3427e-02],
          [ 1.9104e-01, -3.4375e-01, -1.2103e-01,  ..., -1.3208e-01,
            2.6733e-01, -1.9727e-01],
          [ 5.8319e-02,  1.0321e-01, -1.4336e-02,  ...,  1.0474e-01,
           -1.7810e-01,  3.2568e-01],
          ...,
          [-5.7182e-03, -1.9641e-01, -2.9053e-01,  ..., -3.3496e-01,
            5.7770e-02,  2.5635e-01],
          [-9.7351e-02, -5.9418e-02, -2.0654e-01,  ...,  2.2449e-01,
           -2.6294e-01, -4.0576e-01],
          [ 1.8890e-02,  1.8457e-01, -1.6455e-01,  ...,  7.3303e-02,
           -1.8707e-02,  7.8201e-03]],

         [[-1.4404e-02,  1.8762e-01,  5.7556e-02,  ...,  8.2092e-02,
            2.4683e-01, -5.9906e-02],
          [ 2.3425e-01, -3.2129e-01, -1.3684e-01,  ..., -1.0248e-01,
            2.1191e-01, -1.4185e-01],
          [ 4.1931e-02,  1.8066e-01, -1.5160e-02,  ...,  1.6809e-01,
           -2.2449e-01,  2.9834e-01],
          ...,
          [-5.4626e-02, -1.1584e-01, -2.5879e-01,  ..., -3.3521e-01,
           -6.2103e-02,  1.9019e-01],
          [-1.0443e-01, -1.1845e-03, -3.5620e-01,  ...,  2.0825e-01,
           -2.3889e-01, -3.4961e-01],
          [-7.3914e-02,  8.1116e-02, -1.8311e-01,  ...,  1.6632e-02,
            1.9150e-03, -3.2684e-02]],

         ...,

         [[ 1.3039e-02,  1.9666e-01,  7.2083e-02,  ...,  8.3496e-02,
            2.3657e-01, -5.3894e-02],
          [ 2.2314e-01, -2.4255e-01, -1.5552e-01,  ..., -1.2671e-01,
            1.7236e-01, -1.4783e-01],
          [ 3.3875e-02,  2.1313e-01,  7.6965e-02,  ...,  2.0056e-01,
           -1.6956e-01,  2.0996e-01],
          ...,
          [-3.0167e-02, -1.9434e-01, -3.2227e-01,  ..., -3.0298e-01,
           -6.6772e-02,  1.5576e-01],
          [-1.6174e-01,  9.3613e-03, -4.7046e-01,  ...,  1.7273e-01,
           -3.0151e-01, -2.9614e-01],
          [-1.1353e-01,  6.1981e-02, -1.9543e-01,  ..., -1.3939e-02,
           -6.7940e-03, -5.8563e-02]],

         [[ 3.9520e-02,  1.8335e-01,  7.3242e-02,  ...,  9.2590e-02,
            2.4060e-01, -4.0405e-02],
          [ 2.2827e-01, -2.3572e-01, -1.6052e-01,  ..., -1.1664e-01,
            1.7212e-01, -1.5430e-01],
          [ 2.4918e-02,  1.9800e-01,  6.7078e-02,  ...,  2.4683e-01,
           -1.2720e-01,  2.1216e-01],
          ...,
          [-3.0045e-02, -2.0801e-01, -3.6670e-01,  ..., -2.8979e-01,
           -6.3782e-02,  1.9531e-01],
          [-1.3867e-01,  7.6828e-03, -4.4409e-01,  ...,  1.5320e-01,
           -3.0640e-01, -3.1055e-01],
          [-1.2854e-01,  3.8818e-02, -1.6187e-01,  ..., -1.5152e-02,
            9.5444e-03, -6.6223e-02]],

         [[ 2.3285e-02,  1.7407e-01,  6.7078e-02,  ...,  1.0370e-01,
            2.4890e-01, -4.6509e-02],
          [ 2.2327e-01, -2.3450e-01, -1.5564e-01,  ..., -1.0767e-01,
            1.6077e-01, -1.4099e-01],
          [ 2.5772e-02,  2.0044e-01,  7.2693e-02,  ...,  2.3877e-01,
           -1.4819e-01,  2.2974e-01],
          ...,
          [-3.7262e-02, -1.7224e-01, -3.4961e-01,  ..., -2.8174e-01,
           -1.0730e-01,  1.8237e-01],
          [-1.2274e-01,  1.0544e-02, -5.0684e-01,  ...,  1.3855e-01,
           -2.5903e-01, -3.0444e-01],
          [-1.2683e-01,  1.9669e-02, -1.5942e-01,  ..., -3.7415e-02,
           -3.2501e-03, -4.9835e-02]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[ 1.0307e-02,  1.9458e-01,  6.5002e-02,  ...,  7.5012e-02,
           2.3975e-01, -5.0751e-02],
         [ 2.2278e-01, -2.7026e-01, -1.4771e-01,  ..., -1.1292e-01,
           1.8750e-01, -1.4600e-01],
         [ 3.5248e-02,  1.8420e-01,  3.5461e-02,  ...,  1.8896e-01,
          -1.7822e-01,  2.5171e-01],
         ...,
         [-4.0100e-02, -1.6760e-01, -3.0420e-01,  ..., -3.1274e-01,
          -5.2979e-02,  1.8384e-01],
         [-1.2262e-01, -6.3705e-03, -3.8892e-01,  ...,  1.7871e-01,
          -2.5635e-01, -3.0908e-01],
         [-8.8806e-02,  6.9214e-02, -1.7566e-01,  ..., -2.2011e-03,
          -8.9502e-04, -4.3549e-02]],

        [[ 1.2474e-02,  1.5979e-01,  5.5939e-02,  ...,  7.2083e-02,
           2.0215e-01, -4.2908e-02],
         [ 9.5062e-03, -1.9875e-03,  8.3506e-05,  ...,  2.7637e-03,
          -1.1897e-04,  1.1616e-03],
         [ 2.9541e-02,  1.9824e-01,  5.5786e-02,  ...,  2.1240e-01,
          -1.6418e-01,  2.2876e-01],
         ...,
         [-1.8936e-02, -7.3730e-02, -1.3379e-01,  ..., -1.3428e-01,
          -2.8397e-02,  7.6111e-02],
         [-3.4424e-02, -2.1768e-04, -1.0706e-01,  ...,  4.7241e-02,
          -6.8604e-02, -7.8186e-02],
         [-9.0561e-03,  8.6899e-03, -2.2079e-02,  ...,  1.7767e-03,
          -2.0504e-03, -3.0632e-03]],

        [[ 1.4793e-02,  1.8030e-01,  6.3354e-02,  ...,  8.1238e-02,
           2.2888e-01, -4.7668e-02],
         [ 1.1078e-02, -4.1733e-03, -9.7084e-04,  ...,  1.8911e-03,
           1.4162e-03,  2.7180e-05],
         [ 2.9648e-02,  2.0007e-01,  5.6732e-02,  ...,  2.1472e-01,
          -1.6504e-01,  2.3010e-01],
         ...,
         [-2.1103e-02, -8.3008e-02, -1.5088e-01,  ..., -1.5137e-01,
          -3.1555e-02,  8.6060e-02],
         [-3.4821e-02, -2.3770e-04, -1.0840e-01,  ...,  4.7852e-02,
          -6.9458e-02, -7.9285e-02],
         [-8.9264e-03,  8.1482e-03, -2.1378e-02,  ...,  1.6174e-03,
          -2.0237e-03, -2.9850e-03]],

        ...,

        [[ 1.6739e-02,  1.8274e-01,  6.5125e-02,  ...,  8.4717e-02,
           2.3389e-01, -4.8035e-02],
         [ 1.5434e-02, -1.0193e-02, -3.9062e-03,  ..., -5.4598e-04,
           5.6572e-03, -3.1319e-03],
         [ 2.9022e-02,  2.0093e-01,  5.9967e-02,  ...,  2.1875e-01,
          -1.6150e-01,  2.2791e-01],
         ...,
         [-2.1698e-02, -8.5510e-02, -1.5540e-01,  ..., -1.5552e-01,
          -3.2715e-02,  8.8379e-02],
         [-2.4887e-02,  5.8222e-04, -7.6843e-02,  ...,  3.2928e-02,
          -4.8126e-02, -5.2948e-02],
         [-5.6686e-03,  5.6343e-03, -1.5030e-02,  ...,  1.7796e-03,
          -2.0676e-03, -1.3123e-03]],

        [[ 1.7319e-02,  1.8359e-01,  6.5674e-02,  ...,  8.5815e-02,
           2.3572e-01, -4.8187e-02],
         [ 2.2476e-02, -1.9852e-02, -8.6517e-03,  ..., -4.4746e-03,
           1.2466e-02, -8.2169e-03],
         [ 2.8854e-02,  2.0105e-01,  6.0822e-02,  ...,  2.1997e-01,
          -1.6028e-01,  2.2742e-01],
         ...,
         [-2.0386e-02, -7.9590e-02, -1.4490e-01,  ..., -1.4453e-01,
          -3.1158e-02,  8.1787e-02],
         [-2.2629e-02,  7.7057e-04, -6.9702e-02,  ...,  2.9541e-02,
          -4.3304e-02, -4.6936e-02],
         [-4.7035e-03,  4.8714e-03, -1.3130e-02,  ...,  1.8215e-03,
          -2.0809e-03, -8.1491e-04]],

        [[ 1.7563e-02,  1.8335e-01,  6.5674e-02,  ...,  8.6060e-02,
           2.3560e-01, -4.8065e-02],
         [ 2.4551e-02, -2.2705e-02, -1.0048e-02,  ..., -5.6114e-03,
           1.4458e-02, -9.6893e-03],
         [ 2.8824e-02,  2.0093e-01,  6.0913e-02,  ...,  2.2009e-01,
          -1.6016e-01,  2.2729e-01],
         ...,
         [-1.9531e-02, -7.5562e-02, -1.3757e-01,  ..., -1.3708e-01,
          -3.0151e-02,  7.7271e-02],
         [-2.2003e-02,  8.3160e-04, -6.7688e-02,  ...,  2.8549e-02,
          -4.1901e-02, -4.5227e-02],
         [-3.6926e-03,  4.1199e-03, -1.1192e-02,  ...,  1.8816e-03,
          -2.0962e-03, -2.9898e-04]]], device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[-1.1505e-01,  3.9825e-02, -3.8013e-01,  ...,  8.6121e-02,
            2.3682e-01,  9.5642e-02],
          [ 2.2913e-01,  8.9493e-03, -1.8713e-01,  ..., -2.7222e-01,
           -2.3926e-01,  1.7029e-01],
          [ 1.5137e-01, -3.0054e-01, -2.5562e-01,  ..., -2.2302e-01,
            3.2227e-02,  1.3611e-01],
          ...,
          [-2.6392e-01,  7.0229e-03,  2.3865e-01,  ..., -2.7734e-01,
            1.0948e-02, -2.5732e-01],
          [ 6.9031e-02,  1.6687e-01, -1.8628e-01,  ...,  5.0751e-02,
           -1.7004e-01, -2.5806e-01],
          [-3.0289e-02,  1.5076e-01, -1.9055e-01,  ...,  1.7432e-01,
           -1.1237e-01, -1.8173e-02]],

         [[ 1.5996e+00,  2.6270e-01,  1.2090e+00,  ..., -2.4551e+00,
           -6.3965e-01, -2.5625e+00],
          [-5.0684e-01,  8.6670e-01, -3.1403e-02,  ..., -7.2803e-01,
            1.9058e-02, -1.3203e+00],
          [-4.8486e-01,  1.8301e+00,  5.8838e-01,  ...,  5.9570e-01,
           -3.3008e-01, -9.9268e-01],
          ...,
          [ 8.1836e-01, -1.4463e+00, -1.3857e+00,  ...,  2.8369e-01,
           -1.1650e+00,  3.1372e-01],
          [ 5.0781e-01, -1.0439e+00,  2.6260e-02,  ..., -1.9170e+00,
            1.1309e+00, -3.2153e-01],
          [ 4.0869e-01, -1.5293e+00, -1.4514e-01,  ..., -2.1411e-01,
            1.4385e+00,  2.4146e-01]],

         [[ 1.0947e+00,  3.1445e-01,  1.2002e+00,  ..., -2.4961e+00,
           -6.3965e-01, -2.6016e+00],
          [-3.5449e-01,  7.8906e-01,  4.2664e-02,  ..., -7.5537e-01,
           -2.0618e-03, -1.3213e+00],
          [-4.9463e-01,  1.6826e+00,  6.9678e-01,  ...,  1.6260e-01,
           -4.8560e-01, -9.3701e-01],
          ...,
          [ 1.0938e+00, -1.7910e+00, -1.4854e+00,  ...,  7.6843e-02,
           -1.1260e+00,  5.5298e-02],
          [ 5.0098e-01, -1.1484e+00,  3.6572e-01,  ..., -1.9727e+00,
            1.2158e+00, -3.3154e-01],
          [ 4.1040e-01, -1.1230e+00, -1.9836e-01,  ...,  1.3770e-01,
            1.7080e+00,  4.2676e-01]],

         ...,

         [[ 9.7559e-01,  4.0649e-01,  1.2168e+00,  ..., -2.6426e+00,
           -7.2656e-01, -2.7461e+00],
          [-3.3862e-01,  8.7109e-01,  9.2834e-02,  ..., -7.6807e-01,
            7.3730e-02, -1.2607e+00],
          [-5.8789e-01,  1.6465e+00,  6.0303e-01,  ...,  6.4507e-03,
           -5.7324e-01, -1.0430e+00],
          ...,
          [ 1.1787e+00, -2.0820e+00, -1.2529e+00,  ...,  3.4973e-02,
           -9.7754e-01, -1.3330e-01],
          [ 5.4150e-01, -1.3154e+00,  5.7227e-01,  ..., -2.1895e+00,
            1.1953e+00, -2.6831e-01],
          [ 5.8691e-01, -8.7744e-01, -2.2388e-01,  ...,  1.7120e-02,
            1.7900e+00,  6.1523e-01]],

         [[ 1.0420e+00,  4.7998e-01,  1.2402e+00,  ..., -2.6914e+00,
           -6.8506e-01, -2.7910e+00],
          [-4.3677e-01,  9.9512e-01,  5.7373e-02,  ..., -7.9590e-01,
            1.0004e-01, -1.2676e+00],
          [-6.0352e-01,  1.4736e+00,  5.6396e-01,  ..., -9.7229e-02,
           -5.9668e-01, -1.0645e+00],
          ...,
          [ 1.3262e+00, -2.1836e+00, -1.0723e+00,  ...,  8.0200e-02,
           -9.9219e-01, -9.1614e-02],
          [ 4.9756e-01, -1.2646e+00,  5.0244e-01,  ..., -2.2480e+00,
            1.1992e+00, -2.5977e-01],
          [ 5.0049e-01, -8.0371e-01, -2.6099e-01,  ...,  5.1178e-02,
            1.7520e+00,  6.2646e-01]],

         [[ 1.0254e+00,  5.7959e-01,  1.1963e+00,  ..., -2.7617e+00,
           -7.5342e-01, -2.8574e+00],
          [-4.2920e-01,  1.0605e+00,  1.3342e-01,  ..., -8.0566e-01,
            2.1164e-02, -1.2334e+00],
          [-6.4209e-01,  1.5312e+00,  5.8447e-01,  ..., -1.4819e-01,
           -6.2207e-01, -1.0576e+00],
          ...,
          [ 1.3232e+00, -2.2266e+00, -1.1309e+00,  ...,  1.0785e-01,
           -1.0527e+00, -1.2097e-01],
          [ 4.8633e-01, -1.1729e+00,  5.2881e-01,  ..., -2.3203e+00,
            1.1006e+00, -2.7539e-01],
          [ 4.8242e-01, -7.2656e-01, -3.2373e-01,  ...,  8.4656e-02,
            1.7705e+00,  7.1094e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[ 0.1793,  0.0164,  0.3718,  ...,  0.2725, -0.1724,  0.2585],
          [-0.5269, -0.0351,  0.2288,  ...,  0.0918,  0.4307, -0.1247],
          [-0.1168,  0.3740,  0.3491,  ...,  0.2317, -0.3445, -0.2722],
          ...,
          [ 0.4553,  0.0376, -0.3826,  ...,  0.4675, -0.1080,  0.3232],
          [ 0.0621, -0.4250,  0.2664,  ...,  0.5068,  0.5161,  0.8711],
          [ 0.1884, -0.2947,  0.2791,  ..., -0.4971, -0.0185,  0.1952]],

         [[-0.7344, -1.7480, -2.4590,  ...,  0.3633,  1.7031,  0.1990],
          [ 1.0508, -1.0693, -2.1328,  ..., -2.7070, -1.6299, -0.2114],
          [ 0.7842, -1.6689, -1.0498,  ..., -1.9873,  2.6602,  0.5078],
          ...,
          [-1.3848, -0.9341,  3.2598,  ..., -0.6895,  0.1186, -3.7832],
          [-0.9424, -0.8760, -2.0879,  ...,  0.6973, -2.7910, -2.5117],
          [ 0.0341,  0.2944, -0.0196,  ...,  2.0664, -0.5698, -0.5547]],

         [[-0.5557, -1.8711, -2.5762,  ...,  0.4065,  1.8447,  0.2352],
          [ 0.7368, -0.9941, -2.1934,  ..., -2.7656, -1.4893, -0.2600],
          [ 0.4521, -1.7822, -0.8291,  ..., -2.2578,  2.3066,  0.6270],
          ...,
          [-1.1943, -1.0264,  2.6504,  ..., -0.6719,  0.3572, -3.8477],
          [-0.9531, -0.5718, -1.9688,  ...,  0.7622, -2.8066, -2.5039],
          [-0.1070,  0.1995, -0.2568,  ...,  2.2637, -0.4502, -0.5967]],

         ...,

         [[-0.4966, -1.9463, -2.5625,  ...,  0.3704,  1.7744,  0.1932],
          [ 0.5474, -0.8589, -2.3184,  ..., -2.9199, -1.3291, -0.3105],
          [ 0.2374, -1.7568, -0.6963,  ..., -2.4062,  2.0723,  0.6587],
          ...,
          [-1.2969, -1.3564,  2.7246,  ..., -0.5693,  0.3120, -3.8809],
          [-0.9082, -0.4463, -2.1055,  ...,  0.7349, -2.6602, -2.6270],
          [-0.4009,  0.3032, -0.2260,  ...,  2.3145, -0.6118, -0.6074]],

         [[-0.5791, -1.9795, -2.5312,  ...,  0.3765,  1.6963,  0.1947],
          [ 0.4998, -0.8633, -2.3398,  ..., -3.0195, -1.1992, -0.3047],
          [ 0.2030, -1.7432, -0.5908,  ..., -2.5137,  2.2051,  0.5156],
          ...,
          [-1.2490, -1.5371,  2.8477,  ..., -0.4744,  0.2120, -3.8203],
          [-0.8916, -0.3740, -2.1484,  ...,  0.7402, -2.6973, -2.6719],
          [-0.4307,  0.4016, -0.2299,  ...,  2.2012, -0.7837, -0.6768]],

         [[-0.5537, -2.0000, -2.5566,  ...,  0.3955,  1.7188,  0.2124],
          [ 0.6011, -0.8560, -2.3926,  ..., -3.0879, -1.2598, -0.2164],
          [ 0.1722, -1.8076, -0.5908,  ..., -2.5156,  2.1367,  0.5557],
          ...,
          [-1.2422, -1.5410,  2.7695,  ..., -0.5640,  0.1124, -3.8027],
          [-0.9028, -0.3918, -2.0977,  ...,  0.7656, -2.6523, -2.7344],
          [-0.4658,  0.4321, -0.2208,  ...,  2.2168, -0.6831, -0.7598]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 1.6603e-03,  3.1204e-03, -2.8648e-03,  ...,  1.6999e-04,
           -3.5648e-03, -2.4910e-03],
          [-1.9588e-03,  2.1400e-03,  1.5440e-03,  ...,  4.5443e-04,
           -9.0551e-04, -4.1962e-03],
          [ 3.6430e-03, -1.0376e-03, -4.5891e-03,  ..., -9.8133e-04,
           -2.8515e-03, -1.8568e-03],
          ...,
          [-1.3428e-03, -2.5768e-03,  1.0891e-03,  ...,  2.8267e-03,
           -8.4686e-04,  2.2446e-02],
          [-8.2064e-04,  1.0786e-03,  1.8060e-05,  ..., -6.9427e-04,
            4.1733e-03, -2.3441e-03],
          [-1.1225e-03,  1.5631e-03, -7.3910e-05,  ..., -2.8849e-04,
           -5.7106e-03, -5.2404e-04]],

         [[ 4.7607e-01, -8.7051e-03, -2.3486e-01,  ...,  1.6235e-02,
            3.4009e-01,  2.0251e-01],
          [-3.0174e-03, -1.5247e-01, -5.0232e-02,  ..., -1.3318e-01,
            1.9080e-01, -7.5195e-02],
          [ 3.7622e-01, -2.2461e-01, -8.0139e-02,  ...,  1.2372e-01,
            1.5625e-01, -3.4149e-02],
          ...,
          [ 1.7227e-02, -7.8979e-02, -1.1969e-01,  ...,  1.2311e-01,
           -1.1826e-02, -5.2344e-01],
          [-5.7068e-02, -5.0354e-02, -1.7126e-01,  ..., -9.6985e-02,
            7.7002e-01,  1.4575e-01],
          [-5.3833e-02,  3.1689e-01,  2.2717e-01,  ..., -7.0496e-02,
            5.7159e-02, -3.0411e-02]],

         [[ 3.7012e-01, -4.6082e-03, -2.8149e-01,  ...,  4.6997e-02,
            3.9258e-01,  1.1377e-01],
          [-9.8206e-02, -8.1787e-02, -4.4281e-02,  ..., -8.6975e-02,
            2.4512e-01, -1.8054e-01],
          [ 2.5977e-01, -2.1228e-01, -1.9299e-01,  ...,  1.3110e-01,
            8.5999e-02,  3.2776e-02],
          ...,
          [-2.9388e-02, -5.5176e-02, -1.2927e-01,  ...,  1.4319e-01,
            3.4760e-02, -5.3711e-01],
          [-1.2024e-01, -5.2307e-02, -1.7615e-01,  ..., -1.1639e-01,
            6.8604e-01,  1.0999e-01],
          [-1.6772e-01,  3.1226e-01,  2.4353e-01,  ..., -1.0925e-01,
           -1.5335e-03, -6.3477e-02]],

         ...,

         [[ 2.9712e-01,  5.0629e-02, -3.0420e-01,  ...,  1.1774e-01,
            5.2002e-01,  1.3489e-01],
          [-1.0590e-01, -1.6508e-03, -7.9712e-02,  ..., -4.9866e-02,
            2.6440e-01, -2.4988e-01],
          [ 2.8247e-01, -2.4231e-01, -1.7029e-01,  ...,  8.6365e-02,
            1.0693e-01, -1.8692e-02],
          ...,
          [-4.3259e-03, -4.2084e-02, -1.1487e-01,  ...,  1.7468e-01,
            2.1591e-02, -4.8218e-01],
          [-1.2842e-01, -6.3293e-02, -2.0886e-01,  ..., -9.2346e-02,
            6.3623e-01,  1.2402e-01],
          [-2.3059e-01,  2.6050e-01,  2.2498e-01,  ..., -1.7651e-01,
           -3.3173e-02, -5.4688e-02]],

         [[ 3.3276e-01,  6.9702e-02, -3.3667e-01,  ...,  1.3733e-01,
            5.4199e-01,  7.9590e-02],
          [-1.1841e-01,  1.4877e-02, -5.7526e-02,  ..., -3.8757e-02,
            2.6343e-01, -2.4988e-01],
          [ 3.0151e-01, -2.5537e-01, -1.8848e-01,  ...,  7.5012e-02,
            8.8562e-02, -9.4147e-03],
          ...,
          [-9.0179e-03, -3.7598e-02, -1.0577e-01,  ...,  1.6357e-01,
            2.4918e-02, -4.8804e-01],
          [-1.4111e-01, -4.4952e-02, -1.9714e-01,  ..., -9.7168e-02,
            6.3721e-01,  1.2634e-01],
          [-2.7832e-01,  2.6538e-01,  2.1240e-01,  ..., -2.0667e-01,
           -4.1351e-02, -3.3966e-02]],

         [[ 3.0518e-01,  4.1962e-02, -2.9883e-01,  ...,  1.3452e-01,
            5.5859e-01,  5.7037e-02],
          [-8.7952e-02,  1.5778e-02, -6.7322e-02,  ..., -2.5848e-02,
            2.7466e-01, -2.4146e-01],
          [ 2.7368e-01, -2.4585e-01, -2.2778e-01,  ...,  8.0750e-02,
            8.6304e-02, -4.2229e-03],
          ...,
          [-1.8188e-02, -2.6535e-02, -1.0114e-01,  ...,  1.6931e-01,
            3.5309e-02, -4.9707e-01],
          [-1.6101e-01, -7.9163e-02, -1.6663e-01,  ..., -9.1064e-02,
            5.9912e-01,  1.2659e-01],
          [-2.8394e-01,  2.6514e-01,  2.0117e-01,  ..., -2.2351e-01,
           -4.3518e-02, -5.6915e-02]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[ 3.3716e-01,  2.3758e-02, -2.8931e-01,  ...,  8.9844e-02,
           4.6411e-01,  1.1340e-01],
         [-9.2590e-02, -3.6713e-02, -6.1584e-02,  ..., -6.7505e-02,
           2.4915e-01, -2.0581e-01],
         [ 2.8271e-01, -2.3010e-01, -1.7444e-01,  ...,  9.9487e-02,
           9.3018e-02, -3.7823e-03],
         ...,
         [-1.1276e-02, -4.9316e-02, -1.1670e-01,  ...,  1.5686e-01,
           2.3041e-02, -5.0244e-01],
         [-1.2805e-01, -5.9662e-02, -1.8652e-01,  ..., -9.7168e-02,
           6.5088e-01,  1.2140e-01],
         [-2.0129e-01,  2.7979e-01,  2.1790e-01,  ..., -1.5210e-01,
          -1.6998e-02, -4.9438e-02]],

        [[ 9.0698e-02,  9.0027e-03, -7.8796e-02,  ...,  2.4094e-02,
           1.2054e-01,  2.8656e-02],
         [-3.8025e-02, -8.0185e-03, -2.2537e-02,  ..., -2.2369e-02,
           9.4177e-02, -8.3618e-02],
         [ 9.8343e-03, -5.9814e-03, -8.1100e-03,  ...,  1.2426e-03,
          -6.7139e-04, -1.9398e-03],
         ...,
         [-4.4250e-03, -1.3618e-02, -2.9724e-02,  ...,  4.5624e-02,
           6.4964e-03, -1.1670e-01],
         [-2.2984e-03,  3.6240e-04, -2.1973e-03,  ..., -1.8492e-03,
           1.1948e-02, -8.6308e-04],
         [-1.9608e-02,  2.8610e-02,  2.1042e-02,  ..., -1.4374e-02,
          -6.4468e-03, -5.2261e-03]],

        [[ 1.2128e-01,  1.1139e-02, -1.0480e-01,  ...,  3.2379e-02,
           1.6321e-01,  3.9307e-02],
         [-6.2561e-02, -1.4236e-02, -3.8727e-02,  ..., -3.7323e-02,
           1.5820e-01, -1.3745e-01],
         [ 1.1795e-02, -7.5798e-03, -9.2850e-03,  ...,  1.9398e-03,
           5.0664e-06, -1.9588e-03],
         ...,
         [-8.7814e-03, -2.8870e-02, -7.2449e-02,  ...,  1.0492e-01,
           1.6754e-02, -3.0933e-01],
         [-3.3722e-03, -1.5879e-04, -3.8071e-03,  ..., -2.6875e-03,
           1.7593e-02,  2.1434e-04],
         [-2.5299e-02,  3.6438e-02,  2.7191e-02,  ..., -1.8661e-02,
          -6.8130e-03, -6.6376e-03]],

        ...,

        [[ 1.0486e-01,  9.9258e-03, -9.0393e-02,  ...,  2.7679e-02,
           1.3953e-01,  3.3661e-02],
         [-7.0374e-02, -1.5823e-02, -4.4037e-02,  ..., -4.1901e-02,
           1.7896e-01, -1.5503e-01],
         [ 1.3611e-02, -9.0561e-03, -1.0361e-02,  ...,  2.5902e-03,
           6.3705e-04, -1.9798e-03],
         ...,
         [-8.1482e-03, -2.6779e-02, -6.6528e-02,  ...,  9.6680e-02,
           1.5312e-02, -2.8247e-01],
         [-4.3526e-03, -6.2752e-04, -5.2490e-03,  ..., -3.4370e-03,
           2.2614e-02,  1.1740e-03],
         [-2.4063e-02,  3.4698e-02,  2.5833e-02,  ..., -1.7715e-02,
          -6.7558e-03, -6.3400e-03]],

        [[ 1.0510e-01,  9.9640e-03, -9.0637e-02,  ...,  2.7786e-02,
           1.4001e-01,  3.3722e-02],
         [-7.3059e-02, -1.6266e-02, -4.5868e-02,  ..., -4.3427e-02,
           1.8616e-01, -1.6125e-01],
         [ 1.4862e-02, -1.0071e-02, -1.1093e-02,  ...,  3.0365e-03,
           1.0710e-03, -1.9932e-03],
         ...,
         [-7.1144e-03, -2.2995e-02, -5.6152e-02,  ...,  8.2458e-02,
           1.2878e-02, -2.3596e-01],
         [-4.7722e-03, -8.2874e-04, -5.8670e-03,  ..., -3.7556e-03,
           2.4750e-02,  1.5831e-03],
         [-2.6138e-02,  3.7506e-02,  2.8030e-02,  ..., -1.9272e-02,
          -6.8970e-03, -6.8474e-03]],

        [[ 1.1285e-01,  1.0536e-02, -9.7290e-02,  ...,  2.9922e-02,
           1.5088e-01,  3.6438e-02],
         [-7.3669e-02, -1.6556e-02, -4.6295e-02,  ..., -4.3884e-02,
           1.8787e-01, -1.6260e-01],
         [ 1.5266e-02, -1.0391e-02, -1.1322e-02,  ...,  3.1776e-03,
           1.2150e-03, -2.0008e-03],
         ...,
         [-7.2670e-03, -2.3605e-02, -5.7861e-02,  ...,  8.4839e-02,
           1.3275e-02, -2.4377e-01],
         [-5.4703e-03, -1.1654e-03, -6.9046e-03,  ..., -4.2953e-03,
           2.8381e-02,  2.2755e-03],
         [-2.7542e-02,  3.9490e-02,  2.9602e-02,  ..., -2.0340e-02,
          -6.9695e-03, -7.2021e-03]]], device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[-3.2471e-01,  6.3623e-01, -8.4473e-02,  ..., -8.5059e-01,
            2.0776e-01, -3.2080e-01],
          [-1.0312e+00,  7.1729e-01, -4.6356e-02,  ..., -4.3970e-01,
            9.2676e-01,  1.9531e-01],
          [ 5.1709e-01,  1.9763e-01,  1.1328e+00,  ...,  8.4570e-01,
            1.4236e-02, -5.5029e-01],
          ...,
          [-1.1660e+00, -5.6592e-01, -2.2986e-01,  ..., -4.3286e-01,
            4.5923e-01, -8.5547e-01],
          [ 6.0352e-01,  2.1582e-01,  7.4414e-01,  ...,  7.5378e-02,
            3.0981e-01,  8.7061e-01],
          [-1.7249e-01, -3.6768e-01,  1.7200e-01,  ...,  4.5288e-01,
            7.3633e-01,  5.6732e-02]],

         [[-1.5586e+00,  5.1611e-01,  4.4800e-01,  ..., -6.6455e-01,
           -1.0559e-02,  6.0352e-01],
          [ 2.4414e+00, -1.5088e+00,  3.6407e-02,  ..., -1.8701e+00,
           -6.2305e-01,  5.2872e-03],
          [-4.9902e-01,  4.3457e-01, -1.5225e+00,  ...,  1.5564e-01,
            5.4962e-02,  8.3130e-02],
          ...,
          [ 1.8574e+00,  1.1494e+00, -5.9766e-01,  ...,  3.0957e+00,
           -5.5420e-01,  7.7344e-01],
          [-9.3701e-01, -4.6387e-01, -1.2793e+00,  ..., -1.7705e+00,
            9.0283e-01, -1.6973e+00],
          [-5.9863e-01,  7.5537e-01,  3.2056e-01,  ..., -6.1963e-01,
           -7.7441e-01, -1.2939e-01]],

         [[-1.5518e+00,  2.9639e-01,  5.6934e-01,  ..., -6.9141e-01,
           -1.3489e-01,  5.8447e-01],
          [ 2.1992e+00, -1.2246e+00,  8.8989e-02,  ..., -1.9131e+00,
           -4.6558e-01,  1.9409e-01],
          [-8.3984e-01,  6.4795e-01, -1.5684e+00,  ...,  4.1992e-01,
           -9.3750e-02, -7.4482e-04],
          ...,
          [ 2.1895e+00,  1.1963e+00, -5.8740e-01,  ...,  2.7324e+00,
           -7.7197e-01,  1.2559e+00],
          [-1.1543e+00, -6.1426e-01, -1.4512e+00,  ..., -1.9629e+00,
            8.3496e-01, -1.6768e+00],
          [-8.5986e-01,  1.1855e+00,  2.7734e-01,  ..., -7.3291e-01,
           -8.1689e-01, -3.0835e-01]],

         ...,

         [[-1.2998e+00, -1.7288e-02,  3.6084e-01,  ..., -8.3398e-01,
           -2.1143e-01,  7.4609e-01],
          [ 2.1562e+00, -1.0859e+00, -2.2852e-01,  ..., -2.0977e+00,
           -4.1211e-01,  1.7004e-01],
          [-9.9268e-01,  5.3174e-01, -1.5781e+00,  ...,  4.6069e-01,
           -2.3792e-01,  2.5854e-01],
          ...,
          [ 2.0762e+00,  1.1631e+00, -4.9487e-01,  ...,  2.7344e+00,
           -6.0254e-01,  1.1260e+00],
          [-1.5430e+00, -4.7852e-01, -1.2959e+00,  ..., -1.7266e+00,
            1.0400e+00, -1.6611e+00],
          [-7.2510e-01,  1.3672e+00,  3.5327e-01,  ..., -7.1094e-01,
           -8.6719e-01, -1.5100e-01]],

         [[-1.2158e+00, -7.4158e-02,  3.8965e-01,  ..., -7.8467e-01,
           -2.7222e-01,  8.6377e-01],
          [ 2.2559e+00, -1.0156e+00, -1.7285e-01,  ..., -2.1934e+00,
           -3.9746e-01,  2.5879e-01],
          [-1.0547e+00,  5.4346e-01, -1.5928e+00,  ...,  5.0342e-01,
           -2.2595e-01,  4.9341e-01],
          ...,
          [ 1.9863e+00,  1.0752e+00, -4.6582e-01,  ...,  2.7148e+00,
           -6.0303e-01,  1.1689e+00],
          [-1.6123e+00, -4.2432e-01, -1.2314e+00,  ..., -1.4629e+00,
            1.1855e+00, -1.6328e+00],
          [-7.4561e-01,  1.3545e+00,  1.9434e-01,  ..., -8.3838e-01,
           -1.0811e+00, -7.4829e-02]],

         [[-1.3008e+00, -8.3008e-02,  4.4702e-01,  ..., -8.0518e-01,
           -3.8110e-01,  8.2275e-01],
          [ 2.3066e+00, -9.8145e-01, -1.7346e-01,  ..., -2.2793e+00,
           -4.7803e-01,  3.1494e-01],
          [-1.1504e+00,  6.3965e-01, -1.5459e+00,  ...,  5.4346e-01,
           -2.1155e-01,  4.2432e-01],
          ...,
          [ 2.1699e+00,  1.0674e+00, -4.5435e-01,  ...,  2.5215e+00,
           -5.9717e-01,  1.2100e+00],
          [-1.6680e+00, -5.3906e-01, -1.4121e+00,  ..., -1.6934e+00,
            1.2441e+00, -1.6787e+00],
          [-7.9297e-01,  1.4434e+00,  2.4673e-02,  ..., -8.9844e-01,
           -1.0439e+00, -1.5833e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[-2.4506e-02, -7.7832e-01, -2.8003e-01,  ...,  1.8535e+00,
           -3.1689e-01,  2.4548e-01],
          [ 9.1846e-01, -1.3367e-01,  6.0486e-02,  ...,  1.1895e+00,
           -5.0586e-01,  2.3340e-01],
          [-1.0400e+00, -4.3848e-01, -1.1143e+00,  ..., -8.3447e-01,
            6.0400e-01,  1.5947e+00],
          ...,
          [ 6.3574e-01,  7.0898e-01,  5.6934e-01,  ...,  3.6792e-01,
           -3.2715e-01,  9.9316e-01],
          [-5.3174e-01, -3.9038e-01, -7.1045e-01,  ..., -1.0000e+00,
            2.9761e-01, -1.1201e+00],
          [ 8.8672e-01,  3.1787e-01, -4.0359e-03,  ..., -9.6387e-01,
           -9.5361e-01,  1.9275e-01]],

         [[-8.7842e-01,  2.9199e+00,  3.7308e-03,  ...,  4.5142e-01,
            1.4033e+00,  6.9141e-01],
          [-1.2383e+00, -5.7031e-01,  1.6772e-01,  ...,  3.3356e-02,
            4.3457e-01, -2.8198e-02],
          [-7.7539e-01,  3.2129e-01,  3.1250e+00,  ...,  1.2012e+00,
           -2.9258e+00, -3.4863e+00],
          ...,
          [-1.3037e+00, -1.2292e-01, -2.6035e+00,  ...,  6.4697e-01,
            3.7964e-01, -1.8115e+00],
          [ 1.7930e+00, -1.9443e+00, -7.2852e-01,  ..., -5.4932e-01,
            6.5527e-01,  3.3008e-01],
          [-3.7891e+00, -4.4873e-01,  5.4346e-01,  ...,  2.2266e-01,
            1.3271e+00,  1.3047e+00]],

         [[-1.0361e+00,  2.7578e+00, -2.7283e-02,  ...,  5.1855e-01,
            1.4512e+00,  4.1260e-01],
          [-1.2881e+00, -5.6738e-01,  6.1798e-02,  ...,  1.8311e-01,
            2.2522e-01, -4.9652e-02],
          [-4.8389e-01,  2.7881e-01,  2.9004e+00,  ...,  1.4775e+00,
           -2.9883e+00, -3.5664e+00],
          ...,
          [-1.0107e+00, -2.7026e-01, -2.8008e+00,  ...,  1.2178e+00,
            4.9463e-01, -1.4160e+00],
          [ 1.4160e+00, -2.3848e+00, -4.8511e-01,  ..., -5.4102e-01,
            5.1709e-01,  1.7297e-01],
          [-3.8809e+00, -6.8799e-01,  3.9258e-01,  ..., -2.7563e-01,
            1.1348e+00,  1.1621e+00]],

         ...,

         [[-8.7012e-01,  3.0000e+00,  1.2274e-01,  ...,  5.3662e-01,
            1.4971e+00,  3.2324e-01],
          [-1.3916e+00, -6.3818e-01, -2.5879e-01,  ...,  1.7029e-01,
            9.8755e-02,  6.1432e-02],
          [-5.6055e-01,  2.9614e-01,  2.5469e+00,  ...,  1.3232e+00,
           -3.1836e+00, -3.3145e+00],
          ...,
          [-7.5928e-01, -4.6240e-01, -3.0176e+00,  ...,  1.3867e+00,
            7.9297e-01, -1.3926e+00],
          [ 1.3623e+00, -2.7031e+00, -1.6028e-01,  ..., -6.3037e-01,
            4.0430e-01,  6.5117e-03],
          [-4.0469e+00, -8.3057e-01,  1.6162e-01,  ..., -3.3374e-01,
            9.7803e-01,  1.1943e+00]],

         [[-8.7939e-01,  3.1777e+00,  7.7148e-02,  ...,  6.1230e-01,
            1.5566e+00,  2.8491e-01],
          [-1.4443e+00, -6.7480e-01, -4.3286e-01,  ...,  1.6980e-01,
            2.9297e-02,  9.4299e-02],
          [-5.1514e-01,  3.0225e-01,  2.4863e+00,  ...,  1.1055e+00,
           -3.2559e+00, -3.2559e+00],
          ...,
          [-7.4609e-01, -5.3662e-01, -3.1270e+00,  ...,  1.4336e+00,
            7.9932e-01, -1.3379e+00],
          [ 1.3398e+00, -2.8066e+00,  7.7248e-04,  ..., -6.6162e-01,
            3.7549e-01, -8.2703e-02],
          [-4.1484e+00, -8.7158e-01,  2.1436e-01,  ..., -4.6558e-01,
            9.6094e-01,  1.3076e+00]],

         [[-8.7842e-01,  3.1992e+00,  7.1960e-02,  ...,  7.7100e-01,
            1.5713e+00,  2.4292e-01],
          [-1.4072e+00, -6.7236e-01, -4.3774e-01,  ...,  1.9604e-01,
           -1.1551e-02,  1.5350e-02],
          [-5.7812e-01,  3.2666e-01,  2.4512e+00,  ...,  1.2139e+00,
           -3.3301e+00, -3.3457e+00],
          ...,
          [-9.1406e-01, -7.1631e-01, -3.2344e+00,  ...,  1.4922e+00,
            7.9639e-01, -1.2314e+00],
          [ 1.2871e+00, -2.9766e+00, -5.0446e-02,  ..., -4.3066e-01,
            4.2505e-01, -1.3306e-01],
          [-4.2305e+00, -8.5059e-01,  1.4844e-01,  ..., -6.2988e-01,
            9.0332e-01,  1.3232e+00]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[-8.1956e-05,  1.6804e-03, -5.9586e-03,  ..., -6.6710e-04,
           -1.6003e-03,  4.8661e-04],
          [ 2.0771e-03,  3.8986e-03,  4.9591e-04,  ...,  8.3847e-03,
            7.6342e-04,  7.8278e-03],
          [ 5.8327e-03,  2.7990e-04, -4.0245e-03,  ..., -8.3313e-03,
           -3.3302e-03,  1.4496e-02],
          ...,
          [ 3.7918e-03,  6.2180e-04,  8.7976e-04,  ...,  1.6890e-03,
            5.4092e-03,  3.1376e-03],
          [-4.0269e-04,  1.8787e-04, -2.0618e-03,  ...,  2.6455e-03,
            3.0041e-03,  4.5013e-03],
          [-7.0620e-04, -3.0079e-03,  7.5817e-04,  ..., -5.7888e-04,
            2.8191e-03, -3.7956e-04]],

         [[-4.8737e-02,  7.4097e-02,  3.9246e-02,  ...,  1.5942e-01,
            3.5828e-02, -5.9082e-02],
          [ 1.2244e-01, -7.4219e-02, -1.9312e-01,  ...,  1.1932e-02,
            2.2522e-01, -1.4966e-01],
          [ 1.1664e-01,  1.2067e-01,  5.4138e-02,  ..., -1.9293e-03,
            1.3770e-01, -2.9282e-02],
          ...,
          [ 2.4475e-01,  2.5879e-01,  3.0945e-02,  ...,  2.4121e-01,
           -8.9551e-01, -4.5190e-01],
          [ 2.5342e-01, -2.1835e-02,  1.4307e-01,  ...,  1.7151e-01,
           -2.2598e-02, -2.3267e-01],
          [ 3.4863e-01, -2.9480e-02,  6.9946e-02,  ...,  1.0529e-01,
           -1.5552e-01, -2.1021e-01]],

         [[-1.1884e-01,  1.1658e-01, -3.2043e-02,  ...,  4.9255e-02,
            1.1847e-01, -6.2683e-02],
          [-7.2746e-03, -6.4392e-02, -1.0132e-01,  ...,  7.8979e-02,
            1.7749e-01, -2.8882e-01],
          [ 6.8298e-02,  1.4648e-01,  7.7637e-02,  ..., -4.4067e-02,
            1.2152e-01,  2.1561e-02],
          ...,
          [ 2.9272e-01,  1.3721e-01,  1.0962e-01,  ...,  2.2388e-01,
           -9.3213e-01, -3.9746e-01],
          [ 2.6392e-01, -5.9631e-02,  9.5703e-02,  ...,  1.8042e-01,
           -3.7506e-02, -1.9421e-01],
          [ 3.6279e-01, -3.7689e-02,  8.9844e-02,  ...,  9.4299e-02,
           -8.8562e-02, -2.3242e-01]],

         ...,

         [[-2.1460e-01,  1.5430e-01, -3.4904e-03,  ...,  3.7109e-02,
            1.6003e-01, -9.5291e-03],
          [-1.1981e-01, -1.3232e-01, -3.4027e-02,  ...,  5.8075e-02,
            1.0449e-01, -2.9028e-01],
          [ 9.7168e-02,  1.4441e-01,  1.0529e-01,  ..., -1.1176e-01,
            8.5022e-02,  1.6434e-02],
          ...,
          [ 3.3398e-01,  8.1909e-02,  6.5857e-02,  ...,  2.3486e-01,
           -8.4033e-01, -4.0259e-01],
          [ 2.7075e-01, -8.9783e-02,  8.6121e-02,  ...,  1.4246e-01,
           -5.3680e-02, -1.2549e-01],
          [ 3.1299e-01,  1.0986e-02,  1.4038e-01,  ...,  1.6357e-01,
           -3.8452e-02, -2.7075e-01]],

         [[-2.4780e-01,  1.6772e-01,  8.8425e-03,  ...,  1.1292e-02,
            1.5063e-01,  2.3590e-02],
          [-1.3452e-01, -1.2482e-01, -2.1225e-02,  ...,  4.0375e-02,
            1.4185e-01, -2.7515e-01],
          [ 1.1951e-01,  1.6602e-01,  1.0571e-01,  ..., -1.2842e-01,
            9.5825e-02,  4.5853e-03],
          ...,
          [ 3.0444e-01,  6.5796e-02,  2.8702e-02,  ...,  2.1667e-01,
           -8.2959e-01, -4.2554e-01],
          [ 2.6929e-01, -9.0576e-02,  7.8186e-02,  ...,  1.2891e-01,
           -6.5796e-02, -1.4368e-01],
          [ 3.1787e-01,  7.1030e-03,  1.3550e-01,  ...,  1.6504e-01,
           -3.8361e-02, -2.6489e-01]],

         [[-2.7344e-01,  1.9604e-01, -1.2238e-02,  ...,  1.4313e-02,
            1.3672e-01,  1.1818e-02],
          [-1.4880e-01, -1.0266e-01, -4.4983e-02,  ...,  3.3295e-02,
            1.5540e-01, -2.6440e-01],
          [ 1.2317e-01,  1.7358e-01,  9.5520e-02,  ..., -1.2463e-01,
            9.7656e-02,  1.3702e-02],
          ...,
          [ 2.8979e-01,  6.6162e-02,  3.4882e-02,  ...,  2.3730e-01,
           -8.4863e-01, -4.0796e-01],
          [ 2.4304e-01, -9.8145e-02,  8.0139e-02,  ...,  1.2952e-01,
           -7.1777e-02, -1.3916e-01],
          [ 2.9907e-01,  5.5923e-03,  1.1334e-01,  ...,  1.3477e-01,
           -4.6783e-02, -2.6221e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[-1.8359e-01,  1.4587e-01, -4.5319e-03,  ...,  4.3884e-02,
           1.2622e-01, -1.7822e-02],
         [-6.9336e-02, -9.5947e-02, -7.3914e-02,  ...,  5.4810e-02,
           1.4990e-01, -2.6465e-01],
         [ 1.0199e-01,  1.4844e-01,  8.7646e-02,  ..., -8.0566e-02,
           1.0254e-01,  1.2115e-02],
         ...,
         [ 3.0078e-01,  1.1462e-01,  6.1005e-02,  ...,  2.2583e-01,
          -8.7305e-01, -4.0283e-01],
         [ 2.6294e-01, -7.3181e-02,  9.6497e-02,  ...,  1.4978e-01,
          -5.1758e-02, -1.6382e-01],
         [ 3.3472e-01, -9.4147e-03,  1.0974e-01,  ...,  1.3379e-01,
          -7.3608e-02, -2.4609e-01]],

        [[-1.4450e-02,  1.3573e-02, -5.5580e-03,  ...,  4.6730e-03,
           8.8882e-03, -1.9817e-03],
         [-1.8406e-03, -1.5507e-03, -3.5877e-03,  ...,  1.0971e-02,
           8.9264e-03, -7.1640e-03],
         [ 2.7130e-02,  3.3905e-02,  1.7166e-02,  ..., -2.6688e-02,
           1.9211e-02,  1.4740e-02],
         ...,
         [ 1.2610e-01,  4.4189e-02,  2.6749e-02,  ...,  9.2163e-02,
          -3.5107e-01, -1.6003e-01],
         [ 9.5459e-02, -2.7634e-02,  3.2837e-02,  ...,  5.5511e-02,
          -1.7563e-02, -5.5084e-02],
         [ 1.5020e-04, -3.0155e-03,  1.0529e-03,  ..., -2.1911e-04,
           2.6455e-03, -1.0242e-03]],

        [[-9.1629e-03,  9.1629e-03, -5.7335e-03,  ...,  2.5692e-03,
           5.0011e-03, -1.0042e-03],
         [-2.6398e-03, -2.6054e-03, -4.3373e-03,  ...,  1.1467e-02,
           1.0475e-02, -1.0040e-02],
         [ 4.1199e-02,  5.6152e-02,  3.1189e-02,  ..., -3.9154e-02,
           3.3905e-02,  1.4961e-02],
         ...,
         [ 1.1951e-01,  4.0192e-02,  2.4963e-02,  ...,  8.6975e-02,
          -3.3008e-01, -1.5051e-01],
         [ 1.1877e-01, -3.4485e-02,  4.1229e-02,  ...,  6.8359e-02,
          -2.2644e-02, -6.9580e-02],
         [ 2.3246e-06, -3.0136e-03,  1.0023e-03,  ..., -2.8062e-04,
           2.6760e-03, -9.1410e-04]],

        ...,

        [[-6.5041e-03,  6.9656e-03, -5.7983e-03,  ...,  1.6155e-03,
           3.0670e-03, -5.6267e-04],
         [-3.5324e-03, -3.8509e-03, -5.2643e-03,  ...,  1.2039e-02,
           1.2329e-02, -1.3420e-02],
         [ 4.8981e-02,  6.8237e-02,  3.8757e-02,  ..., -4.5471e-02,
           4.2236e-02,  1.4885e-02],
         ...,
         [ 1.2372e-01,  4.1656e-02,  2.5681e-02,  ...,  9.0088e-02,
          -3.4204e-01, -1.5625e-01],
         [ 1.1566e-01, -3.3752e-02,  4.0039e-02,  ...,  6.6467e-02,
          -2.2049e-02, -6.7383e-02],
         [ 1.3626e-04, -3.0155e-03,  1.0481e-03,  ..., -2.2435e-04,
           2.6474e-03, -1.0147e-03]],

        [[-5.4512e-03,  6.0959e-03, -5.8174e-03,  ...,  1.2474e-03,
           2.2945e-03, -3.8815e-04],
         [-3.9368e-03, -4.3373e-03, -5.5656e-03,  ...,  1.2245e-02,
           1.3000e-02, -1.4709e-02],
         [ 4.9225e-02,  6.8542e-02,  3.8971e-02,  ..., -4.5776e-02,
           4.2358e-02,  1.4839e-02],
         ...,
         [ 1.1920e-01,  4.0100e-02,  2.4719e-02,  ...,  8.6792e-02,
          -3.2886e-01, -1.5027e-01],
         [ 1.1151e-01, -3.2745e-02,  3.8391e-02,  ...,  6.4026e-02,
          -2.1301e-02, -6.4575e-02],
         [ 1.7345e-04, -3.0136e-03,  1.0624e-03,  ..., -2.0695e-04,
           2.6417e-03, -1.0452e-03]],

        [[-5.7030e-03,  6.2943e-03, -5.8174e-03,  ...,  1.3075e-03,
           2.4700e-03, -4.1270e-04],
         [-4.0359e-03, -4.5013e-03, -5.6992e-03,  ...,  1.2321e-02,
           1.3260e-02, -1.5152e-02],
         [ 5.2612e-02,  7.3792e-02,  4.2236e-02,  ..., -4.8645e-02,
           4.5898e-02,  1.4816e-02],
         ...,
         [ 1.1896e-01,  3.9948e-02,  2.4582e-02,  ...,  8.6670e-02,
          -3.2812e-01, -1.5002e-01],
         [ 1.0535e-01, -3.0884e-02,  3.6224e-02,  ...,  6.0699e-02,
          -1.9958e-02, -6.0913e-02],
         [ 1.1259e-04, -3.0136e-03,  1.0414e-03,  ..., -2.3258e-04,
           2.6550e-03, -9.9945e-04]]], device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[ 0.3286, -0.3809,  0.2703,  ..., -0.1987,  0.2534,  0.2542],
          [-0.5015, -0.4023,  0.5864,  ..., -0.2781, -0.3789,  0.4458],
          [ 0.3230,  0.3721, -0.2445,  ...,  0.0109, -0.0108, -0.4761],
          ...,
          [ 0.1180, -0.1962, -0.6240,  ..., -0.4224, -0.2310, -0.1293],
          [ 0.4768, -0.5430,  0.3606,  ...,  0.2856, -0.1379, -0.2688],
          [ 0.1187,  0.1791,  0.4258,  ..., -0.3992,  0.2563, -0.3069]],

         [[-1.3916,  0.7310, -0.6113,  ...,  0.3984, -1.8926,  0.3386],
          [-0.1234,  0.5498, -2.4902,  ..., -0.7715,  0.0102, -0.4565],
          [-0.1997,  1.1973, -0.0037,  ...,  0.2625, -2.4980,  1.4131],
          ...,
          [-2.4531, -1.0283, -0.9897,  ...,  0.3484,  1.4150, -0.6333],
          [-1.0254,  1.1689, -1.1523,  ..., -1.2295,  1.0664,  1.3906],
          [ 1.9424, -0.0256, -0.7715,  ...,  0.1814, -1.3467, -1.6758]],

         [[-1.3379,  0.5737, -0.4810,  ...,  0.6909, -1.6035,  0.2673],
          [-0.1815,  0.8711, -2.5293,  ..., -0.8115, -0.0670, -0.7764],
          [ 0.1132,  1.2305, -0.0139,  ...,  0.2437, -2.7656,  1.4902],
          ...,
          [-2.4238, -0.9624, -1.3486,  ...,  0.4673,  1.6660, -0.7939],
          [-1.1807,  1.2588, -1.0371,  ..., -1.4062,  1.0645,  1.7246],
          [ 1.9424,  0.2805, -0.5894,  ..., -0.0459, -1.1016, -1.4492]],

         ...,

         [[-1.0732,  0.2563, -0.5264,  ...,  0.6694, -1.4219,  0.2805],
          [-0.1998,  1.2461, -2.3320,  ..., -1.0156, -0.1748, -0.6963],
          [ 0.3074,  1.1514, -0.2925,  ...,  0.8652, -3.0137,  1.0703],
          ...,
          [-2.6016, -0.8589, -1.5967,  ...,  0.4917,  1.6924, -0.8428],
          [-1.3652,  1.1211, -0.8091,  ..., -1.2666,  1.0039,  1.8252],
          [ 2.4355,  0.4463, -0.5601,  ..., -0.2405, -1.0166, -1.5781]],

         [[-1.0938,  0.0398, -0.5146,  ...,  0.6313, -1.4219,  0.2405],
          [-0.1858,  1.3799, -2.4258,  ..., -0.9536, -0.1333, -0.6738],
          [ 0.6094,  1.0684, -0.3635,  ...,  1.0303, -3.1777,  0.7319],
          ...,
          [-2.6348, -0.7896, -1.4971,  ...,  0.5469,  1.6631, -0.8906],
          [-1.4336,  1.0273, -0.8477,  ..., -1.2637,  1.1084,  1.8711],
          [ 2.5371,  0.4185, -0.5107,  ..., -0.3743, -1.0908, -1.6104]],

         [[-1.1787, -0.0862, -0.3972,  ...,  0.6699, -1.4590,  0.2927],
          [-0.2247,  1.4082, -2.4844,  ..., -1.0303, -0.0845, -0.6675],
          [ 0.5938,  1.0645, -0.3113,  ...,  0.8604, -3.2305,  0.8140],
          ...,
          [-2.6504, -0.8052, -1.4395,  ...,  0.4436,  1.5859, -1.0537],
          [-1.4160,  1.0693, -0.8647,  ..., -1.3271,  1.1494,  1.8643],
          [ 2.5566,  0.5312, -0.4272,  ..., -0.5425, -1.0166, -1.6357]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[-8.0908e-01,  8.9355e-01, -3.2666e-01,  ...,  7.2070e-01,
           -5.8398e-01, -3.0298e-01],
          [ 8.1055e-01,  5.2783e-01, -5.7715e-01,  ...,  6.3818e-01,
            5.0195e-01, -7.1582e-01],
          [-6.6748e-01, -8.1836e-01,  5.5811e-01,  ..., -1.6785e-01,
            1.7383e-01,  7.1338e-01],
          ...,
          [ 6.6260e-01,  5.2686e-01,  1.0586e+00,  ...,  8.1055e-01,
            9.5947e-01,  6.0596e-01],
          [-7.8809e-01,  8.6426e-01, -4.0283e-01,  ..., -8.4375e-01,
            1.8604e-01,  4.3286e-01],
          [-3.2666e-01, -4.8877e-01, -7.4561e-01,  ...,  4.2822e-01,
           -3.0469e-01,  6.4258e-01]],

         [[ 1.3877e+00, -4.1431e-01,  3.9825e-02,  ..., -1.4844e+00,
            2.1914e+00, -1.1162e+00],
          [-3.1875e+00, -2.6294e-01, -8.8257e-02,  ...,  4.1901e-02,
           -1.3311e+00,  2.3364e-01],
          [-1.2324e+00,  3.4844e+00, -1.9580e+00,  ...,  1.3594e+00,
           -6.8555e-01, -1.5215e+00],
          ...,
          [-1.2469e-01, -1.4805e+00, -2.2207e+00,  ..., -1.9756e+00,
           -1.7363e+00,  6.3916e-01],
          [ 1.1826e+00, -1.1172e+00,  1.5342e+00,  ...,  2.1406e+00,
            2.8979e-01, -2.1641e+00],
          [ 2.2437e-01,  3.1934e-01,  1.7002e+00,  ..., -1.3574e+00,
            4.0942e-01, -1.2529e+00]],

         [[ 1.1797e+00, -5.9424e-01, -1.5845e-01,  ..., -1.7383e+00,
            2.2461e+00, -9.7705e-01],
          [-3.4121e+00, -1.6968e-01, -5.4321e-02,  ...,  2.4683e-01,
           -1.5254e+00,  2.4341e-01],
          [-9.6240e-01,  3.1406e+00, -1.9238e+00,  ...,  1.2129e+00,
           -6.6357e-01, -1.4688e+00],
          ...,
          [-2.4017e-02, -1.4395e+00, -2.4180e+00,  ..., -2.2129e+00,
           -1.7227e+00,  5.9473e-01],
          [ 7.1680e-01, -8.4180e-01,  1.3008e+00,  ...,  1.9277e+00,
            4.4336e-01, -1.7734e+00],
          [ 3.1030e-01,  7.7979e-01,  1.9316e+00,  ..., -1.3223e+00,
            2.8125e-01, -8.7695e-01]],

         ...,

         [[ 1.2666e+00, -7.2754e-01, -2.5464e-01,  ..., -1.6758e+00,
            2.4082e+00, -8.5547e-01],
          [-3.5352e+00,  1.6296e-01, -3.2300e-01,  ...,  3.1052e-02,
           -9.7559e-01,  3.6163e-03],
          [-9.7607e-01,  2.8691e+00, -1.8516e+00,  ...,  1.1973e+00,
           -1.0869e+00, -1.2979e+00],
          ...,
          [-1.1481e-01, -1.5674e+00, -2.4238e+00,  ..., -2.1914e+00,
           -1.6973e+00,  5.2930e-01],
          [ 5.8838e-01, -6.9824e-01,  1.2002e+00,  ...,  1.9951e+00,
            5.2002e-01, -2.0117e+00],
          [ 2.6172e-01,  9.4482e-01,  1.8857e+00,  ..., -1.3125e+00,
            2.5537e-01, -8.0518e-01]],

         [[ 1.2363e+00, -7.9297e-01, -2.6929e-01,  ..., -1.6895e+00,
            2.3340e+00, -7.6611e-01],
          [-3.5293e+00,  2.6685e-01, -2.7808e-01,  ..., -1.3391e-01,
           -8.5742e-01, -2.1763e-03],
          [-8.8770e-01,  2.8145e+00, -1.8828e+00,  ...,  1.0322e+00,
           -1.1436e+00, -1.1074e+00],
          ...,
          [-3.5370e-02, -1.5371e+00, -2.5098e+00,  ..., -2.2910e+00,
           -1.6875e+00,  5.7568e-01],
          [ 6.4258e-01, -6.2891e-01,  1.2549e+00,  ...,  2.0664e+00,
            5.5518e-01, -2.0918e+00],
          [ 2.4060e-01,  9.5215e-01,  1.9775e+00,  ..., -1.3408e+00,
            1.7944e-01, -8.2178e-01]],

         [[ 1.2598e+00, -8.6914e-01, -2.0728e-01,  ..., -1.7412e+00,
            2.2969e+00, -7.7979e-01],
          [-3.5996e+00,  3.1396e-01, -2.5586e-01,  ..., -4.2267e-03,
           -9.9658e-01,  7.9895e-02],
          [-7.5244e-01,  2.6191e+00, -1.9395e+00,  ...,  9.4873e-01,
           -1.1113e+00, -1.2832e+00],
          ...,
          [-4.4220e-02, -1.4971e+00, -2.5664e+00,  ..., -2.2598e+00,
           -1.7051e+00,  5.6445e-01],
          [ 5.6689e-01, -6.6260e-01,  1.1367e+00,  ...,  2.0117e+00,
            6.2598e-01, -2.0586e+00],
          [ 2.5513e-01,  1.0459e+00,  2.1016e+00,  ..., -1.4141e+00,
            1.4722e-01, -7.7197e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[-8.6927e-04, -5.5351e-03,  6.9542e-03,  ..., -1.2941e-03,
            8.2626e-03,  9.6512e-03],
          [-5.0116e-04,  1.8148e-03,  3.2177e-03,  ..., -7.0457e-03,
           -4.4632e-03,  2.9068e-03],
          [ 1.0635e-02, -8.4305e-03,  7.3357e-03,  ..., -9.4299e-03,
            1.3092e-02, -6.3324e-04],
          ...,
          [-3.2082e-03,  7.8735e-03, -1.3580e-03,  ...,  1.3762e-03,
           -8.1062e-05, -3.2825e-03],
          [-5.7268e-04,  3.1338e-03, -3.3665e-03,  ..., -4.9734e-04,
            8.5068e-03,  3.7289e-03],
          [ 7.5006e-04, -5.5199e-03, -3.0155e-03,  ...,  1.9035e-03,
           -4.3335e-03,  2.6321e-03]],

         [[-1.9360e-01,  1.7908e-01,  1.3049e-01,  ..., -1.4148e-01,
           -1.2659e-01,  1.4732e-02],
          [ 1.7365e-02,  3.6401e-01, -3.0127e-01,  ...,  1.6809e-01,
           -5.0598e-02,  1.6998e-02],
          [-4.6600e-02,  1.5320e-01,  1.1224e-01,  ..., -8.5510e-02,
            1.5576e-01, -8.3313e-03],
          ...,
          [ 1.3965e-01,  2.5562e-01, -2.3544e-02,  ...,  3.0556e-03,
           -3.0029e-01,  9.2529e-02],
          [ 2.1936e-01,  6.7871e-02, -5.3406e-02,  ...,  1.2805e-01,
           -6.5613e-02, -1.0321e-01],
          [-6.2378e-02, -6.0701e-04, -3.5571e-01,  ...,  1.3232e-01,
           -2.3645e-01, -2.0129e-01]],

         [[-1.7310e-01,  2.5098e-01,  1.2524e-01,  ..., -1.7700e-01,
           -1.6882e-01,  5.3894e-02],
          [ 2.8320e-02,  3.2300e-01, -2.5757e-01,  ...,  1.3367e-01,
           -9.7809e-03,  5.8960e-02],
          [-3.2379e-02,  6.0760e-02,  9.4421e-02,  ..., -1.0638e-01,
            1.5393e-01,  1.7532e-02],
          ...,
          [ 1.6113e-01,  2.6074e-01,  4.4060e-03,  ...,  4.5044e-02,
           -3.4351e-01,  7.8796e-02],
          [ 1.9934e-01,  5.3375e-02, -5.2032e-03,  ...,  5.9784e-02,
           -5.1849e-02, -6.9092e-02],
          [-4.1504e-02,  3.1525e-02, -3.2642e-01,  ...,  1.9409e-01,
           -2.0129e-01, -1.7529e-01]],

         ...,

         [[-1.7444e-01,  2.9199e-01,  1.4294e-01,  ..., -1.2927e-01,
           -1.4905e-01,  6.9458e-02],
          [-5.5389e-02,  2.9761e-01, -1.8030e-01,  ...,  7.1045e-02,
           -7.7515e-03,  2.6413e-02],
          [-9.7107e-02,  4.3457e-02,  1.2299e-01,  ..., -1.1047e-01,
            1.2988e-01,  5.6839e-03],
          ...,
          [ 1.4526e-01,  3.3081e-01,  3.4760e-02,  ...,  4.2877e-03,
           -3.0493e-01,  4.1504e-02],
          [ 2.4829e-01,  9.7534e-02, -4.1992e-02,  ...,  5.8502e-02,
           -5.9280e-03, -1.0455e-01],
          [ 2.3315e-02,  9.7847e-04, -2.8271e-01,  ...,  2.2705e-01,
           -1.9556e-01, -1.9067e-01]],

         [[-1.6748e-01,  2.7173e-01,  1.4966e-01,  ..., -1.2140e-01,
           -1.4014e-01,  7.8491e-02],
          [-6.8665e-02,  2.7856e-01, -1.8140e-01,  ...,  4.1687e-02,
           -3.4454e-02,  1.8005e-02],
          [-8.8440e-02,  4.9530e-02,  1.1011e-01,  ..., -1.1328e-01,
            1.2134e-01,  1.3817e-02],
          ...,
          [ 1.2286e-01,  3.0981e-01,  1.8646e-02,  ..., -3.4451e-04,
           -2.6929e-01,  6.5674e-02],
          [ 2.4939e-01,  1.2231e-01, -5.7281e-02,  ...,  7.0190e-02,
            2.0447e-02, -1.0565e-01],
          [ 2.0630e-02, -4.7729e-02, -2.7759e-01,  ...,  2.1851e-01,
           -2.1692e-01, -1.9617e-01]],

         [[-1.7822e-01,  2.9272e-01,  1.4319e-01,  ..., -1.5991e-01,
           -1.5515e-01,  7.7576e-02],
          [-5.6763e-02,  2.8589e-01, -1.8445e-01,  ...,  4.0009e-02,
           -4.6173e-02,  2.6703e-02],
          [-8.2153e-02,  4.3701e-02,  1.0522e-01,  ..., -1.0559e-01,
            1.1188e-01,  1.5610e-02],
          ...,
          [ 1.1603e-01,  3.1177e-01,  3.2562e-02,  ...,  2.7954e-02,
           -2.5293e-01,  5.1300e-02],
          [ 2.4695e-01,  1.3965e-01, -6.2683e-02,  ...,  6.2561e-02,
            3.6194e-02, -7.8247e-02],
          [ 3.2593e-02, -4.0863e-02, -2.8076e-01,  ...,  2.5415e-01,
           -2.2766e-01, -2.1863e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[-1.7554e-01,  2.6465e-01,  1.3977e-01,  ..., -1.4856e-01,
          -1.5234e-01,  5.7556e-02],
         [-1.7136e-02,  3.1030e-01, -2.1436e-01,  ...,  1.0077e-01,
          -3.0563e-02,  3.0106e-02],
         [-6.9580e-02,  6.3477e-02,  1.1060e-01,  ..., -1.0309e-01,
           1.3770e-01,  1.0361e-02],
         ...,
         [ 1.3770e-01,  2.9688e-01,  1.4893e-02,  ...,  1.9684e-02,
          -3.0078e-01,  6.4514e-02],
         [ 2.2900e-01,  9.4727e-02, -4.0314e-02,  ...,  6.7139e-02,
          -1.2016e-02, -8.9661e-02],
         [-3.4046e-04, -5.0850e-03, -3.0029e-01,  ...,  2.0740e-01,
          -2.0752e-01, -1.9482e-01]],

        [[-1.1955e-02,  1.2039e-02,  1.5503e-02,  ..., -1.0658e-02,
          -2.0428e-03,  1.2886e-02],
         [-1.6861e-02,  2.0190e-01, -1.3403e-01,  ...,  5.7953e-02,
          -2.1103e-02,  2.0218e-02],
         [-6.3049e-02,  4.6936e-02,  9.6741e-02,  ..., -9.1370e-02,
           1.1676e-01,  9.6283e-03],
         ...,
         [-1.7576e-03,  1.0933e-02, -1.1501e-03,  ...,  1.5602e-03,
          -3.1815e-03, -2.6093e-03],
         [ 7.1239e-04,  3.6545e-03, -3.5763e-03,  ..., -1.3041e-04,
           8.4076e-03,  3.2082e-03],
         [ 6.9261e-05, -5.4169e-03, -3.0609e-02,  ...,  1.9852e-02,
          -2.3056e-02, -1.5358e-02]],

        [[-1.0750e-02,  1.0162e-02,  1.4580e-02,  ..., -9.6436e-03,
          -9.2745e-04,  1.2558e-02],
         [-2.1225e-02,  2.2485e-01, -1.4819e-01,  ...,  6.3232e-02,
          -2.2949e-02,  2.2064e-02],
         [-6.7688e-02,  4.9957e-02,  1.0229e-01,  ..., -9.6741e-02,
           1.2317e-01,  1.0452e-02],
         ...,
         [-2.0390e-03,  1.0353e-02, -1.1873e-03,  ...,  1.5249e-03,
          -2.5826e-03, -2.7409e-03],
         [ 3.7456e-04,  3.5191e-03, -3.5210e-03,  ..., -2.2912e-04,
           8.4381e-03,  3.3455e-03],
         [ 1.4460e-04, -5.4131e-03, -2.3849e-02,  ...,  1.5320e-02,
          -1.8448e-02, -1.0902e-02]],

        ...,

        [[-1.0353e-02,  9.4910e-03,  1.4259e-02,  ..., -9.3079e-03,
          -5.5122e-04,  1.2428e-02],
         [-2.2293e-02,  2.3206e-01, -1.5308e-01,  ...,  6.5125e-02,
          -2.3636e-02,  2.2598e-02],
         [-7.1167e-02,  5.2460e-02,  1.0657e-01,  ..., -1.0071e-01,
           1.2830e-01,  1.0979e-02],
         ...,
         [-2.1420e-03,  1.0132e-02, -1.2016e-03,  ...,  1.5125e-03,
          -2.3613e-03, -2.7905e-03],
         [ 2.0981e-04,  3.4542e-03, -3.4943e-03,  ..., -2.7633e-04,
           8.4534e-03,  3.4122e-03],
         [ 7.2658e-05, -5.3635e-03, -2.3102e-02,  ...,  1.4694e-02,
          -1.7899e-02, -1.0353e-02]],

        [[-1.1192e-02,  1.0841e-02,  1.4915e-02,  ..., -1.0017e-02,
          -1.3332e-03,  1.2680e-02],
         [-2.2064e-02,  2.3279e-01, -1.5381e-01,  ...,  6.5613e-02,
          -2.3727e-02,  2.2675e-02],
         [-7.1838e-02,  5.2032e-02,  1.0687e-01,  ..., -1.0107e-01,
           1.2817e-01,  1.1101e-02],
         ...,
         [-2.2907e-03,  9.8190e-03, -1.2226e-03,  ...,  1.4925e-03,
          -2.0428e-03, -2.8591e-03],
         [ 2.6345e-04,  3.4771e-03, -3.5038e-03,  ..., -2.6226e-04,
           8.4534e-03,  3.3913e-03],
         [ 9.4473e-05, -5.3673e-03, -2.2552e-02,  ...,  1.4351e-02,
          -1.7532e-02, -1.0002e-02]],

        [[-1.1780e-02,  1.1772e-02,  1.5366e-02,  ..., -1.0506e-02,
          -1.8711e-03,  1.2863e-02],
         [-2.2675e-02,  2.3303e-01, -1.5369e-01,  ...,  6.5186e-02,
          -2.3773e-02,  2.2629e-02],
         [-7.1472e-02,  5.1910e-02,  1.0632e-01,  ..., -1.0065e-01,
           1.2744e-01,  1.1024e-02],
         ...,
         [-2.2697e-03,  9.8648e-03, -1.2188e-03,  ...,  1.4954e-03,
          -2.0866e-03, -2.8496e-03],
         [ 3.3832e-04,  3.5076e-03, -3.5152e-03,  ..., -2.4128e-04,
           8.4457e-03,  3.3607e-03],
         [ 8.5235e-05, -5.3787e-03, -2.3727e-02,  ...,  1.5137e-02,
          -1.8341e-02, -1.0773e-02]]], device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[ 7.5879e-01,  4.3481e-01, -1.0508e+00,  ..., -1.3525e+00,
           -8.9697e-01,  8.6621e-01],
          [-2.7417e-01, -3.7646e-01,  9.8511e-02,  ..., -2.0203e-01,
           -2.2119e-01, -1.1123e+00],
          [-3.3154e-01,  1.4658e+00, -1.7158e+00,  ..., -1.4075e-01,
           -9.8633e-01,  9.0869e-01],
          ...,
          [ 1.6250e+00, -2.3291e-01,  1.2354e+00,  ...,  7.5879e-01,
           -1.1709e+00,  8.8574e-01],
          [ 1.0225e+00,  9.6191e-01,  1.5967e+00,  ...,  6.8213e-01,
            9.2529e-01,  9.4043e-01],
          [-4.6802e-01, -2.8828e+00, -3.9575e-01,  ...,  1.1982e+00,
           -2.8638e-01, -3.3350e-01]],

         [[-2.2988e+00, -1.7520e+00,  2.0312e+00,  ...,  7.2559e-01,
            6.0791e-01, -2.3279e-01],
          [ 2.3066e+00,  1.1465e+00,  2.8839e-03,  ..., -8.6084e-01,
            3.7280e-01,  1.1875e+00],
          [ 2.6172e+00, -1.0850e+00, -1.5955e-01,  ..., -8.5693e-01,
            9.6289e-01, -2.8652e+00],
          ...,
          [-1.0234e+00, -1.4639e+00, -7.8027e-01,  ..., -1.6826e+00,
            1.4297e+00, -1.2539e+00],
          [-7.3926e-01, -1.6562e+00,  7.0152e-03,  ..., -1.5625e+00,
           -1.5391e+00, -1.7227e+00],
          [ 2.2656e+00,  2.4160e+00, -3.5370e-02,  ...,  1.5149e-01,
            1.2002e+00,  7.4072e-01]],

         [[-2.3340e+00, -1.4209e+00,  2.2754e+00,  ...,  1.3086e+00,
            9.1699e-01, -5.2051e-01],
          [ 2.3320e+00,  1.0977e+00, -4.2229e-03,  ..., -8.8818e-01,
            4.4702e-01,  1.1299e+00],
          [ 2.8320e+00, -7.7393e-01, -1.4929e-01,  ..., -1.0049e+00,
            1.2695e+00, -2.8398e+00],
          ...,
          [-9.3408e-01, -1.4053e+00, -8.4814e-01,  ..., -1.8047e+00,
            1.2754e+00, -1.4668e+00],
          [-6.0938e-01, -1.8057e+00, -3.1958e-01,  ..., -1.5918e+00,
           -1.9482e+00, -1.8525e+00],
          [ 2.4082e+00,  2.6445e+00, -4.2999e-02,  ...,  1.7432e-01,
            1.0049e+00,  8.1201e-01]],

         ...,

         [[-2.7168e+00, -1.6738e+00,  2.2070e+00,  ...,  1.3096e+00,
            9.7998e-01, -7.6123e-01],
          [ 2.3867e+00,  1.2334e+00,  3.2617e-01,  ..., -9.3115e-01,
            4.2969e-01,  1.1865e+00],
          [ 2.9414e+00, -7.3438e-01, -1.7944e-01,  ..., -6.8311e-01,
            1.1602e+00, -2.6328e+00],
          ...,
          [-9.4482e-01, -1.2344e+00, -5.8545e-01,  ..., -1.5459e+00,
            1.1641e+00, -1.8115e+00],
          [-5.2783e-01, -1.7754e+00, -2.6929e-01,  ..., -1.8604e+00,
           -2.1699e+00, -1.8477e+00],
          [ 2.5039e+00,  2.6855e+00,  5.5313e-03,  ...,  2.5781e-01,
            9.4092e-01,  7.5928e-01]],

         [[-2.8594e+00, -1.7773e+00,  2.0430e+00,  ...,  1.2617e+00,
            1.0156e+00, -7.5879e-01],
          [ 2.4277e+00,  1.2900e+00,  3.1519e-01,  ..., -1.0039e+00,
            4.8193e-01,  1.1777e+00],
          [ 2.9062e+00, -7.8174e-01, -1.5063e-01,  ..., -6.4893e-01,
            1.2793e+00, -2.5352e+00],
          ...,
          [-1.1455e+00, -1.1689e+00, -4.8193e-01,  ..., -1.5000e+00,
            1.0859e+00, -1.7900e+00],
          [-4.5508e-01, -1.7148e+00, -2.9272e-01,  ..., -1.8633e+00,
           -2.2676e+00, -1.9668e+00],
          [ 2.4863e+00,  2.6445e+00,  3.7048e-02,  ...,  3.0762e-01,
            1.0029e+00,  7.5049e-01]],

         [[-2.7070e+00, -1.7275e+00,  2.1523e+00,  ...,  1.4170e+00,
            9.8828e-01, -8.1006e-01],
          [ 2.4277e+00,  1.3027e+00,  4.0186e-01,  ..., -1.0176e+00,
            5.1709e-01,  1.1709e+00],
          [ 2.7773e+00, -8.6523e-01, -1.8433e-01,  ..., -7.4316e-01,
            1.3896e+00, -2.4375e+00],
          ...,
          [-1.0332e+00, -1.2051e+00, -4.0747e-01,  ..., -1.5830e+00,
            1.1133e+00, -1.6553e+00],
          [-4.8315e-01, -1.7715e+00, -2.2363e-01,  ..., -1.8184e+00,
           -2.2578e+00, -2.0410e+00],
          [ 2.5234e+00,  2.6543e+00,  4.3427e-02,  ...,  3.4717e-01,
            1.0518e+00,  8.0566e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[-6.7188e-01,  1.3125e+00,  4.8022e-01,  ...,  9.0576e-01,
            1.0664e+00, -9.5459e-01],
          [ 1.6614e-01, -1.6833e-01, -3.5986e-01,  ...,  9.2773e-01,
            8.0908e-01,  1.1133e+00],
          [ 1.0205e+00, -1.2256e+00,  1.8369e+00,  ..., -2.3975e-01,
            9.3652e-01, -4.7754e-01],
          ...,
          [-1.4189e+00,  1.1172e+00, -1.3975e+00,  ..., -9.3750e-01,
            7.8174e-01, -7.9150e-01],
          [-1.4971e+00, -1.0410e+00, -4.0796e-01,  ..., -1.2783e+00,
           -5.8936e-01, -1.1445e+00],
          [ 3.9160e-01,  7.0996e-01,  2.2385e-02,  ..., -1.0889e+00,
            1.7468e-01,  1.0980e-01]],

         [[-2.8125e+00,  5.3760e-01, -1.8906e+00,  ..., -1.6631e+00,
           -1.0244e+00,  2.0117e+00],
          [-4.9609e-01,  2.2290e-01, -5.6299e-01,  ..., -1.0371e+00,
           -2.7759e-01, -1.2705e+00],
          [ 1.4004e+00,  2.5859e+00, -2.4902e+00,  ...,  4.1992e-02,
           -8.4863e-01, -1.6772e-01],
          ...,
          [ 2.5117e+00, -4.1367e+00,  8.2129e-01,  ...,  8.4766e-01,
           -3.6084e-01,  1.1738e+00],
          [ 1.7607e+00,  6.0596e-01,  1.7559e+00,  ..., -1.0762e+00,
            9.1260e-01,  1.1826e+00],
          [-4.5728e-01, -1.4951e+00,  4.0601e-01,  ...,  3.6152e+00,
           -1.5127e+00, -1.1992e+00]],

         [[-2.7852e+00,  4.0466e-02, -1.9111e+00,  ..., -1.4834e+00,
           -1.0645e+00,  1.9883e+00],
          [-5.8740e-01,  1.3171e-01, -7.0654e-01,  ..., -1.3984e+00,
           -2.7319e-01, -1.2383e+00],
          [ 1.7461e+00,  2.1543e+00, -2.2676e+00,  ..., -2.1667e-01,
           -9.2920e-01, -9.2896e-02],
          ...,
          [ 1.9482e+00, -4.1328e+00,  1.0205e+00,  ...,  6.5869e-01,
           -4.4287e-01,  1.1172e+00],
          [ 1.9404e+00,  7.9102e-01,  1.6240e+00,  ..., -7.3096e-01,
            1.1172e+00,  1.1562e+00],
          [-9.3155e-03, -1.4443e+00,  7.2412e-01,  ...,  3.6289e+00,
           -1.5088e+00, -1.1201e+00]],

         ...,

         [[-3.0801e+00, -5.7678e-02, -2.0293e+00,  ..., -1.4609e+00,
           -1.3125e+00,  2.1055e+00],
          [-5.4053e-01,  4.0601e-01, -9.0674e-01,  ..., -1.5664e+00,
           -2.7881e-01, -1.2666e+00],
          [ 1.5781e+00,  2.1387e+00, -2.3320e+00,  ..., -2.5195e-01,
           -1.0752e+00,  2.9346e-01],
          ...,
          [ 1.6465e+00, -4.4492e+00,  1.2812e+00,  ...,  5.2295e-01,
           -5.1123e-01,  9.2529e-01],
          [ 2.1973e+00,  7.5098e-01,  1.7090e+00,  ..., -3.1665e-01,
            1.2822e+00,  1.3301e+00],
          [ 1.3623e-01, -1.4531e+00,  7.0947e-01,  ...,  3.8184e+00,
           -1.3613e+00, -1.0596e+00]],

         [[-2.9961e+00,  2.3060e-03, -2.2422e+00,  ..., -1.4814e+00,
           -1.4629e+00,  2.0918e+00],
          [-4.7949e-01,  4.6606e-01, -9.9707e-01,  ..., -1.5068e+00,
           -1.5149e-01, -1.2754e+00],
          [ 1.6523e+00,  2.0332e+00, -2.3301e+00,  ..., -4.5752e-01,
           -1.0195e+00,  3.8721e-01],
          ...,
          [ 1.6816e+00, -4.5352e+00,  1.3623e+00,  ...,  5.7568e-01,
           -6.6992e-01,  8.7012e-01],
          [ 2.3105e+00,  7.5439e-01,  1.7910e+00,  ..., -2.5879e-01,
            1.3096e+00,  1.4268e+00],
          [ 2.7441e-01, -1.5225e+00,  7.2119e-01,  ...,  3.8672e+00,
           -1.3994e+00, -1.1094e+00]],

         [[-3.1309e+00, -6.8115e-02, -2.2305e+00,  ..., -1.3799e+00,
           -1.5625e+00,  2.2461e+00],
          [-4.5483e-01,  4.6362e-01, -9.3945e-01,  ..., -1.5459e+00,
           -4.6753e-02, -1.2393e+00],
          [ 1.7598e+00,  2.0215e+00, -2.2969e+00,  ..., -4.6094e-01,
           -9.4873e-01,  4.9829e-01],
          ...,
          [ 1.6416e+00, -4.5938e+00,  1.4775e+00,  ...,  6.2549e-01,
           -6.5723e-01,  7.9443e-01],
          [ 2.3262e+00,  8.1104e-01,  1.8037e+00,  ..., -2.3474e-01,
            1.3408e+00,  1.4883e+00],
          [ 2.9639e-01, -1.5938e+00,  7.4268e-01,  ...,  3.8926e+00,
           -1.4404e+00, -1.1143e+00]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 9.4986e-03, -1.6737e-04,  5.1308e-03,  ..., -6.5470e-04,
            4.1122e-03, -2.9602e-03],
          [-3.2139e-04,  1.1845e-03,  2.4185e-03,  ...,  4.4465e-04,
           -1.8677e-02, -4.3030e-03],
          [ 4.3449e-03,  6.4468e-03,  1.0490e-03,  ..., -1.2083e-03,
            3.2940e-03,  3.1872e-03],
          ...,
          [ 4.5090e-03,  9.4128e-04, -2.0218e-03,  ...,  1.3351e-03,
           -6.8779e-03,  3.9444e-03],
          [ 1.5345e-03,  7.4577e-04, -6.7291e-03,  ...,  3.0918e-03,
           -5.7030e-04,  2.4605e-03],
          [ 1.3466e-03, -2.2373e-03, -6.5079e-03,  ..., -3.0727e-03,
            1.4595e-02, -3.1967e-03]],

         [[-1.4587e-01,  1.0413e-01,  9.8389e-02,  ..., -2.5146e-01,
           -2.0065e-02, -2.3145e-01],
          [ 3.3960e-01, -5.3418e-01,  5.3009e-02,  ...,  1.8784e-02,
            4.1602e-01, -8.3557e-02],
          [ 5.7220e-02, -2.4170e-02,  3.6572e-01,  ...,  1.0583e-01,
           -3.2690e-01, -5.6946e-02],
          ...,
          [ 5.6006e-01,  1.0124e-02, -2.2507e-02,  ..., -1.3281e-01,
           -4.3408e-01, -7.9834e-02],
          [-1.4417e-01,  6.1707e-02,  3.6438e-02,  ..., -4.8309e-02,
           -3.1543e-01, -2.3669e-01],
          [ 5.7556e-02, -6.9336e-01,  1.9824e-01,  ..., -6.6101e-02,
            7.8760e-01,  3.9612e-02]],

         [[-1.6931e-01,  1.1340e-01,  6.1493e-02,  ..., -2.1033e-01,
           -7.3975e-02, -2.1326e-01],
          [ 1.8225e-01, -5.3223e-01, -1.7639e-02,  ..., -3.4607e-02,
            3.9575e-01, -9.1309e-02],
          [-2.1835e-02,  3.8177e-02,  3.7183e-01,  ...,  1.2537e-01,
           -3.5840e-01, -6.4392e-02],
          ...,
          [ 5.7275e-01,  5.4535e-02, -4.0070e-02,  ..., -1.4380e-01,
           -4.4751e-01, -2.3972e-02],
          [-1.4539e-01,  8.9661e-02,  7.8003e-02,  ...,  1.7731e-02,
           -3.2446e-01, -2.4377e-01],
          [ 1.6968e-01, -7.2559e-01,  2.8247e-01,  ...,  5.6877e-03,
            8.3789e-01, -2.5375e-02]],

         ...,

         [[-1.8848e-01,  8.6182e-02,  5.7953e-02,  ..., -2.2302e-01,
           -8.2153e-02, -2.1729e-01],
          [ 8.1909e-02, -5.4736e-01,  2.0004e-02,  ..., -6.7627e-02,
            4.1650e-01, -2.3633e-01],
          [-8.5815e-02,  8.3252e-02,  2.5537e-01,  ...,  2.1033e-01,
           -4.2407e-01, -5.3406e-02],
          ...,
          [ 5.6641e-01,  3.3447e-02, -4.1809e-02,  ..., -9.8511e-02,
           -4.0283e-01, -4.2419e-02],
          [-1.3062e-01,  6.6040e-02,  7.4036e-02,  ...,  5.9113e-02,
           -2.6709e-01, -2.0764e-01],
          [ 2.1545e-01, -7.9736e-01,  3.5107e-01,  ...,  1.1731e-01,
            8.6182e-01, -7.6721e-02]],

         [[-1.8799e-01,  8.9050e-02,  4.3488e-02,  ..., -2.1899e-01,
           -8.7952e-02, -1.8054e-01],
          [ 5.9357e-02, -5.7861e-01,  1.2169e-02,  ..., -6.8542e-02,
            4.1699e-01, -2.2339e-01],
          [-6.6345e-02,  1.0535e-01,  2.4255e-01,  ...,  2.1497e-01,
           -4.2163e-01, -6.4697e-02],
          ...,
          [ 5.6787e-01,  1.5144e-02, -2.7008e-02,  ..., -8.8745e-02,
           -4.0527e-01, -5.1697e-02],
          [-1.5588e-01,  8.8196e-02,  9.0332e-02,  ...,  6.2927e-02,
           -2.5488e-01, -1.8762e-01],
          [ 2.4719e-01, -7.9346e-01,  3.5791e-01,  ...,  1.3098e-01,
            8.9746e-01, -1.0419e-01]],

         [[-1.9666e-01,  8.8562e-02,  3.4973e-02,  ..., -2.0325e-01,
           -8.6609e-02, -1.6553e-01],
          [ 7.4585e-02, -5.2148e-01,  1.6678e-02,  ..., -3.8147e-02,
            4.0454e-01, -2.3645e-01],
          [-9.2529e-02,  1.4221e-01,  2.4890e-01,  ...,  2.3999e-01,
           -3.8794e-01, -2.1637e-02],
          ...,
          [ 5.6982e-01,  1.9699e-02, -3.5522e-02,  ..., -8.8257e-02,
           -4.1919e-01, -5.6244e-02],
          [-1.4429e-01,  9.1736e-02,  1.1060e-01,  ...,  5.7770e-02,
           -2.6660e-01, -1.8762e-01],
          [ 2.2876e-01, -7.9248e-01,  3.4766e-01,  ...,  1.3306e-01,
            8.7549e-01, -7.3303e-02]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[-1.7896e-01,  9.7534e-02,  5.9601e-02,  ..., -2.2168e-01,
          -7.1594e-02, -2.0496e-01],
         [ 1.4233e-01, -5.4053e-01,  1.3458e-02,  ..., -4.3701e-02,
           4.1138e-01, -1.7529e-01],
         [-6.1340e-02,  8.2397e-02,  2.8516e-01,  ...,  1.9080e-01,
          -3.8916e-01, -5.1544e-02],
         ...,
         [ 5.7275e-01,  2.8091e-02, -3.5278e-02,  ..., -1.0931e-01,
          -4.1846e-01, -4.8584e-02],
         [-1.4099e-01,  7.7515e-02,  8.1909e-02,  ...,  4.2328e-02,
          -2.8564e-01, -2.1155e-01],
         [ 1.9080e-01, -7.7002e-01,  3.1055e-01,  ...,  6.8726e-02,
           8.5889e-01, -5.1514e-02]],

        [[-1.2585e-01,  6.7627e-02,  4.1138e-02,  ..., -1.5564e-01,
          -5.2246e-02, -1.4355e-01],
         [ 4.7760e-02, -2.0081e-01,  6.1531e-03,  ..., -1.7380e-02,
           1.4136e-01, -7.1228e-02],
         [-3.3703e-03,  1.5518e-02,  6.0272e-02,  ...,  3.0365e-02,
          -6.8420e-02, -7.9727e-03],
         ...,
         [ 5.0964e-03,  9.6941e-04, -2.0542e-03,  ...,  1.2121e-03,
          -7.3090e-03,  3.8872e-03],
         [-7.3433e-03,  5.4016e-03, -1.5554e-03,  ...,  4.9324e-03,
          -1.8875e-02, -1.1330e-02],
         [ 1.0017e-02, -3.7079e-02,  7.9193e-03,  ...,  2.3711e-04,
           5.2887e-02, -5.4398e-03]],

        [[-1.4172e-01,  7.5623e-02,  4.5319e-02,  ..., -1.7371e-01,
          -5.8899e-02, -1.5991e-01],
         [ 4.7882e-02, -2.0544e-01,  6.2790e-03,  ..., -1.7929e-02,
           1.4502e-01, -7.3547e-02],
         [-5.9509e-03,  1.8372e-02,  7.1899e-02,  ...,  3.7872e-02,
          -8.4045e-02, -1.0246e-02],
         ...,
         [ 5.0964e-03,  9.6941e-04, -2.0542e-03,  ...,  1.2140e-03,
          -7.3090e-03,  3.8891e-03],
         [-8.5678e-03,  6.0387e-03, -8.4925e-04,  ...,  5.1651e-03,
          -2.1393e-02, -1.3222e-02],
         [ 1.1551e-02, -4.3182e-02,  1.0460e-02,  ...,  8.4448e-04,
           5.9601e-02, -5.8441e-03]],

        ...,

        [[-1.5955e-01,  8.4412e-02,  4.9774e-02,  ..., -1.9373e-01,
          -6.6467e-02, -1.7810e-01],
         [ 4.8645e-02, -2.0789e-01,  6.4316e-03,  ..., -1.8021e-02,
           1.4697e-01, -7.4341e-02],
         [-9.0408e-03,  2.2003e-02,  9.1064e-02,  ...,  4.9011e-02,
          -1.0846e-01, -1.3908e-02],
         ...,
         [ 5.1918e-03,  9.7466e-04, -2.0599e-03,  ...,  1.1940e-03,
          -7.3776e-03,  3.8795e-03],
         [-1.3252e-02,  8.5220e-03,  1.9503e-03,  ...,  6.2637e-03,
          -3.0991e-02, -2.0447e-02],
         [ 1.3199e-02, -4.9744e-02,  1.3184e-02,  ...,  1.4925e-03,
           6.6772e-02, -6.2828e-03]],

        [[-1.6345e-01,  8.5876e-02,  5.0262e-02,  ..., -1.9739e-01,
          -6.8420e-02, -1.8115e-01],
         [ 4.8950e-02, -2.1045e-01,  6.4812e-03,  ..., -1.8280e-02,
           1.4893e-01, -7.5378e-02],
         [-9.0179e-03,  2.1973e-02,  8.8196e-02,  ...,  4.8035e-02,
          -1.0559e-01, -1.3390e-02],
         ...,
         [ 5.2528e-03,  9.7752e-04, -2.0638e-03,  ...,  1.1816e-03,
          -7.4234e-03,  3.8738e-03],
         [-1.5152e-02,  9.5215e-03,  3.0899e-03,  ...,  6.7253e-03,
          -3.4851e-02, -2.3346e-02],
         [ 1.3779e-02, -5.2002e-02,  1.4137e-02,  ...,  1.7385e-03,
           6.9275e-02, -6.4468e-03]],

        [[-1.5979e-01,  8.4167e-02,  4.9408e-02,  ..., -1.9348e-01,
          -6.6772e-02, -1.7749e-01],
         [ 4.6997e-02, -2.0276e-01,  6.3438e-03,  ..., -1.7639e-02,
           1.4294e-01, -7.2998e-02],
         [-8.6975e-03,  2.1591e-02,  8.4351e-02,  ...,  4.6265e-02,
          -1.0132e-01, -1.2680e-02],
         ...,
         [ 5.3596e-03,  9.8228e-04, -2.0695e-03,  ...,  1.1606e-03,
          -7.4997e-03,  3.8643e-03],
         [-1.5549e-02,  9.7275e-03,  3.3092e-03,  ...,  6.7749e-03,
          -3.5675e-02, -2.3972e-02],
         [ 1.4091e-02, -5.3223e-02,  1.4648e-02,  ...,  1.8702e-03,
           7.0618e-02, -6.5346e-03]]], device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[-0.6582, -0.1344, -1.0586,  ...,  0.6782, -1.1318, -0.8384],
          [ 1.0459, -1.2686, -1.6445,  ..., -0.0444, -0.9805, -0.3682],
          [-0.3313, -1.4697,  0.0209,  ...,  1.1982, -0.5176,  1.5781],
          ...,
          [ 1.5879, -1.2266,  1.1699,  ...,  0.4421, -0.2404,  1.2314],
          [-0.1718,  0.2664,  2.7500,  ...,  0.4333,  2.4336, -1.6250],
          [-0.5376,  1.2891, -1.1143,  ..., -0.1544,  0.4221,  0.5181]],

         [[ 0.3123,  0.6094,  1.2744,  ..., -1.7373,  0.3455, -0.2322],
          [ 0.1208,  2.0938,  0.5649,  ..., -0.9326,  1.1895, -0.0078],
          [-0.5640,  3.1328, -2.6836,  ...,  1.8232, -0.6284, -1.3281],
          ...,
          [-2.8691,  0.7720, -1.2686,  ..., -2.1309,  0.1587, -0.5493],
          [-0.5884,  1.2793, -1.7520,  ...,  0.9219, -1.4795,  1.3955],
          [-1.0234, -1.6514, -0.5200,  ...,  0.3882,  0.6973, -2.3340]],

         [[-0.0196,  0.6328,  1.6807,  ..., -1.9111,  0.4702, -0.2454],
          [-0.3718,  1.9307,  0.3901,  ..., -0.7290,  1.0977, -0.1077],
          [-0.3188,  3.4844, -2.6465,  ...,  1.9209, -0.5752, -1.1797],
          ...,
          [-3.2344,  0.7070, -1.5107,  ..., -2.2617,  0.2407, -0.5103],
          [-0.6143,  1.4326, -1.6436,  ...,  0.5234, -1.7461,  1.1309],
          [-1.1064, -1.7061, -0.5195,  ...,  0.1353,  0.8496, -2.5195]],

         ...,

         [[ 0.0869,  0.8101,  1.8633,  ..., -1.8633,  0.4014, -0.1182],
          [-0.6421,  1.8105,  0.2537,  ..., -0.6553,  1.1113, -0.1597],
          [-0.3645,  3.5176, -2.6758,  ...,  1.9287, -0.5854, -1.3740],
          ...,
          [-3.2520,  0.8433, -1.8564,  ..., -2.0293,  0.2627, -0.5654],
          [-0.6230,  1.4629, -1.5732,  ...,  0.4880, -1.6582,  1.1172],
          [-1.1416, -1.6650, -0.6006,  ..., -0.2588,  0.8809, -2.5430]],

         [[ 0.0487,  0.7676,  1.8721,  ..., -1.8154,  0.3621, -0.1897],
          [-0.6133,  1.7646,  0.1592,  ..., -0.5913,  1.1387, -0.2395],
          [-0.3970,  3.5039, -2.7305,  ...,  1.9346, -0.4941, -1.3965],
          ...,
          [-3.1816,  0.8330, -1.9971,  ..., -1.9854,  0.3250, -0.5952],
          [-0.5776,  1.5078, -1.4463,  ...,  0.4131, -1.5986,  1.2432],
          [-1.0791, -1.6934, -0.6328,  ..., -0.2786,  0.8813, -2.5664]],

         [[ 0.0180,  0.8662,  1.9268,  ..., -1.8926,  0.3689, -0.1979],
          [-0.6094,  1.6895,  0.1089,  ..., -0.6567,  1.1475, -0.3059],
          [-0.3962,  3.6250, -2.7305,  ...,  2.0605, -0.4990, -1.3730],
          ...,
          [-3.2305,  0.8018, -2.1074,  ..., -2.0488,  0.3230, -0.5703],
          [-0.5581,  1.5664, -1.4639,  ...,  0.3799, -1.5967,  1.2490],
          [-1.1250, -1.6719, -0.6567,  ..., -0.3186,  0.8345, -2.5586]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[ 6.5137e-01,  5.1318e-01,  1.3818e-01,  ...,  3.9215e-02,
            3.0371e+00,  5.2637e-01],
          [-1.3818e+00,  1.9072e+00,  2.0684e+00,  ..., -9.3799e-01,
            1.5850e+00,  7.4023e-01],
          [ 2.9004e-01,  1.2598e+00, -1.1871e-02,  ..., -1.1104e+00,
            8.0859e-01, -6.7139e-01],
          ...,
          [-1.6924e+00,  1.1279e+00, -6.3477e-01,  ..., -2.7344e-01,
            1.5796e-01, -1.2363e+00],
          [-3.8989e-01,  2.7026e-01, -1.4805e+00,  ...,  1.7688e-01,
           -1.7188e+00,  2.7441e-01],
          [-1.3660e-01, -1.0703e+00,  1.9946e-01,  ...,  2.4280e-01,
            2.0300e-01, -6.3428e-01]],

         [[-8.6572e-01, -2.2339e-01,  1.8008e+00,  ...,  1.4014e+00,
           -1.8438e+00,  2.8594e+00],
          [-9.3213e-01, -1.6602e+00,  1.9995e-01,  ...,  2.3193e-01,
           -1.4229e+00, -1.3135e+00],
          [-2.5547e+00,  2.2681e-01, -1.1006e+00,  ...,  1.0480e-01,
           -1.6494e+00,  2.0840e+00],
          ...,
          [ 3.0493e-01, -6.3398e+00,  1.1660e+00,  ..., -1.0088e+00,
            1.3740e+00,  4.9922e+00],
          [ 3.6743e-01, -1.4893e-01, -1.0480e-01,  ...,  6.8066e-01,
            5.0195e-01,  1.5020e+00],
          [-5.2490e-01, -2.1504e+00, -1.4258e+00,  ..., -1.0859e+00,
            6.4941e-02, -2.7808e-01]],

         [[-1.0156e+00, -2.3364e-01,  1.9717e+00,  ...,  1.0732e+00,
           -1.5449e+00,  2.5332e+00],
          [-1.0137e+00, -1.7607e+00,  6.2549e-01,  ...,  4.6661e-02,
           -1.6289e+00, -1.6719e+00],
          [-2.3457e+00,  4.0454e-01, -1.1113e+00,  ..., -2.3792e-01,
           -1.6514e+00,  2.0938e+00],
          ...,
          [ 2.2314e-01, -6.2773e+00,  1.1406e+00,  ..., -1.1650e+00,
            1.1641e+00,  4.8164e+00],
          [ 3.2031e-01, -1.5381e-01,  1.2360e-01,  ...,  7.9932e-01,
            7.2412e-01,  1.4385e+00],
          [-8.0078e-01, -2.1074e+00, -1.4551e+00,  ..., -1.2080e+00,
           -4.4525e-02, -2.7832e-01]],

         ...,

         [[-1.1885e+00, -3.6407e-02,  2.0176e+00,  ...,  1.3516e+00,
           -1.3740e+00,  2.0293e+00],
          [-1.1553e+00, -1.9033e+00,  8.0078e-01,  ..., -1.9214e-01,
           -1.8486e+00, -1.8037e+00],
          [-2.3984e+00,  2.2778e-01, -1.0078e+00,  ..., -2.1265e-01,
           -1.5410e+00,  1.9932e+00],
          ...,
          [ 1.4990e-01, -6.4531e+00,  9.7314e-01,  ..., -1.2812e+00,
            1.0146e+00,  5.0195e+00],
          [ 4.6851e-01,  4.8004e-02,  2.8955e-01,  ...,  8.1348e-01,
            9.1504e-01,  1.4072e+00],
          [-1.0586e+00, -2.0234e+00, -1.5566e+00,  ..., -1.0869e+00,
           -2.2852e-01, -2.2180e-01]],

         [[-1.3398e+00,  2.8336e-02,  1.9590e+00,  ...,  1.4023e+00,
           -1.3320e+00,  2.1504e+00],
          [-1.1982e+00, -1.9414e+00,  9.3311e-01,  ..., -3.5352e-01,
           -1.9424e+00, -1.7637e+00],
          [-2.4277e+00,  2.2791e-01, -9.7803e-01,  ..., -1.8579e-01,
           -1.5215e+00,  1.9268e+00],
          ...,
          [ 1.1304e-01, -6.5156e+00,  8.8477e-01,  ..., -1.3711e+00,
            1.0801e+00,  5.0781e+00],
          [ 5.1416e-01, -7.7576e-02,  3.7012e-01,  ...,  7.1777e-01,
            1.0254e+00,  1.4072e+00],
          [-1.0312e+00, -2.0176e+00, -1.5615e+00,  ..., -9.7852e-01,
           -2.8418e-01, -2.0129e-01]],

         [[-1.2461e+00, -5.6610e-03,  1.9277e+00,  ...,  1.3506e+00,
           -1.3252e+00,  2.1094e+00],
          [-1.1396e+00, -1.9844e+00,  9.2236e-01,  ..., -2.9932e-01,
           -2.0410e+00, -1.7764e+00],
          [-2.3750e+00,  3.0884e-01, -1.1191e+00,  ..., -1.8921e-01,
           -1.5059e+00,  1.8809e+00],
          ...,
          [ 1.5430e-01, -6.6562e+00,  9.3262e-01,  ..., -1.5029e+00,
            1.1182e+00,  5.1836e+00],
          [ 4.7314e-01, -5.5725e-02,  4.6680e-01,  ...,  6.4209e-01,
            1.0625e+00,  1.3477e+00],
          [-1.0947e+00, -2.0957e+00, -1.6143e+00,  ..., -1.0332e+00,
           -3.1128e-01, -1.9470e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 2.4750e-02, -8.7738e-03, -1.1034e-03,  ...,  1.8021e-02,
            5.0926e-03,  9.4849e-02],
          [-2.6035e-03, -1.0405e-03,  1.3542e-02,  ..., -1.0483e-02,
            1.9226e-03, -1.3285e-03],
          [-9.0485e-03,  4.5738e-03,  1.0330e-02,  ...,  7.4310e-03,
            4.3640e-03, -1.8606e-03],
          ...,
          [-5.2547e-04, -5.6953e-03, -1.2039e-02,  ...,  6.1340e-03,
           -9.9945e-03, -1.0963e-02],
          [ 2.9907e-03, -9.5062e-03,  8.7051e-03,  ..., -9.4528e-03,
           -3.4771e-03, -2.2202e-03],
          [ 2.7370e-03, -5.0125e-03,  1.5305e-02,  ..., -1.4069e-02,
            1.8711e-03, -4.5624e-03]],

         [[ 1.2042e-01, -1.7395e-03, -2.1179e-01,  ...,  3.0688e-01,
           -1.3867e-01, -7.4854e-01],
          [ 4.9622e-02, -7.2266e-02,  2.0142e-01,  ...,  4.4434e-02,
           -2.1130e-01,  1.8579e-01],
          [ 5.0110e-02,  2.0752e-01,  2.3486e-01,  ...,  1.5906e-01,
            3.4741e-01, -9.1309e-02],
          ...,
          [ 2.7405e-02, -3.4863e-01,  1.0370e-01,  ...,  3.6987e-01,
            4.5868e-02,  3.5248e-02],
          [ 2.7905e-01,  4.0625e-01,  2.9688e-01,  ..., -9.0210e-02,
           -3.1836e-01,  2.8760e-01],
          [-1.7322e-01, -2.7368e-01,  6.0059e-01,  ...,  2.7246e-01,
           -8.8867e-02,  8.6304e-02]],

         [[ 1.1401e-01, -1.8112e-02, -2.5903e-01,  ...,  3.9722e-01,
           -1.1194e-01, -6.9727e-01],
          [ 3.3478e-02, -1.3171e-01,  1.7322e-01,  ...,  1.0422e-02,
           -2.2437e-01,  2.1289e-01],
          [ 6.7017e-02,  2.6465e-01,  2.4646e-01,  ...,  8.8440e-02,
            3.6304e-01, -9.0515e-02],
          ...,
          [ 3.5675e-02, -4.0210e-01,  8.7341e-02,  ...,  3.3276e-01,
            7.2510e-02,  5.5420e-02],
          [ 2.4707e-01,  3.3618e-01,  3.4009e-01,  ..., -1.1804e-01,
           -3.7769e-01,  2.0312e-01],
          [-2.1594e-01, -2.0166e-01,  5.5957e-01,  ...,  2.9248e-01,
           -1.0168e-01,  1.5479e-01]],

         ...,

         [[ 1.4331e-01, -1.2848e-02, -2.5513e-01,  ...,  3.6694e-01,
           -1.2134e-01, -6.6943e-01],
          [ 4.7394e-02, -2.0081e-01,  2.1887e-01,  ...,  5.3215e-03,
           -2.3022e-01,  2.2107e-01],
          [ 5.3345e-02,  3.2153e-01,  2.9736e-01,  ...,  2.7985e-02,
            3.7207e-01, -1.2683e-01],
          ...,
          [ 2.0874e-02, -4.1016e-01,  4.1534e-02,  ...,  3.5083e-01,
            3.2104e-02,  1.1176e-01],
          [ 1.8433e-01,  3.6938e-01,  3.3862e-01,  ..., -1.2573e-01,
           -3.2227e-01,  1.5796e-01],
          [-1.8579e-01, -8.9966e-02,  5.3906e-01,  ...,  2.1899e-01,
           -9.7107e-02,  1.9653e-01]],

         [[ 1.3379e-01, -2.3132e-02, -2.4487e-01,  ...,  3.4497e-01,
           -1.2744e-01, -6.5967e-01],
          [ 9.3872e-02, -2.0605e-01,  1.9434e-01,  ...,  3.2978e-03,
           -2.2876e-01,  2.1655e-01],
          [ 1.8143e-02,  3.3350e-01,  2.9248e-01,  ...,  2.2247e-02,
            3.6646e-01, -1.8274e-01],
          ...,
          [ 3.5553e-02, -4.1919e-01, -7.2708e-03,  ...,  3.2812e-01,
            2.7939e-02,  1.2421e-01],
          [ 1.8262e-01,  3.7866e-01,  3.1250e-01,  ..., -1.2488e-01,
           -3.2275e-01,  1.3428e-01],
          [-2.2217e-01, -8.7097e-02,  5.6738e-01,  ...,  2.2278e-01,
           -5.5420e-02,  2.0764e-01]],

         [[ 1.2134e-01, -4.0436e-02, -2.3926e-01,  ...,  3.5938e-01,
           -1.2329e-01, -6.5039e-01],
          [ 6.7322e-02, -2.2998e-01,  2.0056e-01,  ...,  2.1076e-03,
           -2.0520e-01,  2.1570e-01],
          [ 4.3304e-02,  3.4009e-01,  2.8516e-01,  ...,  1.9409e-02,
            3.7305e-01, -1.6626e-01],
          ...,
          [ 5.2368e-02, -4.4531e-01, -1.2939e-02,  ...,  3.1226e-01,
            5.6274e-02,  1.0889e-01],
          [ 1.8970e-01,  3.8843e-01,  3.1812e-01,  ..., -1.4124e-01,
           -3.0005e-01,  1.2445e-01],
          [-2.0020e-01, -9.6558e-02,  5.8350e-01,  ...,  2.1143e-01,
           -5.1422e-02,  2.3193e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[ 1.2683e-01, -1.6693e-02, -2.4805e-01,  ...,  3.6304e-01,
          -1.1835e-01, -6.8457e-01],
         [ 5.6763e-02, -1.6833e-01,  1.9543e-01,  ...,  4.9934e-03,
          -2.2168e-01,  2.1313e-01],
         [ 5.0873e-02,  2.9663e-01,  2.7441e-01,  ...,  6.0059e-02,
           3.6597e-01, -1.2695e-01],
         ...,
         [ 3.4119e-02, -4.0381e-01,  4.0680e-02,  ...,  3.3740e-01,
           4.8218e-02,  8.6365e-02],
         [ 2.0203e-01,  3.7036e-01,  3.2568e-01,  ..., -1.2964e-01,
          -3.3105e-01,  1.5784e-01],
         [-1.9580e-01, -1.4478e-01,  5.6201e-01,  ...,  2.4170e-01,
          -8.5266e-02,  1.8359e-01]],

        [[ 8.3496e-02, -1.4229e-02, -1.4294e-01,  ...,  2.1594e-01,
          -6.4758e-02, -3.4595e-01],
         [ 2.9335e-03, -1.6708e-02,  3.1250e-02,  ..., -9.0408e-03,
          -2.0111e-02,  1.9684e-02],
         [ 2.6703e-04,  4.8096e-02,  5.0201e-02,  ...,  1.6724e-02,
           5.9479e-02, -2.0279e-02],
         ...,
         [ 4.8981e-03, -6.9580e-02, -3.3493e-03,  ...,  5.9265e-02,
          -5.5647e-04,  4.6692e-03],
         [ 1.6861e-02,  1.3992e-02,  2.8122e-02,  ..., -1.6220e-02,
          -2.4246e-02,  1.0101e-02],
         [-4.1656e-03, -9.9564e-03,  3.4393e-02,  ..., -5.1384e-03,
          -1.1692e-03,  1.9684e-03]],

        [[ 8.8135e-02, -1.4709e-02, -1.5430e-01,  ...,  2.3193e-01,
          -7.0312e-02, -3.8110e-01],
         [ 1.3599e-03, -1.2230e-02,  2.6199e-02,  ..., -9.4452e-03,
          -1.3802e-02,  1.3672e-02],
         [-6.7413e-05,  4.6448e-02,  4.8706e-02,  ...,  1.6449e-02,
           5.7434e-02, -1.9592e-02],
         ...,
         [ 5.1994e-03, -7.2876e-02, -2.9640e-03,  ...,  6.1951e-02,
          -6.7830e-05,  5.4932e-03],
         [ 1.5457e-02,  1.1726e-02,  2.6245e-02,  ..., -1.5594e-02,
          -2.2217e-02,  8.8120e-03],
         [-4.3869e-03, -1.0056e-02,  3.4973e-02,  ..., -4.8828e-03,
          -1.2569e-03,  2.2087e-03]],

        ...,

        [[ 8.4778e-02, -1.4427e-02, -1.4636e-01,  ...,  2.2083e-01,
          -6.6284e-02, -3.5571e-01],
         [ 1.6289e-03, -1.2917e-02,  2.7084e-02,  ..., -9.3307e-03,
          -1.4900e-02,  1.4702e-02],
         [-1.1129e-03,  4.1595e-02,  4.4250e-02,  ...,  1.5427e-02,
           5.1300e-02, -1.7548e-02],
         ...,
         [ 3.6736e-03, -5.4871e-02, -5.3291e-03,  ...,  4.7058e-02,
          -2.7142e-03,  1.0309e-03],
         [ 1.4992e-02,  1.0986e-02,  2.5635e-02,  ..., -1.5388e-02,
          -2.1545e-02,  8.3771e-03],
         [-4.9973e-03, -1.0452e-02,  3.6652e-02,  ..., -4.1122e-03,
          -1.5182e-03,  2.8114e-03]],

        [[ 8.1787e-02, -1.4198e-02, -1.3892e-01,  ...,  2.1045e-01,
          -6.2622e-02, -3.3252e-01],
         [ 3.0613e-03, -1.6953e-02,  3.1677e-02,  ..., -8.9493e-03,
          -2.0584e-02,  2.0111e-02],
         [-1.3981e-03,  4.0253e-02,  4.3030e-02,  ...,  1.5129e-02,
           4.9591e-02, -1.6983e-02],
         ...,
         [ 4.0894e-03, -5.9692e-02, -4.7302e-03,  ...,  5.1025e-02,
          -2.0180e-03,  2.2335e-03],
         [ 1.4862e-02,  1.0811e-02,  2.5497e-02,  ..., -1.5350e-02,
          -2.1393e-02,  8.2474e-03],
         [-5.3406e-03, -1.0689e-02,  3.7567e-02,  ..., -3.6774e-03,
          -1.6623e-03,  3.1338e-03]],

        [[ 8.1299e-02, -1.4153e-02, -1.3782e-01,  ...,  2.0898e-01,
          -6.2164e-02, -3.2959e-01],
         [ 3.2387e-03, -1.7426e-02,  3.2257e-02,  ..., -8.8730e-03,
          -2.1317e-02,  2.0813e-02],
         [-1.2341e-03,  4.1107e-02,  4.3793e-02,  ...,  1.5297e-02,
           5.0659e-02, -1.7349e-02],
         ...,
         [ 4.2152e-03, -6.1157e-02, -4.5280e-03,  ...,  5.2277e-02,
          -1.8063e-03,  2.5883e-03],
         [ 1.6434e-02,  1.3496e-02,  2.7695e-02,  ..., -1.6129e-02,
          -2.3743e-02,  9.6359e-03],
         [-5.8556e-03, -1.1047e-02,  3.9001e-02,  ..., -3.0136e-03,
          -1.8873e-03,  3.6278e-03]]], device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[ 0.2773,  1.0596, -1.8965,  ...,  2.2422,  1.5352, -0.2634],
          [ 0.0404,  0.7007, -1.0811,  ...,  0.4170, -0.2119,  0.8154],
          [-3.2090, -2.5605,  0.1901,  ...,  2.2031, -0.3782, -0.3826],
          ...,
          [-1.2988, -1.2754, -2.2793,  ...,  2.0859,  0.3462,  0.7686],
          [ 0.7305, -2.1855,  0.0989,  ...,  0.5864, -0.5654,  1.4121],
          [-1.3184, -2.2637,  0.7993,  ..., -0.0704, -1.1641,  1.9863]],

         [[ 1.4697, -0.1838,  0.5288,  ..., -2.1992, -1.6035,  3.2832],
          [-1.5146,  0.1791, -0.5884,  ..., -0.6064, -0.0685,  0.2854],
          [ 0.7178,  0.3809,  0.5942,  ..., -1.2148, -2.3613, -1.1221],
          ...,
          [-0.1821,  1.2090,  0.2739,  ...,  0.3862,  0.3706,  0.3860],
          [-1.0205,  2.0352, -1.7861,  ..., -0.9004, -0.6621, -1.8379],
          [ 2.3359,  2.2070,  0.1637,  ..., -0.3386, -0.5039, -0.2722]],

         [[ 1.3125, -0.3096,  0.6333,  ..., -2.0742, -1.6299,  3.2754],
          [-1.3057,  0.2406, -0.6685,  ..., -0.5010, -0.1646,  0.2705],
          [ 0.6777, -0.0269,  0.7490,  ..., -1.2822, -2.3945, -0.9746],
          ...,
          [-0.2217,  1.4941,  0.3545,  ...,  0.4773,  0.4746,  0.2998],
          [-0.9360,  2.2539, -1.6387,  ..., -0.8159, -0.4131, -1.9766],
          [ 2.0371,  2.1973,  0.2520,  ..., -0.3335, -0.5171, -0.0113]],

         ...,

         [[ 0.9951, -0.3252,  0.8193,  ..., -1.8955, -1.4824,  3.2988],
          [-1.1553,  0.4451, -0.9351,  ..., -0.2808, -0.3191,  0.3894],
          [ 0.5264, -0.3276,  0.8066,  ..., -1.2607, -2.4258, -0.9150],
          ...,
          [-0.4385,  1.6094,  0.3396,  ...,  0.7222,  0.2817,  0.1625],
          [-0.7246,  2.3965, -1.4561,  ..., -0.8076, -0.2461, -2.0273],
          [ 1.9902,  2.0332,  0.3447,  ..., -0.3772, -0.4595,  0.2747]],

         [[ 0.8857, -0.4248,  0.9106,  ..., -1.9854, -1.2852,  3.1953],
          [-1.0938,  0.5889, -1.0537,  ..., -0.2988, -0.3291,  0.4495],
          [ 0.4968, -0.2893,  0.7476,  ..., -1.2637, -2.3945, -0.8491],
          ...,
          [-0.4917,  1.7373,  0.3232,  ...,  0.7798,  0.1824,  0.1619],
          [-0.7515,  2.4473, -1.3779,  ..., -0.7632, -0.1101, -2.0645],
          [ 1.9092,  1.9395,  0.3162,  ..., -0.2729, -0.5122,  0.3813]],

         [[ 0.8481, -0.5225,  0.8853,  ..., -2.0156, -1.4355,  3.1895],
          [-1.1074,  0.6465, -1.1055,  ..., -0.3193, -0.2722,  0.4692],
          [ 0.5122, -0.2944,  0.8447,  ..., -1.2900, -2.4316, -0.7910],
          ...,
          [-0.4695,  1.8330,  0.3435,  ...,  0.7656,  0.1805,  0.2338],
          [-0.7500,  2.5273, -1.3145,  ..., -0.8169, -0.0894, -2.0957],
          [ 1.9521,  1.9199,  0.2708,  ..., -0.2240, -0.5068,  0.4250]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[-2.2498e-01, -1.4297e+00,  5.9033e-01,  ..., -2.3398e+00,
           -1.6787e+00,  1.6689e+00],
          [-5.8594e-01, -6.0254e-01,  4.2017e-01,  ..., -1.1299e+00,
           -1.1981e-01,  3.9502e-01],
          [ 7.7832e-01,  6.1328e-01,  2.6587e-01,  ..., -9.1309e-01,
           -1.2207e+00, -2.6196e-01],
          ...,
          [-6.5088e-01,  9.9219e-01,  1.1895e+00,  ..., -1.0420e+00,
           -1.7773e-01,  1.1340e-01],
          [-1.2314e+00,  1.4883e+00, -4.2993e-01,  ..., -1.3311e+00,
            1.1904e+00, -3.2812e-01],
          [ 7.2412e-01,  1.7969e+00, -1.8818e+00,  ..., -1.1074e+00,
           -3.4619e-01,  9.3811e-02]],

         [[-1.9639e+00,  2.6831e-01, -7.7686e-01,  ..., -5.4102e-01,
            1.7090e-01,  1.9033e+00],
          [-6.6846e-01,  1.5254e+00,  4.3823e-01,  ...,  3.5522e-01,
           -2.9004e+00, -7.8711e-01],
          [-1.0801e+00, -1.5137e+00,  1.1914e+00,  ...,  6.6589e-02,
           -5.1758e-01, -1.8145e+00],
          ...,
          [ 9.7070e-01,  4.5850e-01, -3.0811e-01,  ...,  8.0444e-02,
            7.7002e-01, -5.2734e-01],
          [ 9.4287e-01, -3.0289e-03, -4.9512e-01,  ...,  4.5996e-01,
            9.2480e-01, -2.3254e-02],
          [ 2.0300e-01,  1.6094e+00, -1.5479e+00,  ...,  2.9043e+00,
            6.0791e-01,  1.0010e+00]],

         [[-1.6875e+00,  7.4756e-01, -8.2324e-01,  ..., -9.7266e-01,
            5.4248e-01,  1.8408e+00],
          [-3.8257e-01,  1.7129e+00,  5.1855e-01,  ...,  2.3755e-01,
           -2.9668e+00, -9.2627e-01],
          [-1.3164e+00, -1.9014e+00,  8.8623e-01,  ...,  1.2494e-01,
           -4.0283e-01, -2.2637e+00],
          ...,
          [ 9.8486e-01,  4.4385e-01, -4.0601e-01,  ...,  1.5906e-01,
            8.8428e-01, -3.9136e-01],
          [ 1.0098e+00,  5.9296e-02, -1.6870e-01,  ...,  5.6104e-01,
            8.0762e-01, -1.1707e-01],
          [ 2.1960e-01,  1.5752e+00, -1.6406e+00,  ...,  3.0605e+00,
            4.8608e-01,  8.8721e-01]],

         ...,

         [[-1.4629e+00,  8.5645e-01, -7.7344e-01,  ..., -9.3994e-01,
            6.1523e-01,  2.0176e+00],
          [-1.5881e-01,  2.0840e+00,  3.5815e-01,  ...,  2.3950e-01,
           -2.9043e+00, -9.0039e-01],
          [-1.5098e+00, -2.1836e+00,  4.8584e-01,  ...,  3.1592e-01,
           -1.5674e-01, -2.5176e+00],
          ...,
          [ 8.9990e-01,  4.6851e-01, -3.1592e-01,  ...,  3.6035e-01,
            6.0303e-01, -3.0420e-01],
          [ 9.6484e-01, -4.1779e-02,  2.7542e-02,  ...,  7.3975e-01,
            7.9395e-01, -1.4819e-01],
          [ 3.7891e-01,  1.6514e+00, -1.7217e+00,  ...,  3.2109e+00,
            2.2131e-01,  6.1426e-01]],

         [[-1.4756e+00,  9.3945e-01, -6.7432e-01,  ..., -9.2334e-01,
            5.6738e-01,  2.0469e+00],
          [-8.1848e-02,  2.2051e+00,  3.4155e-01,  ...,  3.3057e-01,
           -2.9668e+00, -8.8037e-01],
          [-1.5742e+00, -2.2285e+00,  2.3889e-01,  ...,  3.5864e-01,
           -2.8702e-02, -2.5742e+00],
          ...,
          [ 8.4473e-01,  4.6021e-01, -3.6133e-01,  ...,  4.4946e-01,
            5.3125e-01, -3.8281e-01],
          [ 9.7607e-01, -1.1945e-01,  8.7769e-02,  ...,  6.5576e-01,
            8.1592e-01, -1.0553e-01],
          [ 4.1064e-01,  1.6289e+00, -1.8291e+00,  ...,  3.2129e+00,
            1.1176e-01,  5.5273e-01]],

         [[-1.5488e+00,  9.8340e-01, -6.6602e-01,  ..., -9.4824e-01,
            6.3867e-01,  2.0371e+00],
          [-2.0630e-02,  2.2500e+00,  3.0249e-01,  ...,  3.5107e-01,
           -3.0566e+00, -1.0029e+00],
          [-1.6230e+00, -2.1992e+00,  2.2522e-01,  ...,  4.2358e-01,
           -9.6313e-02, -2.6348e+00],
          ...,
          [ 8.5498e-01,  4.0088e-01, -4.4507e-01,  ...,  4.7119e-01,
            5.9131e-01, -3.6816e-01],
          [ 1.0488e+00, -1.4307e-01,  1.7456e-01,  ...,  6.4600e-01,
            9.1748e-01, -7.3120e-02],
          [ 4.0771e-01,  1.6924e+00, -1.8770e+00,  ...,  3.3652e+00,
            1.0541e-01,  5.3125e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 3.3817e-03,  5.1384e-03,  1.2520e-02,  ...,  6.2408e-03,
            2.3687e-04, -4.6997e-03],
          [-1.6956e-03,  1.4603e-02, -1.6708e-02,  ..., -1.9272e-02,
           -1.0767e-03,  1.2146e-02],
          [-1.3933e-03,  3.5172e-03,  1.6861e-02,  ...,  2.5959e-03,
            8.5678e-03,  3.4180e-03],
          ...,
          [ 1.1108e-02, -6.5193e-03,  9.4757e-03,  ...,  7.3204e-03,
            2.4567e-03,  1.1002e-02],
          [ 1.2497e-02, -7.5293e-04, -1.9348e-02,  ...,  9.2621e-03,
            1.3809e-02, -6.7215e-03],
          [-6.4278e-03, -1.0811e-02, -9.8724e-03,  ..., -7.8964e-04,
           -6.8626e-03,  1.0185e-02]],

         [[ 7.8430e-02, -2.7374e-02,  5.1514e-01,  ...,  1.1208e-02,
            3.6475e-01, -3.8232e-01],
          [ 3.1763e-01,  1.3496e+00, -4.9512e-01,  ..., -1.0120e-01,
           -4.0430e-01, -1.4612e-01],
          [ 3.2642e-01, -7.6599e-02,  2.6172e-01,  ..., -2.1204e-01,
           -1.4319e-01, -2.8955e-01],
          ...,
          [ 6.4087e-02,  2.4646e-01,  1.4490e-01,  ..., -3.5742e-01,
           -6.1426e-01, -7.1411e-03],
          [ 2.9834e-01, -7.7087e-02,  9.1919e-02,  ..., -2.3889e-01,
            7.1875e-01, -5.2832e-01],
          [ 1.1560e-01, -1.2537e-01, -2.1069e-01,  ...,  8.2092e-02,
           -1.3733e-02,  3.0127e-01]],

         [[ 2.3804e-03, -1.6108e-03,  4.1333e-01,  ..., -4.6051e-02,
            2.9932e-01, -2.9810e-01],
          [ 2.2095e-01,  1.2510e+00, -5.1855e-01,  ..., -5.0720e-02,
           -5.0928e-01, -1.8604e-01],
          [ 3.3984e-01, -1.1334e-01,  3.7622e-01,  ..., -1.1023e-01,
           -2.0349e-01, -2.4548e-01],
          ...,
          [ 1.1560e-01,  2.7319e-01,  3.0701e-02,  ..., -3.0078e-01,
           -6.2744e-01, -7.5256e-02],
          [ 1.9507e-01, -1.4417e-01,  6.5979e-02,  ..., -9.1309e-02,
            6.1670e-01, -5.3760e-01],
          [ 9.8389e-02, -1.2360e-01, -2.4036e-01,  ...,  6.7566e-02,
            2.8595e-02,  2.0569e-01]],

         ...,

         [[ 9.6664e-03,  7.6714e-03,  4.2944e-01,  ..., -9.6924e-02,
            3.3154e-01, -2.8101e-01],
          [ 1.6943e-01,  1.1562e+00, -5.6152e-01,  ..., -7.9834e-02,
           -6.0693e-01, -2.0923e-01],
          [ 2.5098e-01, -1.3318e-01,  4.2871e-01,  ..., -9.8328e-02,
           -1.9189e-01, -2.4695e-01],
          ...,
          [ 1.8164e-01,  3.2178e-01,  5.1270e-03,  ..., -2.2180e-01,
           -7.4219e-01, -4.6875e-02],
          [ 1.4746e-01, -1.6614e-01,  4.5471e-02,  ..., -6.0272e-02,
            5.9912e-01, -5.5957e-01],
          [ 3.6072e-02, -1.1230e-01, -2.3840e-01,  ...,  7.3853e-02,
            6.8787e-02,  2.3291e-01]],

         [[ 2.9583e-03,  3.3966e-02,  4.1870e-01,  ..., -1.3098e-01,
            3.5718e-01, -2.5928e-01],
          [ 1.7651e-01,  1.1748e+00, -5.9473e-01,  ..., -8.5327e-02,
           -5.7422e-01, -1.7419e-01],
          [ 2.7905e-01, -1.5088e-01,  4.3335e-01,  ..., -7.0312e-02,
           -2.0386e-01, -2.2241e-01],
          ...,
          [ 1.9067e-01,  2.9346e-01,  3.1982e-02,  ..., -1.8396e-01,
           -7.6514e-01, -3.6591e-02],
          [ 1.4478e-01, -1.7383e-01,  6.9763e-02,  ..., -4.0894e-02,
            5.8789e-01, -5.7373e-01],
          [ 2.8610e-02, -1.4111e-01, -2.6318e-01,  ...,  7.5989e-02,
            6.8298e-02,  2.4377e-01]],

         [[ 2.6123e-02,  2.0065e-03,  4.0332e-01,  ..., -1.4624e-01,
            3.7109e-01, -2.5854e-01],
          [ 1.6772e-01,  1.1787e+00, -5.7422e-01,  ..., -6.2805e-02,
           -5.7764e-01, -1.6138e-01],
          [ 2.7490e-01, -1.3025e-01,  4.5947e-01,  ..., -4.3793e-02,
           -2.0056e-01, -2.1106e-01],
          ...,
          [ 1.9006e-01,  2.6636e-01,  1.3115e-02,  ..., -1.7847e-01,
           -7.3877e-01, -3.2654e-02],
          [ 1.4294e-01, -1.6882e-01,  9.5276e-02,  ..., -2.2598e-02,
            5.8496e-01, -5.5518e-01],
          [ 3.1342e-02, -1.4197e-01, -2.5684e-01,  ...,  7.5989e-02,
            6.6711e-02,  2.4414e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[ 1.2039e-02,  8.3237e-03,  4.1919e-01,  ..., -1.0394e-01,
           3.4155e-01, -2.7588e-01],
         [ 1.8091e-01,  1.1953e+00, -5.6152e-01,  ..., -6.8604e-02,
          -5.6543e-01, -1.8433e-01],
         [ 2.7808e-01, -1.3220e-01,  4.0894e-01,  ..., -8.4839e-02,
          -1.9153e-01, -2.3389e-01],
         ...,
         [ 1.5833e-01,  2.8345e-01,  2.9739e-02,  ..., -2.3462e-01,
          -7.1191e-01, -5.0140e-02],
         [ 1.7773e-01, -1.5125e-01,  6.8848e-02,  ..., -7.4341e-02,
           6.1377e-01, -5.5420e-01],
         [ 5.5878e-02, -1.3586e-01, -2.5098e-01,  ...,  7.5012e-02,
           5.4596e-02,  2.3755e-01]],

        [[ 8.6288e-03,  4.6654e-03,  1.9495e-01,  ..., -3.3386e-02,
           1.4746e-01, -1.2927e-01],
         [ 2.0401e-02,  1.3818e-01, -6.9275e-02,  ..., -2.4765e-02,
          -5.3467e-02, -7.1793e-03],
         [ 5.0293e-02, -1.9180e-02,  8.1970e-02,  ..., -1.6724e-02,
          -2.5925e-02, -4.0619e-02],
         ...,
         [ 4.2328e-02,  5.7678e-02,  1.5472e-02,  ..., -4.8706e-02,
          -1.5491e-01, -2.3994e-03],
         [ 2.2018e-02, -8.8043e-03, -1.4549e-02,  ...,  4.0817e-03,
           4.7241e-02, -3.6804e-02],
         [-2.2709e-05, -2.1683e-02, -3.0731e-02,  ...,  5.9319e-03,
          -2.1973e-03,  3.0609e-02]],

        [[ 8.4229e-03,  5.0621e-03,  2.0032e-01,  ..., -3.6163e-02,
           1.5271e-01, -1.3245e-01],
         [ 2.4796e-02,  1.6418e-01, -8.0688e-02,  ..., -2.5879e-02,
          -6.4941e-02, -1.1337e-02],
         [ 2.8687e-02, -9.6970e-03,  5.4749e-02,  ..., -8.6594e-03,
          -1.1513e-02, -2.2232e-02],
         ...,
         [ 4.0924e-02,  5.4840e-02,  1.5327e-02,  ..., -4.6326e-02,
          -1.4795e-01, -1.7452e-03],
         [ 2.0355e-02, -7.4310e-03, -1.5373e-02,  ...,  5.0163e-03,
           4.1443e-02, -3.1616e-02],
         [ 1.3626e-04, -2.1942e-02, -3.1219e-02,  ...,  6.0883e-03,
          -2.0905e-03,  3.1082e-02]],

        ...,

        [[ 8.3084e-03,  5.3520e-03,  1.9812e-01,  ..., -3.6835e-02,
           1.5161e-01, -1.3062e-01],
         [ 2.9129e-02,  1.8982e-01, -9.1919e-02,  ..., -2.6978e-02,
          -7.6355e-02, -1.5457e-02],
         [ 2.2552e-02, -6.9809e-03,  4.6936e-02,  ..., -6.4087e-03,
          -7.3814e-03, -1.7014e-02],
         ...,
         [ 4.0436e-02,  5.3589e-02,  1.5182e-02,  ..., -4.5074e-02,
          -1.4514e-01, -1.4277e-03],
         [ 1.8127e-02, -5.5695e-03, -1.6495e-02,  ...,  6.2332e-03,
           3.3691e-02, -2.4643e-02],
         [ 3.0446e-04, -2.2202e-02, -3.1708e-02,  ...,  6.2523e-03,
          -1.9951e-03,  3.1586e-02]],

        [[ 8.2092e-03,  5.4779e-03,  1.9836e-01,  ..., -3.7476e-02,
           1.5222e-01, -1.3062e-01],
         [ 2.7695e-02,  1.8201e-01, -8.8684e-02,  ..., -2.6642e-02,
          -7.3181e-02, -1.4244e-02],
         [ 2.1057e-02, -6.3248e-03,  4.5074e-02,  ..., -5.8441e-03,
          -6.3858e-03, -1.5732e-02],
         ...,
         [ 4.0436e-02,  5.3528e-02,  1.5137e-02,  ..., -4.4922e-02,
          -1.4502e-01, -1.3990e-03],
         [ 1.8509e-02, -5.9357e-03, -1.6281e-02,  ...,  6.0501e-03,
           3.5095e-02, -2.5955e-02],
         [ 1.3418e-03, -2.4063e-02, -3.5278e-02,  ...,  7.3929e-03,
          -1.1501e-03,  3.5034e-02]],

        [[ 8.2779e-03,  5.5542e-03,  2.0105e-01,  ..., -3.8422e-02,
           1.5454e-01, -1.3232e-01],
         [ 2.7481e-02,  1.8042e-01, -8.7952e-02,  ..., -2.6596e-02,
          -7.2388e-02, -1.3962e-02],
         [ 1.8326e-02, -5.1041e-03,  4.1565e-02,  ..., -4.8561e-03,
          -4.5433e-03, -1.3412e-02],
         ...,
         [ 3.9948e-02,  5.2551e-02,  1.5053e-02,  ..., -4.4067e-02,
          -1.4258e-01, -1.1873e-03],
         [ 1.8448e-02, -5.8670e-03, -1.6312e-02,  ...,  6.0768e-03,
           3.4851e-02, -2.5711e-02],
         [ 2.2640e-03, -2.5589e-02, -3.8208e-02,  ...,  8.3389e-03,
          -5.2309e-04,  3.7933e-02]]], device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[-0.7026, -0.1968, -0.6846,  ...,  1.2207,  0.6016, -0.4124],
          [-3.0781,  2.1113, -0.1493,  ..., -1.4844,  0.6768, -1.7061],
          [ 3.0566,  0.3623,  1.0117,  ..., -1.6367, -1.8789,  0.4043],
          ...,
          [-0.7012,  1.5840, -0.5996,  ..., -1.6895,  1.8086, -0.4902],
          [ 1.4922, -0.4854,  1.4492,  ...,  0.6089, -1.5938,  1.2471],
          [-1.3994,  2.0469, -3.1504,  ...,  1.4766,  2.8594,  0.3479]],

         [[ 0.3579,  0.2208, -1.1768,  ...,  0.6279,  0.0760, -0.7080],
          [ 0.8232, -1.8379, -1.1631,  ...,  1.4170,  0.3909,  0.3948],
          [ 0.1619, -2.7773,  0.8501,  ...,  1.2656,  3.1172, -1.5098],
          ...,
          [ 0.3623, -1.2715, -0.2268,  ...,  0.1089, -2.0684, -0.3247],
          [ 1.1416, -1.9453, -1.1465,  ...,  0.3333,  0.4785, -1.2324],
          [-0.5884, -1.0957,  3.3438,  ..., -0.5249, -2.0547, -0.2705]],

         [[ 0.4878,  0.2349, -1.4004,  ...,  0.6548,  0.0411, -0.5820],
          [ 1.1982, -1.5107, -0.9604,  ...,  1.6562,  0.1903,  0.3599],
          [-0.1597, -2.4551,  0.8125,  ...,  1.0488,  2.7207, -1.6689],
          ...,
          [ 0.3345, -1.1543, -0.1334,  ...,  0.1036, -2.0410, -0.4490],
          [ 1.1250, -1.9961, -0.9531,  ...,  0.3625,  0.5039, -1.2051],
          [-0.2157, -1.2324,  2.8887,  ..., -0.4939, -2.1270, -0.4790]],

         ...,

         [[ 0.3931,  0.2861, -1.4688,  ...,  0.6289,  0.1381, -0.7935],
          [ 1.3262, -1.5400, -0.9888,  ...,  1.8799,  0.2705,  0.3254],
          [-0.4343, -2.2754,  0.7871,  ...,  0.8921,  2.6914, -1.5664],
          ...,
          [ 0.3398, -1.0713,  0.1498,  ...,  0.3423, -2.1895, -0.4036],
          [ 0.9023, -1.8779, -0.8105,  ...,  0.4697,  0.7217, -1.0469],
          [ 0.0039, -0.8315,  2.7871,  ..., -0.3640, -2.0547, -0.4512]],

         [[ 0.4680,  0.3484, -1.5010,  ...,  0.6655,  0.1313, -0.8145],
          [ 1.3809, -1.5566, -1.0830,  ...,  2.0020,  0.2480,  0.3384],
          [-0.4377, -2.1113,  0.8413,  ...,  0.9307,  2.6602, -1.5176],
          ...,
          [ 0.3596, -1.0381,  0.0966,  ...,  0.3608, -2.3066, -0.3225],
          [ 0.7534, -1.8477, -0.7485,  ...,  0.5210,  0.7729, -0.9551],
          [ 0.1367, -0.8545,  2.7500,  ..., -0.3613, -2.0508, -0.4653]],

         [[ 0.5244,  0.3140, -1.4541,  ...,  0.7041,  0.0426, -0.7324],
          [ 1.4600, -1.4590, -1.0586,  ...,  1.9473,  0.2494,  0.3352],
          [-0.3691, -1.9336,  0.9453,  ...,  0.8892,  2.5996, -1.5752],
          ...,
          [ 0.3623, -1.0244,  0.0042,  ...,  0.3435, -2.3047, -0.3779],
          [ 0.8267, -1.9219, -0.8105,  ...,  0.4734,  0.7446, -0.9868],
          [ 0.1404, -0.8999,  2.7637,  ..., -0.3530, -2.0195, -0.5654]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[ 0.0399,  0.2137,  0.3271,  ..., -0.0146, -0.1615, -0.1609],
          [ 1.3438, -1.1543, -0.0302,  ...,  0.7021, -0.1709,  1.0371],
          [-1.2383,  0.7759,  0.9478,  ...,  0.9390,  0.3677, -1.8330],
          ...,
          [ 1.0283, -0.8062,  0.6621,  ...,  0.6509, -1.3740,  0.2839],
          [-0.6040,  0.7271, -0.5757,  ...,  0.7925,  0.5791, -0.5371],
          [ 0.3708, -1.4658,  1.7793,  ..., -2.1836, -1.9346, -0.6792]],

         [[-0.3679,  1.6357, -0.7173,  ...,  0.4890,  0.5273,  1.0195],
          [-1.3408, -0.9189, -3.8594,  ..., -1.2266, -0.6479, -2.1621],
          [ 1.2090, -0.4062,  2.0254,  ...,  0.9541, -0.9370,  0.1737],
          ...,
          [-1.2285, -0.5498, -1.3291,  ..., -0.2900,  0.3982, -0.3826],
          [ 1.7900, -0.5303,  1.2656,  ..., -0.1140, -1.8818,  1.9531],
          [-0.7593, -0.1313,  0.5688,  ..., -0.9194, -1.2832,  0.2979]],

         [[-0.3406,  1.4326, -0.6118,  ...,  0.4509,  0.6445,  0.8911],
          [-1.2402, -0.8052, -3.3867,  ..., -1.3857, -0.7026, -2.4082],
          [ 1.3750, -0.6680,  2.0176,  ...,  1.1455, -0.7603,  0.1240],
          ...,
          [-1.2656, -0.4980, -1.4668,  ..., -0.3394,  0.7002, -0.4392],
          [ 2.1250, -0.4832,  1.3594,  ..., -0.1954, -1.7793,  2.3574],
          [-0.8076,  0.1248,  0.5479,  ..., -0.8608, -1.3135,  0.7700]],

         ...,

         [[-0.2308,  1.2832, -0.5464,  ...,  0.3157,  0.5962,  0.9604],
          [-1.1670, -0.5669, -2.9727,  ..., -1.4961, -0.5977, -2.4883],
          [ 1.2852, -1.0176,  1.8369,  ...,  0.7852, -0.9561,  0.1326],
          ...,
          [-1.2188, -0.4021, -1.6035,  ..., -0.1921,  0.9849, -0.4758],
          [ 2.1699, -0.1891,  1.3408,  ...,  0.0409, -2.0605,  2.4395],
          [-1.0322,  0.3169,  0.5010,  ..., -0.9043, -1.4805,  0.8745]],

         [[-0.2405,  1.1621, -0.4849,  ...,  0.2932,  0.5742,  1.0176],
          [-1.2305, -0.5503, -2.9883,  ..., -1.5166, -0.4719, -2.4805],
          [ 1.3516, -0.9790,  1.7285,  ...,  0.6851, -0.9937,  0.2659],
          ...,
          [-1.2314, -0.4570, -1.5625,  ..., -0.2467,  1.0664, -0.4575],
          [ 2.0293,  0.0531,  1.4004,  ...,  0.0634, -2.1348,  2.5449],
          [-1.1074,  0.4226,  0.5273,  ..., -0.9863, -1.5020,  0.9121]],

         [[-0.2842,  1.0957, -0.4421,  ...,  0.3013,  0.5806,  0.9873],
          [-1.3438, -0.4473, -3.0117,  ..., -1.5820, -0.5103, -2.5527],
          [ 1.4961, -0.8643,  1.8398,  ...,  0.7446, -0.9199,  0.1938],
          ...,
          [-1.3252, -0.4048, -1.6621,  ..., -0.1481,  1.0684, -0.4810],
          [ 2.0391, -0.0474,  1.4404,  ...,  0.0536, -2.0332,  2.6582],
          [-1.1416,  0.4741,  0.4216,  ..., -0.9355, -1.4199,  0.9023]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 8.9569e-03,  8.2703e-03,  1.0765e-02,  ..., -1.2787e-02,
           -1.9882e-02,  2.3254e-02],
          [ 2.5654e-03,  9.5139e-03, -4.0588e-03,  ...,  1.4448e-03,
            1.0147e-03,  1.1360e-02],
          [-2.9354e-03, -4.4250e-03,  6.3934e-03,  ...,  1.0818e-02,
            7.0877e-03, -1.3084e-03],
          ...,
          [-2.3365e-03, -1.9479e-04,  1.7609e-02,  ..., -1.0399e-02,
           -8.0185e-03, -3.5915e-03],
          [ 1.0460e-02, -5.8403e-03,  3.5019e-03,  ..., -1.0338e-03,
           -2.3251e-03,  8.8730e-03],
          [ 4.9934e-03, -1.0147e-02, -4.7874e-03,  ..., -7.2861e-03,
           -3.5801e-03, -4.7607e-03]],

         [[ 1.3525e-01,  2.6562e-01,  7.2217e-01,  ..., -5.1562e-01,
           -6.5527e-01,  7.6270e-01],
          [-9.8877e-03, -2.7539e-01,  2.5681e-02,  ..., -2.5122e-01,
           -2.1045e-01,  1.3969e-02],
          [ 4.8389e-01,  1.5430e-01,  5.5359e-02,  ...,  5.5566e-01,
            2.4097e-01, -1.7664e-01],
          ...,
          [ 2.9810e-01, -2.7173e-01,  4.5996e-01,  ...,  4.9591e-03,
           -6.9092e-01, -9.5398e-02],
          [-1.2236e+00,  3.5986e-01,  4.1919e-01,  ...,  3.8818e-01,
           -5.6152e-01,  9.6985e-02],
          [ 1.6736e-01, -1.8066e-01,  2.4573e-01,  ..., -4.1718e-02,
            9.4177e-02,  5.4688e-02]],

         [[ 1.4824e-02,  1.8054e-01,  5.2393e-01,  ..., -6.0303e-01,
           -6.2695e-01,  7.8320e-01],
          [-3.0319e-02, -2.7344e-01, -4.8920e-02,  ..., -3.1421e-01,
           -2.0886e-01,  1.3794e-01],
          [ 4.5825e-01,  1.4612e-01, -4.5227e-02,  ...,  5.7617e-01,
            3.3521e-01, -1.9824e-01],
          ...,
          [ 2.0227e-01, -2.4927e-01,  3.7939e-01,  ..., -9.8267e-03,
           -6.4258e-01, -2.0752e-01],
          [-1.2402e+00,  3.2056e-01,  4.9365e-01,  ...,  2.5830e-01,
           -5.3613e-01,  2.8168e-02],
          [ 1.5356e-01, -7.3547e-02,  2.0532e-01,  ..., -2.6642e-02,
            1.3452e-01,  3.6987e-02]],

         ...,

         [[ 4.7394e-02,  2.2058e-01,  4.4434e-01,  ..., -5.8447e-01,
           -7.9980e-01,  6.7969e-01],
          [-5.4810e-02, -2.5659e-01, -6.7932e-02,  ..., -3.3301e-01,
           -2.3804e-01,  2.0496e-01],
          [ 5.3906e-01,  7.6355e-02, -1.0486e-01,  ...,  5.6494e-01,
            2.9150e-01, -1.6785e-01],
          ...,
          [ 1.5540e-01, -2.2864e-01,  3.7354e-01,  ..., -2.0691e-02,
           -6.6992e-01, -1.8494e-01],
          [-1.1660e+00,  2.1790e-01,  5.6396e-01,  ...,  2.3596e-01,
           -5.4150e-01,  7.8247e-02],
          [ 1.9031e-01, -1.0797e-01,  1.7627e-01,  ..., -3.7460e-03,
            1.0144e-01,  1.5640e-02]],

         [[ 8.9798e-03,  2.3657e-01,  4.6338e-01,  ..., -5.8789e-01,
           -8.0811e-01,  6.5430e-01],
          [-9.6558e-02, -2.4023e-01, -9.0210e-02,  ..., -3.2715e-01,
           -2.7612e-01,  2.2290e-01],
          [ 5.6641e-01,  1.0565e-01, -5.4108e-02,  ...,  5.6445e-01,
            2.7148e-01, -1.4905e-01],
          ...,
          [ 1.5625e-01, -2.2278e-01,  3.8745e-01,  ..., -5.7739e-02,
           -6.7871e-01, -1.4966e-01],
          [-1.1680e+00,  1.8677e-01,  5.6592e-01,  ...,  2.0715e-01,
           -5.4297e-01,  7.4951e-02],
          [ 2.3730e-01, -7.5195e-02,  1.8054e-01,  ..., -5.2704e-02,
            1.3025e-01,  7.9956e-03]],

         [[ 2.1271e-02,  2.1411e-01,  4.3286e-01,  ..., -6.1768e-01,
           -7.5098e-01,  6.6846e-01],
          [-8.3130e-02, -2.4561e-01, -7.5806e-02,  ..., -3.3740e-01,
           -2.7368e-01,  2.3242e-01],
          [ 5.8691e-01,  1.1139e-01, -9.4971e-02,  ...,  5.9375e-01,
            2.7393e-01, -1.2585e-01],
          ...,
          [ 1.4673e-01, -2.0227e-01,  3.5718e-01,  ..., -8.8257e-02,
           -7.0264e-01, -1.6357e-01],
          [-1.1885e+00,  1.9067e-01,  5.3076e-01,  ...,  2.2070e-01,
           -5.0586e-01,  8.0811e-02],
          [ 2.3169e-01, -4.5715e-02,  1.6736e-01,  ..., -4.6906e-02,
            1.2451e-01,  1.0353e-02]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[ 0.0361,  0.2218,  0.4978,  ..., -0.5845, -0.7388,  0.7041],
         [-0.0600, -0.2583, -0.0640,  ..., -0.3269, -0.2534,  0.1898],
         [ 0.5293,  0.1098, -0.0682,  ...,  0.5845,  0.2832, -0.1661],
         ...,
         [ 0.1720, -0.2325,  0.3767,  ..., -0.0427, -0.6719, -0.1727],
         [-1.1924,  0.2341,  0.5361,  ...,  0.2355, -0.5371,  0.0677],
         [ 0.1962, -0.0865,  0.1858,  ..., -0.0372,  0.1178,  0.0262]],

        [[ 0.0106,  0.0195,  0.0371,  ..., -0.0426, -0.0570,  0.0594],
         [-0.0188, -0.1245, -0.0243,  ..., -0.1512, -0.1146,  0.0786],
         [ 0.2534,  0.0530, -0.0273,  ...,  0.2949,  0.1450, -0.0875],
         ...,
         [ 0.0058, -0.0097,  0.0322,  ..., -0.0109, -0.0334, -0.0096],
         [-0.2900,  0.0617,  0.1307,  ...,  0.0633, -0.1367,  0.0228],
         [ 0.1493, -0.0723,  0.1448,  ..., -0.0299,  0.0898,  0.0212]],

        [[ 0.0107,  0.0201,  0.0385,  ..., -0.0442, -0.0591,  0.0613],
         [-0.0173, -0.1130, -0.0229,  ..., -0.1385, -0.1050,  0.0736],
         [ 0.1947,  0.0399, -0.0195,  ...,  0.2297,  0.1133, -0.0677],
         ...,
         [ 0.0068, -0.0109,  0.0341,  ..., -0.0110, -0.0366, -0.0104],
         [-0.3154,  0.0668,  0.1421,  ...,  0.0683, -0.1481,  0.0240],
         [ 0.1321, -0.0648,  0.1270,  ..., -0.0272,  0.0787,  0.0181]],

        ...,

        [[ 0.0105,  0.0185,  0.0348,  ..., -0.0400, -0.0539,  0.0562],
         [-0.0141, -0.0953, -0.0196,  ..., -0.1178, -0.0894,  0.0635],
         [ 0.1820,  0.0374, -0.0174,  ...,  0.2162,  0.1068, -0.0637],
         ...,
         [ 0.0072, -0.0115,  0.0349,  ..., -0.0110, -0.0382, -0.0108],
         [-0.2717,  0.0567,  0.1238,  ...,  0.0587, -0.1285,  0.0220],
         [ 0.1366, -0.0677,  0.1329,  ..., -0.0279,  0.0819,  0.0193]],

        [[ 0.0105,  0.0187,  0.0352,  ..., -0.0405, -0.0546,  0.0569],
         [-0.0140, -0.0947, -0.0194,  ..., -0.1170, -0.0888,  0.0630],
         [ 0.1753,  0.0360, -0.0164,  ...,  0.2087,  0.1032, -0.0615],
         ...,
         [ 0.0070, -0.0112,  0.0345,  ..., -0.0110, -0.0374, -0.0106],
         [-0.2576,  0.0534,  0.1179,  ...,  0.0555, -0.1221,  0.0213],
         [ 0.1392, -0.0690,  0.1359,  ..., -0.0283,  0.0836,  0.0199]],

        [[ 0.0105,  0.0188,  0.0355,  ..., -0.0408, -0.0550,  0.0573],
         [-0.0140, -0.0944, -0.0195,  ..., -0.1168, -0.0886,  0.0630],
         [ 0.1616,  0.0329, -0.0147,  ...,  0.1935,  0.0958, -0.0568],
         ...,
         [ 0.0073, -0.0115,  0.0350,  ..., -0.0110, -0.0384, -0.0108],
         [-0.3042,  0.0637,  0.1378,  ...,  0.0653, -0.1429,  0.0235],
         [ 0.1326, -0.0660,  0.1289,  ..., -0.0273,  0.0793,  0.0187]]],
       device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[ 2.1270, -1.5967, -1.8926,  ...,  0.8213, -1.2627, -2.1270],
          [-0.1897,  0.1013,  0.9556,  ..., -0.1089,  1.5811, -1.1641],
          [ 1.1602,  2.2480,  0.7974,  ...,  0.4709,  0.9233,  1.1768],
          ...,
          [-1.1738, -0.0595, -1.4062,  ..., -1.2754,  0.9204,  1.4492],
          [ 0.1425,  1.4170, -1.5674,  ...,  2.4883, -1.0283,  0.6001],
          [ 0.6606, -1.7598,  0.5454,  ..., -0.6938,  0.9824,  0.8389]],

         [[ 1.5586, -0.2996, -0.5015,  ...,  0.2419, -0.9551,  1.4326],
          [-1.3525, -0.4382,  1.0146,  ..., -1.0596, -1.1240,  1.9912],
          [-0.5767, -0.8677, -0.3350,  ...,  0.2642,  0.1991, -1.7402],
          ...,
          [ 0.3225,  0.6128,  0.0975,  ...,  1.3379,  0.4836, -0.6201],
          [-2.0840, -1.7949,  2.9785,  ..., -1.2939,  0.8188,  1.3320],
          [-2.2734,  1.6709, -0.8540,  ...,  1.3916, -0.3547, -0.6836]],

         [[ 1.5332, -0.4353, -0.6123,  ...,  0.3157, -1.3105,  1.5908],
          [-1.5469, -0.6069,  1.0996,  ..., -1.2334, -1.1406,  1.8252],
          [-0.7368, -0.7866, -0.3723,  ...,  0.1484,  0.1132, -1.7510],
          ...,
          [ 0.4172,  0.6094,  0.3120,  ...,  1.2314,  0.4443, -0.7285],
          [-2.2246, -1.8291,  3.1484,  ..., -1.4834,  0.5889,  1.5303],
          [-2.4375,  1.8350, -0.9355,  ...,  1.3135, -0.5879, -0.7139]],

         ...,

         [[ 1.2119, -0.3433, -0.6846,  ...,  0.5771, -1.3613,  1.5449],
          [-1.6562, -0.7310,  1.0811,  ..., -1.2539, -1.1035,  1.7646],
          [-0.8325, -1.1250, -0.3152,  ...,  0.0481,  0.0397, -1.7148],
          ...,
          [ 0.4690,  0.6831,  0.3640,  ...,  1.0635,  0.5215, -0.6528],
          [-2.4805, -1.8672,  3.2676,  ..., -1.5654,  0.5063,  1.5762],
          [-2.3379,  1.8281, -0.9971,  ...,  1.2646, -0.5654, -0.6753]],

         [[ 1.1650, -0.3293, -0.7568,  ...,  0.5811, -1.3574,  1.5400],
          [-1.7324, -0.6504,  1.0811,  ..., -1.3008, -1.1338,  1.7539],
          [-0.8325, -1.1064, -0.3428,  ...,  0.0511,  0.0621, -1.6699],
          ...,
          [ 0.4746,  0.7129,  0.3367,  ...,  1.0332,  0.5562, -0.6504],
          [-2.5059, -1.8799,  3.3125,  ..., -1.5596,  0.4553,  1.5928],
          [-2.2930,  1.8877, -1.0703,  ...,  1.2598, -0.5571, -0.6221]],

         [[ 1.1934, -0.3145, -0.7729,  ...,  0.5762, -1.4863,  1.5986],
          [-1.6699, -0.7651,  1.0801,  ..., -1.3145, -1.0713,  1.7256],
          [-0.8564, -1.0732, -0.3340,  ...,  0.0703,  0.0212, -1.6064],
          ...,
          [ 0.4612,  0.6216,  0.3418,  ...,  0.9663,  0.4644, -0.6694],
          [-2.6641, -1.9053,  3.3828,  ..., -1.6006,  0.4563,  1.6982],
          [-2.4082,  1.9863, -1.0654,  ...,  1.2393, -0.5913, -0.6719]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[-1.2324,  0.1561,  1.0498,  ..., -0.6191,  0.5073,  0.6665],
          [-0.0718, -0.3345, -0.2144,  ..., -0.0404, -1.0723,  1.1523],
          [-0.4434, -0.7202,  0.9287,  ...,  0.7236,  0.1963, -0.8667],
          ...,
          [ 0.4158,  0.2603,  1.0078,  ...,  0.9761, -0.5015, -0.9561],
          [-0.8535, -1.4736,  0.2234,  ..., -1.3047,  0.4138, -0.9126],
          [-0.5737,  1.7490,  0.2043,  ...,  0.4309,  0.4673, -0.6387]],

         [[ 1.6670, -2.3926, -3.6582,  ..., -0.2393, -2.3535,  0.3406],
          [-0.3936, -0.1195, -2.4219,  ..., -0.4688,  3.5352, -0.6724],
          [ 2.0859,  1.6895,  0.5820,  ..., -0.4802,  1.1904,  0.3167],
          ...,
          [-0.7358,  0.6226,  0.1819,  ..., -0.2145,  0.7192, -0.0994],
          [-0.9683,  0.9380, -0.8813,  ...,  1.6621, -3.9824,  0.7559],
          [ 0.5234, -1.3945, -1.0518,  ...,  0.0332,  0.2389,  0.4019]],

         [[ 1.8115, -2.6055, -3.9609,  ...,  0.1628, -2.5293,  0.1316],
          [-0.5762,  0.0741, -2.1465,  ..., -0.6548,  3.8066, -0.5396],
          [ 2.2266,  2.0430,  0.6865,  ..., -0.6201,  1.3818,  0.3586],
          ...,
          [-0.7212,  0.6729,  0.0389,  ..., -0.1724,  0.9541,  0.0734],
          [-0.7939,  0.9321, -0.9575,  ...,  1.9629, -4.2109,  0.7256],
          [ 0.6182, -1.4072, -1.1719,  ..., -0.2649, -0.0103,  0.5269]],

         ...,

         [[ 2.0078, -2.4629, -4.0312,  ...,  0.3928, -2.6230, -0.0314],
          [-0.8877, -0.0268, -2.0195,  ..., -0.7031,  3.9453, -0.5571],
          [ 2.4824,  2.2656,  0.8198,  ..., -0.7568,  1.4180,  0.4314],
          ...,
          [-0.6631,  0.7710,  0.0995,  ..., -0.4102,  1.2041,  0.1104],
          [-0.6851,  0.8525, -0.8359,  ...,  1.8408, -4.2070,  0.6758],
          [ 0.9272, -1.4375, -1.2812,  ..., -0.1965, -0.0509,  0.6494]],

         [[ 1.9775, -2.4375, -4.0273,  ...,  0.4202, -2.6250, -0.1180],
          [-0.8921, -0.0813, -2.0020,  ..., -0.6831,  3.9453, -0.5459],
          [ 2.5098,  2.2930,  0.7969,  ..., -0.7847,  1.3926,  0.4607],
          ...,
          [-0.5947,  0.7666,  0.1091,  ..., -0.4678,  1.2959,  0.1642],
          [-0.6860,  0.8706, -0.8296,  ...,  1.8242, -4.2266,  0.7529],
          [ 0.9463, -1.4404, -1.2598,  ..., -0.2015, -0.0875,  0.6924]],

         [[ 2.0195, -2.4785, -4.1094,  ...,  0.4285, -2.6602, -0.1426],
          [-0.7783, -0.0776, -1.9893,  ..., -0.7305,  3.9512, -0.4761],
          [ 2.5645,  2.3145,  0.7788,  ..., -0.7769,  1.4023,  0.4573],
          ...,
          [-0.5698,  0.7202,  0.0712,  ..., -0.4924,  1.2969,  0.1976],
          [-0.6987,  0.8813, -0.8394,  ...,  1.9580, -4.3828,  0.7339],
          [ 0.8887, -1.4062, -1.2588,  ..., -0.2246, -0.1571,  0.6514]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[-3.5210e-03,  1.4709e-02,  2.3975e-03,  ..., -1.6907e-02,
           -6.0692e-03, -1.3199e-02],
          [ 5.7106e-03, -4.7684e-03,  5.8708e-03,  ..., -1.0628e-02,
            3.9711e-03, -7.1793e-03],
          [ 9.1705e-03,  8.9951e-03,  1.1253e-03,  ...,  1.3504e-03,
           -3.2997e-03,  8.9111e-03],
          ...,
          [ 1.4572e-02, -6.8207e-03,  7.3318e-03,  ...,  2.3087e-02,
            4.0207e-03,  3.5453e-04],
          [ 1.8951e-02, -4.0359e-03,  9.0408e-03,  ..., -8.5983e-03,
           -1.2146e-02,  1.0223e-02],
          [ 1.8524e-02,  1.5869e-02, -7.1716e-03,  ..., -1.7181e-02,
           -7.5989e-03,  1.4130e-02]],

         [[ 3.8745e-01,  6.6699e-01,  5.0879e-01,  ..., -2.5024e-01,
           -1.1261e-02, -2.3401e-01],
          [ 1.9043e-01,  4.9194e-01, -4.6436e-01,  ..., -5.6006e-01,
            7.9712e-02, -2.9639e-01],
          [-3.4302e-01,  5.9375e-01,  4.4037e-02,  ...,  4.6899e-01,
           -5.1416e-01,  7.8125e-02],
          ...,
          [ 2.5220e-01, -3.4790e-02,  1.3147e-01,  ...,  6.8115e-01,
            4.0112e-01, -7.0496e-02],
          [-2.9175e-01, -3.4912e-01,  4.7339e-01,  ..., -1.7615e-01,
           -1.4490e-01,  1.3757e-01],
          [ 2.0239e-01,  7.4561e-01, -4.1309e-01,  ..., -3.4180e-01,
           -6.3477e-01, -3.4302e-01]],

         [[ 4.0991e-01,  6.0254e-01,  4.9585e-01,  ..., -3.5205e-01,
            3.6163e-02, -2.9419e-01],
          [ 6.8420e-02,  5.2490e-01, -4.7827e-01,  ..., -5.8203e-01,
            5.7343e-02, -3.2910e-01],
          [-3.6133e-01,  5.9814e-01,  5.3986e-02,  ...,  4.9976e-01,
           -4.3384e-01, -9.1095e-03],
          ...,
          [ 3.2910e-01, -1.5295e-01,  9.1370e-02,  ...,  6.8018e-01,
            3.7158e-01, -8.8196e-02],
          [-2.8735e-01, -3.8110e-01,  4.7437e-01,  ..., -1.5454e-01,
           -1.1438e-01,  1.3196e-01],
          [ 3.3667e-01,  6.2207e-01, -3.9258e-01,  ..., -3.1641e-01,
           -6.1182e-01, -3.3569e-01]],

         ...,

         [[ 4.8071e-01,  5.1709e-01,  4.0991e-01,  ..., -4.2505e-01,
            2.5833e-02, -2.9199e-01],
          [ 5.4810e-02,  5.3418e-01, -5.3125e-01,  ..., -6.1963e-01,
           -3.0411e-02, -4.1699e-01],
          [-2.3132e-01,  5.2734e-01,  4.2450e-02,  ...,  5.3516e-01,
           -4.8022e-01, -9.1171e-03],
          ...,
          [ 4.1406e-01, -1.6858e-01,  3.8696e-02,  ...,  7.1729e-01,
            2.6392e-01, -3.7506e-02],
          [-2.8735e-01, -4.0454e-01,  4.6045e-01,  ..., -1.4905e-01,
           -1.0938e-01,  5.0964e-02],
          [ 3.4619e-01,  6.1865e-01, -4.2554e-01,  ..., -3.8306e-01,
           -6.1133e-01, -3.6255e-01]],

         [[ 5.0635e-01,  5.0488e-01,  4.3091e-01,  ..., -4.1260e-01,
            1.6769e-02, -2.8027e-01],
          [ 9.0149e-02,  5.4248e-01, -6.0596e-01,  ..., -5.8350e-01,
           -3.4546e-02, -4.3335e-01],
          [-2.2998e-01,  5.6104e-01,  3.6072e-02,  ...,  5.6592e-01,
           -4.7803e-01,  3.7861e-03],
          ...,
          [ 4.1455e-01, -1.8103e-01,  3.8879e-02,  ...,  7.5293e-01,
            2.6074e-01, -6.3538e-02],
          [-3.1445e-01, -4.0771e-01,  4.5239e-01,  ..., -1.2939e-01,
           -1.0022e-01,  7.7454e-02],
          [ 3.3423e-01,  6.3965e-01, -4.3604e-01,  ..., -3.7036e-01,
           -6.1572e-01, -3.7573e-01]],

         [[ 5.2051e-01,  5.1221e-01,  4.2725e-01,  ..., -4.2993e-01,
            3.7251e-03, -2.6611e-01],
          [ 7.0984e-02,  5.1514e-01, -5.8301e-01,  ..., -5.7520e-01,
           -4.0131e-02, -4.3506e-01],
          [-2.3987e-01,  5.4492e-01,  3.9551e-02,  ...,  5.6445e-01,
           -4.8828e-01, -1.3458e-02],
          ...,
          [ 3.9844e-01, -2.0056e-01,  4.4495e-02,  ...,  7.1484e-01,
            2.7734e-01, -5.3253e-02],
          [-2.6929e-01, -3.9624e-01,  5.0391e-01,  ..., -1.5674e-01,
           -1.1499e-01,  8.2397e-02],
          [ 3.3618e-01,  6.2354e-01, -4.1064e-01,  ..., -3.2397e-01,
           -6.1230e-01, -3.9697e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[ 4.7412e-01,  5.4834e-01,  4.3604e-01,  ..., -3.9478e-01,
           1.9348e-02, -2.7979e-01],
         [ 7.6904e-02,  5.2734e-01, -5.3174e-01,  ..., -5.9863e-01,
          -1.6069e-03, -3.8330e-01],
         [-2.6758e-01,  5.5615e-01,  4.4098e-02,  ...,  5.2734e-01,
          -4.7363e-01, -6.2904e-03],
         ...,
         [ 3.7744e-01, -1.6296e-01,  5.7220e-02,  ...,  7.1191e-01,
           3.0786e-01, -5.8685e-02],
         [-2.8564e-01, -3.9038e-01,  4.6167e-01,  ..., -1.5149e-01,
          -1.1670e-01,  9.3628e-02],
         [ 3.2422e-01,  6.4014e-01, -4.2261e-01,  ..., -3.4741e-01,
          -6.1475e-01, -3.5913e-01]],

        [[ 2.4933e-02,  4.8950e-02,  2.9877e-02,  ..., -3.8940e-02,
          -4.5662e-03, -2.9465e-02],
         [ 1.1238e-02,  3.2257e-02, -3.0991e-02,  ..., -5.1636e-02,
           4.2152e-03, -3.2654e-02],
         [-1.1864e-03,  2.8168e-02,  2.6646e-03,  ...,  1.8829e-02,
          -1.9424e-02,  8.7357e-03],
         ...,
         [ 1.6373e-02, -7.5684e-03,  7.6180e-03,  ...,  2.6581e-02,
           5.6152e-03,  4.7505e-05],
         [-2.6230e-02, -6.1218e-02,  7.5928e-02,  ..., -2.9633e-02,
          -2.7618e-02,  2.2156e-02],
         [ 2.8870e-02,  3.8025e-02, -2.1698e-02,  ..., -2.8732e-02,
          -2.8885e-02,  1.1301e-03]],

        [[ 3.5553e-02,  6.1676e-02,  4.0100e-02,  ..., -4.7180e-02,
          -3.9978e-03, -3.5553e-02],
         [ 1.3145e-02,  4.5013e-02, -4.3640e-02,  ..., -6.5735e-02,
           4.3488e-03, -4.1412e-02],
         [-7.7343e-04,  2.7435e-02,  2.6054e-03,  ...,  1.8173e-02,
          -1.8799e-02,  8.7280e-03],
         ...,
         [ 1.5961e-02, -7.3929e-03,  7.5493e-03,  ...,  2.5772e-02,
           5.2452e-03,  1.1885e-04],
         [-1.6754e-02, -4.9286e-02,  6.1920e-02,  ..., -2.5192e-02,
          -2.4338e-02,  1.9577e-02],
         [ 2.8656e-02,  3.7415e-02, -2.1347e-02,  ..., -2.8442e-02,
          -2.8336e-02,  1.4420e-03]],

        ...,

        [[ 3.3142e-02,  5.8746e-02,  3.7750e-02,  ..., -4.5319e-02,
          -4.1313e-03, -3.4149e-02],
         [ 1.2909e-02,  4.3335e-02, -4.2023e-02,  ..., -6.3904e-02,
           4.3221e-03, -4.0283e-02],
         [ 1.3466e-03,  2.3483e-02,  2.2869e-03,  ...,  1.4557e-02,
          -1.5488e-02,  8.7814e-03],
         ...,
         [ 1.5884e-02, -7.3624e-03,  7.5378e-03,  ...,  2.5635e-02,
           5.1765e-03,  1.3173e-04],
         [-9.0714e-03, -3.9551e-02,  5.0537e-02,  ..., -2.1606e-02,
          -2.1713e-02,  1.7548e-02],
         [ 2.9282e-02,  3.8666e-02, -2.2186e-02,  ..., -2.9129e-02,
          -2.9572e-02,  6.7616e-04]],

        [[ 2.9648e-02,  5.4504e-02,  3.4332e-02,  ..., -4.2603e-02,
          -4.3182e-03, -3.2135e-02],
         [ 1.2978e-02,  4.3915e-02, -4.2572e-02,  ..., -6.4514e-02,
           4.3221e-03, -4.0680e-02],
         [ 1.5383e-03,  2.3132e-02,  2.2602e-03,  ...,  1.4236e-02,
          -1.5190e-02,  8.7891e-03],
         ...,
         [ 1.5884e-02, -7.3662e-03,  7.5378e-03,  ...,  2.5635e-02,
           5.1804e-03,  1.3137e-04],
         [-7.2098e-03, -3.7170e-02,  4.7791e-02,  ..., -2.0737e-02,
          -2.1072e-02,  1.7044e-02],
         [ 2.9922e-02,  4.0009e-02, -2.3071e-02,  ..., -2.9831e-02,
          -3.0869e-02, -1.1945e-04]],

        [[ 3.4241e-02,  6.0059e-02,  3.8818e-02,  ..., -4.6143e-02,
          -4.0779e-03, -3.4760e-02],
         [ 1.3344e-02,  4.6265e-02, -4.4891e-02,  ..., -6.7139e-02,
           4.3602e-03, -4.2267e-02],
         [ 1.8990e-04,  2.5635e-02,  2.4605e-03,  ...,  1.6525e-02,
          -1.7303e-02,  8.7585e-03],
         ...,
         [ 1.5976e-02, -7.4043e-03,  7.5531e-03,  ...,  2.5818e-02,
           5.2605e-03,  1.1569e-04],
         [-9.6436e-03, -4.0283e-02,  5.1422e-02,  ..., -2.1881e-02,
          -2.1896e-02,  1.7685e-02],
         [ 3.0090e-02,  4.0344e-02, -2.3300e-02,  ..., -3.0014e-02,
          -3.1189e-02, -3.2115e-04]]], device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[ 1.2109,  0.2395, -1.7393,  ...,  1.1514,  1.1533, -0.5981],
          [ 3.2441, -0.5161,  0.1639,  ...,  1.9834,  0.0388,  1.0303],
          [ 0.3918, -0.3743, -1.7295,  ...,  0.6743,  2.1836, -0.4644],
          ...,
          [-0.0576,  0.8867, -0.6445,  ...,  2.0859,  0.2566,  2.2598],
          [-1.5801,  0.2578,  2.0020,  ..., -1.2051, -0.0812,  1.0596],
          [-0.0810, -0.2281, -0.8184,  ...,  0.3660, -0.6309, -2.0527]],

         [[ 0.9604, -0.7314,  1.5771,  ..., -1.2021,  0.3296,  0.4248],
          [ 1.3691, -0.2935, -1.2500,  ...,  0.5815, -2.4766, -1.8164],
          [-2.3672,  0.8872, -0.9058,  ..., -1.7207, -1.8301,  1.5391],
          ...,
          [ 0.3892, -0.0950, -0.2532,  ..., -0.8853, -1.6289,  0.1571],
          [-0.5742, -0.7720, -1.6572,  ...,  1.5010,  1.0576,  1.5459],
          [-0.1274, -0.0094,  1.2568,  ..., -0.0983, -0.6260, -0.0542]],

         [[ 0.8540, -0.8892,  1.6465,  ..., -0.8613,  0.7109,  0.2418],
          [ 1.2373, -0.2201, -1.3584,  ...,  0.6357, -2.9121, -1.5645],
          [-2.2422,  1.1924, -0.8213,  ..., -1.4551, -1.7119,  1.6582],
          ...,
          [ 0.5083, -0.0339, -0.6279,  ..., -0.9287, -1.3906,  0.2368],
          [-0.6812, -0.7271, -1.8154,  ...,  1.2676,  0.7681,  1.7324],
          [-0.1423,  0.3655,  1.2627,  ..., -0.0823, -0.7275,  0.2086]],

         ...,

         [[ 1.0137, -0.8071,  1.6240,  ..., -0.6372,  1.0498,  0.1880],
          [ 1.4082, -0.2318, -1.4141,  ...,  0.7446, -3.1465, -1.3301],
          [-2.0195,  1.3936, -0.7280,  ..., -1.5859, -1.5088,  1.6455],
          ...,
          [ 0.5732,  0.1204, -0.8975,  ..., -0.9390, -1.3506,  0.1670],
          [-0.8857, -0.8081, -1.8936,  ...,  1.2559,  0.6255,  1.8047],
          [-0.0850,  0.3608,  1.3467,  ..., -0.1033, -0.7666,  0.3420]],

         [[ 1.0596, -0.8628,  1.6699,  ..., -0.6196,  1.1680,  0.1959],
          [ 1.4082, -0.2148, -1.5088,  ...,  0.8013, -3.1602, -1.3203],
          [-1.9736,  1.3662, -0.6938,  ..., -1.7031, -1.4756,  1.6709],
          ...,
          [ 0.5659,  0.1128, -0.9448,  ..., -0.9448, -1.3730,  0.1368],
          [-0.9414, -0.8545, -1.9189,  ...,  1.3037,  0.6289,  1.7852],
          [-0.0999,  0.2949,  1.3271,  ..., -0.1122, -0.8135,  0.2620]],

         [[ 0.9937, -0.9512,  1.6777,  ..., -0.5767,  1.1533,  0.1344],
          [ 1.2627, -0.1349, -1.4678,  ...,  0.7974, -3.1738, -1.3301],
          [-1.9541,  1.3652, -0.6392,  ..., -1.6182, -1.4951,  1.6670],
          ...,
          [ 0.5703,  0.1128, -0.9282,  ..., -0.8857, -1.2969,  0.0952],
          [-0.8931, -0.8887, -1.9287,  ...,  1.2285,  0.5718,  1.8184],
          [-0.1368,  0.3149,  1.2910,  ..., -0.1381, -0.7671,  0.3342]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[ 1.4375,  1.0420,  0.8315,  ...,  0.5483, -0.4790,  0.0951],
          [ 0.4038,  0.4482, -1.6279,  ..., -1.5732, -0.1721, -1.4814],
          [ 0.3196,  1.6660, -1.5205,  ..., -2.3281, -0.9326,  0.5083],
          ...,
          [ 1.6953,  0.7417,  0.5815,  ..., -0.3430, -0.0756,  0.5059],
          [ 0.3547, -0.5938, -1.1523,  ...,  0.7246,  0.6377,  0.5381],
          [-0.8677,  0.6567,  0.4600,  ...,  1.1035,  0.5098, -0.2925]],

         [[ 1.3525, -1.5225, -0.5239,  ...,  2.4102, -3.4980,  1.1865],
          [ 4.0938, -3.0723, -1.9473,  ...,  1.7607, -1.1289, -0.5493],
          [ 0.1868,  1.8301, -1.1162,  ..., -0.5942,  1.3271,  1.5117],
          ...,
          [ 2.0371,  2.1953, -1.4209,  ...,  0.1281, -0.6733,  2.6855],
          [-1.5225,  0.4526,  2.8359,  ...,  0.2710,  0.6406,  1.6572],
          [ 0.9932,  1.8379, -2.7207,  ...,  1.6797, -0.9243, -1.5166]],

         [[ 1.5283, -1.5723, -0.6240,  ...,  2.3203, -3.5234,  1.3174],
          [ 4.4805, -3.0840, -1.9316,  ...,  1.9199, -0.8989, -0.3516],
          [ 0.1864,  1.6660, -1.2412,  ..., -0.4795,  1.4580,  1.7578],
          ...,
          [ 1.9248,  2.1738, -1.6309,  ...,  0.0102, -0.6792,  2.7168],
          [-1.5684,  0.5347,  2.9570,  ...,  0.2896,  0.4871,  1.6387],
          [ 1.1260,  2.0176, -2.8457,  ...,  1.4697, -0.9165, -1.7061]],

         ...,

         [[ 1.7705, -1.7676, -0.5566,  ...,  2.1973, -3.6660,  1.3496],
          [ 4.3789, -3.0254, -1.5566,  ...,  1.8213, -0.7852,  0.0746],
          [ 0.3594,  1.5000, -1.3135,  ..., -0.3921,  1.5049,  1.9639],
          ...,
          [ 1.8867,  2.2871, -1.6738,  ...,  0.1768, -0.4807,  2.7988],
          [-1.5420,  0.5322,  2.9707,  ...,  0.2457,  0.3396,  1.7793],
          [ 1.3701,  2.1816, -2.7207,  ...,  1.4404, -0.9941, -1.4697]],

         [[ 1.8789, -1.7939, -0.5415,  ...,  2.1465, -3.7168,  1.3916],
          [ 4.4023, -3.0371, -1.5000,  ...,  1.7441, -0.7598,  0.2098],
          [ 0.3293,  1.5225, -1.3086,  ..., -0.4937,  1.4717,  2.0527],
          ...,
          [ 1.8564,  2.3848, -1.7598,  ...,  0.1763, -0.4250,  2.8105],
          [-1.4814,  0.5298,  2.9590,  ...,  0.2196,  0.2832,  1.9014],
          [ 1.4199,  2.3047, -2.6582,  ...,  1.5254, -1.0195, -1.4678]],

         [[ 1.8691, -1.9287, -0.6895,  ...,  2.1758, -3.7305,  1.3574],
          [ 4.5586, -3.0859, -1.6084,  ...,  1.8564, -0.7495,  0.1984],
          [ 0.3301,  1.5137, -1.3477,  ..., -0.5278,  1.5410,  2.0215],
          ...,
          [ 1.9238,  2.3926, -1.7803,  ...,  0.1368, -0.4612,  2.8496],
          [-1.5410,  0.5786,  3.0156,  ...,  0.1602,  0.3086,  1.8818],
          [ 1.3340,  2.3516, -2.6855,  ...,  1.3975, -1.0156, -1.4766]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[-1.6260,  0.4993, -0.2871,  ...,  0.4329,  0.5200, -0.1644],
          [ 0.8247,  0.0592,  0.9082,  ...,  0.1791, -1.1787,  0.4768],
          [ 0.5986, -0.1289,  0.9312,  ..., -0.7847,  0.4971,  0.3882],
          ...,
          [ 0.0853,  0.9248,  0.7852,  ...,  0.2979, -0.8096,  0.1062],
          [ 0.2537, -0.5552, -0.4539,  ..., -0.8345,  0.2305, -0.0236],
          [-0.1442,  0.4285, -0.6772,  ...,  0.0404, -0.0705, -0.4312]],

         [[-1.4619, -0.0763,  1.6533,  ...,  0.4409,  0.1360,  0.4399],
          [-0.1043,  1.9102,  0.1460,  ...,  0.8506, -1.4238, -0.0406],
          [ 1.2109, -2.2754,  1.3252,  ..., -0.4868,  0.5205, -1.0576],
          ...,
          [ 0.7388,  0.9634, -0.1700,  ...,  1.9004,  0.6123, -1.3545],
          [ 0.6206, -0.7837, -0.8833,  ..., -1.4658,  0.6035, -0.8296],
          [-0.1725,  0.1719,  0.8872,  ...,  0.1214,  0.2673,  0.4424]],

         [[-1.7432,  0.2634,  1.3555,  ...,  0.4375,  0.3608,  0.4062],
          [-0.5288,  1.6113,  0.2031,  ...,  0.9912, -2.2617,  0.0698],
          [ 0.8335, -1.3867,  0.7739,  ..., -0.7612, -0.2859, -1.0908],
          ...,
          [ 0.5332,  0.4387, -0.0323,  ...,  1.8975,  0.1223, -1.4326],
          [ 0.4404, -0.8354, -0.7495,  ..., -1.5381,  0.5830, -0.6626],
          [-0.3899,  0.2067,  0.5376,  ...,  0.0699,  0.1886,  0.3250]],

         ...,

         [[-2.0840, -0.4746,  2.1641,  ...,  1.0625,  0.0732,  0.3999],
          [ 0.3198,  1.5479,  0.1843,  ...,  0.2051, -2.1992,  0.5327],
          [ 1.1836, -2.9199,  2.1465,  ..., -0.5825,  0.7070, -0.8833],
          ...,
          [ 1.2422,  0.3499, -0.5684,  ...,  1.4893, -0.2830, -0.8135],
          [ 0.4412, -0.6431, -0.7124,  ..., -1.5049,  0.3291, -0.8071],
          [-0.6548,  0.0698,  0.7656,  ..., -0.0250, -0.0928,  0.1605]],

         [[-2.0723, -0.5688,  1.7324,  ...,  0.8877,  0.1465,  0.5605],
          [ 0.2281,  0.9868,  0.0424,  ...,  0.0530, -2.4023,  0.5552],
          [ 1.1367, -3.4902,  2.0156,  ..., -1.0146,  0.6426, -1.1592],
          ...,
          [ 1.1592,  0.4492, -0.5513,  ...,  1.3047, -0.1583, -1.5811],
          [ 0.4700, -0.6377, -0.6646,  ..., -1.4307,  0.2939, -0.7153],
          [-0.6704,  0.1004,  0.7510,  ...,  0.0037, -0.0823,  0.2142]],

         [[-1.8262, -0.3086,  0.9224,  ...,  0.1875,  0.2462,  0.6851],
          [-0.1077,  0.7041, -0.0898,  ...,  0.3550, -2.4902,  0.4749],
          [ 1.0361, -3.2129,  1.6064,  ..., -1.5225,  0.1573, -1.4580],
          ...,
          [ 0.8682,  0.1957, -0.3538,  ...,  1.4092, -0.0848, -2.2461],
          [ 0.4312, -0.7510, -0.6548,  ..., -1.3379,  0.3560, -0.5195],
          [-0.6270,  0.1531,  0.6328,  ...,  0.0298, -0.0687,  0.2622]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[ 0.6929, -0.4084,  1.0312,  ...,  0.8857, -0.8062, -0.1281],
          [-1.0234,  1.5664,  0.6963,  ...,  0.7905,  0.7974, -0.2710],
          [ 0.2052, -0.4028,  0.9141,  ...,  0.3652, -1.6719, -2.4043],
          ...,
          [ 0.4294,  1.0674, -0.2443,  ...,  1.0752, -1.2734, -0.5566],
          [-0.3560, -0.6211, -1.3203,  ..., -0.7271, -0.3994, -0.9951],
          [ 0.7456,  1.1377,  0.1748,  ..., -0.0867, -0.1804,  0.5337]],

         [[ 0.5508, -0.6504,  0.2512,  ...,  0.6860, -1.6289, -0.3799],
          [-1.7246,  0.9478,  0.7319,  ...,  1.6299,  0.0597,  0.1758],
          [-0.4175,  0.2917, -0.0219,  ...,  0.7900, -1.7090, -2.6328],
          ...,
          [-0.5659,  0.6494,  0.0557,  ...,  1.5977, -2.1250, -1.1973],
          [-1.0557, -0.7739, -0.8750,  ..., -0.3721, -0.6143, -0.8018],
          [-1.6602,  0.5254,  0.1387,  ..., -0.5820, -2.2324,  0.7148]],

         [[ 0.4155, -0.6064,  0.1375,  ...,  0.7280, -1.5840, -0.7168],
          [-0.9517,  0.9106,  0.3916,  ...,  1.0508,  0.3179,  0.3953],
          [ 0.3098,  0.1237,  0.5044,  ...,  0.8838, -1.5205, -2.3965],
          ...,
          [-0.4412,  0.9023, -0.1299,  ...,  1.2646, -2.1113, -1.2705],
          [-0.7856, -0.7466, -0.8452,  ..., -0.5400, -0.7192, -0.9385],
          [-1.2461, -0.0417,  0.1792,  ..., -0.7720, -1.8857, -0.1777]],

         ...,

         [[ 0.1709, -0.9160, -0.0039,  ...,  0.6870, -2.1855, -0.7109],
          [-1.6631,  0.4446, -0.0154,  ...,  1.2871,  0.1681,  0.1018],
          [ 0.5830, -1.1592,  0.9712,  ...,  0.4971, -1.2148, -2.4961],
          ...,
          [-0.9062,  0.8110, -0.1214,  ...,  0.9268, -2.0078, -1.8594],
          [-0.9692, -0.9805, -1.0918,  ..., -0.3206, -0.9238, -0.9688],
          [-0.9473, -0.0482,  0.8955,  ..., -0.5571, -3.4941,  0.0946]],

         [[ 0.2810, -0.6885, -0.5015,  ...,  0.1423, -2.1289, -0.6592],
          [-1.6514,  1.0498,  0.0311,  ...,  1.4131,  0.2668,  0.1550],
          [ 0.7690, -0.1698,  0.6211,  ...,  0.2976, -1.6973, -2.6465],
          ...,
          [-1.0205,  0.6265, -0.1276,  ...,  1.0176, -2.1660, -1.6875],
          [-0.9863, -1.0352, -1.0322,  ..., -0.3066, -1.0283, -0.8140],
          [-1.3721,  0.9180,  0.5176,  ..., -0.0365, -3.3652,  0.5830]],

         [[ 0.6270, -0.4570, -1.0986,  ..., -0.4583, -2.0508, -0.6401],
          [-1.4492,  1.4062,  0.1493,  ...,  1.2578,  0.4089,  0.2930],
          [ 0.8022,  0.4834,  0.6567,  ..., -0.0153, -1.9404, -2.6133],
          ...,
          [-0.9741,  0.4939, -0.3726,  ...,  0.9946, -2.1855, -1.3076],
          [-0.9614, -0.9546, -0.8398,  ..., -0.2759, -1.1572, -0.7036],
          [-1.3379,  1.3408, -0.1826,  ...,  0.0970, -3.1309, -0.1011]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[-6.3538e-02,  1.4214e-02,  3.2440e-02,  ..., -5.9891e-04,
            2.4843e-04, -2.1591e-02],
          [ 3.2898e-02,  1.7380e-02,  4.6234e-02,  ..., -5.6549e-02,
            6.9733e-03,  5.7861e-02],
          [-1.7380e-02,  1.1816e-03, -5.7892e-02,  ..., -3.5278e-02,
           -5.3772e-02,  2.9007e-02],
          ...,
          [ 1.0178e-02, -1.1517e-01, -7.9250e-04,  ..., -3.3722e-03,
            3.9886e-02,  1.3367e-02],
          [-5.5389e-02, -8.7585e-02, -8.7402e-02,  ..., -3.4308e-04,
            3.5126e-02,  3.8574e-02],
          [ 1.9806e-02, -3.1708e-02,  5.1231e-03,  ...,  1.7033e-03,
           -3.3783e-02,  4.9164e-02]],

         [[-1.3721e-01,  5.7281e-02,  6.5186e-02,  ...,  1.8097e-02,
            6.0043e-03, -2.4002e-02],
          [ 7.4341e-02,  4.9652e-02,  8.0566e-02,  ..., -6.5552e-02,
            6.0852e-02,  1.1859e-01],
          [-4.6265e-02, -2.3403e-03, -6.9641e-02,  ..., -2.6962e-02,
           -5.0720e-02,  6.3721e-02],
          ...,
          [-1.1421e-02, -1.9080e-01, -1.3745e-04,  ..., -2.3880e-02,
            9.1125e-02,  1.0696e-02],
          [-2.2690e-02, -3.3423e-01, -9.2285e-02,  ..., -1.0999e-01,
            1.1084e-01,  2.8152e-02],
          [ 3.9215e-02, -6.3049e-02,  1.4786e-02,  ..., -4.3091e-02,
           -9.2041e-02,  2.7222e-01]],

         [[-1.3733e-01,  8.6792e-02,  5.8441e-02,  ...,  2.6764e-02,
           -1.8585e-02, -3.1647e-02],
          [ 6.7261e-02,  3.3508e-02,  9.2102e-02,  ..., -8.3069e-02,
            5.0018e-02,  1.2238e-01],
          [-5.6854e-02, -2.1561e-02, -8.6182e-02,  ..., -5.4077e-02,
           -8.0444e-02,  6.0913e-02],
          ...,
          [ 5.6534e-03, -1.8970e-01,  3.5610e-03,  ..., -1.0956e-02,
            8.5693e-02,  1.2579e-03],
          [-2.1988e-02, -3.3667e-01, -5.9998e-02,  ..., -7.1411e-02,
            8.8745e-02,  4.5807e-02],
          [ 3.9124e-02, -8.1848e-02,  2.7161e-02,  ..., -8.0719e-03,
           -2.4506e-02,  3.1836e-01]],

         ...,

         [[-1.4441e-01,  7.3792e-02,  5.3772e-02,  ...,  1.5297e-02,
           -1.5640e-02, -3.0899e-02],
          [ 7.1350e-02,  3.0701e-02,  9.9365e-02,  ..., -6.8726e-02,
            4.6600e-02,  1.3525e-01],
          [-6.4209e-02,  1.0204e-03, -1.0199e-01,  ..., -7.2815e-02,
           -8.1848e-02,  7.0801e-02],
          ...,
          [ 1.6098e-02, -1.9458e-01, -1.1658e-02,  ..., -6.0234e-03,
            8.6853e-02, -1.2283e-02],
          [ 2.9739e-02, -2.5000e-01, -1.1395e-01,  ..., -1.3318e-01,
            6.1188e-02,  4.6021e-02],
          [-9.6655e-04, -9.0820e-02,  7.0740e-02,  ..., -4.4739e-02,
           -6.3171e-02, -2.8833e-01]],

         [[-1.3416e-01,  6.9336e-02,  6.1646e-02,  ...,  1.7365e-02,
           -1.7334e-02, -2.7985e-02],
          [ 7.9773e-02,  3.7994e-02,  9.5276e-02,  ..., -6.7810e-02,
            4.6478e-02,  1.4233e-01],
          [-7.2388e-02, -7.7362e-03, -1.0815e-01,  ..., -8.2153e-02,
           -7.3486e-02,  8.2581e-02],
          ...,
          [ 1.1673e-02, -2.0276e-01, -7.7343e-04,  ..., -8.4763e-03,
            8.0017e-02, -2.1393e-02],
          [ 4.4189e-02, -2.2546e-01, -1.1230e-01,  ..., -1.6284e-01,
            8.8989e-02,  5.4291e-02],
          [ 1.6022e-02, -1.1908e-01,  4.6692e-02,  ..., -8.1177e-02,
           -1.1694e-01, -1.6321e-01]],

         [[-1.4331e-01,  6.4148e-02,  5.0476e-02,  ...,  2.9083e-02,
           -7.8583e-03, -3.3752e-02],
          [ 7.5623e-02,  3.4760e-02,  9.4177e-02,  ..., -6.7932e-02,
            4.4830e-02,  1.5002e-01],
          [-6.8542e-02, -1.3855e-02, -1.0492e-01,  ..., -8.2336e-02,
           -8.3496e-02,  7.9834e-02],
          ...,
          [ 1.0414e-03, -2.1130e-01, -1.1101e-03,  ..., -1.4687e-02,
            8.7219e-02, -9.9716e-03],
          [ 7.2205e-02, -2.2351e-01, -9.9304e-02,  ..., -1.8579e-01,
            1.0339e-01,  4.6509e-02],
          [ 3.5095e-02, -1.3403e-01,  2.3529e-02,  ..., -6.6528e-02,
           -1.0889e-01,  8.3130e-02]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[-1.3770e-01,  7.2205e-02,  5.4932e-02,  ...,  2.3056e-02,
          -1.1665e-02, -3.2074e-02],
         [ 6.8176e-02,  3.3203e-02,  8.8501e-02,  ..., -7.0862e-02,
           4.3457e-02,  1.2488e-01],
         [-6.3416e-02, -4.7340e-03, -9.7046e-02,  ..., -6.9275e-02,
          -7.9224e-02,  7.1899e-02],
         ...,
         [ 6.8283e-03, -1.9678e-01, -3.0746e-03,  ..., -1.0201e-02,
           8.4534e-02, -8.7738e-03],
         [ 6.8512e-03, -2.7588e-01, -9.3384e-02,  ..., -1.1096e-01,
           8.0566e-02,  4.3823e-02],
         [ 2.0508e-02, -8.1238e-02,  3.8788e-02,  ..., -2.2751e-02,
          -5.0507e-02,  7.0190e-02]],

        [[-1.3342e-01,  6.9275e-02,  5.3314e-02,  ...,  2.1927e-02,
          -1.1269e-02, -3.1738e-02],
         [ 5.3009e-02,  2.6855e-02,  6.9946e-02,  ..., -6.4514e-02,
           2.8183e-02,  9.5398e-02],
         [-4.5410e-02, -1.4839e-03, -8.2642e-02,  ..., -5.6702e-02,
          -6.8237e-02,  5.5267e-02],
         ...,
         [ 7.4806e-03, -1.7688e-01, -2.7218e-03,  ..., -8.6365e-03,
           7.4280e-02, -3.0880e-03],
         [-1.1810e-02, -2.2449e-01, -9.1553e-02,  ..., -7.9102e-02,
           6.8237e-02,  4.1992e-02],
         [ 2.0599e-02, -5.8289e-02,  2.0828e-02,  ..., -1.7105e-02,
          -5.0568e-02,  4.0497e-02]],

        [[-1.3721e-01,  7.2083e-02,  5.4535e-02,  ...,  2.3239e-02,
          -1.1642e-02, -3.2288e-02],
         [ 6.2683e-02,  3.2196e-02,  8.0078e-02,  ..., -6.7444e-02,
           3.8666e-02,  1.1230e-01],
         [-6.3049e-02, -7.3509e-03, -9.7351e-02,  ..., -6.9641e-02,
          -7.4280e-02,  7.3669e-02],
         ...,
         [ 6.9733e-03, -1.9055e-01, -3.0441e-03,  ..., -9.8801e-03,
           8.1177e-02, -7.3090e-03],
         [-7.8812e-03, -2.3535e-01, -9.1858e-02,  ..., -8.6182e-02,
           7.1472e-02,  4.2236e-02],
         [ 2.2202e-02, -6.6528e-02,  2.5726e-02,  ..., -2.1988e-02,
          -5.4688e-02,  6.3721e-02]],

        ...,

        [[-1.3989e-01,  7.4707e-02,  5.4718e-02,  ...,  2.3148e-02,
          -1.3260e-02, -3.2471e-02],
         [ 6.6040e-02,  3.3478e-02,  8.4961e-02,  ..., -7.0129e-02,
           4.2847e-02,  1.1926e-01],
         [-6.1035e-02, -1.0386e-03, -9.3689e-02,  ..., -6.6345e-02,
          -8.2520e-02,  6.7993e-02],
         ...,
         [ 6.6452e-03, -1.9495e-01, -2.8362e-03,  ..., -1.0231e-02,
           8.3496e-02, -7.7820e-03],
         [-3.7994e-03, -2.5000e-01, -9.2346e-02,  ..., -9.3384e-02,
           7.3853e-02,  4.2725e-02],
         [ 1.8890e-02, -7.2876e-02,  3.6835e-02,  ..., -2.2461e-02,
          -5.1300e-02,  4.0619e-02]],

        [[-1.3916e-01,  7.2693e-02,  5.5023e-02,  ...,  2.2125e-02,
          -1.3351e-02, -3.1738e-02],
         [ 6.6345e-02,  3.2990e-02,  8.6182e-02,  ..., -7.0618e-02,
           4.2664e-02,  1.2048e-01],
         [-6.4392e-02,  3.8207e-05, -9.9792e-02,  ..., -7.1411e-02,
          -8.1421e-02,  7.1594e-02],
         ...,
         [ 7.3700e-03, -1.9507e-01, -3.3684e-03,  ..., -9.6283e-03,
           8.3679e-02, -8.7357e-03],
         [-3.7327e-03, -2.4792e-01, -9.2529e-02,  ..., -9.3079e-02,
           7.3486e-02,  4.2786e-02],
         [ 1.9302e-02, -7.3486e-02,  3.5553e-02,  ..., -2.4338e-02,
          -5.3986e-02,  3.6896e-02]],

        [[-1.3794e-01,  6.9946e-02,  5.4871e-02,  ...,  2.2110e-02,
          -1.2558e-02, -3.1342e-02],
         [ 6.7017e-02,  3.3203e-02,  8.6792e-02,  ..., -7.0435e-02,
           4.2908e-02,  1.2170e-01],
         [-6.7505e-02, -4.2686e-03, -1.0364e-01,  ..., -7.6477e-02,
          -7.8308e-02,  7.6294e-02],
         ...,
         [ 7.7324e-03, -1.9556e-01, -3.6087e-03,  ..., -9.4604e-03,
           8.3679e-02, -9.6512e-03],
         [-4.0169e-03, -2.4585e-01, -9.2529e-02,  ..., -9.2529e-02,
           7.3303e-02,  4.2725e-02],
         [ 1.9974e-02, -7.3792e-02,  3.3234e-02,  ..., -2.6245e-02,
          -5.7098e-02,  3.3936e-02]]], device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[-0.5181, -0.0325, -0.2019,  ..., -0.1226,  0.1266, -0.1266],
          [-0.1675, -0.2871,  0.2406,  ..., -0.4253, -0.2252,  0.2240],
          [ 0.3618, -0.1884, -0.2661,  ..., -0.5005,  0.6616, -0.6016],
          ...,
          [ 0.4314, -0.3250, -0.5020,  ...,  0.2898, -0.9136, -0.5229],
          [-0.4692, -0.5220,  0.4355,  ...,  0.6440,  0.0385, -0.0142],
          [ 0.8936, -0.4395,  0.3955,  ..., -0.4888, -0.1870, -0.0492]],

         [[ 0.4695, -1.5166,  0.4294,  ...,  0.4180,  1.1758,  1.4102],
          [ 0.7832, -0.2377, -1.3701,  ...,  0.4751,  1.3457, -1.3438],
          [-1.4473, -1.8125, -0.5161,  ..., -0.4102,  1.1328,  0.9399],
          ...,
          [-0.2644, -0.7471, -1.8945,  ..., -1.7451,  1.8574,  1.6631],
          [ 0.2605, -0.1516,  0.3074,  ...,  0.0490,  0.0990, -0.0338],
          [-1.7715, -1.5508, -1.4658,  ..., -0.5366, -1.9189,  1.7334]],

         [[ 0.3047, -1.3330,  0.2712,  ...,  0.2069,  1.1396,  1.3711],
          [ 0.7324, -0.1141, -1.2744,  ...,  0.4836,  1.2480, -1.2480],
          [-1.6768, -1.7988, -0.4734,  ..., -0.7944,  1.2227,  0.7222],
          ...,
          [-0.2377, -0.7197, -1.5645,  ..., -1.6504,  2.1191,  1.6250],
          [ 0.2859, -0.2153,  0.2788,  ..., -0.0729, -0.0684,  0.1019],
          [-1.6514, -1.9053, -1.8203,  ..., -0.2773, -1.9717,  1.6270]],

         ...,

         [[ 0.1936, -1.1865,  0.2001,  ...,  0.2499,  0.9365,  1.3438],
          [ 0.7480, -0.1009, -1.1895,  ...,  0.4434,  1.1641, -1.1631],
          [-1.7930, -1.7764, -0.6719,  ..., -0.7925,  1.3213,  0.7139],
          ...,
          [-0.4446, -0.6167, -1.6074,  ..., -1.6045,  2.0488,  1.5635],
          [ 0.2416, -0.1002,  0.2996,  ..., -0.1357, -0.1263,  0.0393],
          [-1.6885, -2.3281, -2.1191,  ..., -0.3755, -2.0977,  1.4385]],

         [[ 0.1578, -1.1631,  0.1737,  ...,  0.2458,  0.8833,  1.3486],
          [ 0.7393, -0.0927, -1.1514,  ...,  0.4150,  1.1260, -1.1260],
          [-1.9307, -1.8770, -0.8188,  ..., -0.8384,  1.3096,  0.7207],
          ...,
          [-0.5078, -0.5718, -1.6299,  ..., -1.6670,  2.1738,  1.5400],
          [ 0.1730, -0.1124,  0.3037,  ..., -0.2158, -0.1111,  0.0495],
          [-1.8018, -2.4316, -2.1445,  ..., -0.4443, -2.0410,  1.3945]],

         [[ 0.1450, -1.1621,  0.1715,  ...,  0.2522,  0.8599,  1.3291],
          [ 0.6851, -0.0566, -1.1260,  ...,  0.3899,  1.1016, -1.1006],
          [-2.0098, -1.8887, -0.8306,  ..., -0.8228,  1.2891,  0.6343],
          ...,
          [-0.5518, -0.6499, -1.5137,  ..., -1.6562,  2.2129,  1.4629],
          [ 0.1885, -0.1666,  0.3123,  ..., -0.2224, -0.0502,  0.0582],
          [-2.1074, -2.4531, -1.9453,  ..., -0.4971, -1.9658,  1.3389]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[ 0.9746,  0.3232, -0.8262,  ..., -0.3037, -0.1205,  0.2300],
          [ 0.7412,  1.4697, -0.4409,  ...,  0.9922,  0.4287, -0.4290],
          [-0.0912,  0.5303,  0.5332,  ...,  0.0781, -1.4893,  1.4463],
          ...,
          [ 1.9385, -0.0842, -0.7549,  ...,  0.7432,  1.7852,  1.1807],
          [ 0.7656,  0.3152, -1.7764,  ..., -1.3330, -1.3584,  1.0986],
          [-1.0566,  2.0625, -1.3838,  ...,  2.1777,  1.0820, -0.5874]],

         [[-1.1895, -1.3506,  0.6919,  ..., -1.5371,  0.5586, -2.3223],
          [ 0.3428, -1.8389,  0.7485,  ...,  0.1992, -0.7266,  0.7300],
          [ 1.1758, -0.0517, -0.8828,  ..., -0.3450,  0.0105, -0.6343],
          ...,
          [ 0.5742, -1.8682, -3.4199,  ..., -1.3721, -0.6211, -0.0118],
          [-2.6445, -2.7891,  0.6050,  ...,  1.5869, -0.4397, -1.2539],
          [ 1.3398,  0.4983,  0.0175,  ...,  0.9463, -0.7349, -0.2812]],

         [[-1.0244, -1.5830,  0.5444,  ..., -1.2969,  0.8408, -1.9375],
          [ 0.3452, -1.5596,  0.6758,  ...,  0.2427, -0.6538,  0.6567],
          [ 1.1865, -0.3066, -0.8999,  ..., -0.5552,  0.0666, -0.5972],
          ...,
          [ 0.5239, -1.8555, -3.2148,  ..., -1.4648, -0.4470, -0.0961],
          [-2.6523, -2.4961,  0.5566,  ...,  1.5078, -0.6147, -1.2031],
          [ 1.2305,  0.2059,  0.0755,  ...,  0.8330, -0.7466,  0.0076]],

         ...,

         [[-1.0371, -1.5303,  0.4185,  ..., -0.9883,  0.9536, -1.7275],
          [ 0.3174, -1.0664,  0.5728,  ...,  0.6216, -0.5562,  0.5581],
          [ 1.0420, -0.1996, -1.0752,  ..., -0.5264, -0.0423, -0.5361],
          ...,
          [ 0.4375, -1.7959, -3.3086,  ..., -1.3555, -0.5562, -0.2812],
          [-2.2910, -2.3047,  0.6118,  ...,  1.4199, -0.5830, -1.2383],
          [ 0.7925, -0.2690, -0.2413,  ...,  0.7974, -0.7334, -0.2267]],

         [[-1.1475, -1.4980,  0.4136,  ..., -0.9214,  0.9688, -1.7080],
          [ 0.2729, -0.8286,  0.5693,  ...,  0.6182, -0.5508,  0.5522],
          [ 1.0342, -0.2869, -1.2070,  ..., -0.5376, -0.0381, -0.5981],
          ...,
          [ 0.4277, -1.7158, -3.3730,  ..., -1.3955, -0.5610, -0.3000],
          [-2.0508, -2.3066,  0.6733,  ...,  1.3955, -0.5293, -1.3887],
          [ 0.6235, -0.3943, -0.1953,  ...,  0.7197, -0.7681, -0.3208]],

         [[-1.1787, -1.5410,  0.4131,  ..., -0.9453,  0.9839, -1.6992],
          [ 0.1771, -0.8682,  0.5918,  ...,  0.3887, -0.5762,  0.5771],
          [ 1.0273, -0.2642, -1.0967,  ..., -0.4336, -0.0703, -0.5859],
          ...,
          [ 0.4932, -1.7627, -3.3223,  ..., -1.3779, -0.6069, -0.3655],
          [-2.1055, -2.3613,  0.7515,  ...,  1.3438, -0.4509, -1.4111],
          [ 0.5425, -0.3992, -0.1328,  ...,  0.5767, -0.6934, -0.5542]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[-0.0047,  0.0018, -0.0048,  ...,  0.0020, -0.0023, -0.0008],
          [ 0.0015, -0.0071, -0.0045,  ..., -0.0029,  0.0026,  0.0012],
          [ 0.0020,  0.0037,  0.0049,  ...,  0.0020, -0.0053,  0.0087],
          ...,
          [-0.0039, -0.0077, -0.0082,  ...,  0.0014,  0.0050, -0.0032],
          [-0.0024,  0.0015,  0.0019,  ..., -0.0051,  0.0149,  0.0062],
          [ 0.0097, -0.0152,  0.0011,  ..., -0.0084, -0.0014,  0.0015]],

         [[-0.1154,  0.0028,  0.0737,  ...,  0.0844, -0.1586, -0.0774],
          [-0.0221, -0.0503,  0.0430,  ...,  0.0436, -0.0495, -0.1109],
          [ 0.0502, -0.0085,  0.1060,  ...,  0.1176, -0.2815, -0.2864],
          ...,
          [ 0.0296, -0.0064,  0.1141,  ...,  0.0876,  0.0418, -0.0252],
          [-0.0825, -0.2505,  0.0739,  ..., -0.1394,  0.3621,  0.0656],
          [ 0.1171,  0.0112, -0.1218,  ...,  0.0212, -0.0209, -0.0203]],

         [[-0.1111,  0.0127,  0.0421,  ...,  0.0709, -0.1525, -0.0395],
          [-0.0329, -0.0266,  0.0526,  ...,  0.0594, -0.0594, -0.0869],
          [-0.0202,  0.0161,  0.1086,  ...,  0.1290, -0.2517, -0.2517],
          ...,
          [ 0.0063, -0.0050,  0.1074,  ...,  0.0903,  0.0571,  0.0352],
          [-0.0089, -0.2429,  0.0775,  ..., -0.1411,  0.3032,  0.0683],
          [ 0.0888, -0.0128, -0.1279,  ...,  0.0186,  0.0313, -0.0605]],

         ...,

         [[-0.1005,  0.0135,  0.0331,  ...,  0.0249, -0.1998, -0.0038],
          [-0.0273, -0.0333,  0.0375,  ...,  0.0353, -0.0632, -0.0934],
          [-0.0309,  0.0762,  0.0912,  ...,  0.1306, -0.2603, -0.2471],
          ...,
          [-0.0009, -0.0072,  0.1049,  ...,  0.0997,  0.0624,  0.0443],
          [ 0.0361, -0.2396,  0.0435,  ..., -0.1492,  0.2722,  0.0643],
          [ 0.0565, -0.0232, -0.1132,  ...,  0.0086,  0.0330, -0.0784]],

         [[-0.1110,  0.0291,  0.0378,  ..., -0.0055, -0.2036, -0.0010],
          [-0.0311, -0.0358,  0.0345,  ...,  0.0307, -0.0593, -0.0917],
          [-0.0153,  0.0881,  0.0980,  ...,  0.1426, -0.2622, -0.2607],
          ...,
          [-0.0049,  0.0017,  0.1094,  ...,  0.1078,  0.0642,  0.0416],
          [ 0.0487, -0.2329,  0.0476,  ..., -0.1610,  0.2773,  0.0642],
          [ 0.0626, -0.0097, -0.1118,  ...,  0.0101,  0.0310, -0.0669]],

         [[-0.1118,  0.0177,  0.0292,  ..., -0.0081, -0.1980, -0.0017],
          [-0.0286, -0.0396,  0.0304,  ...,  0.0304, -0.0605, -0.0936],
          [-0.0165,  0.0670,  0.1077,  ...,  0.1313, -0.2539, -0.2732],
          ...,
          [ 0.0015,  0.0092,  0.1147,  ...,  0.1097,  0.0696,  0.0446],
          [ 0.0463, -0.2145,  0.0474,  ..., -0.1522,  0.2654,  0.0808],
          [ 0.0602, -0.0156, -0.1236,  ...,  0.0179,  0.0339, -0.0590]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[-0.1073,  0.0151,  0.0425,  ...,  0.0369, -0.1744, -0.0246],
         [-0.0289, -0.0352,  0.0405,  ...,  0.0417, -0.0594, -0.0915],
         [-0.0126,  0.0437,  0.1022,  ...,  0.1302, -0.2622, -0.2583],
         ...,
         [ 0.0061, -0.0013,  0.1074,  ...,  0.0975,  0.0589,  0.0321],
         [ 0.0075, -0.2389,  0.0579,  ..., -0.1461,  0.2905,  0.0656],
         [ 0.0726, -0.0124, -0.1207,  ...,  0.0156,  0.0266, -0.0595]],

        [[-0.0887,  0.0143,  0.0307,  ...,  0.0235, -0.1483, -0.0134],
         [-0.0220, -0.0280,  0.0293,  ...,  0.0302, -0.0454, -0.0686],
         [ 0.0007,  0.0075,  0.0151,  ...,  0.0153, -0.0321, -0.0191],
         ...,
         [ 0.0090, -0.0033,  0.0978,  ...,  0.0862,  0.0510,  0.0214],
         [ 0.0039, -0.0598,  0.0154,  ..., -0.0419,  0.0831,  0.0216],
         [ 0.0640, -0.0151, -0.1169,  ...,  0.0137,  0.0313, -0.0635]],

        [[-0.0903,  0.0145,  0.0315,  ...,  0.0242, -0.1509, -0.0139],
         [-0.0197, -0.0258,  0.0260,  ...,  0.0270, -0.0408, -0.0617],
         [ 0.0011,  0.0061,  0.0112,  ...,  0.0103, -0.0220, -0.0087],
         ...,
         [ 0.0084, -0.0033,  0.0965,  ...,  0.0855,  0.0509,  0.0224],
         [ 0.0041, -0.0615,  0.0157,  ..., -0.0428,  0.0850,  0.0220],
         [ 0.0637, -0.0151, -0.1174,  ...,  0.0136,  0.0317, -0.0643]],

        ...,

        [[-0.0870,  0.0140,  0.0300,  ...,  0.0229, -0.1454, -0.0132],
         [-0.0209, -0.0268,  0.0277,  ...,  0.0287, -0.0432, -0.0650],
         [ 0.0006,  0.0074,  0.0143,  ...,  0.0144, -0.0301, -0.0170],
         ...,
         [ 0.0083, -0.0030,  0.0994,  ...,  0.0883,  0.0526,  0.0242],
         [ 0.0045, -0.0674,  0.0171,  ..., -0.0464,  0.0917,  0.0234],
         [ 0.0624, -0.0153, -0.1174,  ...,  0.0133,  0.0325, -0.0654]],

        [[-0.0846,  0.0137,  0.0289,  ...,  0.0221, -0.1414, -0.0128],
         [-0.0195, -0.0255,  0.0257,  ...,  0.0267, -0.0403, -0.0608],
         [ 0.0006,  0.0073,  0.0140,  ...,  0.0140, -0.0294, -0.0162],
         ...,
         [ 0.0083, -0.0030,  0.1005,  ...,  0.0892,  0.0531,  0.0246],
         [ 0.0042, -0.0642,  0.0164,  ..., -0.0444,  0.0880,  0.0226],
         [ 0.0621, -0.0153, -0.1174,  ...,  0.0133,  0.0327, -0.0655]],

        [[-0.0833,  0.0135,  0.0283,  ...,  0.0217, -0.1389, -0.0125],
         [-0.0175, -0.0238,  0.0228,  ...,  0.0239, -0.0363, -0.0549],
         [ 0.0008,  0.0069,  0.0130,  ...,  0.0126, -0.0267, -0.0134],
         ...,
         [ 0.0081, -0.0030,  0.0992,  ...,  0.0883,  0.0527,  0.0246],
         [ 0.0041, -0.0630,  0.0161,  ..., -0.0437,  0.0867,  0.0223],
         [ 0.0619, -0.0153, -0.1172,  ...,  0.0133,  0.0326, -0.0652]]],
       device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[ 2.7856e-01,  2.6562e-01,  4.8755e-01,  ...,  3.6450e-01,
            3.7549e-01, -3.5693e-01],
          [-3.0005e-01,  4.2700e-01, -1.5898e-03,  ...,  1.9373e-01,
           -2.4829e-01,  6.4014e-01],
          [ 3.0298e-01,  1.2622e-01,  4.3628e-01,  ..., -3.1372e-01,
            1.3672e-02,  9.2468e-02],
          ...,
          [-8.2397e-02,  1.4661e-01,  8.8989e-02,  ...,  1.6125e-01,
           -4.9622e-02,  7.5928e-02],
          [ 1.5601e-01, -1.2769e-01, -1.0895e-01,  ...,  4.1504e-02,
           -2.6440e-01, -1.4389e-04],
          [ 2.2522e-01, -1.5234e-01,  1.1157e-01,  ...,  4.2383e-01,
            2.0447e-01, -2.2595e-01]],

         [[-3.8501e-01,  2.0508e+00,  3.0029e-01,  ..., -2.2617e+00,
           -4.6924e-01,  9.1650e-01],
          [ 2.8290e-02, -2.9082e+00, -6.5137e-01,  ..., -2.1582e+00,
            1.6650e+00, -7.0459e-01],
          [-1.0029e+00,  1.3555e+00, -4.0137e-01,  ...,  4.7583e-01,
           -1.8530e-01, -3.7402e-01],
          ...,
          [-2.2449e-01,  5.9912e-01,  1.8713e-01,  ...,  6.0889e-01,
           -6.9434e-01, -1.3066e+00],
          [ 1.2469e-01, -3.5205e-01,  9.7900e-01,  ..., -1.8379e+00,
           -2.5952e-01,  1.0146e+00],
          [-1.4541e+00, -1.4785e+00,  1.3757e-01,  ..., -6.4746e-01,
            3.7476e-01,  2.3901e-01]],

         [[-2.1826e-01,  2.5098e+00,  2.9150e-01,  ..., -2.2520e+00,
           -6.2012e-01,  9.7510e-01],
          [-9.6741e-02, -2.9316e+00, -5.6543e-01,  ..., -2.0137e+00,
            1.2490e+00, -6.4258e-01],
          [-9.2578e-01,  1.5205e+00, -4.7778e-01,  ...,  5.7227e-01,
           -1.7566e-01, -9.4531e-01],
          ...,
          [-2.9468e-01,  6.0742e-01,  2.7075e-01,  ...,  7.9639e-01,
           -5.8594e-01, -1.3018e+00],
          [ 2.6831e-01, -3.1128e-01,  8.9941e-01,  ..., -1.9697e+00,
           -3.2324e-01,  8.8525e-01],
          [-1.3252e+00, -1.9141e+00,  3.3350e-01,  ..., -4.3164e-01,
            7.6660e-01,  2.2083e-01]],

         ...,

         [[-4.4312e-01,  2.4414e+00,  3.0493e-01,  ..., -2.5117e+00,
           -7.8223e-01,  9.2676e-01],
          [-5.0586e-01, -2.9355e+00, -5.0928e-01,  ..., -2.1914e+00,
            9.4043e-01, -6.5918e-01],
          [-9.0820e-01,  1.6113e+00, -8.1445e-01,  ...,  9.5459e-01,
           -6.4209e-01, -1.4473e+00],
          ...,
          [-3.1934e-01,  4.5703e-01,  3.0078e-01,  ...,  8.1934e-01,
           -7.0068e-01, -1.2812e+00],
          [ 3.6182e-01, -4.4482e-01,  9.5410e-01,  ..., -2.0176e+00,
           -2.7124e-01,  1.1377e+00],
          [-1.7354e+00, -2.1445e+00,  4.9561e-01,  ..., -2.9639e-01,
            8.8525e-01,  1.5808e-01]],

         [[-4.9341e-01,  2.3613e+00,  2.8076e-01,  ..., -2.3770e+00,
           -8.3105e-01,  9.1406e-01],
          [-4.4629e-01, -2.8145e+00, -3.8745e-01,  ..., -2.2617e+00,
            9.1260e-01, -7.6318e-01],
          [-9.5117e-01,  1.8428e+00, -8.3789e-01,  ...,  8.0127e-01,
           -8.0566e-01, -1.6025e+00],
          ...,
          [-3.2935e-01,  3.7720e-01,  3.1470e-01,  ...,  7.3193e-01,
           -7.4561e-01, -1.2607e+00],
          [ 4.2041e-01, -4.6582e-01,  9.2969e-01,  ..., -1.9834e+00,
           -2.8711e-01,  1.1904e+00],
          [-1.6211e+00, -2.1465e+00,  4.5874e-01,  ..., -2.8760e-01,
            8.6572e-01,  2.3230e-01]],

         [[-4.0283e-01,  2.3652e+00,  2.8052e-01,  ..., -2.4062e+00,
           -8.7646e-01,  8.9307e-01],
          [-4.1602e-01, -2.6973e+00, -3.6719e-01,  ..., -2.1992e+00,
            8.9014e-01, -6.0010e-01],
          [-9.6875e-01,  1.8076e+00, -1.0361e+00,  ...,  8.0811e-01,
           -9.1113e-01, -1.6250e+00],
          ...,
          [-3.4009e-01,  4.5801e-01,  3.2178e-01,  ...,  7.6562e-01,
           -6.5332e-01, -1.1992e+00],
          [ 5.4199e-01, -5.3857e-01,  8.8818e-01,  ..., -1.9854e+00,
           -2.8394e-01,  1.2344e+00],
          [-1.6465e+00, -2.2090e+00,  4.7656e-01,  ..., -3.3887e-01,
            8.8623e-01,  2.6050e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[-7.2656e-01, -8.3545e-01, -1.3936e+00,  ..., -5.0146e-01,
           -6.5479e-01,  2.1753e-01],
          [ 1.4434e+00, -1.3789e+00, -5.1318e-01,  ..., -1.1738e+00,
            3.9575e-01, -1.3887e+00],
          [-1.1133e+00, -2.2314e-01, -9.6973e-01,  ...,  5.6641e-01,
           -2.8784e-01,  2.5366e-01],
          ...,
          [ 3.9673e-01, -1.8689e-01, -4.4702e-01,  ..., -3.0176e-01,
            8.2825e-02,  1.8738e-01],
          [-5.9570e-02, -4.6997e-02, -3.2532e-02,  ..., -4.9377e-02,
            5.3418e-01,  3.5492e-02],
          [-3.0884e-01,  3.4570e-01, -8.6865e-01,  ..., -7.8125e-01,
           -5.8252e-01,  5.3320e-01]],

         [[ 1.2363e+00,  1.4658e+00,  2.6465e+00,  ...,  1.9629e+00,
            1.0742e+00,  1.4185e-01],
          [-1.0898e+00, -9.7595e-02, -2.5439e-01,  ..., -3.8794e-01,
            1.1094e+00,  5.2344e-01],
          [ 1.1250e+00,  3.0391e+00,  9.7852e-01,  ..., -3.4351e-01,
            1.7002e+00, -5.1270e-01],
          ...,
          [-7.3047e-01,  1.5498e+00,  6.7676e-01,  ...,  1.0322e+00,
           -1.4929e-01, -1.5303e+00],
          [-6.4795e-01, -2.1622e-02, -3.4570e-01,  ..., -2.5977e-01,
           -2.4688e+00, -1.2012e+00],
          [ 1.4238e+00, -3.0640e-02, -7.5073e-02,  ...,  1.8652e+00,
            4.6875e-01,  2.9639e-01]],

         [[ 1.1357e+00,  1.2246e+00,  2.5508e+00,  ...,  1.9844e+00,
            1.0332e+00,  1.6937e-02],
          [-1.2256e+00, -3.0176e-01, -2.5879e-01,  ..., -2.1252e-01,
            8.5400e-01,  5.6592e-01],
          [ 9.7070e-01,  3.2148e+00,  9.4580e-01,  ...,  7.4768e-02,
            1.4658e+00, -8.7207e-01],
          ...,
          [-8.4424e-01,  1.5166e+00,  7.9932e-01,  ...,  9.1016e-01,
            9.7595e-02, -1.3096e+00],
          [-6.8652e-01, -1.6270e-03, -3.9722e-01,  ..., -3.3911e-01,
           -2.5527e+00, -1.1201e+00],
          [ 1.4824e+00, -2.7319e-01, -6.1340e-02,  ...,  1.6182e+00,
            7.0020e-01,  1.5906e-01]],

         ...,

         [[ 1.0205e+00,  1.0107e+00,  2.5859e+00,  ...,  1.7500e+00,
            5.3418e-01, -5.2704e-02],
          [-1.3340e+00, -2.8442e-01, -3.7305e-01,  ..., -4.4312e-01,
            8.6816e-01,  4.1113e-01],
          [ 9.8096e-01,  3.8164e+00,  6.4697e-01,  ...,  5.1758e-01,
            1.2041e+00, -1.3691e+00],
          ...,
          [-9.2285e-01,  1.3252e+00,  8.7793e-01,  ...,  1.0244e+00,
            1.0162e-01, -1.2256e+00],
          [-8.1006e-01, -1.9058e-02, -3.9307e-01,  ..., -2.7759e-01,
           -2.5801e+00, -1.1748e+00],
          [ 1.5439e+00, -5.8447e-01, -3.8239e-02,  ...,  1.5420e+00,
            9.3994e-01, -9.2834e-02]],

         [[ 1.0488e+00,  9.1113e-01,  2.6250e+00,  ...,  1.7676e+00,
            4.0503e-01, -1.6797e-01],
          [-1.3096e+00, -1.3208e-01, -2.9077e-01,  ..., -4.3823e-01,
            9.5117e-01,  3.4229e-01],
          [ 1.0332e+00,  4.0117e+00,  5.9619e-01,  ...,  5.1172e-01,
            1.1719e+00, -1.4414e+00],
          ...,
          [-9.8877e-01,  1.0996e+00,  9.3799e-01,  ...,  9.8389e-01,
            1.1456e-01, -1.3193e+00],
          [-7.6318e-01, -5.3314e-02, -4.1895e-01,  ..., -1.7542e-01,
           -2.5898e+00, -1.2715e+00],
          [ 1.4922e+00, -4.9829e-01, -1.2711e-02,  ...,  1.5352e+00,
            1.0596e+00, -1.8799e-01]],

         [[ 1.0195e+00,  7.9736e-01,  2.6641e+00,  ...,  1.7412e+00,
            3.9746e-01, -1.8640e-01],
          [-1.3271e+00, -2.6875e-03, -2.5781e-01,  ..., -3.5059e-01,
            9.8486e-01,  4.5630e-01],
          [ 1.0352e+00,  3.9883e+00,  5.4443e-01,  ...,  5.4248e-01,
            1.0596e+00, -1.6201e+00],
          ...,
          [-1.0010e+00,  1.0166e+00,  9.5850e-01,  ...,  9.7900e-01,
            2.3010e-01, -1.2568e+00],
          [-7.7588e-01,  7.5317e-02, -4.2334e-01,  ..., -1.5869e-01,
           -2.6191e+00, -1.3623e+00],
          [ 1.3828e+00, -4.7437e-01, -1.3687e-02,  ...,  1.4648e+00,
            1.1865e+00, -1.0394e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[-1.4055e-04,  7.7009e-04,  1.5278e-03,  ...,  7.8049e-03,
            7.0333e-04, -5.0850e-03],
          [ 7.8735e-03,  4.0936e-04,  1.1740e-03,  ...,  3.7174e-03,
           -1.8406e-03,  2.4338e-03],
          [ 3.5667e-04,  8.0490e-04,  4.6768e-03,  ...,  1.2474e-03,
            6.2752e-03,  4.3793e-03],
          ...,
          [-3.5343e-03, -3.1643e-03, -6.7215e-03,  ..., -2.5711e-03,
           -1.0063e-02, -3.2463e-03],
          [-4.9934e-03,  1.9274e-03, -1.3237e-02,  ...,  3.5114e-03,
           -5.8365e-03, -1.1330e-03],
          [ 1.0843e-03,  9.6464e-04, -2.5043e-03,  ...,  2.3117e-03,
           -2.1820e-03,  2.1267e-03]],

         [[ 9.0485e-03,  2.2961e-01,  6.7810e-02,  ...,  5.6839e-03,
            2.2339e-01, -4.3427e-02],
          [ 1.9104e-01, -3.4375e-01, -1.2103e-01,  ..., -1.3208e-01,
            2.6733e-01, -1.9727e-01],
          [ 5.8319e-02,  1.0321e-01, -1.4336e-02,  ...,  1.0474e-01,
           -1.7810e-01,  3.2568e-01],
          ...,
          [-5.7182e-03, -1.9641e-01, -2.9053e-01,  ..., -3.3496e-01,
            5.7770e-02,  2.5635e-01],
          [-9.7351e-02, -5.9418e-02, -2.0654e-01,  ...,  2.2449e-01,
           -2.6294e-01, -4.0576e-01],
          [ 1.8890e-02,  1.8457e-01, -1.6455e-01,  ...,  7.3303e-02,
           -1.8707e-02,  7.8201e-03]],

         [[-1.4404e-02,  1.8762e-01,  5.7556e-02,  ...,  8.2092e-02,
            2.4683e-01, -5.9906e-02],
          [ 2.3425e-01, -3.2129e-01, -1.3684e-01,  ..., -1.0248e-01,
            2.1191e-01, -1.4185e-01],
          [ 4.1931e-02,  1.8066e-01, -1.5160e-02,  ...,  1.6809e-01,
           -2.2449e-01,  2.9834e-01],
          ...,
          [-5.4626e-02, -1.1584e-01, -2.5879e-01,  ..., -3.3521e-01,
           -6.2103e-02,  1.9019e-01],
          [-1.0443e-01, -1.1845e-03, -3.5620e-01,  ...,  2.0825e-01,
           -2.3889e-01, -3.4961e-01],
          [-7.3914e-02,  8.1116e-02, -1.8311e-01,  ...,  1.6632e-02,
            1.9150e-03, -3.2684e-02]],

         ...,

         [[ 1.3039e-02,  1.9666e-01,  7.2083e-02,  ...,  8.3496e-02,
            2.3657e-01, -5.3894e-02],
          [ 2.2314e-01, -2.4255e-01, -1.5552e-01,  ..., -1.2671e-01,
            1.7236e-01, -1.4783e-01],
          [ 3.3875e-02,  2.1313e-01,  7.6965e-02,  ...,  2.0056e-01,
           -1.6956e-01,  2.0996e-01],
          ...,
          [-3.0167e-02, -1.9434e-01, -3.2227e-01,  ..., -3.0298e-01,
           -6.6772e-02,  1.5576e-01],
          [-1.6174e-01,  9.3613e-03, -4.7046e-01,  ...,  1.7273e-01,
           -3.0151e-01, -2.9614e-01],
          [-1.1353e-01,  6.1981e-02, -1.9543e-01,  ..., -1.3939e-02,
           -6.7940e-03, -5.8563e-02]],

         [[ 3.9520e-02,  1.8335e-01,  7.3242e-02,  ...,  9.2590e-02,
            2.4060e-01, -4.0405e-02],
          [ 2.2827e-01, -2.3572e-01, -1.6052e-01,  ..., -1.1664e-01,
            1.7212e-01, -1.5430e-01],
          [ 2.4918e-02,  1.9800e-01,  6.7078e-02,  ...,  2.4683e-01,
           -1.2720e-01,  2.1216e-01],
          ...,
          [-3.0045e-02, -2.0801e-01, -3.6670e-01,  ..., -2.8979e-01,
           -6.3782e-02,  1.9531e-01],
          [-1.3867e-01,  7.6828e-03, -4.4409e-01,  ...,  1.5320e-01,
           -3.0640e-01, -3.1055e-01],
          [-1.2854e-01,  3.8818e-02, -1.6187e-01,  ..., -1.5152e-02,
            9.5444e-03, -6.6223e-02]],

         [[ 2.3285e-02,  1.7407e-01,  6.7078e-02,  ...,  1.0370e-01,
            2.4890e-01, -4.6509e-02],
          [ 2.2327e-01, -2.3450e-01, -1.5564e-01,  ..., -1.0767e-01,
            1.6077e-01, -1.4099e-01],
          [ 2.5772e-02,  2.0044e-01,  7.2693e-02,  ...,  2.3877e-01,
           -1.4819e-01,  2.2974e-01],
          ...,
          [-3.7262e-02, -1.7224e-01, -3.4961e-01,  ..., -2.8174e-01,
           -1.0730e-01,  1.8237e-01],
          [-1.2274e-01,  1.0544e-02, -5.0684e-01,  ...,  1.3855e-01,
           -2.5903e-01, -3.0444e-01],
          [-1.2683e-01,  1.9669e-02, -1.5942e-01,  ..., -3.7415e-02,
           -3.2501e-03, -4.9835e-02]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[ 1.0307e-02,  1.9458e-01,  6.5002e-02,  ...,  7.5012e-02,
           2.3975e-01, -5.0751e-02],
         [ 2.2278e-01, -2.7026e-01, -1.4771e-01,  ..., -1.1292e-01,
           1.8750e-01, -1.4600e-01],
         [ 3.5248e-02,  1.8420e-01,  3.5461e-02,  ...,  1.8896e-01,
          -1.7822e-01,  2.5171e-01],
         ...,
         [-4.0100e-02, -1.6760e-01, -3.0420e-01,  ..., -3.1274e-01,
          -5.2979e-02,  1.8384e-01],
         [-1.2262e-01, -6.3705e-03, -3.8892e-01,  ...,  1.7871e-01,
          -2.5635e-01, -3.0908e-01],
         [-8.8806e-02,  6.9214e-02, -1.7566e-01,  ..., -2.2011e-03,
          -8.9502e-04, -4.3549e-02]],

        [[ 1.2474e-02,  1.5979e-01,  5.5939e-02,  ...,  7.2083e-02,
           2.0215e-01, -4.2908e-02],
         [ 9.5062e-03, -1.9875e-03,  8.3506e-05,  ...,  2.7637e-03,
          -1.1897e-04,  1.1616e-03],
         [ 2.9541e-02,  1.9824e-01,  5.5786e-02,  ...,  2.1240e-01,
          -1.6418e-01,  2.2876e-01],
         ...,
         [-1.8936e-02, -7.3730e-02, -1.3379e-01,  ..., -1.3428e-01,
          -2.8397e-02,  7.6111e-02],
         [-3.4424e-02, -2.1768e-04, -1.0706e-01,  ...,  4.7241e-02,
          -6.8604e-02, -7.8186e-02],
         [-9.0561e-03,  8.6899e-03, -2.2079e-02,  ...,  1.7767e-03,
          -2.0504e-03, -3.0632e-03]],

        [[ 1.4793e-02,  1.8030e-01,  6.3354e-02,  ...,  8.1238e-02,
           2.2888e-01, -4.7668e-02],
         [ 1.1078e-02, -4.1733e-03, -9.7084e-04,  ...,  1.8911e-03,
           1.4162e-03,  2.7180e-05],
         [ 2.9648e-02,  2.0007e-01,  5.6732e-02,  ...,  2.1472e-01,
          -1.6504e-01,  2.3010e-01],
         ...,
         [-2.1103e-02, -8.3008e-02, -1.5088e-01,  ..., -1.5137e-01,
          -3.1555e-02,  8.6060e-02],
         [-3.4821e-02, -2.3770e-04, -1.0840e-01,  ...,  4.7852e-02,
          -6.9458e-02, -7.9285e-02],
         [-8.9264e-03,  8.1482e-03, -2.1378e-02,  ...,  1.6174e-03,
          -2.0237e-03, -2.9850e-03]],

        ...,

        [[ 1.6739e-02,  1.8274e-01,  6.5125e-02,  ...,  8.4717e-02,
           2.3389e-01, -4.8035e-02],
         [ 1.5434e-02, -1.0193e-02, -3.9062e-03,  ..., -5.4598e-04,
           5.6572e-03, -3.1319e-03],
         [ 2.9022e-02,  2.0093e-01,  5.9967e-02,  ...,  2.1875e-01,
          -1.6150e-01,  2.2791e-01],
         ...,
         [-2.1698e-02, -8.5510e-02, -1.5540e-01,  ..., -1.5552e-01,
          -3.2715e-02,  8.8379e-02],
         [-2.4887e-02,  5.8222e-04, -7.6843e-02,  ...,  3.2928e-02,
          -4.8126e-02, -5.2948e-02],
         [-5.6686e-03,  5.6343e-03, -1.5030e-02,  ...,  1.7796e-03,
          -2.0676e-03, -1.3123e-03]],

        [[ 1.7319e-02,  1.8359e-01,  6.5674e-02,  ...,  8.5815e-02,
           2.3572e-01, -4.8187e-02],
         [ 2.2476e-02, -1.9852e-02, -8.6517e-03,  ..., -4.4746e-03,
           1.2466e-02, -8.2169e-03],
         [ 2.8854e-02,  2.0105e-01,  6.0822e-02,  ...,  2.1997e-01,
          -1.6028e-01,  2.2742e-01],
         ...,
         [-2.0386e-02, -7.9590e-02, -1.4490e-01,  ..., -1.4453e-01,
          -3.1158e-02,  8.1787e-02],
         [-2.2629e-02,  7.7057e-04, -6.9702e-02,  ...,  2.9541e-02,
          -4.3304e-02, -4.6936e-02],
         [-4.7035e-03,  4.8714e-03, -1.3130e-02,  ...,  1.8215e-03,
          -2.0809e-03, -8.1491e-04]],

        [[ 1.7563e-02,  1.8335e-01,  6.5674e-02,  ...,  8.6060e-02,
           2.3560e-01, -4.8065e-02],
         [ 2.4551e-02, -2.2705e-02, -1.0048e-02,  ..., -5.6114e-03,
           1.4458e-02, -9.6893e-03],
         [ 2.8824e-02,  2.0093e-01,  6.0913e-02,  ...,  2.2009e-01,
          -1.6016e-01,  2.2729e-01],
         ...,
         [-1.9531e-02, -7.5562e-02, -1.3757e-01,  ..., -1.3708e-01,
          -3.0151e-02,  7.7271e-02],
         [-2.2003e-02,  8.3160e-04, -6.7688e-02,  ...,  2.8549e-02,
          -4.1901e-02, -4.5227e-02],
         [-3.6926e-03,  4.1199e-03, -1.1192e-02,  ...,  1.8816e-03,
          -2.0962e-03, -2.9898e-04]]], device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[-1.1505e-01,  3.9825e-02, -3.8013e-01,  ...,  8.6121e-02,
            2.3682e-01,  9.5642e-02],
          [ 2.2913e-01,  8.9493e-03, -1.8713e-01,  ..., -2.7222e-01,
           -2.3926e-01,  1.7029e-01],
          [ 1.5137e-01, -3.0054e-01, -2.5562e-01,  ..., -2.2302e-01,
            3.2227e-02,  1.3611e-01],
          ...,
          [-2.6392e-01,  7.0229e-03,  2.3865e-01,  ..., -2.7734e-01,
            1.0948e-02, -2.5732e-01],
          [ 6.9031e-02,  1.6687e-01, -1.8628e-01,  ...,  5.0751e-02,
           -1.7004e-01, -2.5806e-01],
          [-3.0289e-02,  1.5076e-01, -1.9055e-01,  ...,  1.7432e-01,
           -1.1237e-01, -1.8173e-02]],

         [[ 1.5996e+00,  2.6270e-01,  1.2090e+00,  ..., -2.4551e+00,
           -6.3965e-01, -2.5625e+00],
          [-5.0684e-01,  8.6670e-01, -3.1403e-02,  ..., -7.2803e-01,
            1.9058e-02, -1.3203e+00],
          [-4.8486e-01,  1.8301e+00,  5.8838e-01,  ...,  5.9570e-01,
           -3.3008e-01, -9.9268e-01],
          ...,
          [ 8.1836e-01, -1.4463e+00, -1.3857e+00,  ...,  2.8369e-01,
           -1.1650e+00,  3.1372e-01],
          [ 5.0781e-01, -1.0439e+00,  2.6260e-02,  ..., -1.9170e+00,
            1.1309e+00, -3.2153e-01],
          [ 4.0869e-01, -1.5293e+00, -1.4514e-01,  ..., -2.1411e-01,
            1.4385e+00,  2.4146e-01]],

         [[ 1.0947e+00,  3.1445e-01,  1.2002e+00,  ..., -2.4961e+00,
           -6.3965e-01, -2.6016e+00],
          [-3.5449e-01,  7.8906e-01,  4.2664e-02,  ..., -7.5537e-01,
           -2.0618e-03, -1.3213e+00],
          [-4.9463e-01,  1.6826e+00,  6.9678e-01,  ...,  1.6260e-01,
           -4.8560e-01, -9.3701e-01],
          ...,
          [ 1.0938e+00, -1.7910e+00, -1.4854e+00,  ...,  7.6843e-02,
           -1.1260e+00,  5.5298e-02],
          [ 5.0098e-01, -1.1484e+00,  3.6572e-01,  ..., -1.9727e+00,
            1.2158e+00, -3.3154e-01],
          [ 4.1040e-01, -1.1230e+00, -1.9836e-01,  ...,  1.3770e-01,
            1.7080e+00,  4.2676e-01]],

         ...,

         [[ 9.7559e-01,  4.0649e-01,  1.2168e+00,  ..., -2.6426e+00,
           -7.2656e-01, -2.7461e+00],
          [-3.3862e-01,  8.7109e-01,  9.2834e-02,  ..., -7.6807e-01,
            7.3730e-02, -1.2607e+00],
          [-5.8789e-01,  1.6465e+00,  6.0303e-01,  ...,  6.4507e-03,
           -5.7324e-01, -1.0430e+00],
          ...,
          [ 1.1787e+00, -2.0820e+00, -1.2529e+00,  ...,  3.4973e-02,
           -9.7754e-01, -1.3330e-01],
          [ 5.4150e-01, -1.3154e+00,  5.7227e-01,  ..., -2.1895e+00,
            1.1953e+00, -2.6831e-01],
          [ 5.8691e-01, -8.7744e-01, -2.2388e-01,  ...,  1.7120e-02,
            1.7900e+00,  6.1523e-01]],

         [[ 1.0420e+00,  4.7998e-01,  1.2402e+00,  ..., -2.6914e+00,
           -6.8506e-01, -2.7910e+00],
          [-4.3677e-01,  9.9512e-01,  5.7373e-02,  ..., -7.9590e-01,
            1.0004e-01, -1.2676e+00],
          [-6.0352e-01,  1.4736e+00,  5.6396e-01,  ..., -9.7229e-02,
           -5.9668e-01, -1.0645e+00],
          ...,
          [ 1.3262e+00, -2.1836e+00, -1.0723e+00,  ...,  8.0200e-02,
           -9.9219e-01, -9.1614e-02],
          [ 4.9756e-01, -1.2646e+00,  5.0244e-01,  ..., -2.2480e+00,
            1.1992e+00, -2.5977e-01],
          [ 5.0049e-01, -8.0371e-01, -2.6099e-01,  ...,  5.1178e-02,
            1.7520e+00,  6.2646e-01]],

         [[ 1.0254e+00,  5.7959e-01,  1.1963e+00,  ..., -2.7617e+00,
           -7.5342e-01, -2.8574e+00],
          [-4.2920e-01,  1.0605e+00,  1.3342e-01,  ..., -8.0566e-01,
            2.1164e-02, -1.2334e+00],
          [-6.4209e-01,  1.5312e+00,  5.8447e-01,  ..., -1.4819e-01,
           -6.2207e-01, -1.0576e+00],
          ...,
          [ 1.3232e+00, -2.2266e+00, -1.1309e+00,  ...,  1.0785e-01,
           -1.0527e+00, -1.2097e-01],
          [ 4.8633e-01, -1.1729e+00,  5.2881e-01,  ..., -2.3203e+00,
            1.1006e+00, -2.7539e-01],
          [ 4.8242e-01, -7.2656e-01, -3.2373e-01,  ...,  8.4656e-02,
            1.7705e+00,  7.1094e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[ 0.1793,  0.0164,  0.3718,  ...,  0.2725, -0.1724,  0.2585],
          [-0.5269, -0.0351,  0.2288,  ...,  0.0918,  0.4307, -0.1247],
          [-0.1168,  0.3740,  0.3491,  ...,  0.2317, -0.3445, -0.2722],
          ...,
          [ 0.4553,  0.0376, -0.3826,  ...,  0.4675, -0.1080,  0.3232],
          [ 0.0621, -0.4250,  0.2664,  ...,  0.5068,  0.5161,  0.8711],
          [ 0.1884, -0.2947,  0.2791,  ..., -0.4971, -0.0185,  0.1952]],

         [[-0.7344, -1.7480, -2.4590,  ...,  0.3633,  1.7031,  0.1990],
          [ 1.0508, -1.0693, -2.1328,  ..., -2.7070, -1.6299, -0.2114],
          [ 0.7842, -1.6689, -1.0498,  ..., -1.9873,  2.6602,  0.5078],
          ...,
          [-1.3848, -0.9341,  3.2598,  ..., -0.6895,  0.1186, -3.7832],
          [-0.9424, -0.8760, -2.0879,  ...,  0.6973, -2.7910, -2.5117],
          [ 0.0341,  0.2944, -0.0196,  ...,  2.0664, -0.5698, -0.5547]],

         [[-0.5557, -1.8711, -2.5762,  ...,  0.4065,  1.8447,  0.2352],
          [ 0.7368, -0.9941, -2.1934,  ..., -2.7656, -1.4893, -0.2600],
          [ 0.4521, -1.7822, -0.8291,  ..., -2.2578,  2.3066,  0.6270],
          ...,
          [-1.1943, -1.0264,  2.6504,  ..., -0.6719,  0.3572, -3.8477],
          [-0.9531, -0.5718, -1.9688,  ...,  0.7622, -2.8066, -2.5039],
          [-0.1070,  0.1995, -0.2568,  ...,  2.2637, -0.4502, -0.5967]],

         ...,

         [[-0.4966, -1.9463, -2.5625,  ...,  0.3704,  1.7744,  0.1932],
          [ 0.5474, -0.8589, -2.3184,  ..., -2.9199, -1.3291, -0.3105],
          [ 0.2374, -1.7568, -0.6963,  ..., -2.4062,  2.0723,  0.6587],
          ...,
          [-1.2969, -1.3564,  2.7246,  ..., -0.5693,  0.3120, -3.8809],
          [-0.9082, -0.4463, -2.1055,  ...,  0.7349, -2.6602, -2.6270],
          [-0.4009,  0.3032, -0.2260,  ...,  2.3145, -0.6118, -0.6074]],

         [[-0.5791, -1.9795, -2.5312,  ...,  0.3765,  1.6963,  0.1947],
          [ 0.4998, -0.8633, -2.3398,  ..., -3.0195, -1.1992, -0.3047],
          [ 0.2030, -1.7432, -0.5908,  ..., -2.5137,  2.2051,  0.5156],
          ...,
          [-1.2490, -1.5371,  2.8477,  ..., -0.4744,  0.2120, -3.8203],
          [-0.8916, -0.3740, -2.1484,  ...,  0.7402, -2.6973, -2.6719],
          [-0.4307,  0.4016, -0.2299,  ...,  2.2012, -0.7837, -0.6768]],

         [[-0.5537, -2.0000, -2.5566,  ...,  0.3955,  1.7188,  0.2124],
          [ 0.6011, -0.8560, -2.3926,  ..., -3.0879, -1.2598, -0.2164],
          [ 0.1722, -1.8076, -0.5908,  ..., -2.5156,  2.1367,  0.5557],
          ...,
          [-1.2422, -1.5410,  2.7695,  ..., -0.5640,  0.1124, -3.8027],
          [-0.9028, -0.3918, -2.0977,  ...,  0.7656, -2.6523, -2.7344],
          [-0.4658,  0.4321, -0.2208,  ...,  2.2168, -0.6831, -0.7598]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 1.6603e-03,  3.1204e-03, -2.8648e-03,  ...,  1.6999e-04,
           -3.5648e-03, -2.4910e-03],
          [-1.9588e-03,  2.1400e-03,  1.5440e-03,  ...,  4.5443e-04,
           -9.0551e-04, -4.1962e-03],
          [ 3.6430e-03, -1.0376e-03, -4.5891e-03,  ..., -9.8133e-04,
           -2.8515e-03, -1.8568e-03],
          ...,
          [-1.3428e-03, -2.5768e-03,  1.0891e-03,  ...,  2.8267e-03,
           -8.4686e-04,  2.2446e-02],
          [-8.2064e-04,  1.0786e-03,  1.8060e-05,  ..., -6.9427e-04,
            4.1733e-03, -2.3441e-03],
          [-1.1225e-03,  1.5631e-03, -7.3910e-05,  ..., -2.8849e-04,
           -5.7106e-03, -5.2404e-04]],

         [[ 4.7607e-01, -8.7051e-03, -2.3486e-01,  ...,  1.6235e-02,
            3.4009e-01,  2.0251e-01],
          [-3.0174e-03, -1.5247e-01, -5.0232e-02,  ..., -1.3318e-01,
            1.9080e-01, -7.5195e-02],
          [ 3.7622e-01, -2.2461e-01, -8.0139e-02,  ...,  1.2372e-01,
            1.5625e-01, -3.4149e-02],
          ...,
          [ 1.7227e-02, -7.8979e-02, -1.1969e-01,  ...,  1.2311e-01,
           -1.1826e-02, -5.2344e-01],
          [-5.7068e-02, -5.0354e-02, -1.7126e-01,  ..., -9.6985e-02,
            7.7002e-01,  1.4575e-01],
          [-5.3833e-02,  3.1689e-01,  2.2717e-01,  ..., -7.0496e-02,
            5.7159e-02, -3.0411e-02]],

         [[ 3.7012e-01, -4.6082e-03, -2.8149e-01,  ...,  4.6997e-02,
            3.9258e-01,  1.1377e-01],
          [-9.8206e-02, -8.1787e-02, -4.4281e-02,  ..., -8.6975e-02,
            2.4512e-01, -1.8054e-01],
          [ 2.5977e-01, -2.1228e-01, -1.9299e-01,  ...,  1.3110e-01,
            8.5999e-02,  3.2776e-02],
          ...,
          [-2.9388e-02, -5.5176e-02, -1.2927e-01,  ...,  1.4319e-01,
            3.4760e-02, -5.3711e-01],
          [-1.2024e-01, -5.2307e-02, -1.7615e-01,  ..., -1.1639e-01,
            6.8604e-01,  1.0999e-01],
          [-1.6772e-01,  3.1226e-01,  2.4353e-01,  ..., -1.0925e-01,
           -1.5335e-03, -6.3477e-02]],

         ...,

         [[ 2.9712e-01,  5.0629e-02, -3.0420e-01,  ...,  1.1774e-01,
            5.2002e-01,  1.3489e-01],
          [-1.0590e-01, -1.6508e-03, -7.9712e-02,  ..., -4.9866e-02,
            2.6440e-01, -2.4988e-01],
          [ 2.8247e-01, -2.4231e-01, -1.7029e-01,  ...,  8.6365e-02,
            1.0693e-01, -1.8692e-02],
          ...,
          [-4.3259e-03, -4.2084e-02, -1.1487e-01,  ...,  1.7468e-01,
            2.1591e-02, -4.8218e-01],
          [-1.2842e-01, -6.3293e-02, -2.0886e-01,  ..., -9.2346e-02,
            6.3623e-01,  1.2402e-01],
          [-2.3059e-01,  2.6050e-01,  2.2498e-01,  ..., -1.7651e-01,
           -3.3173e-02, -5.4688e-02]],

         [[ 3.3276e-01,  6.9702e-02, -3.3667e-01,  ...,  1.3733e-01,
            5.4199e-01,  7.9590e-02],
          [-1.1841e-01,  1.4877e-02, -5.7526e-02,  ..., -3.8757e-02,
            2.6343e-01, -2.4988e-01],
          [ 3.0151e-01, -2.5537e-01, -1.8848e-01,  ...,  7.5012e-02,
            8.8562e-02, -9.4147e-03],
          ...,
          [-9.0179e-03, -3.7598e-02, -1.0577e-01,  ...,  1.6357e-01,
            2.4918e-02, -4.8804e-01],
          [-1.4111e-01, -4.4952e-02, -1.9714e-01,  ..., -9.7168e-02,
            6.3721e-01,  1.2634e-01],
          [-2.7832e-01,  2.6538e-01,  2.1240e-01,  ..., -2.0667e-01,
           -4.1351e-02, -3.3966e-02]],

         [[ 3.0518e-01,  4.1962e-02, -2.9883e-01,  ...,  1.3452e-01,
            5.5859e-01,  5.7037e-02],
          [-8.7952e-02,  1.5778e-02, -6.7322e-02,  ..., -2.5848e-02,
            2.7466e-01, -2.4146e-01],
          [ 2.7368e-01, -2.4585e-01, -2.2778e-01,  ...,  8.0750e-02,
            8.6304e-02, -4.2229e-03],
          ...,
          [-1.8188e-02, -2.6535e-02, -1.0114e-01,  ...,  1.6931e-01,
            3.5309e-02, -4.9707e-01],
          [-1.6101e-01, -7.9163e-02, -1.6663e-01,  ..., -9.1064e-02,
            5.9912e-01,  1.2659e-01],
          [-2.8394e-01,  2.6514e-01,  2.0117e-01,  ..., -2.2351e-01,
           -4.3518e-02, -5.6915e-02]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[ 3.3716e-01,  2.3758e-02, -2.8931e-01,  ...,  8.9844e-02,
           4.6411e-01,  1.1340e-01],
         [-9.2590e-02, -3.6713e-02, -6.1584e-02,  ..., -6.7505e-02,
           2.4915e-01, -2.0581e-01],
         [ 2.8271e-01, -2.3010e-01, -1.7444e-01,  ...,  9.9487e-02,
           9.3018e-02, -3.7823e-03],
         ...,
         [-1.1276e-02, -4.9316e-02, -1.1670e-01,  ...,  1.5686e-01,
           2.3041e-02, -5.0244e-01],
         [-1.2805e-01, -5.9662e-02, -1.8652e-01,  ..., -9.7168e-02,
           6.5088e-01,  1.2140e-01],
         [-2.0129e-01,  2.7979e-01,  2.1790e-01,  ..., -1.5210e-01,
          -1.6998e-02, -4.9438e-02]],

        [[ 9.0698e-02,  9.0027e-03, -7.8796e-02,  ...,  2.4094e-02,
           1.2054e-01,  2.8656e-02],
         [-3.8025e-02, -8.0185e-03, -2.2537e-02,  ..., -2.2369e-02,
           9.4177e-02, -8.3618e-02],
         [ 9.8343e-03, -5.9814e-03, -8.1100e-03,  ...,  1.2426e-03,
          -6.7139e-04, -1.9398e-03],
         ...,
         [-4.4250e-03, -1.3618e-02, -2.9724e-02,  ...,  4.5624e-02,
           6.4964e-03, -1.1670e-01],
         [-2.2984e-03,  3.6240e-04, -2.1973e-03,  ..., -1.8492e-03,
           1.1948e-02, -8.6308e-04],
         [-1.9608e-02,  2.8610e-02,  2.1042e-02,  ..., -1.4374e-02,
          -6.4468e-03, -5.2261e-03]],

        [[ 1.2128e-01,  1.1139e-02, -1.0480e-01,  ...,  3.2379e-02,
           1.6321e-01,  3.9307e-02],
         [-6.2561e-02, -1.4236e-02, -3.8727e-02,  ..., -3.7323e-02,
           1.5820e-01, -1.3745e-01],
         [ 1.1795e-02, -7.5798e-03, -9.2850e-03,  ...,  1.9398e-03,
           5.0664e-06, -1.9588e-03],
         ...,
         [-8.7814e-03, -2.8870e-02, -7.2449e-02,  ...,  1.0492e-01,
           1.6754e-02, -3.0933e-01],
         [-3.3722e-03, -1.5879e-04, -3.8071e-03,  ..., -2.6875e-03,
           1.7593e-02,  2.1434e-04],
         [-2.5299e-02,  3.6438e-02,  2.7191e-02,  ..., -1.8661e-02,
          -6.8130e-03, -6.6376e-03]],

        ...,

        [[ 1.0486e-01,  9.9258e-03, -9.0393e-02,  ...,  2.7679e-02,
           1.3953e-01,  3.3661e-02],
         [-7.0374e-02, -1.5823e-02, -4.4037e-02,  ..., -4.1901e-02,
           1.7896e-01, -1.5503e-01],
         [ 1.3611e-02, -9.0561e-03, -1.0361e-02,  ...,  2.5902e-03,
           6.3705e-04, -1.9798e-03],
         ...,
         [-8.1482e-03, -2.6779e-02, -6.6528e-02,  ...,  9.6680e-02,
           1.5312e-02, -2.8247e-01],
         [-4.3526e-03, -6.2752e-04, -5.2490e-03,  ..., -3.4370e-03,
           2.2614e-02,  1.1740e-03],
         [-2.4063e-02,  3.4698e-02,  2.5833e-02,  ..., -1.7715e-02,
          -6.7558e-03, -6.3400e-03]],

        [[ 1.0510e-01,  9.9640e-03, -9.0637e-02,  ...,  2.7786e-02,
           1.4001e-01,  3.3722e-02],
         [-7.3059e-02, -1.6266e-02, -4.5868e-02,  ..., -4.3427e-02,
           1.8616e-01, -1.6125e-01],
         [ 1.4862e-02, -1.0071e-02, -1.1093e-02,  ...,  3.0365e-03,
           1.0710e-03, -1.9932e-03],
         ...,
         [-7.1144e-03, -2.2995e-02, -5.6152e-02,  ...,  8.2458e-02,
           1.2878e-02, -2.3596e-01],
         [-4.7722e-03, -8.2874e-04, -5.8670e-03,  ..., -3.7556e-03,
           2.4750e-02,  1.5831e-03],
         [-2.6138e-02,  3.7506e-02,  2.8030e-02,  ..., -1.9272e-02,
          -6.8970e-03, -6.8474e-03]],

        [[ 1.1285e-01,  1.0536e-02, -9.7290e-02,  ...,  2.9922e-02,
           1.5088e-01,  3.6438e-02],
         [-7.3669e-02, -1.6556e-02, -4.6295e-02,  ..., -4.3884e-02,
           1.8787e-01, -1.6260e-01],
         [ 1.5266e-02, -1.0391e-02, -1.1322e-02,  ...,  3.1776e-03,
           1.2150e-03, -2.0008e-03],
         ...,
         [-7.2670e-03, -2.3605e-02, -5.7861e-02,  ...,  8.4839e-02,
           1.3275e-02, -2.4377e-01],
         [-5.4703e-03, -1.1654e-03, -6.9046e-03,  ..., -4.2953e-03,
           2.8381e-02,  2.2755e-03],
         [-2.7542e-02,  3.9490e-02,  2.9602e-02,  ..., -2.0340e-02,
          -6.9695e-03, -7.2021e-03]]], device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[-3.2471e-01,  6.3623e-01, -8.4473e-02,  ..., -8.5059e-01,
            2.0776e-01, -3.2080e-01],
          [-1.0312e+00,  7.1729e-01, -4.6356e-02,  ..., -4.3970e-01,
            9.2676e-01,  1.9531e-01],
          [ 5.1709e-01,  1.9763e-01,  1.1328e+00,  ...,  8.4570e-01,
            1.4236e-02, -5.5029e-01],
          ...,
          [-1.1660e+00, -5.6592e-01, -2.2986e-01,  ..., -4.3286e-01,
            4.5923e-01, -8.5547e-01],
          [ 6.0352e-01,  2.1582e-01,  7.4414e-01,  ...,  7.5378e-02,
            3.0981e-01,  8.7061e-01],
          [-1.7249e-01, -3.6768e-01,  1.7200e-01,  ...,  4.5288e-01,
            7.3633e-01,  5.6732e-02]],

         [[-1.5586e+00,  5.1611e-01,  4.4800e-01,  ..., -6.6455e-01,
           -1.0559e-02,  6.0352e-01],
          [ 2.4414e+00, -1.5088e+00,  3.6407e-02,  ..., -1.8701e+00,
           -6.2305e-01,  5.2872e-03],
          [-4.9902e-01,  4.3457e-01, -1.5225e+00,  ...,  1.5564e-01,
            5.4962e-02,  8.3130e-02],
          ...,
          [ 1.8574e+00,  1.1494e+00, -5.9766e-01,  ...,  3.0957e+00,
           -5.5420e-01,  7.7344e-01],
          [-9.3701e-01, -4.6387e-01, -1.2793e+00,  ..., -1.7705e+00,
            9.0283e-01, -1.6973e+00],
          [-5.9863e-01,  7.5537e-01,  3.2056e-01,  ..., -6.1963e-01,
           -7.7441e-01, -1.2939e-01]],

         [[-1.5518e+00,  2.9639e-01,  5.6934e-01,  ..., -6.9141e-01,
           -1.3489e-01,  5.8447e-01],
          [ 2.1992e+00, -1.2246e+00,  8.8989e-02,  ..., -1.9131e+00,
           -4.6558e-01,  1.9409e-01],
          [-8.3984e-01,  6.4795e-01, -1.5684e+00,  ...,  4.1992e-01,
           -9.3750e-02, -7.4482e-04],
          ...,
          [ 2.1895e+00,  1.1963e+00, -5.8740e-01,  ...,  2.7324e+00,
           -7.7197e-01,  1.2559e+00],
          [-1.1543e+00, -6.1426e-01, -1.4512e+00,  ..., -1.9629e+00,
            8.3496e-01, -1.6768e+00],
          [-8.5986e-01,  1.1855e+00,  2.7734e-01,  ..., -7.3291e-01,
           -8.1689e-01, -3.0835e-01]],

         ...,

         [[-1.2998e+00, -1.7288e-02,  3.6084e-01,  ..., -8.3398e-01,
           -2.1143e-01,  7.4609e-01],
          [ 2.1562e+00, -1.0859e+00, -2.2852e-01,  ..., -2.0977e+00,
           -4.1211e-01,  1.7004e-01],
          [-9.9268e-01,  5.3174e-01, -1.5781e+00,  ...,  4.6069e-01,
           -2.3792e-01,  2.5854e-01],
          ...,
          [ 2.0762e+00,  1.1631e+00, -4.9487e-01,  ...,  2.7344e+00,
           -6.0254e-01,  1.1260e+00],
          [-1.5430e+00, -4.7852e-01, -1.2959e+00,  ..., -1.7266e+00,
            1.0400e+00, -1.6611e+00],
          [-7.2510e-01,  1.3672e+00,  3.5327e-01,  ..., -7.1094e-01,
           -8.6719e-01, -1.5100e-01]],

         [[-1.2158e+00, -7.4158e-02,  3.8965e-01,  ..., -7.8467e-01,
           -2.7222e-01,  8.6377e-01],
          [ 2.2559e+00, -1.0156e+00, -1.7285e-01,  ..., -2.1934e+00,
           -3.9746e-01,  2.5879e-01],
          [-1.0547e+00,  5.4346e-01, -1.5928e+00,  ...,  5.0342e-01,
           -2.2595e-01,  4.9341e-01],
          ...,
          [ 1.9863e+00,  1.0752e+00, -4.6582e-01,  ...,  2.7148e+00,
           -6.0303e-01,  1.1689e+00],
          [-1.6123e+00, -4.2432e-01, -1.2314e+00,  ..., -1.4629e+00,
            1.1855e+00, -1.6328e+00],
          [-7.4561e-01,  1.3545e+00,  1.9434e-01,  ..., -8.3838e-01,
           -1.0811e+00, -7.4829e-02]],

         [[-1.3008e+00, -8.3008e-02,  4.4702e-01,  ..., -8.0518e-01,
           -3.8110e-01,  8.2275e-01],
          [ 2.3066e+00, -9.8145e-01, -1.7346e-01,  ..., -2.2793e+00,
           -4.7803e-01,  3.1494e-01],
          [-1.1504e+00,  6.3965e-01, -1.5459e+00,  ...,  5.4346e-01,
           -2.1155e-01,  4.2432e-01],
          ...,
          [ 2.1699e+00,  1.0674e+00, -4.5435e-01,  ...,  2.5215e+00,
           -5.9717e-01,  1.2100e+00],
          [-1.6680e+00, -5.3906e-01, -1.4121e+00,  ..., -1.6934e+00,
            1.2441e+00, -1.6787e+00],
          [-7.9297e-01,  1.4434e+00,  2.4673e-02,  ..., -8.9844e-01,
           -1.0439e+00, -1.5833e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[-2.4506e-02, -7.7832e-01, -2.8003e-01,  ...,  1.8535e+00,
           -3.1689e-01,  2.4548e-01],
          [ 9.1846e-01, -1.3367e-01,  6.0486e-02,  ...,  1.1895e+00,
           -5.0586e-01,  2.3340e-01],
          [-1.0400e+00, -4.3848e-01, -1.1143e+00,  ..., -8.3447e-01,
            6.0400e-01,  1.5947e+00],
          ...,
          [ 6.3574e-01,  7.0898e-01,  5.6934e-01,  ...,  3.6792e-01,
           -3.2715e-01,  9.9316e-01],
          [-5.3174e-01, -3.9038e-01, -7.1045e-01,  ..., -1.0000e+00,
            2.9761e-01, -1.1201e+00],
          [ 8.8672e-01,  3.1787e-01, -4.0359e-03,  ..., -9.6387e-01,
           -9.5361e-01,  1.9275e-01]],

         [[-8.7842e-01,  2.9199e+00,  3.7308e-03,  ...,  4.5142e-01,
            1.4033e+00,  6.9141e-01],
          [-1.2383e+00, -5.7031e-01,  1.6772e-01,  ...,  3.3356e-02,
            4.3457e-01, -2.8198e-02],
          [-7.7539e-01,  3.2129e-01,  3.1250e+00,  ...,  1.2012e+00,
           -2.9258e+00, -3.4863e+00],
          ...,
          [-1.3037e+00, -1.2292e-01, -2.6035e+00,  ...,  6.4697e-01,
            3.7964e-01, -1.8115e+00],
          [ 1.7930e+00, -1.9443e+00, -7.2852e-01,  ..., -5.4932e-01,
            6.5527e-01,  3.3008e-01],
          [-3.7891e+00, -4.4873e-01,  5.4346e-01,  ...,  2.2266e-01,
            1.3271e+00,  1.3047e+00]],

         [[-1.0361e+00,  2.7578e+00, -2.7283e-02,  ...,  5.1855e-01,
            1.4512e+00,  4.1260e-01],
          [-1.2881e+00, -5.6738e-01,  6.1798e-02,  ...,  1.8311e-01,
            2.2522e-01, -4.9652e-02],
          [-4.8389e-01,  2.7881e-01,  2.9004e+00,  ...,  1.4775e+00,
           -2.9883e+00, -3.5664e+00],
          ...,
          [-1.0107e+00, -2.7026e-01, -2.8008e+00,  ...,  1.2178e+00,
            4.9463e-01, -1.4160e+00],
          [ 1.4160e+00, -2.3848e+00, -4.8511e-01,  ..., -5.4102e-01,
            5.1709e-01,  1.7297e-01],
          [-3.8809e+00, -6.8799e-01,  3.9258e-01,  ..., -2.7563e-01,
            1.1348e+00,  1.1621e+00]],

         ...,

         [[-8.7012e-01,  3.0000e+00,  1.2274e-01,  ...,  5.3662e-01,
            1.4971e+00,  3.2324e-01],
          [-1.3916e+00, -6.3818e-01, -2.5879e-01,  ...,  1.7029e-01,
            9.8755e-02,  6.1432e-02],
          [-5.6055e-01,  2.9614e-01,  2.5469e+00,  ...,  1.3232e+00,
           -3.1836e+00, -3.3145e+00],
          ...,
          [-7.5928e-01, -4.6240e-01, -3.0176e+00,  ...,  1.3867e+00,
            7.9297e-01, -1.3926e+00],
          [ 1.3623e+00, -2.7031e+00, -1.6028e-01,  ..., -6.3037e-01,
            4.0430e-01,  6.5117e-03],
          [-4.0469e+00, -8.3057e-01,  1.6162e-01,  ..., -3.3374e-01,
            9.7803e-01,  1.1943e+00]],

         [[-8.7939e-01,  3.1777e+00,  7.7148e-02,  ...,  6.1230e-01,
            1.5566e+00,  2.8491e-01],
          [-1.4443e+00, -6.7480e-01, -4.3286e-01,  ...,  1.6980e-01,
            2.9297e-02,  9.4299e-02],
          [-5.1514e-01,  3.0225e-01,  2.4863e+00,  ...,  1.1055e+00,
           -3.2559e+00, -3.2559e+00],
          ...,
          [-7.4609e-01, -5.3662e-01, -3.1270e+00,  ...,  1.4336e+00,
            7.9932e-01, -1.3379e+00],
          [ 1.3398e+00, -2.8066e+00,  7.7248e-04,  ..., -6.6162e-01,
            3.7549e-01, -8.2703e-02],
          [-4.1484e+00, -8.7158e-01,  2.1436e-01,  ..., -4.6558e-01,
            9.6094e-01,  1.3076e+00]],

         [[-8.7842e-01,  3.1992e+00,  7.1960e-02,  ...,  7.7100e-01,
            1.5713e+00,  2.4292e-01],
          [-1.4072e+00, -6.7236e-01, -4.3774e-01,  ...,  1.9604e-01,
           -1.1551e-02,  1.5350e-02],
          [-5.7812e-01,  3.2666e-01,  2.4512e+00,  ...,  1.2139e+00,
           -3.3301e+00, -3.3457e+00],
          ...,
          [-9.1406e-01, -7.1631e-01, -3.2344e+00,  ...,  1.4922e+00,
            7.9639e-01, -1.2314e+00],
          [ 1.2871e+00, -2.9766e+00, -5.0446e-02,  ..., -4.3066e-01,
            4.2505e-01, -1.3306e-01],
          [-4.2305e+00, -8.5059e-01,  1.4844e-01,  ..., -6.2988e-01,
            9.0332e-01,  1.3232e+00]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[-8.1956e-05,  1.6804e-03, -5.9586e-03,  ..., -6.6710e-04,
           -1.6003e-03,  4.8661e-04],
          [ 2.0771e-03,  3.8986e-03,  4.9591e-04,  ...,  8.3847e-03,
            7.6342e-04,  7.8278e-03],
          [ 5.8327e-03,  2.7990e-04, -4.0245e-03,  ..., -8.3313e-03,
           -3.3302e-03,  1.4496e-02],
          ...,
          [ 3.7918e-03,  6.2180e-04,  8.7976e-04,  ...,  1.6890e-03,
            5.4092e-03,  3.1376e-03],
          [-4.0269e-04,  1.8787e-04, -2.0618e-03,  ...,  2.6455e-03,
            3.0041e-03,  4.5013e-03],
          [-7.0620e-04, -3.0079e-03,  7.5817e-04,  ..., -5.7888e-04,
            2.8191e-03, -3.7956e-04]],

         [[-4.8737e-02,  7.4097e-02,  3.9246e-02,  ...,  1.5942e-01,
            3.5828e-02, -5.9082e-02],
          [ 1.2244e-01, -7.4219e-02, -1.9312e-01,  ...,  1.1932e-02,
            2.2522e-01, -1.4966e-01],
          [ 1.1664e-01,  1.2067e-01,  5.4138e-02,  ..., -1.9293e-03,
            1.3770e-01, -2.9282e-02],
          ...,
          [ 2.4475e-01,  2.5879e-01,  3.0945e-02,  ...,  2.4121e-01,
           -8.9551e-01, -4.5190e-01],
          [ 2.5342e-01, -2.1835e-02,  1.4307e-01,  ...,  1.7151e-01,
           -2.2598e-02, -2.3267e-01],
          [ 3.4863e-01, -2.9480e-02,  6.9946e-02,  ...,  1.0529e-01,
           -1.5552e-01, -2.1021e-01]],

         [[-1.1884e-01,  1.1658e-01, -3.2043e-02,  ...,  4.9255e-02,
            1.1847e-01, -6.2683e-02],
          [-7.2746e-03, -6.4392e-02, -1.0132e-01,  ...,  7.8979e-02,
            1.7749e-01, -2.8882e-01],
          [ 6.8298e-02,  1.4648e-01,  7.7637e-02,  ..., -4.4067e-02,
            1.2152e-01,  2.1561e-02],
          ...,
          [ 2.9272e-01,  1.3721e-01,  1.0962e-01,  ...,  2.2388e-01,
           -9.3213e-01, -3.9746e-01],
          [ 2.6392e-01, -5.9631e-02,  9.5703e-02,  ...,  1.8042e-01,
           -3.7506e-02, -1.9421e-01],
          [ 3.6279e-01, -3.7689e-02,  8.9844e-02,  ...,  9.4299e-02,
           -8.8562e-02, -2.3242e-01]],

         ...,

         [[-2.1460e-01,  1.5430e-01, -3.4904e-03,  ...,  3.7109e-02,
            1.6003e-01, -9.5291e-03],
          [-1.1981e-01, -1.3232e-01, -3.4027e-02,  ...,  5.8075e-02,
            1.0449e-01, -2.9028e-01],
          [ 9.7168e-02,  1.4441e-01,  1.0529e-01,  ..., -1.1176e-01,
            8.5022e-02,  1.6434e-02],
          ...,
          [ 3.3398e-01,  8.1909e-02,  6.5857e-02,  ...,  2.3486e-01,
           -8.4033e-01, -4.0259e-01],
          [ 2.7075e-01, -8.9783e-02,  8.6121e-02,  ...,  1.4246e-01,
           -5.3680e-02, -1.2549e-01],
          [ 3.1299e-01,  1.0986e-02,  1.4038e-01,  ...,  1.6357e-01,
           -3.8452e-02, -2.7075e-01]],

         [[-2.4780e-01,  1.6772e-01,  8.8425e-03,  ...,  1.1292e-02,
            1.5063e-01,  2.3590e-02],
          [-1.3452e-01, -1.2482e-01, -2.1225e-02,  ...,  4.0375e-02,
            1.4185e-01, -2.7515e-01],
          [ 1.1951e-01,  1.6602e-01,  1.0571e-01,  ..., -1.2842e-01,
            9.5825e-02,  4.5853e-03],
          ...,
          [ 3.0444e-01,  6.5796e-02,  2.8702e-02,  ...,  2.1667e-01,
           -8.2959e-01, -4.2554e-01],
          [ 2.6929e-01, -9.0576e-02,  7.8186e-02,  ...,  1.2891e-01,
           -6.5796e-02, -1.4368e-01],
          [ 3.1787e-01,  7.1030e-03,  1.3550e-01,  ...,  1.6504e-01,
           -3.8361e-02, -2.6489e-01]],

         [[-2.7344e-01,  1.9604e-01, -1.2238e-02,  ...,  1.4313e-02,
            1.3672e-01,  1.1818e-02],
          [-1.4880e-01, -1.0266e-01, -4.4983e-02,  ...,  3.3295e-02,
            1.5540e-01, -2.6440e-01],
          [ 1.2317e-01,  1.7358e-01,  9.5520e-02,  ..., -1.2463e-01,
            9.7656e-02,  1.3702e-02],
          ...,
          [ 2.8979e-01,  6.6162e-02,  3.4882e-02,  ...,  2.3730e-01,
           -8.4863e-01, -4.0796e-01],
          [ 2.4304e-01, -9.8145e-02,  8.0139e-02,  ...,  1.2952e-01,
           -7.1777e-02, -1.3916e-01],
          [ 2.9907e-01,  5.5923e-03,  1.1334e-01,  ...,  1.3477e-01,
           -4.6783e-02, -2.6221e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[-1.8359e-01,  1.4587e-01, -4.5319e-03,  ...,  4.3884e-02,
           1.2622e-01, -1.7822e-02],
         [-6.9336e-02, -9.5947e-02, -7.3914e-02,  ...,  5.4810e-02,
           1.4990e-01, -2.6465e-01],
         [ 1.0199e-01,  1.4844e-01,  8.7646e-02,  ..., -8.0566e-02,
           1.0254e-01,  1.2115e-02],
         ...,
         [ 3.0078e-01,  1.1462e-01,  6.1005e-02,  ...,  2.2583e-01,
          -8.7305e-01, -4.0283e-01],
         [ 2.6294e-01, -7.3181e-02,  9.6497e-02,  ...,  1.4978e-01,
          -5.1758e-02, -1.6382e-01],
         [ 3.3472e-01, -9.4147e-03,  1.0974e-01,  ...,  1.3379e-01,
          -7.3608e-02, -2.4609e-01]],

        [[-1.4450e-02,  1.3573e-02, -5.5580e-03,  ...,  4.6730e-03,
           8.8882e-03, -1.9817e-03],
         [-1.8406e-03, -1.5507e-03, -3.5877e-03,  ...,  1.0971e-02,
           8.9264e-03, -7.1640e-03],
         [ 2.7130e-02,  3.3905e-02,  1.7166e-02,  ..., -2.6688e-02,
           1.9211e-02,  1.4740e-02],
         ...,
         [ 1.2610e-01,  4.4189e-02,  2.6749e-02,  ...,  9.2163e-02,
          -3.5107e-01, -1.6003e-01],
         [ 9.5459e-02, -2.7634e-02,  3.2837e-02,  ...,  5.5511e-02,
          -1.7563e-02, -5.5084e-02],
         [ 1.5020e-04, -3.0155e-03,  1.0529e-03,  ..., -2.1911e-04,
           2.6455e-03, -1.0242e-03]],

        [[-9.1629e-03,  9.1629e-03, -5.7335e-03,  ...,  2.5692e-03,
           5.0011e-03, -1.0042e-03],
         [-2.6398e-03, -2.6054e-03, -4.3373e-03,  ...,  1.1467e-02,
           1.0475e-02, -1.0040e-02],
         [ 4.1199e-02,  5.6152e-02,  3.1189e-02,  ..., -3.9154e-02,
           3.3905e-02,  1.4961e-02],
         ...,
         [ 1.1951e-01,  4.0192e-02,  2.4963e-02,  ...,  8.6975e-02,
          -3.3008e-01, -1.5051e-01],
         [ 1.1877e-01, -3.4485e-02,  4.1229e-02,  ...,  6.8359e-02,
          -2.2644e-02, -6.9580e-02],
         [ 2.3246e-06, -3.0136e-03,  1.0023e-03,  ..., -2.8062e-04,
           2.6760e-03, -9.1410e-04]],

        ...,

        [[-6.5041e-03,  6.9656e-03, -5.7983e-03,  ...,  1.6155e-03,
           3.0670e-03, -5.6267e-04],
         [-3.5324e-03, -3.8509e-03, -5.2643e-03,  ...,  1.2039e-02,
           1.2329e-02, -1.3420e-02],
         [ 4.8981e-02,  6.8237e-02,  3.8757e-02,  ..., -4.5471e-02,
           4.2236e-02,  1.4885e-02],
         ...,
         [ 1.2372e-01,  4.1656e-02,  2.5681e-02,  ...,  9.0088e-02,
          -3.4204e-01, -1.5625e-01],
         [ 1.1566e-01, -3.3752e-02,  4.0039e-02,  ...,  6.6467e-02,
          -2.2049e-02, -6.7383e-02],
         [ 1.3626e-04, -3.0155e-03,  1.0481e-03,  ..., -2.2435e-04,
           2.6474e-03, -1.0147e-03]],

        [[-5.4512e-03,  6.0959e-03, -5.8174e-03,  ...,  1.2474e-03,
           2.2945e-03, -3.8815e-04],
         [-3.9368e-03, -4.3373e-03, -5.5656e-03,  ...,  1.2245e-02,
           1.3000e-02, -1.4709e-02],
         [ 4.9225e-02,  6.8542e-02,  3.8971e-02,  ..., -4.5776e-02,
           4.2358e-02,  1.4839e-02],
         ...,
         [ 1.1920e-01,  4.0100e-02,  2.4719e-02,  ...,  8.6792e-02,
          -3.2886e-01, -1.5027e-01],
         [ 1.1151e-01, -3.2745e-02,  3.8391e-02,  ...,  6.4026e-02,
          -2.1301e-02, -6.4575e-02],
         [ 1.7345e-04, -3.0136e-03,  1.0624e-03,  ..., -2.0695e-04,
           2.6417e-03, -1.0452e-03]],

        [[-5.7030e-03,  6.2943e-03, -5.8174e-03,  ...,  1.3075e-03,
           2.4700e-03, -4.1270e-04],
         [-4.0359e-03, -4.5013e-03, -5.6992e-03,  ...,  1.2321e-02,
           1.3260e-02, -1.5152e-02],
         [ 5.2612e-02,  7.3792e-02,  4.2236e-02,  ..., -4.8645e-02,
           4.5898e-02,  1.4816e-02],
         ...,
         [ 1.1896e-01,  3.9948e-02,  2.4582e-02,  ...,  8.6670e-02,
          -3.2812e-01, -1.5002e-01],
         [ 1.0535e-01, -3.0884e-02,  3.6224e-02,  ...,  6.0699e-02,
          -1.9958e-02, -6.0913e-02],
         [ 1.1259e-04, -3.0136e-03,  1.0414e-03,  ..., -2.3258e-04,
           2.6550e-03, -9.9945e-04]]], device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[ 0.3286, -0.3809,  0.2703,  ..., -0.1987,  0.2534,  0.2542],
          [-0.5015, -0.4023,  0.5864,  ..., -0.2781, -0.3789,  0.4458],
          [ 0.3230,  0.3721, -0.2445,  ...,  0.0109, -0.0108, -0.4761],
          ...,
          [ 0.1180, -0.1962, -0.6240,  ..., -0.4224, -0.2310, -0.1293],
          [ 0.4768, -0.5430,  0.3606,  ...,  0.2856, -0.1379, -0.2688],
          [ 0.1187,  0.1791,  0.4258,  ..., -0.3992,  0.2563, -0.3069]],

         [[-1.3916,  0.7310, -0.6113,  ...,  0.3984, -1.8926,  0.3386],
          [-0.1234,  0.5498, -2.4902,  ..., -0.7715,  0.0102, -0.4565],
          [-0.1997,  1.1973, -0.0037,  ...,  0.2625, -2.4980,  1.4131],
          ...,
          [-2.4531, -1.0283, -0.9897,  ...,  0.3484,  1.4150, -0.6333],
          [-1.0254,  1.1689, -1.1523,  ..., -1.2295,  1.0664,  1.3906],
          [ 1.9424, -0.0256, -0.7715,  ...,  0.1814, -1.3467, -1.6758]],

         [[-1.3379,  0.5737, -0.4810,  ...,  0.6909, -1.6035,  0.2673],
          [-0.1815,  0.8711, -2.5293,  ..., -0.8115, -0.0670, -0.7764],
          [ 0.1132,  1.2305, -0.0139,  ...,  0.2437, -2.7656,  1.4902],
          ...,
          [-2.4238, -0.9624, -1.3486,  ...,  0.4673,  1.6660, -0.7939],
          [-1.1807,  1.2588, -1.0371,  ..., -1.4062,  1.0645,  1.7246],
          [ 1.9424,  0.2805, -0.5894,  ..., -0.0459, -1.1016, -1.4492]],

         ...,

         [[-1.0732,  0.2563, -0.5264,  ...,  0.6694, -1.4219,  0.2805],
          [-0.1998,  1.2461, -2.3320,  ..., -1.0156, -0.1748, -0.6963],
          [ 0.3074,  1.1514, -0.2925,  ...,  0.8652, -3.0137,  1.0703],
          ...,
          [-2.6016, -0.8589, -1.5967,  ...,  0.4917,  1.6924, -0.8428],
          [-1.3652,  1.1211, -0.8091,  ..., -1.2666,  1.0039,  1.8252],
          [ 2.4355,  0.4463, -0.5601,  ..., -0.2405, -1.0166, -1.5781]],

         [[-1.0938,  0.0398, -0.5146,  ...,  0.6313, -1.4219,  0.2405],
          [-0.1858,  1.3799, -2.4258,  ..., -0.9536, -0.1333, -0.6738],
          [ 0.6094,  1.0684, -0.3635,  ...,  1.0303, -3.1777,  0.7319],
          ...,
          [-2.6348, -0.7896, -1.4971,  ...,  0.5469,  1.6631, -0.8906],
          [-1.4336,  1.0273, -0.8477,  ..., -1.2637,  1.1084,  1.8711],
          [ 2.5371,  0.4185, -0.5107,  ..., -0.3743, -1.0908, -1.6104]],

         [[-1.1787, -0.0862, -0.3972,  ...,  0.6699, -1.4590,  0.2927],
          [-0.2247,  1.4082, -2.4844,  ..., -1.0303, -0.0845, -0.6675],
          [ 0.5938,  1.0645, -0.3113,  ...,  0.8604, -3.2305,  0.8140],
          ...,
          [-2.6504, -0.8052, -1.4395,  ...,  0.4436,  1.5859, -1.0537],
          [-1.4160,  1.0693, -0.8647,  ..., -1.3271,  1.1494,  1.8643],
          [ 2.5566,  0.5312, -0.4272,  ..., -0.5425, -1.0166, -1.6357]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[-8.0908e-01,  8.9355e-01, -3.2666e-01,  ...,  7.2070e-01,
           -5.8398e-01, -3.0298e-01],
          [ 8.1055e-01,  5.2783e-01, -5.7715e-01,  ...,  6.3818e-01,
            5.0195e-01, -7.1582e-01],
          [-6.6748e-01, -8.1836e-01,  5.5811e-01,  ..., -1.6785e-01,
            1.7383e-01,  7.1338e-01],
          ...,
          [ 6.6260e-01,  5.2686e-01,  1.0586e+00,  ...,  8.1055e-01,
            9.5947e-01,  6.0596e-01],
          [-7.8809e-01,  8.6426e-01, -4.0283e-01,  ..., -8.4375e-01,
            1.8604e-01,  4.3286e-01],
          [-3.2666e-01, -4.8877e-01, -7.4561e-01,  ...,  4.2822e-01,
           -3.0469e-01,  6.4258e-01]],

         [[ 1.3877e+00, -4.1431e-01,  3.9825e-02,  ..., -1.4844e+00,
            2.1914e+00, -1.1162e+00],
          [-3.1875e+00, -2.6294e-01, -8.8257e-02,  ...,  4.1901e-02,
           -1.3311e+00,  2.3364e-01],
          [-1.2324e+00,  3.4844e+00, -1.9580e+00,  ...,  1.3594e+00,
           -6.8555e-01, -1.5215e+00],
          ...,
          [-1.2469e-01, -1.4805e+00, -2.2207e+00,  ..., -1.9756e+00,
           -1.7363e+00,  6.3916e-01],
          [ 1.1826e+00, -1.1172e+00,  1.5342e+00,  ...,  2.1406e+00,
            2.8979e-01, -2.1641e+00],
          [ 2.2437e-01,  3.1934e-01,  1.7002e+00,  ..., -1.3574e+00,
            4.0942e-01, -1.2529e+00]],

         [[ 1.1797e+00, -5.9424e-01, -1.5845e-01,  ..., -1.7383e+00,
            2.2461e+00, -9.7705e-01],
          [-3.4121e+00, -1.6968e-01, -5.4321e-02,  ...,  2.4683e-01,
           -1.5254e+00,  2.4341e-01],
          [-9.6240e-01,  3.1406e+00, -1.9238e+00,  ...,  1.2129e+00,
           -6.6357e-01, -1.4688e+00],
          ...,
          [-2.4017e-02, -1.4395e+00, -2.4180e+00,  ..., -2.2129e+00,
           -1.7227e+00,  5.9473e-01],
          [ 7.1680e-01, -8.4180e-01,  1.3008e+00,  ...,  1.9277e+00,
            4.4336e-01, -1.7734e+00],
          [ 3.1030e-01,  7.7979e-01,  1.9316e+00,  ..., -1.3223e+00,
            2.8125e-01, -8.7695e-01]],

         ...,

         [[ 1.2666e+00, -7.2754e-01, -2.5464e-01,  ..., -1.6758e+00,
            2.4082e+00, -8.5547e-01],
          [-3.5352e+00,  1.6296e-01, -3.2300e-01,  ...,  3.1052e-02,
           -9.7559e-01,  3.6163e-03],
          [-9.7607e-01,  2.8691e+00, -1.8516e+00,  ...,  1.1973e+00,
           -1.0869e+00, -1.2979e+00],
          ...,
          [-1.1481e-01, -1.5674e+00, -2.4238e+00,  ..., -2.1914e+00,
           -1.6973e+00,  5.2930e-01],
          [ 5.8838e-01, -6.9824e-01,  1.2002e+00,  ...,  1.9951e+00,
            5.2002e-01, -2.0117e+00],
          [ 2.6172e-01,  9.4482e-01,  1.8857e+00,  ..., -1.3125e+00,
            2.5537e-01, -8.0518e-01]],

         [[ 1.2363e+00, -7.9297e-01, -2.6929e-01,  ..., -1.6895e+00,
            2.3340e+00, -7.6611e-01],
          [-3.5293e+00,  2.6685e-01, -2.7808e-01,  ..., -1.3391e-01,
           -8.5742e-01, -2.1763e-03],
          [-8.8770e-01,  2.8145e+00, -1.8828e+00,  ...,  1.0322e+00,
           -1.1436e+00, -1.1074e+00],
          ...,
          [-3.5370e-02, -1.5371e+00, -2.5098e+00,  ..., -2.2910e+00,
           -1.6875e+00,  5.7568e-01],
          [ 6.4258e-01, -6.2891e-01,  1.2549e+00,  ...,  2.0664e+00,
            5.5518e-01, -2.0918e+00],
          [ 2.4060e-01,  9.5215e-01,  1.9775e+00,  ..., -1.3408e+00,
            1.7944e-01, -8.2178e-01]],

         [[ 1.2598e+00, -8.6914e-01, -2.0728e-01,  ..., -1.7412e+00,
            2.2969e+00, -7.7979e-01],
          [-3.5996e+00,  3.1396e-01, -2.5586e-01,  ..., -4.2267e-03,
           -9.9658e-01,  7.9895e-02],
          [-7.5244e-01,  2.6191e+00, -1.9395e+00,  ...,  9.4873e-01,
           -1.1113e+00, -1.2832e+00],
          ...,
          [-4.4220e-02, -1.4971e+00, -2.5664e+00,  ..., -2.2598e+00,
           -1.7051e+00,  5.6445e-01],
          [ 5.6689e-01, -6.6260e-01,  1.1367e+00,  ...,  2.0117e+00,
            6.2598e-01, -2.0586e+00],
          [ 2.5513e-01,  1.0459e+00,  2.1016e+00,  ..., -1.4141e+00,
            1.4722e-01, -7.7197e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[-8.6927e-04, -5.5351e-03,  6.9542e-03,  ..., -1.2941e-03,
            8.2626e-03,  9.6512e-03],
          [-5.0116e-04,  1.8148e-03,  3.2177e-03,  ..., -7.0457e-03,
           -4.4632e-03,  2.9068e-03],
          [ 1.0635e-02, -8.4305e-03,  7.3357e-03,  ..., -9.4299e-03,
            1.3092e-02, -6.3324e-04],
          ...,
          [-3.2082e-03,  7.8735e-03, -1.3580e-03,  ...,  1.3762e-03,
           -8.1062e-05, -3.2825e-03],
          [-5.7268e-04,  3.1338e-03, -3.3665e-03,  ..., -4.9734e-04,
            8.5068e-03,  3.7289e-03],
          [ 7.5006e-04, -5.5199e-03, -3.0155e-03,  ...,  1.9035e-03,
           -4.3335e-03,  2.6321e-03]],

         [[-1.9360e-01,  1.7908e-01,  1.3049e-01,  ..., -1.4148e-01,
           -1.2659e-01,  1.4732e-02],
          [ 1.7365e-02,  3.6401e-01, -3.0127e-01,  ...,  1.6809e-01,
           -5.0598e-02,  1.6998e-02],
          [-4.6600e-02,  1.5320e-01,  1.1224e-01,  ..., -8.5510e-02,
            1.5576e-01, -8.3313e-03],
          ...,
          [ 1.3965e-01,  2.5562e-01, -2.3544e-02,  ...,  3.0556e-03,
           -3.0029e-01,  9.2529e-02],
          [ 2.1936e-01,  6.7871e-02, -5.3406e-02,  ...,  1.2805e-01,
           -6.5613e-02, -1.0321e-01],
          [-6.2378e-02, -6.0701e-04, -3.5571e-01,  ...,  1.3232e-01,
           -2.3645e-01, -2.0129e-01]],

         [[-1.7310e-01,  2.5098e-01,  1.2524e-01,  ..., -1.7700e-01,
           -1.6882e-01,  5.3894e-02],
          [ 2.8320e-02,  3.2300e-01, -2.5757e-01,  ...,  1.3367e-01,
           -9.7809e-03,  5.8960e-02],
          [-3.2379e-02,  6.0760e-02,  9.4421e-02,  ..., -1.0638e-01,
            1.5393e-01,  1.7532e-02],
          ...,
          [ 1.6113e-01,  2.6074e-01,  4.4060e-03,  ...,  4.5044e-02,
           -3.4351e-01,  7.8796e-02],
          [ 1.9934e-01,  5.3375e-02, -5.2032e-03,  ...,  5.9784e-02,
           -5.1849e-02, -6.9092e-02],
          [-4.1504e-02,  3.1525e-02, -3.2642e-01,  ...,  1.9409e-01,
           -2.0129e-01, -1.7529e-01]],

         ...,

         [[-1.7444e-01,  2.9199e-01,  1.4294e-01,  ..., -1.2927e-01,
           -1.4905e-01,  6.9458e-02],
          [-5.5389e-02,  2.9761e-01, -1.8030e-01,  ...,  7.1045e-02,
           -7.7515e-03,  2.6413e-02],
          [-9.7107e-02,  4.3457e-02,  1.2299e-01,  ..., -1.1047e-01,
            1.2988e-01,  5.6839e-03],
          ...,
          [ 1.4526e-01,  3.3081e-01,  3.4760e-02,  ...,  4.2877e-03,
           -3.0493e-01,  4.1504e-02],
          [ 2.4829e-01,  9.7534e-02, -4.1992e-02,  ...,  5.8502e-02,
           -5.9280e-03, -1.0455e-01],
          [ 2.3315e-02,  9.7847e-04, -2.8271e-01,  ...,  2.2705e-01,
           -1.9556e-01, -1.9067e-01]],

         [[-1.6748e-01,  2.7173e-01,  1.4966e-01,  ..., -1.2140e-01,
           -1.4014e-01,  7.8491e-02],
          [-6.8665e-02,  2.7856e-01, -1.8140e-01,  ...,  4.1687e-02,
           -3.4454e-02,  1.8005e-02],
          [-8.8440e-02,  4.9530e-02,  1.1011e-01,  ..., -1.1328e-01,
            1.2134e-01,  1.3817e-02],
          ...,
          [ 1.2286e-01,  3.0981e-01,  1.8646e-02,  ..., -3.4451e-04,
           -2.6929e-01,  6.5674e-02],
          [ 2.4939e-01,  1.2231e-01, -5.7281e-02,  ...,  7.0190e-02,
            2.0447e-02, -1.0565e-01],
          [ 2.0630e-02, -4.7729e-02, -2.7759e-01,  ...,  2.1851e-01,
           -2.1692e-01, -1.9617e-01]],

         [[-1.7822e-01,  2.9272e-01,  1.4319e-01,  ..., -1.5991e-01,
           -1.5515e-01,  7.7576e-02],
          [-5.6763e-02,  2.8589e-01, -1.8445e-01,  ...,  4.0009e-02,
           -4.6173e-02,  2.6703e-02],
          [-8.2153e-02,  4.3701e-02,  1.0522e-01,  ..., -1.0559e-01,
            1.1188e-01,  1.5610e-02],
          ...,
          [ 1.1603e-01,  3.1177e-01,  3.2562e-02,  ...,  2.7954e-02,
           -2.5293e-01,  5.1300e-02],
          [ 2.4695e-01,  1.3965e-01, -6.2683e-02,  ...,  6.2561e-02,
            3.6194e-02, -7.8247e-02],
          [ 3.2593e-02, -4.0863e-02, -2.8076e-01,  ...,  2.5415e-01,
           -2.2766e-01, -2.1863e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[-1.7554e-01,  2.6465e-01,  1.3977e-01,  ..., -1.4856e-01,
          -1.5234e-01,  5.7556e-02],
         [-1.7136e-02,  3.1030e-01, -2.1436e-01,  ...,  1.0077e-01,
          -3.0563e-02,  3.0106e-02],
         [-6.9580e-02,  6.3477e-02,  1.1060e-01,  ..., -1.0309e-01,
           1.3770e-01,  1.0361e-02],
         ...,
         [ 1.3770e-01,  2.9688e-01,  1.4893e-02,  ...,  1.9684e-02,
          -3.0078e-01,  6.4514e-02],
         [ 2.2900e-01,  9.4727e-02, -4.0314e-02,  ...,  6.7139e-02,
          -1.2016e-02, -8.9661e-02],
         [-3.4046e-04, -5.0850e-03, -3.0029e-01,  ...,  2.0740e-01,
          -2.0752e-01, -1.9482e-01]],

        [[-1.1955e-02,  1.2039e-02,  1.5503e-02,  ..., -1.0658e-02,
          -2.0428e-03,  1.2886e-02],
         [-1.6861e-02,  2.0190e-01, -1.3403e-01,  ...,  5.7953e-02,
          -2.1103e-02,  2.0218e-02],
         [-6.3049e-02,  4.6936e-02,  9.6741e-02,  ..., -9.1370e-02,
           1.1676e-01,  9.6283e-03],
         ...,
         [-1.7576e-03,  1.0933e-02, -1.1501e-03,  ...,  1.5602e-03,
          -3.1815e-03, -2.6093e-03],
         [ 7.1239e-04,  3.6545e-03, -3.5763e-03,  ..., -1.3041e-04,
           8.4076e-03,  3.2082e-03],
         [ 6.9261e-05, -5.4169e-03, -3.0609e-02,  ...,  1.9852e-02,
          -2.3056e-02, -1.5358e-02]],

        [[-1.0750e-02,  1.0162e-02,  1.4580e-02,  ..., -9.6436e-03,
          -9.2745e-04,  1.2558e-02],
         [-2.1225e-02,  2.2485e-01, -1.4819e-01,  ...,  6.3232e-02,
          -2.2949e-02,  2.2064e-02],
         [-6.7688e-02,  4.9957e-02,  1.0229e-01,  ..., -9.6741e-02,
           1.2317e-01,  1.0452e-02],
         ...,
         [-2.0390e-03,  1.0353e-02, -1.1873e-03,  ...,  1.5249e-03,
          -2.5826e-03, -2.7409e-03],
         [ 3.7456e-04,  3.5191e-03, -3.5210e-03,  ..., -2.2912e-04,
           8.4381e-03,  3.3455e-03],
         [ 1.4460e-04, -5.4131e-03, -2.3849e-02,  ...,  1.5320e-02,
          -1.8448e-02, -1.0902e-02]],

        ...,

        [[-1.0353e-02,  9.4910e-03,  1.4259e-02,  ..., -9.3079e-03,
          -5.5122e-04,  1.2428e-02],
         [-2.2293e-02,  2.3206e-01, -1.5308e-01,  ...,  6.5125e-02,
          -2.3636e-02,  2.2598e-02],
         [-7.1167e-02,  5.2460e-02,  1.0657e-01,  ..., -1.0071e-01,
           1.2830e-01,  1.0979e-02],
         ...,
         [-2.1420e-03,  1.0132e-02, -1.2016e-03,  ...,  1.5125e-03,
          -2.3613e-03, -2.7905e-03],
         [ 2.0981e-04,  3.4542e-03, -3.4943e-03,  ..., -2.7633e-04,
           8.4534e-03,  3.4122e-03],
         [ 7.2658e-05, -5.3635e-03, -2.3102e-02,  ...,  1.4694e-02,
          -1.7899e-02, -1.0353e-02]],

        [[-1.1192e-02,  1.0841e-02,  1.4915e-02,  ..., -1.0017e-02,
          -1.3332e-03,  1.2680e-02],
         [-2.2064e-02,  2.3279e-01, -1.5381e-01,  ...,  6.5613e-02,
          -2.3727e-02,  2.2675e-02],
         [-7.1838e-02,  5.2032e-02,  1.0687e-01,  ..., -1.0107e-01,
           1.2817e-01,  1.1101e-02],
         ...,
         [-2.2907e-03,  9.8190e-03, -1.2226e-03,  ...,  1.4925e-03,
          -2.0428e-03, -2.8591e-03],
         [ 2.6345e-04,  3.4771e-03, -3.5038e-03,  ..., -2.6226e-04,
           8.4534e-03,  3.3913e-03],
         [ 9.4473e-05, -5.3673e-03, -2.2552e-02,  ...,  1.4351e-02,
          -1.7532e-02, -1.0002e-02]],

        [[-1.1780e-02,  1.1772e-02,  1.5366e-02,  ..., -1.0506e-02,
          -1.8711e-03,  1.2863e-02],
         [-2.2675e-02,  2.3303e-01, -1.5369e-01,  ...,  6.5186e-02,
          -2.3773e-02,  2.2629e-02],
         [-7.1472e-02,  5.1910e-02,  1.0632e-01,  ..., -1.0065e-01,
           1.2744e-01,  1.1024e-02],
         ...,
         [-2.2697e-03,  9.8648e-03, -1.2188e-03,  ...,  1.4954e-03,
          -2.0866e-03, -2.8496e-03],
         [ 3.3832e-04,  3.5076e-03, -3.5152e-03,  ..., -2.4128e-04,
           8.4457e-03,  3.3607e-03],
         [ 8.5235e-05, -5.3787e-03, -2.3727e-02,  ...,  1.5137e-02,
          -1.8341e-02, -1.0773e-02]]], device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[ 7.5879e-01,  4.3481e-01, -1.0508e+00,  ..., -1.3525e+00,
           -8.9697e-01,  8.6621e-01],
          [-2.7417e-01, -3.7646e-01,  9.8511e-02,  ..., -2.0203e-01,
           -2.2119e-01, -1.1123e+00],
          [-3.3154e-01,  1.4658e+00, -1.7158e+00,  ..., -1.4075e-01,
           -9.8633e-01,  9.0869e-01],
          ...,
          [ 1.6250e+00, -2.3291e-01,  1.2354e+00,  ...,  7.5879e-01,
           -1.1709e+00,  8.8574e-01],
          [ 1.0225e+00,  9.6191e-01,  1.5967e+00,  ...,  6.8213e-01,
            9.2529e-01,  9.4043e-01],
          [-4.6802e-01, -2.8828e+00, -3.9575e-01,  ...,  1.1982e+00,
           -2.8638e-01, -3.3350e-01]],

         [[-2.2988e+00, -1.7520e+00,  2.0312e+00,  ...,  7.2559e-01,
            6.0791e-01, -2.3279e-01],
          [ 2.3066e+00,  1.1465e+00,  2.8839e-03,  ..., -8.6084e-01,
            3.7280e-01,  1.1875e+00],
          [ 2.6172e+00, -1.0850e+00, -1.5955e-01,  ..., -8.5693e-01,
            9.6289e-01, -2.8652e+00],
          ...,
          [-1.0234e+00, -1.4639e+00, -7.8027e-01,  ..., -1.6826e+00,
            1.4297e+00, -1.2539e+00],
          [-7.3926e-01, -1.6562e+00,  7.0152e-03,  ..., -1.5625e+00,
           -1.5391e+00, -1.7227e+00],
          [ 2.2656e+00,  2.4160e+00, -3.5370e-02,  ...,  1.5149e-01,
            1.2002e+00,  7.4072e-01]],

         [[-2.3340e+00, -1.4209e+00,  2.2754e+00,  ...,  1.3086e+00,
            9.1699e-01, -5.2051e-01],
          [ 2.3320e+00,  1.0977e+00, -4.2229e-03,  ..., -8.8818e-01,
            4.4702e-01,  1.1299e+00],
          [ 2.8320e+00, -7.7393e-01, -1.4929e-01,  ..., -1.0049e+00,
            1.2695e+00, -2.8398e+00],
          ...,
          [-9.3408e-01, -1.4053e+00, -8.4814e-01,  ..., -1.8047e+00,
            1.2754e+00, -1.4668e+00],
          [-6.0938e-01, -1.8057e+00, -3.1958e-01,  ..., -1.5918e+00,
           -1.9482e+00, -1.8525e+00],
          [ 2.4082e+00,  2.6445e+00, -4.2999e-02,  ...,  1.7432e-01,
            1.0049e+00,  8.1201e-01]],

         ...,

         [[-2.7168e+00, -1.6738e+00,  2.2070e+00,  ...,  1.3096e+00,
            9.7998e-01, -7.6123e-01],
          [ 2.3867e+00,  1.2334e+00,  3.2617e-01,  ..., -9.3115e-01,
            4.2969e-01,  1.1865e+00],
          [ 2.9414e+00, -7.3438e-01, -1.7944e-01,  ..., -6.8311e-01,
            1.1602e+00, -2.6328e+00],
          ...,
          [-9.4482e-01, -1.2344e+00, -5.8545e-01,  ..., -1.5459e+00,
            1.1641e+00, -1.8115e+00],
          [-5.2783e-01, -1.7754e+00, -2.6929e-01,  ..., -1.8604e+00,
           -2.1699e+00, -1.8477e+00],
          [ 2.5039e+00,  2.6855e+00,  5.5313e-03,  ...,  2.5781e-01,
            9.4092e-01,  7.5928e-01]],

         [[-2.8594e+00, -1.7773e+00,  2.0430e+00,  ...,  1.2617e+00,
            1.0156e+00, -7.5879e-01],
          [ 2.4277e+00,  1.2900e+00,  3.1519e-01,  ..., -1.0039e+00,
            4.8193e-01,  1.1777e+00],
          [ 2.9062e+00, -7.8174e-01, -1.5063e-01,  ..., -6.4893e-01,
            1.2793e+00, -2.5352e+00],
          ...,
          [-1.1455e+00, -1.1689e+00, -4.8193e-01,  ..., -1.5000e+00,
            1.0859e+00, -1.7900e+00],
          [-4.5508e-01, -1.7148e+00, -2.9272e-01,  ..., -1.8633e+00,
           -2.2676e+00, -1.9668e+00],
          [ 2.4863e+00,  2.6445e+00,  3.7048e-02,  ...,  3.0762e-01,
            1.0029e+00,  7.5049e-01]],

         [[-2.7070e+00, -1.7275e+00,  2.1523e+00,  ...,  1.4170e+00,
            9.8828e-01, -8.1006e-01],
          [ 2.4277e+00,  1.3027e+00,  4.0186e-01,  ..., -1.0176e+00,
            5.1709e-01,  1.1709e+00],
          [ 2.7773e+00, -8.6523e-01, -1.8433e-01,  ..., -7.4316e-01,
            1.3896e+00, -2.4375e+00],
          ...,
          [-1.0332e+00, -1.2051e+00, -4.0747e-01,  ..., -1.5830e+00,
            1.1133e+00, -1.6553e+00],
          [-4.8315e-01, -1.7715e+00, -2.2363e-01,  ..., -1.8184e+00,
           -2.2578e+00, -2.0410e+00],
          [ 2.5234e+00,  2.6543e+00,  4.3427e-02,  ...,  3.4717e-01,
            1.0518e+00,  8.0566e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[-6.7188e-01,  1.3125e+00,  4.8022e-01,  ...,  9.0576e-01,
            1.0664e+00, -9.5459e-01],
          [ 1.6614e-01, -1.6833e-01, -3.5986e-01,  ...,  9.2773e-01,
            8.0908e-01,  1.1133e+00],
          [ 1.0205e+00, -1.2256e+00,  1.8369e+00,  ..., -2.3975e-01,
            9.3652e-01, -4.7754e-01],
          ...,
          [-1.4189e+00,  1.1172e+00, -1.3975e+00,  ..., -9.3750e-01,
            7.8174e-01, -7.9150e-01],
          [-1.4971e+00, -1.0410e+00, -4.0796e-01,  ..., -1.2783e+00,
           -5.8936e-01, -1.1445e+00],
          [ 3.9160e-01,  7.0996e-01,  2.2385e-02,  ..., -1.0889e+00,
            1.7468e-01,  1.0980e-01]],

         [[-2.8125e+00,  5.3760e-01, -1.8906e+00,  ..., -1.6631e+00,
           -1.0244e+00,  2.0117e+00],
          [-4.9609e-01,  2.2290e-01, -5.6299e-01,  ..., -1.0371e+00,
           -2.7759e-01, -1.2705e+00],
          [ 1.4004e+00,  2.5859e+00, -2.4902e+00,  ...,  4.1992e-02,
           -8.4863e-01, -1.6772e-01],
          ...,
          [ 2.5117e+00, -4.1367e+00,  8.2129e-01,  ...,  8.4766e-01,
           -3.6084e-01,  1.1738e+00],
          [ 1.7607e+00,  6.0596e-01,  1.7559e+00,  ..., -1.0762e+00,
            9.1260e-01,  1.1826e+00],
          [-4.5728e-01, -1.4951e+00,  4.0601e-01,  ...,  3.6152e+00,
           -1.5127e+00, -1.1992e+00]],

         [[-2.7852e+00,  4.0466e-02, -1.9111e+00,  ..., -1.4834e+00,
           -1.0645e+00,  1.9883e+00],
          [-5.8740e-01,  1.3171e-01, -7.0654e-01,  ..., -1.3984e+00,
           -2.7319e-01, -1.2383e+00],
          [ 1.7461e+00,  2.1543e+00, -2.2676e+00,  ..., -2.1667e-01,
           -9.2920e-01, -9.2896e-02],
          ...,
          [ 1.9482e+00, -4.1328e+00,  1.0205e+00,  ...,  6.5869e-01,
           -4.4287e-01,  1.1172e+00],
          [ 1.9404e+00,  7.9102e-01,  1.6240e+00,  ..., -7.3096e-01,
            1.1172e+00,  1.1562e+00],
          [-9.3155e-03, -1.4443e+00,  7.2412e-01,  ...,  3.6289e+00,
           -1.5088e+00, -1.1201e+00]],

         ...,

         [[-3.0801e+00, -5.7678e-02, -2.0293e+00,  ..., -1.4609e+00,
           -1.3125e+00,  2.1055e+00],
          [-5.4053e-01,  4.0601e-01, -9.0674e-01,  ..., -1.5664e+00,
           -2.7881e-01, -1.2666e+00],
          [ 1.5781e+00,  2.1387e+00, -2.3320e+00,  ..., -2.5195e-01,
           -1.0752e+00,  2.9346e-01],
          ...,
          [ 1.6465e+00, -4.4492e+00,  1.2812e+00,  ...,  5.2295e-01,
           -5.1123e-01,  9.2529e-01],
          [ 2.1973e+00,  7.5098e-01,  1.7090e+00,  ..., -3.1665e-01,
            1.2822e+00,  1.3301e+00],
          [ 1.3623e-01, -1.4531e+00,  7.0947e-01,  ...,  3.8184e+00,
           -1.3613e+00, -1.0596e+00]],

         [[-2.9961e+00,  2.3060e-03, -2.2422e+00,  ..., -1.4814e+00,
           -1.4629e+00,  2.0918e+00],
          [-4.7949e-01,  4.6606e-01, -9.9707e-01,  ..., -1.5068e+00,
           -1.5149e-01, -1.2754e+00],
          [ 1.6523e+00,  2.0332e+00, -2.3301e+00,  ..., -4.5752e-01,
           -1.0195e+00,  3.8721e-01],
          ...,
          [ 1.6816e+00, -4.5352e+00,  1.3623e+00,  ...,  5.7568e-01,
           -6.6992e-01,  8.7012e-01],
          [ 2.3105e+00,  7.5439e-01,  1.7910e+00,  ..., -2.5879e-01,
            1.3096e+00,  1.4268e+00],
          [ 2.7441e-01, -1.5225e+00,  7.2119e-01,  ...,  3.8672e+00,
           -1.3994e+00, -1.1094e+00]],

         [[-3.1309e+00, -6.8115e-02, -2.2305e+00,  ..., -1.3799e+00,
           -1.5625e+00,  2.2461e+00],
          [-4.5483e-01,  4.6362e-01, -9.3945e-01,  ..., -1.5459e+00,
           -4.6753e-02, -1.2393e+00],
          [ 1.7598e+00,  2.0215e+00, -2.2969e+00,  ..., -4.6094e-01,
           -9.4873e-01,  4.9829e-01],
          ...,
          [ 1.6416e+00, -4.5938e+00,  1.4775e+00,  ...,  6.2549e-01,
           -6.5723e-01,  7.9443e-01],
          [ 2.3262e+00,  8.1104e-01,  1.8037e+00,  ..., -2.3474e-01,
            1.3408e+00,  1.4883e+00],
          [ 2.9639e-01, -1.5938e+00,  7.4268e-01,  ...,  3.8926e+00,
           -1.4404e+00, -1.1143e+00]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 9.4986e-03, -1.6737e-04,  5.1308e-03,  ..., -6.5470e-04,
            4.1122e-03, -2.9602e-03],
          [-3.2139e-04,  1.1845e-03,  2.4185e-03,  ...,  4.4465e-04,
           -1.8677e-02, -4.3030e-03],
          [ 4.3449e-03,  6.4468e-03,  1.0490e-03,  ..., -1.2083e-03,
            3.2940e-03,  3.1872e-03],
          ...,
          [ 4.5090e-03,  9.4128e-04, -2.0218e-03,  ...,  1.3351e-03,
           -6.8779e-03,  3.9444e-03],
          [ 1.5345e-03,  7.4577e-04, -6.7291e-03,  ...,  3.0918e-03,
           -5.7030e-04,  2.4605e-03],
          [ 1.3466e-03, -2.2373e-03, -6.5079e-03,  ..., -3.0727e-03,
            1.4595e-02, -3.1967e-03]],

         [[-1.4587e-01,  1.0413e-01,  9.8389e-02,  ..., -2.5146e-01,
           -2.0065e-02, -2.3145e-01],
          [ 3.3960e-01, -5.3418e-01,  5.3009e-02,  ...,  1.8784e-02,
            4.1602e-01, -8.3557e-02],
          [ 5.7220e-02, -2.4170e-02,  3.6572e-01,  ...,  1.0583e-01,
           -3.2690e-01, -5.6946e-02],
          ...,
          [ 5.6006e-01,  1.0124e-02, -2.2507e-02,  ..., -1.3281e-01,
           -4.3408e-01, -7.9834e-02],
          [-1.4417e-01,  6.1707e-02,  3.6438e-02,  ..., -4.8309e-02,
           -3.1543e-01, -2.3669e-01],
          [ 5.7556e-02, -6.9336e-01,  1.9824e-01,  ..., -6.6101e-02,
            7.8760e-01,  3.9612e-02]],

         [[-1.6931e-01,  1.1340e-01,  6.1493e-02,  ..., -2.1033e-01,
           -7.3975e-02, -2.1326e-01],
          [ 1.8225e-01, -5.3223e-01, -1.7639e-02,  ..., -3.4607e-02,
            3.9575e-01, -9.1309e-02],
          [-2.1835e-02,  3.8177e-02,  3.7183e-01,  ...,  1.2537e-01,
           -3.5840e-01, -6.4392e-02],
          ...,
          [ 5.7275e-01,  5.4535e-02, -4.0070e-02,  ..., -1.4380e-01,
           -4.4751e-01, -2.3972e-02],
          [-1.4539e-01,  8.9661e-02,  7.8003e-02,  ...,  1.7731e-02,
           -3.2446e-01, -2.4377e-01],
          [ 1.6968e-01, -7.2559e-01,  2.8247e-01,  ...,  5.6877e-03,
            8.3789e-01, -2.5375e-02]],

         ...,

         [[-1.8848e-01,  8.6182e-02,  5.7953e-02,  ..., -2.2302e-01,
           -8.2153e-02, -2.1729e-01],
          [ 8.1909e-02, -5.4736e-01,  2.0004e-02,  ..., -6.7627e-02,
            4.1650e-01, -2.3633e-01],
          [-8.5815e-02,  8.3252e-02,  2.5537e-01,  ...,  2.1033e-01,
           -4.2407e-01, -5.3406e-02],
          ...,
          [ 5.6641e-01,  3.3447e-02, -4.1809e-02,  ..., -9.8511e-02,
           -4.0283e-01, -4.2419e-02],
          [-1.3062e-01,  6.6040e-02,  7.4036e-02,  ...,  5.9113e-02,
           -2.6709e-01, -2.0764e-01],
          [ 2.1545e-01, -7.9736e-01,  3.5107e-01,  ...,  1.1731e-01,
            8.6182e-01, -7.6721e-02]],

         [[-1.8799e-01,  8.9050e-02,  4.3488e-02,  ..., -2.1899e-01,
           -8.7952e-02, -1.8054e-01],
          [ 5.9357e-02, -5.7861e-01,  1.2169e-02,  ..., -6.8542e-02,
            4.1699e-01, -2.2339e-01],
          [-6.6345e-02,  1.0535e-01,  2.4255e-01,  ...,  2.1497e-01,
           -4.2163e-01, -6.4697e-02],
          ...,
          [ 5.6787e-01,  1.5144e-02, -2.7008e-02,  ..., -8.8745e-02,
           -4.0527e-01, -5.1697e-02],
          [-1.5588e-01,  8.8196e-02,  9.0332e-02,  ...,  6.2927e-02,
           -2.5488e-01, -1.8762e-01],
          [ 2.4719e-01, -7.9346e-01,  3.5791e-01,  ...,  1.3098e-01,
            8.9746e-01, -1.0419e-01]],

         [[-1.9666e-01,  8.8562e-02,  3.4973e-02,  ..., -2.0325e-01,
           -8.6609e-02, -1.6553e-01],
          [ 7.4585e-02, -5.2148e-01,  1.6678e-02,  ..., -3.8147e-02,
            4.0454e-01, -2.3645e-01],
          [-9.2529e-02,  1.4221e-01,  2.4890e-01,  ...,  2.3999e-01,
           -3.8794e-01, -2.1637e-02],
          ...,
          [ 5.6982e-01,  1.9699e-02, -3.5522e-02,  ..., -8.8257e-02,
           -4.1919e-01, -5.6244e-02],
          [-1.4429e-01,  9.1736e-02,  1.1060e-01,  ...,  5.7770e-02,
           -2.6660e-01, -1.8762e-01],
          [ 2.2876e-01, -7.9248e-01,  3.4766e-01,  ...,  1.3306e-01,
            8.7549e-01, -7.3303e-02]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[-1.7896e-01,  9.7534e-02,  5.9601e-02,  ..., -2.2168e-01,
          -7.1594e-02, -2.0496e-01],
         [ 1.4233e-01, -5.4053e-01,  1.3458e-02,  ..., -4.3701e-02,
           4.1138e-01, -1.7529e-01],
         [-6.1340e-02,  8.2397e-02,  2.8516e-01,  ...,  1.9080e-01,
          -3.8916e-01, -5.1544e-02],
         ...,
         [ 5.7275e-01,  2.8091e-02, -3.5278e-02,  ..., -1.0931e-01,
          -4.1846e-01, -4.8584e-02],
         [-1.4099e-01,  7.7515e-02,  8.1909e-02,  ...,  4.2328e-02,
          -2.8564e-01, -2.1155e-01],
         [ 1.9080e-01, -7.7002e-01,  3.1055e-01,  ...,  6.8726e-02,
           8.5889e-01, -5.1514e-02]],

        [[-1.2585e-01,  6.7627e-02,  4.1138e-02,  ..., -1.5564e-01,
          -5.2246e-02, -1.4355e-01],
         [ 4.7760e-02, -2.0081e-01,  6.1531e-03,  ..., -1.7380e-02,
           1.4136e-01, -7.1228e-02],
         [-3.3703e-03,  1.5518e-02,  6.0272e-02,  ...,  3.0365e-02,
          -6.8420e-02, -7.9727e-03],
         ...,
         [ 5.0964e-03,  9.6941e-04, -2.0542e-03,  ...,  1.2121e-03,
          -7.3090e-03,  3.8872e-03],
         [-7.3433e-03,  5.4016e-03, -1.5554e-03,  ...,  4.9324e-03,
          -1.8875e-02, -1.1330e-02],
         [ 1.0017e-02, -3.7079e-02,  7.9193e-03,  ...,  2.3711e-04,
           5.2887e-02, -5.4398e-03]],

        [[-1.4172e-01,  7.5623e-02,  4.5319e-02,  ..., -1.7371e-01,
          -5.8899e-02, -1.5991e-01],
         [ 4.7882e-02, -2.0544e-01,  6.2790e-03,  ..., -1.7929e-02,
           1.4502e-01, -7.3547e-02],
         [-5.9509e-03,  1.8372e-02,  7.1899e-02,  ...,  3.7872e-02,
          -8.4045e-02, -1.0246e-02],
         ...,
         [ 5.0964e-03,  9.6941e-04, -2.0542e-03,  ...,  1.2140e-03,
          -7.3090e-03,  3.8891e-03],
         [-8.5678e-03,  6.0387e-03, -8.4925e-04,  ...,  5.1651e-03,
          -2.1393e-02, -1.3222e-02],
         [ 1.1551e-02, -4.3182e-02,  1.0460e-02,  ...,  8.4448e-04,
           5.9601e-02, -5.8441e-03]],

        ...,

        [[-1.5955e-01,  8.4412e-02,  4.9774e-02,  ..., -1.9373e-01,
          -6.6467e-02, -1.7810e-01],
         [ 4.8645e-02, -2.0789e-01,  6.4316e-03,  ..., -1.8021e-02,
           1.4697e-01, -7.4341e-02],
         [-9.0408e-03,  2.2003e-02,  9.1064e-02,  ...,  4.9011e-02,
          -1.0846e-01, -1.3908e-02],
         ...,
         [ 5.1918e-03,  9.7466e-04, -2.0599e-03,  ...,  1.1940e-03,
          -7.3776e-03,  3.8795e-03],
         [-1.3252e-02,  8.5220e-03,  1.9503e-03,  ...,  6.2637e-03,
          -3.0991e-02, -2.0447e-02],
         [ 1.3199e-02, -4.9744e-02,  1.3184e-02,  ...,  1.4925e-03,
           6.6772e-02, -6.2828e-03]],

        [[-1.6345e-01,  8.5876e-02,  5.0262e-02,  ..., -1.9739e-01,
          -6.8420e-02, -1.8115e-01],
         [ 4.8950e-02, -2.1045e-01,  6.4812e-03,  ..., -1.8280e-02,
           1.4893e-01, -7.5378e-02],
         [-9.0179e-03,  2.1973e-02,  8.8196e-02,  ...,  4.8035e-02,
          -1.0559e-01, -1.3390e-02],
         ...,
         [ 5.2528e-03,  9.7752e-04, -2.0638e-03,  ...,  1.1816e-03,
          -7.4234e-03,  3.8738e-03],
         [-1.5152e-02,  9.5215e-03,  3.0899e-03,  ...,  6.7253e-03,
          -3.4851e-02, -2.3346e-02],
         [ 1.3779e-02, -5.2002e-02,  1.4137e-02,  ...,  1.7385e-03,
           6.9275e-02, -6.4468e-03]],

        [[-1.5979e-01,  8.4167e-02,  4.9408e-02,  ..., -1.9348e-01,
          -6.6772e-02, -1.7749e-01],
         [ 4.6997e-02, -2.0276e-01,  6.3438e-03,  ..., -1.7639e-02,
           1.4294e-01, -7.2998e-02],
         [-8.6975e-03,  2.1591e-02,  8.4351e-02,  ...,  4.6265e-02,
          -1.0132e-01, -1.2680e-02],
         ...,
         [ 5.3596e-03,  9.8228e-04, -2.0695e-03,  ...,  1.1606e-03,
          -7.4997e-03,  3.8643e-03],
         [-1.5549e-02,  9.7275e-03,  3.3092e-03,  ...,  6.7749e-03,
          -3.5675e-02, -2.3972e-02],
         [ 1.4091e-02, -5.3223e-02,  1.4648e-02,  ...,  1.8702e-03,
           7.0618e-02, -6.5346e-03]]], device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[-0.6582, -0.1344, -1.0586,  ...,  0.6782, -1.1318, -0.8384],
          [ 1.0459, -1.2686, -1.6445,  ..., -0.0444, -0.9805, -0.3682],
          [-0.3313, -1.4697,  0.0209,  ...,  1.1982, -0.5176,  1.5781],
          ...,
          [ 1.5879, -1.2266,  1.1699,  ...,  0.4421, -0.2404,  1.2314],
          [-0.1718,  0.2664,  2.7500,  ...,  0.4333,  2.4336, -1.6250],
          [-0.5376,  1.2891, -1.1143,  ..., -0.1544,  0.4221,  0.5181]],

         [[ 0.3123,  0.6094,  1.2744,  ..., -1.7373,  0.3455, -0.2322],
          [ 0.1208,  2.0938,  0.5649,  ..., -0.9326,  1.1895, -0.0078],
          [-0.5640,  3.1328, -2.6836,  ...,  1.8232, -0.6284, -1.3281],
          ...,
          [-2.8691,  0.7720, -1.2686,  ..., -2.1309,  0.1587, -0.5493],
          [-0.5884,  1.2793, -1.7520,  ...,  0.9219, -1.4795,  1.3955],
          [-1.0234, -1.6514, -0.5200,  ...,  0.3882,  0.6973, -2.3340]],

         [[-0.0196,  0.6328,  1.6807,  ..., -1.9111,  0.4702, -0.2454],
          [-0.3718,  1.9307,  0.3901,  ..., -0.7290,  1.0977, -0.1077],
          [-0.3188,  3.4844, -2.6465,  ...,  1.9209, -0.5752, -1.1797],
          ...,
          [-3.2344,  0.7070, -1.5107,  ..., -2.2617,  0.2407, -0.5103],
          [-0.6143,  1.4326, -1.6436,  ...,  0.5234, -1.7461,  1.1309],
          [-1.1064, -1.7061, -0.5195,  ...,  0.1353,  0.8496, -2.5195]],

         ...,

         [[ 0.0869,  0.8101,  1.8633,  ..., -1.8633,  0.4014, -0.1182],
          [-0.6421,  1.8105,  0.2537,  ..., -0.6553,  1.1113, -0.1597],
          [-0.3645,  3.5176, -2.6758,  ...,  1.9287, -0.5854, -1.3740],
          ...,
          [-3.2520,  0.8433, -1.8564,  ..., -2.0293,  0.2627, -0.5654],
          [-0.6230,  1.4629, -1.5732,  ...,  0.4880, -1.6582,  1.1172],
          [-1.1416, -1.6650, -0.6006,  ..., -0.2588,  0.8809, -2.5430]],

         [[ 0.0487,  0.7676,  1.8721,  ..., -1.8154,  0.3621, -0.1897],
          [-0.6133,  1.7646,  0.1592,  ..., -0.5913,  1.1387, -0.2395],
          [-0.3970,  3.5039, -2.7305,  ...,  1.9346, -0.4941, -1.3965],
          ...,
          [-3.1816,  0.8330, -1.9971,  ..., -1.9854,  0.3250, -0.5952],
          [-0.5776,  1.5078, -1.4463,  ...,  0.4131, -1.5986,  1.2432],
          [-1.0791, -1.6934, -0.6328,  ..., -0.2786,  0.8813, -2.5664]],

         [[ 0.0180,  0.8662,  1.9268,  ..., -1.8926,  0.3689, -0.1979],
          [-0.6094,  1.6895,  0.1089,  ..., -0.6567,  1.1475, -0.3059],
          [-0.3962,  3.6250, -2.7305,  ...,  2.0605, -0.4990, -1.3730],
          ...,
          [-3.2305,  0.8018, -2.1074,  ..., -2.0488,  0.3230, -0.5703],
          [-0.5581,  1.5664, -1.4639,  ...,  0.3799, -1.5967,  1.2490],
          [-1.1250, -1.6719, -0.6567,  ..., -0.3186,  0.8345, -2.5586]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[ 6.5137e-01,  5.1318e-01,  1.3818e-01,  ...,  3.9215e-02,
            3.0371e+00,  5.2637e-01],
          [-1.3818e+00,  1.9072e+00,  2.0684e+00,  ..., -9.3799e-01,
            1.5850e+00,  7.4023e-01],
          [ 2.9004e-01,  1.2598e+00, -1.1871e-02,  ..., -1.1104e+00,
            8.0859e-01, -6.7139e-01],
          ...,
          [-1.6924e+00,  1.1279e+00, -6.3477e-01,  ..., -2.7344e-01,
            1.5796e-01, -1.2363e+00],
          [-3.8989e-01,  2.7026e-01, -1.4805e+00,  ...,  1.7688e-01,
           -1.7188e+00,  2.7441e-01],
          [-1.3660e-01, -1.0703e+00,  1.9946e-01,  ...,  2.4280e-01,
            2.0300e-01, -6.3428e-01]],

         [[-8.6572e-01, -2.2339e-01,  1.8008e+00,  ...,  1.4014e+00,
           -1.8438e+00,  2.8594e+00],
          [-9.3213e-01, -1.6602e+00,  1.9995e-01,  ...,  2.3193e-01,
           -1.4229e+00, -1.3135e+00],
          [-2.5547e+00,  2.2681e-01, -1.1006e+00,  ...,  1.0480e-01,
           -1.6494e+00,  2.0840e+00],
          ...,
          [ 3.0493e-01, -6.3398e+00,  1.1660e+00,  ..., -1.0088e+00,
            1.3740e+00,  4.9922e+00],
          [ 3.6743e-01, -1.4893e-01, -1.0480e-01,  ...,  6.8066e-01,
            5.0195e-01,  1.5020e+00],
          [-5.2490e-01, -2.1504e+00, -1.4258e+00,  ..., -1.0859e+00,
            6.4941e-02, -2.7808e-01]],

         [[-1.0156e+00, -2.3364e-01,  1.9717e+00,  ...,  1.0732e+00,
           -1.5449e+00,  2.5332e+00],
          [-1.0137e+00, -1.7607e+00,  6.2549e-01,  ...,  4.6661e-02,
           -1.6289e+00, -1.6719e+00],
          [-2.3457e+00,  4.0454e-01, -1.1113e+00,  ..., -2.3792e-01,
           -1.6514e+00,  2.0938e+00],
          ...,
          [ 2.2314e-01, -6.2773e+00,  1.1406e+00,  ..., -1.1650e+00,
            1.1641e+00,  4.8164e+00],
          [ 3.2031e-01, -1.5381e-01,  1.2360e-01,  ...,  7.9932e-01,
            7.2412e-01,  1.4385e+00],
          [-8.0078e-01, -2.1074e+00, -1.4551e+00,  ..., -1.2080e+00,
           -4.4525e-02, -2.7832e-01]],

         ...,

         [[-1.1885e+00, -3.6407e-02,  2.0176e+00,  ...,  1.3516e+00,
           -1.3740e+00,  2.0293e+00],
          [-1.1553e+00, -1.9033e+00,  8.0078e-01,  ..., -1.9214e-01,
           -1.8486e+00, -1.8037e+00],
          [-2.3984e+00,  2.2778e-01, -1.0078e+00,  ..., -2.1265e-01,
           -1.5410e+00,  1.9932e+00],
          ...,
          [ 1.4990e-01, -6.4531e+00,  9.7314e-01,  ..., -1.2812e+00,
            1.0146e+00,  5.0195e+00],
          [ 4.6851e-01,  4.8004e-02,  2.8955e-01,  ...,  8.1348e-01,
            9.1504e-01,  1.4072e+00],
          [-1.0586e+00, -2.0234e+00, -1.5566e+00,  ..., -1.0869e+00,
           -2.2852e-01, -2.2180e-01]],

         [[-1.3398e+00,  2.8336e-02,  1.9590e+00,  ...,  1.4023e+00,
           -1.3320e+00,  2.1504e+00],
          [-1.1982e+00, -1.9414e+00,  9.3311e-01,  ..., -3.5352e-01,
           -1.9424e+00, -1.7637e+00],
          [-2.4277e+00,  2.2791e-01, -9.7803e-01,  ..., -1.8579e-01,
           -1.5215e+00,  1.9268e+00],
          ...,
          [ 1.1304e-01, -6.5156e+00,  8.8477e-01,  ..., -1.3711e+00,
            1.0801e+00,  5.0781e+00],
          [ 5.1416e-01, -7.7576e-02,  3.7012e-01,  ...,  7.1777e-01,
            1.0254e+00,  1.4072e+00],
          [-1.0312e+00, -2.0176e+00, -1.5615e+00,  ..., -9.7852e-01,
           -2.8418e-01, -2.0129e-01]],

         [[-1.2461e+00, -5.6610e-03,  1.9277e+00,  ...,  1.3506e+00,
           -1.3252e+00,  2.1094e+00],
          [-1.1396e+00, -1.9844e+00,  9.2236e-01,  ..., -2.9932e-01,
           -2.0410e+00, -1.7764e+00],
          [-2.3750e+00,  3.0884e-01, -1.1191e+00,  ..., -1.8921e-01,
           -1.5059e+00,  1.8809e+00],
          ...,
          [ 1.5430e-01, -6.6562e+00,  9.3262e-01,  ..., -1.5029e+00,
            1.1182e+00,  5.1836e+00],
          [ 4.7314e-01, -5.5725e-02,  4.6680e-01,  ...,  6.4209e-01,
            1.0625e+00,  1.3477e+00],
          [-1.0947e+00, -2.0957e+00, -1.6143e+00,  ..., -1.0332e+00,
           -3.1128e-01, -1.9470e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 2.4750e-02, -8.7738e-03, -1.1034e-03,  ...,  1.8021e-02,
            5.0926e-03,  9.4849e-02],
          [-2.6035e-03, -1.0405e-03,  1.3542e-02,  ..., -1.0483e-02,
            1.9226e-03, -1.3285e-03],
          [-9.0485e-03,  4.5738e-03,  1.0330e-02,  ...,  7.4310e-03,
            4.3640e-03, -1.8606e-03],
          ...,
          [-5.2547e-04, -5.6953e-03, -1.2039e-02,  ...,  6.1340e-03,
           -9.9945e-03, -1.0963e-02],
          [ 2.9907e-03, -9.5062e-03,  8.7051e-03,  ..., -9.4528e-03,
           -3.4771e-03, -2.2202e-03],
          [ 2.7370e-03, -5.0125e-03,  1.5305e-02,  ..., -1.4069e-02,
            1.8711e-03, -4.5624e-03]],

         [[ 1.2042e-01, -1.7395e-03, -2.1179e-01,  ...,  3.0688e-01,
           -1.3867e-01, -7.4854e-01],
          [ 4.9622e-02, -7.2266e-02,  2.0142e-01,  ...,  4.4434e-02,
           -2.1130e-01,  1.8579e-01],
          [ 5.0110e-02,  2.0752e-01,  2.3486e-01,  ...,  1.5906e-01,
            3.4741e-01, -9.1309e-02],
          ...,
          [ 2.7405e-02, -3.4863e-01,  1.0370e-01,  ...,  3.6987e-01,
            4.5868e-02,  3.5248e-02],
          [ 2.7905e-01,  4.0625e-01,  2.9688e-01,  ..., -9.0210e-02,
           -3.1836e-01,  2.8760e-01],
          [-1.7322e-01, -2.7368e-01,  6.0059e-01,  ...,  2.7246e-01,
           -8.8867e-02,  8.6304e-02]],

         [[ 1.1401e-01, -1.8112e-02, -2.5903e-01,  ...,  3.9722e-01,
           -1.1194e-01, -6.9727e-01],
          [ 3.3478e-02, -1.3171e-01,  1.7322e-01,  ...,  1.0422e-02,
           -2.2437e-01,  2.1289e-01],
          [ 6.7017e-02,  2.6465e-01,  2.4646e-01,  ...,  8.8440e-02,
            3.6304e-01, -9.0515e-02],
          ...,
          [ 3.5675e-02, -4.0210e-01,  8.7341e-02,  ...,  3.3276e-01,
            7.2510e-02,  5.5420e-02],
          [ 2.4707e-01,  3.3618e-01,  3.4009e-01,  ..., -1.1804e-01,
           -3.7769e-01,  2.0312e-01],
          [-2.1594e-01, -2.0166e-01,  5.5957e-01,  ...,  2.9248e-01,
           -1.0168e-01,  1.5479e-01]],

         ...,

         [[ 1.4331e-01, -1.2848e-02, -2.5513e-01,  ...,  3.6694e-01,
           -1.2134e-01, -6.6943e-01],
          [ 4.7394e-02, -2.0081e-01,  2.1887e-01,  ...,  5.3215e-03,
           -2.3022e-01,  2.2107e-01],
          [ 5.3345e-02,  3.2153e-01,  2.9736e-01,  ...,  2.7985e-02,
            3.7207e-01, -1.2683e-01],
          ...,
          [ 2.0874e-02, -4.1016e-01,  4.1534e-02,  ...,  3.5083e-01,
            3.2104e-02,  1.1176e-01],
          [ 1.8433e-01,  3.6938e-01,  3.3862e-01,  ..., -1.2573e-01,
           -3.2227e-01,  1.5796e-01],
          [-1.8579e-01, -8.9966e-02,  5.3906e-01,  ...,  2.1899e-01,
           -9.7107e-02,  1.9653e-01]],

         [[ 1.3379e-01, -2.3132e-02, -2.4487e-01,  ...,  3.4497e-01,
           -1.2744e-01, -6.5967e-01],
          [ 9.3872e-02, -2.0605e-01,  1.9434e-01,  ...,  3.2978e-03,
           -2.2876e-01,  2.1655e-01],
          [ 1.8143e-02,  3.3350e-01,  2.9248e-01,  ...,  2.2247e-02,
            3.6646e-01, -1.8274e-01],
          ...,
          [ 3.5553e-02, -4.1919e-01, -7.2708e-03,  ...,  3.2812e-01,
            2.7939e-02,  1.2421e-01],
          [ 1.8262e-01,  3.7866e-01,  3.1250e-01,  ..., -1.2488e-01,
           -3.2275e-01,  1.3428e-01],
          [-2.2217e-01, -8.7097e-02,  5.6738e-01,  ...,  2.2278e-01,
           -5.5420e-02,  2.0764e-01]],

         [[ 1.2134e-01, -4.0436e-02, -2.3926e-01,  ...,  3.5938e-01,
           -1.2329e-01, -6.5039e-01],
          [ 6.7322e-02, -2.2998e-01,  2.0056e-01,  ...,  2.1076e-03,
           -2.0520e-01,  2.1570e-01],
          [ 4.3304e-02,  3.4009e-01,  2.8516e-01,  ...,  1.9409e-02,
            3.7305e-01, -1.6626e-01],
          ...,
          [ 5.2368e-02, -4.4531e-01, -1.2939e-02,  ...,  3.1226e-01,
            5.6274e-02,  1.0889e-01],
          [ 1.8970e-01,  3.8843e-01,  3.1812e-01,  ..., -1.4124e-01,
           -3.0005e-01,  1.2445e-01],
          [-2.0020e-01, -9.6558e-02,  5.8350e-01,  ...,  2.1143e-01,
           -5.1422e-02,  2.3193e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[ 1.2683e-01, -1.6693e-02, -2.4805e-01,  ...,  3.6304e-01,
          -1.1835e-01, -6.8457e-01],
         [ 5.6763e-02, -1.6833e-01,  1.9543e-01,  ...,  4.9934e-03,
          -2.2168e-01,  2.1313e-01],
         [ 5.0873e-02,  2.9663e-01,  2.7441e-01,  ...,  6.0059e-02,
           3.6597e-01, -1.2695e-01],
         ...,
         [ 3.4119e-02, -4.0381e-01,  4.0680e-02,  ...,  3.3740e-01,
           4.8218e-02,  8.6365e-02],
         [ 2.0203e-01,  3.7036e-01,  3.2568e-01,  ..., -1.2964e-01,
          -3.3105e-01,  1.5784e-01],
         [-1.9580e-01, -1.4478e-01,  5.6201e-01,  ...,  2.4170e-01,
          -8.5266e-02,  1.8359e-01]],

        [[ 8.3496e-02, -1.4229e-02, -1.4294e-01,  ...,  2.1594e-01,
          -6.4758e-02, -3.4595e-01],
         [ 2.9335e-03, -1.6708e-02,  3.1250e-02,  ..., -9.0408e-03,
          -2.0111e-02,  1.9684e-02],
         [ 2.6703e-04,  4.8096e-02,  5.0201e-02,  ...,  1.6724e-02,
           5.9479e-02, -2.0279e-02],
         ...,
         [ 4.8981e-03, -6.9580e-02, -3.3493e-03,  ...,  5.9265e-02,
          -5.5647e-04,  4.6692e-03],
         [ 1.6861e-02,  1.3992e-02,  2.8122e-02,  ..., -1.6220e-02,
          -2.4246e-02,  1.0101e-02],
         [-4.1656e-03, -9.9564e-03,  3.4393e-02,  ..., -5.1384e-03,
          -1.1692e-03,  1.9684e-03]],

        [[ 8.8135e-02, -1.4709e-02, -1.5430e-01,  ...,  2.3193e-01,
          -7.0312e-02, -3.8110e-01],
         [ 1.3599e-03, -1.2230e-02,  2.6199e-02,  ..., -9.4452e-03,
          -1.3802e-02,  1.3672e-02],
         [-6.7413e-05,  4.6448e-02,  4.8706e-02,  ...,  1.6449e-02,
           5.7434e-02, -1.9592e-02],
         ...,
         [ 5.1994e-03, -7.2876e-02, -2.9640e-03,  ...,  6.1951e-02,
          -6.7830e-05,  5.4932e-03],
         [ 1.5457e-02,  1.1726e-02,  2.6245e-02,  ..., -1.5594e-02,
          -2.2217e-02,  8.8120e-03],
         [-4.3869e-03, -1.0056e-02,  3.4973e-02,  ..., -4.8828e-03,
          -1.2569e-03,  2.2087e-03]],

        ...,

        [[ 8.4778e-02, -1.4427e-02, -1.4636e-01,  ...,  2.2083e-01,
          -6.6284e-02, -3.5571e-01],
         [ 1.6289e-03, -1.2917e-02,  2.7084e-02,  ..., -9.3307e-03,
          -1.4900e-02,  1.4702e-02],
         [-1.1129e-03,  4.1595e-02,  4.4250e-02,  ...,  1.5427e-02,
           5.1300e-02, -1.7548e-02],
         ...,
         [ 3.6736e-03, -5.4871e-02, -5.3291e-03,  ...,  4.7058e-02,
          -2.7142e-03,  1.0309e-03],
         [ 1.4992e-02,  1.0986e-02,  2.5635e-02,  ..., -1.5388e-02,
          -2.1545e-02,  8.3771e-03],
         [-4.9973e-03, -1.0452e-02,  3.6652e-02,  ..., -4.1122e-03,
          -1.5182e-03,  2.8114e-03]],

        [[ 8.1787e-02, -1.4198e-02, -1.3892e-01,  ...,  2.1045e-01,
          -6.2622e-02, -3.3252e-01],
         [ 3.0613e-03, -1.6953e-02,  3.1677e-02,  ..., -8.9493e-03,
          -2.0584e-02,  2.0111e-02],
         [-1.3981e-03,  4.0253e-02,  4.3030e-02,  ...,  1.5129e-02,
           4.9591e-02, -1.6983e-02],
         ...,
         [ 4.0894e-03, -5.9692e-02, -4.7302e-03,  ...,  5.1025e-02,
          -2.0180e-03,  2.2335e-03],
         [ 1.4862e-02,  1.0811e-02,  2.5497e-02,  ..., -1.5350e-02,
          -2.1393e-02,  8.2474e-03],
         [-5.3406e-03, -1.0689e-02,  3.7567e-02,  ..., -3.6774e-03,
          -1.6623e-03,  3.1338e-03]],

        [[ 8.1299e-02, -1.4153e-02, -1.3782e-01,  ...,  2.0898e-01,
          -6.2164e-02, -3.2959e-01],
         [ 3.2387e-03, -1.7426e-02,  3.2257e-02,  ..., -8.8730e-03,
          -2.1317e-02,  2.0813e-02],
         [-1.2341e-03,  4.1107e-02,  4.3793e-02,  ...,  1.5297e-02,
           5.0659e-02, -1.7349e-02],
         ...,
         [ 4.2152e-03, -6.1157e-02, -4.5280e-03,  ...,  5.2277e-02,
          -1.8063e-03,  2.5883e-03],
         [ 1.6434e-02,  1.3496e-02,  2.7695e-02,  ..., -1.6129e-02,
          -2.3743e-02,  9.6359e-03],
         [-5.8556e-03, -1.1047e-02,  3.9001e-02,  ..., -3.0136e-03,
          -1.8873e-03,  3.6278e-03]]], device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[ 0.2773,  1.0596, -1.8965,  ...,  2.2422,  1.5352, -0.2634],
          [ 0.0404,  0.7007, -1.0811,  ...,  0.4170, -0.2119,  0.8154],
          [-3.2090, -2.5605,  0.1901,  ...,  2.2031, -0.3782, -0.3826],
          ...,
          [-1.2988, -1.2754, -2.2793,  ...,  2.0859,  0.3462,  0.7686],
          [ 0.7305, -2.1855,  0.0989,  ...,  0.5864, -0.5654,  1.4121],
          [-1.3184, -2.2637,  0.7993,  ..., -0.0704, -1.1641,  1.9863]],

         [[ 1.4697, -0.1838,  0.5288,  ..., -2.1992, -1.6035,  3.2832],
          [-1.5146,  0.1791, -0.5884,  ..., -0.6064, -0.0685,  0.2854],
          [ 0.7178,  0.3809,  0.5942,  ..., -1.2148, -2.3613, -1.1221],
          ...,
          [-0.1821,  1.2090,  0.2739,  ...,  0.3862,  0.3706,  0.3860],
          [-1.0205,  2.0352, -1.7861,  ..., -0.9004, -0.6621, -1.8379],
          [ 2.3359,  2.2070,  0.1637,  ..., -0.3386, -0.5039, -0.2722]],

         [[ 1.3125, -0.3096,  0.6333,  ..., -2.0742, -1.6299,  3.2754],
          [-1.3057,  0.2406, -0.6685,  ..., -0.5010, -0.1646,  0.2705],
          [ 0.6777, -0.0269,  0.7490,  ..., -1.2822, -2.3945, -0.9746],
          ...,
          [-0.2217,  1.4941,  0.3545,  ...,  0.4773,  0.4746,  0.2998],
          [-0.9360,  2.2539, -1.6387,  ..., -0.8159, -0.4131, -1.9766],
          [ 2.0371,  2.1973,  0.2520,  ..., -0.3335, -0.5171, -0.0113]],

         ...,

         [[ 0.9951, -0.3252,  0.8193,  ..., -1.8955, -1.4824,  3.2988],
          [-1.1553,  0.4451, -0.9351,  ..., -0.2808, -0.3191,  0.3894],
          [ 0.5264, -0.3276,  0.8066,  ..., -1.2607, -2.4258, -0.9150],
          ...,
          [-0.4385,  1.6094,  0.3396,  ...,  0.7222,  0.2817,  0.1625],
          [-0.7246,  2.3965, -1.4561,  ..., -0.8076, -0.2461, -2.0273],
          [ 1.9902,  2.0332,  0.3447,  ..., -0.3772, -0.4595,  0.2747]],

         [[ 0.8857, -0.4248,  0.9106,  ..., -1.9854, -1.2852,  3.1953],
          [-1.0938,  0.5889, -1.0537,  ..., -0.2988, -0.3291,  0.4495],
          [ 0.4968, -0.2893,  0.7476,  ..., -1.2637, -2.3945, -0.8491],
          ...,
          [-0.4917,  1.7373,  0.3232,  ...,  0.7798,  0.1824,  0.1619],
          [-0.7515,  2.4473, -1.3779,  ..., -0.7632, -0.1101, -2.0645],
          [ 1.9092,  1.9395,  0.3162,  ..., -0.2729, -0.5122,  0.3813]],

         [[ 0.8481, -0.5225,  0.8853,  ..., -2.0156, -1.4355,  3.1895],
          [-1.1074,  0.6465, -1.1055,  ..., -0.3193, -0.2722,  0.4692],
          [ 0.5122, -0.2944,  0.8447,  ..., -1.2900, -2.4316, -0.7910],
          ...,
          [-0.4695,  1.8330,  0.3435,  ...,  0.7656,  0.1805,  0.2338],
          [-0.7500,  2.5273, -1.3145,  ..., -0.8169, -0.0894, -2.0957],
          [ 1.9521,  1.9199,  0.2708,  ..., -0.2240, -0.5068,  0.4250]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[-2.2498e-01, -1.4297e+00,  5.9033e-01,  ..., -2.3398e+00,
           -1.6787e+00,  1.6689e+00],
          [-5.8594e-01, -6.0254e-01,  4.2017e-01,  ..., -1.1299e+00,
           -1.1981e-01,  3.9502e-01],
          [ 7.7832e-01,  6.1328e-01,  2.6587e-01,  ..., -9.1309e-01,
           -1.2207e+00, -2.6196e-01],
          ...,
          [-6.5088e-01,  9.9219e-01,  1.1895e+00,  ..., -1.0420e+00,
           -1.7773e-01,  1.1340e-01],
          [-1.2314e+00,  1.4883e+00, -4.2993e-01,  ..., -1.3311e+00,
            1.1904e+00, -3.2812e-01],
          [ 7.2412e-01,  1.7969e+00, -1.8818e+00,  ..., -1.1074e+00,
           -3.4619e-01,  9.3811e-02]],

         [[-1.9639e+00,  2.6831e-01, -7.7686e-01,  ..., -5.4102e-01,
            1.7090e-01,  1.9033e+00],
          [-6.6846e-01,  1.5254e+00,  4.3823e-01,  ...,  3.5522e-01,
           -2.9004e+00, -7.8711e-01],
          [-1.0801e+00, -1.5137e+00,  1.1914e+00,  ...,  6.6589e-02,
           -5.1758e-01, -1.8145e+00],
          ...,
          [ 9.7070e-01,  4.5850e-01, -3.0811e-01,  ...,  8.0444e-02,
            7.7002e-01, -5.2734e-01],
          [ 9.4287e-01, -3.0289e-03, -4.9512e-01,  ...,  4.5996e-01,
            9.2480e-01, -2.3254e-02],
          [ 2.0300e-01,  1.6094e+00, -1.5479e+00,  ...,  2.9043e+00,
            6.0791e-01,  1.0010e+00]],

         [[-1.6875e+00,  7.4756e-01, -8.2324e-01,  ..., -9.7266e-01,
            5.4248e-01,  1.8408e+00],
          [-3.8257e-01,  1.7129e+00,  5.1855e-01,  ...,  2.3755e-01,
           -2.9668e+00, -9.2627e-01],
          [-1.3164e+00, -1.9014e+00,  8.8623e-01,  ...,  1.2494e-01,
           -4.0283e-01, -2.2637e+00],
          ...,
          [ 9.8486e-01,  4.4385e-01, -4.0601e-01,  ...,  1.5906e-01,
            8.8428e-01, -3.9136e-01],
          [ 1.0098e+00,  5.9296e-02, -1.6870e-01,  ...,  5.6104e-01,
            8.0762e-01, -1.1707e-01],
          [ 2.1960e-01,  1.5752e+00, -1.6406e+00,  ...,  3.0605e+00,
            4.8608e-01,  8.8721e-01]],

         ...,

         [[-1.4629e+00,  8.5645e-01, -7.7344e-01,  ..., -9.3994e-01,
            6.1523e-01,  2.0176e+00],
          [-1.5881e-01,  2.0840e+00,  3.5815e-01,  ...,  2.3950e-01,
           -2.9043e+00, -9.0039e-01],
          [-1.5098e+00, -2.1836e+00,  4.8584e-01,  ...,  3.1592e-01,
           -1.5674e-01, -2.5176e+00],
          ...,
          [ 8.9990e-01,  4.6851e-01, -3.1592e-01,  ...,  3.6035e-01,
            6.0303e-01, -3.0420e-01],
          [ 9.6484e-01, -4.1779e-02,  2.7542e-02,  ...,  7.3975e-01,
            7.9395e-01, -1.4819e-01],
          [ 3.7891e-01,  1.6514e+00, -1.7217e+00,  ...,  3.2109e+00,
            2.2131e-01,  6.1426e-01]],

         [[-1.4756e+00,  9.3945e-01, -6.7432e-01,  ..., -9.2334e-01,
            5.6738e-01,  2.0469e+00],
          [-8.1848e-02,  2.2051e+00,  3.4155e-01,  ...,  3.3057e-01,
           -2.9668e+00, -8.8037e-01],
          [-1.5742e+00, -2.2285e+00,  2.3889e-01,  ...,  3.5864e-01,
           -2.8702e-02, -2.5742e+00],
          ...,
          [ 8.4473e-01,  4.6021e-01, -3.6133e-01,  ...,  4.4946e-01,
            5.3125e-01, -3.8281e-01],
          [ 9.7607e-01, -1.1945e-01,  8.7769e-02,  ...,  6.5576e-01,
            8.1592e-01, -1.0553e-01],
          [ 4.1064e-01,  1.6289e+00, -1.8291e+00,  ...,  3.2129e+00,
            1.1176e-01,  5.5273e-01]],

         [[-1.5488e+00,  9.8340e-01, -6.6602e-01,  ..., -9.4824e-01,
            6.3867e-01,  2.0371e+00],
          [-2.0630e-02,  2.2500e+00,  3.0249e-01,  ...,  3.5107e-01,
           -3.0566e+00, -1.0029e+00],
          [-1.6230e+00, -2.1992e+00,  2.2522e-01,  ...,  4.2358e-01,
           -9.6313e-02, -2.6348e+00],
          ...,
          [ 8.5498e-01,  4.0088e-01, -4.4507e-01,  ...,  4.7119e-01,
            5.9131e-01, -3.6816e-01],
          [ 1.0488e+00, -1.4307e-01,  1.7456e-01,  ...,  6.4600e-01,
            9.1748e-01, -7.3120e-02],
          [ 4.0771e-01,  1.6924e+00, -1.8770e+00,  ...,  3.3652e+00,
            1.0541e-01,  5.3125e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 3.3817e-03,  5.1384e-03,  1.2520e-02,  ...,  6.2408e-03,
            2.3687e-04, -4.6997e-03],
          [-1.6956e-03,  1.4603e-02, -1.6708e-02,  ..., -1.9272e-02,
           -1.0767e-03,  1.2146e-02],
          [-1.3933e-03,  3.5172e-03,  1.6861e-02,  ...,  2.5959e-03,
            8.5678e-03,  3.4180e-03],
          ...,
          [ 1.1108e-02, -6.5193e-03,  9.4757e-03,  ...,  7.3204e-03,
            2.4567e-03,  1.1002e-02],
          [ 1.2497e-02, -7.5293e-04, -1.9348e-02,  ...,  9.2621e-03,
            1.3809e-02, -6.7215e-03],
          [-6.4278e-03, -1.0811e-02, -9.8724e-03,  ..., -7.8964e-04,
           -6.8626e-03,  1.0185e-02]],

         [[ 7.8430e-02, -2.7374e-02,  5.1514e-01,  ...,  1.1208e-02,
            3.6475e-01, -3.8232e-01],
          [ 3.1763e-01,  1.3496e+00, -4.9512e-01,  ..., -1.0120e-01,
           -4.0430e-01, -1.4612e-01],
          [ 3.2642e-01, -7.6599e-02,  2.6172e-01,  ..., -2.1204e-01,
           -1.4319e-01, -2.8955e-01],
          ...,
          [ 6.4087e-02,  2.4646e-01,  1.4490e-01,  ..., -3.5742e-01,
           -6.1426e-01, -7.1411e-03],
          [ 2.9834e-01, -7.7087e-02,  9.1919e-02,  ..., -2.3889e-01,
            7.1875e-01, -5.2832e-01],
          [ 1.1560e-01, -1.2537e-01, -2.1069e-01,  ...,  8.2092e-02,
           -1.3733e-02,  3.0127e-01]],

         [[ 2.3804e-03, -1.6108e-03,  4.1333e-01,  ..., -4.6051e-02,
            2.9932e-01, -2.9810e-01],
          [ 2.2095e-01,  1.2510e+00, -5.1855e-01,  ..., -5.0720e-02,
           -5.0928e-01, -1.8604e-01],
          [ 3.3984e-01, -1.1334e-01,  3.7622e-01,  ..., -1.1023e-01,
           -2.0349e-01, -2.4548e-01],
          ...,
          [ 1.1560e-01,  2.7319e-01,  3.0701e-02,  ..., -3.0078e-01,
           -6.2744e-01, -7.5256e-02],
          [ 1.9507e-01, -1.4417e-01,  6.5979e-02,  ..., -9.1309e-02,
            6.1670e-01, -5.3760e-01],
          [ 9.8389e-02, -1.2360e-01, -2.4036e-01,  ...,  6.7566e-02,
            2.8595e-02,  2.0569e-01]],

         ...,

         [[ 9.6664e-03,  7.6714e-03,  4.2944e-01,  ..., -9.6924e-02,
            3.3154e-01, -2.8101e-01],
          [ 1.6943e-01,  1.1562e+00, -5.6152e-01,  ..., -7.9834e-02,
           -6.0693e-01, -2.0923e-01],
          [ 2.5098e-01, -1.3318e-01,  4.2871e-01,  ..., -9.8328e-02,
           -1.9189e-01, -2.4695e-01],
          ...,
          [ 1.8164e-01,  3.2178e-01,  5.1270e-03,  ..., -2.2180e-01,
           -7.4219e-01, -4.6875e-02],
          [ 1.4746e-01, -1.6614e-01,  4.5471e-02,  ..., -6.0272e-02,
            5.9912e-01, -5.5957e-01],
          [ 3.6072e-02, -1.1230e-01, -2.3840e-01,  ...,  7.3853e-02,
            6.8787e-02,  2.3291e-01]],

         [[ 2.9583e-03,  3.3966e-02,  4.1870e-01,  ..., -1.3098e-01,
            3.5718e-01, -2.5928e-01],
          [ 1.7651e-01,  1.1748e+00, -5.9473e-01,  ..., -8.5327e-02,
           -5.7422e-01, -1.7419e-01],
          [ 2.7905e-01, -1.5088e-01,  4.3335e-01,  ..., -7.0312e-02,
           -2.0386e-01, -2.2241e-01],
          ...,
          [ 1.9067e-01,  2.9346e-01,  3.1982e-02,  ..., -1.8396e-01,
           -7.6514e-01, -3.6591e-02],
          [ 1.4478e-01, -1.7383e-01,  6.9763e-02,  ..., -4.0894e-02,
            5.8789e-01, -5.7373e-01],
          [ 2.8610e-02, -1.4111e-01, -2.6318e-01,  ...,  7.5989e-02,
            6.8298e-02,  2.4377e-01]],

         [[ 2.6123e-02,  2.0065e-03,  4.0332e-01,  ..., -1.4624e-01,
            3.7109e-01, -2.5854e-01],
          [ 1.6772e-01,  1.1787e+00, -5.7422e-01,  ..., -6.2805e-02,
           -5.7764e-01, -1.6138e-01],
          [ 2.7490e-01, -1.3025e-01,  4.5947e-01,  ..., -4.3793e-02,
           -2.0056e-01, -2.1106e-01],
          ...,
          [ 1.9006e-01,  2.6636e-01,  1.3115e-02,  ..., -1.7847e-01,
           -7.3877e-01, -3.2654e-02],
          [ 1.4294e-01, -1.6882e-01,  9.5276e-02,  ..., -2.2598e-02,
            5.8496e-01, -5.5518e-01],
          [ 3.1342e-02, -1.4197e-01, -2.5684e-01,  ...,  7.5989e-02,
            6.6711e-02,  2.4414e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[ 1.2039e-02,  8.3237e-03,  4.1919e-01,  ..., -1.0394e-01,
           3.4155e-01, -2.7588e-01],
         [ 1.8091e-01,  1.1953e+00, -5.6152e-01,  ..., -6.8604e-02,
          -5.6543e-01, -1.8433e-01],
         [ 2.7808e-01, -1.3220e-01,  4.0894e-01,  ..., -8.4839e-02,
          -1.9153e-01, -2.3389e-01],
         ...,
         [ 1.5833e-01,  2.8345e-01,  2.9739e-02,  ..., -2.3462e-01,
          -7.1191e-01, -5.0140e-02],
         [ 1.7773e-01, -1.5125e-01,  6.8848e-02,  ..., -7.4341e-02,
           6.1377e-01, -5.5420e-01],
         [ 5.5878e-02, -1.3586e-01, -2.5098e-01,  ...,  7.5012e-02,
           5.4596e-02,  2.3755e-01]],

        [[ 8.6288e-03,  4.6654e-03,  1.9495e-01,  ..., -3.3386e-02,
           1.4746e-01, -1.2927e-01],
         [ 2.0401e-02,  1.3818e-01, -6.9275e-02,  ..., -2.4765e-02,
          -5.3467e-02, -7.1793e-03],
         [ 5.0293e-02, -1.9180e-02,  8.1970e-02,  ..., -1.6724e-02,
          -2.5925e-02, -4.0619e-02],
         ...,
         [ 4.2328e-02,  5.7678e-02,  1.5472e-02,  ..., -4.8706e-02,
          -1.5491e-01, -2.3994e-03],
         [ 2.2018e-02, -8.8043e-03, -1.4549e-02,  ...,  4.0817e-03,
           4.7241e-02, -3.6804e-02],
         [-2.2709e-05, -2.1683e-02, -3.0731e-02,  ...,  5.9319e-03,
          -2.1973e-03,  3.0609e-02]],

        [[ 8.4229e-03,  5.0621e-03,  2.0032e-01,  ..., -3.6163e-02,
           1.5271e-01, -1.3245e-01],
         [ 2.4796e-02,  1.6418e-01, -8.0688e-02,  ..., -2.5879e-02,
          -6.4941e-02, -1.1337e-02],
         [ 2.8687e-02, -9.6970e-03,  5.4749e-02,  ..., -8.6594e-03,
          -1.1513e-02, -2.2232e-02],
         ...,
         [ 4.0924e-02,  5.4840e-02,  1.5327e-02,  ..., -4.6326e-02,
          -1.4795e-01, -1.7452e-03],
         [ 2.0355e-02, -7.4310e-03, -1.5373e-02,  ...,  5.0163e-03,
           4.1443e-02, -3.1616e-02],
         [ 1.3626e-04, -2.1942e-02, -3.1219e-02,  ...,  6.0883e-03,
          -2.0905e-03,  3.1082e-02]],

        ...,

        [[ 8.3084e-03,  5.3520e-03,  1.9812e-01,  ..., -3.6835e-02,
           1.5161e-01, -1.3062e-01],
         [ 2.9129e-02,  1.8982e-01, -9.1919e-02,  ..., -2.6978e-02,
          -7.6355e-02, -1.5457e-02],
         [ 2.2552e-02, -6.9809e-03,  4.6936e-02,  ..., -6.4087e-03,
          -7.3814e-03, -1.7014e-02],
         ...,
         [ 4.0436e-02,  5.3589e-02,  1.5182e-02,  ..., -4.5074e-02,
          -1.4514e-01, -1.4277e-03],
         [ 1.8127e-02, -5.5695e-03, -1.6495e-02,  ...,  6.2332e-03,
           3.3691e-02, -2.4643e-02],
         [ 3.0446e-04, -2.2202e-02, -3.1708e-02,  ...,  6.2523e-03,
          -1.9951e-03,  3.1586e-02]],

        [[ 8.2092e-03,  5.4779e-03,  1.9836e-01,  ..., -3.7476e-02,
           1.5222e-01, -1.3062e-01],
         [ 2.7695e-02,  1.8201e-01, -8.8684e-02,  ..., -2.6642e-02,
          -7.3181e-02, -1.4244e-02],
         [ 2.1057e-02, -6.3248e-03,  4.5074e-02,  ..., -5.8441e-03,
          -6.3858e-03, -1.5732e-02],
         ...,
         [ 4.0436e-02,  5.3528e-02,  1.5137e-02,  ..., -4.4922e-02,
          -1.4502e-01, -1.3990e-03],
         [ 1.8509e-02, -5.9357e-03, -1.6281e-02,  ...,  6.0501e-03,
           3.5095e-02, -2.5955e-02],
         [ 1.3418e-03, -2.4063e-02, -3.5278e-02,  ...,  7.3929e-03,
          -1.1501e-03,  3.5034e-02]],

        [[ 8.2779e-03,  5.5542e-03,  2.0105e-01,  ..., -3.8422e-02,
           1.5454e-01, -1.3232e-01],
         [ 2.7481e-02,  1.8042e-01, -8.7952e-02,  ..., -2.6596e-02,
          -7.2388e-02, -1.3962e-02],
         [ 1.8326e-02, -5.1041e-03,  4.1565e-02,  ..., -4.8561e-03,
          -4.5433e-03, -1.3412e-02],
         ...,
         [ 3.9948e-02,  5.2551e-02,  1.5053e-02,  ..., -4.4067e-02,
          -1.4258e-01, -1.1873e-03],
         [ 1.8448e-02, -5.8670e-03, -1.6312e-02,  ...,  6.0768e-03,
           3.4851e-02, -2.5711e-02],
         [ 2.2640e-03, -2.5589e-02, -3.8208e-02,  ...,  8.3389e-03,
          -5.2309e-04,  3.7933e-02]]], device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[-0.7026, -0.1968, -0.6846,  ...,  1.2207,  0.6016, -0.4124],
          [-3.0781,  2.1113, -0.1493,  ..., -1.4844,  0.6768, -1.7061],
          [ 3.0566,  0.3623,  1.0117,  ..., -1.6367, -1.8789,  0.4043],
          ...,
          [-0.7012,  1.5840, -0.5996,  ..., -1.6895,  1.8086, -0.4902],
          [ 1.4922, -0.4854,  1.4492,  ...,  0.6089, -1.5938,  1.2471],
          [-1.3994,  2.0469, -3.1504,  ...,  1.4766,  2.8594,  0.3479]],

         [[ 0.3579,  0.2208, -1.1768,  ...,  0.6279,  0.0760, -0.7080],
          [ 0.8232, -1.8379, -1.1631,  ...,  1.4170,  0.3909,  0.3948],
          [ 0.1619, -2.7773,  0.8501,  ...,  1.2656,  3.1172, -1.5098],
          ...,
          [ 0.3623, -1.2715, -0.2268,  ...,  0.1089, -2.0684, -0.3247],
          [ 1.1416, -1.9453, -1.1465,  ...,  0.3333,  0.4785, -1.2324],
          [-0.5884, -1.0957,  3.3438,  ..., -0.5249, -2.0547, -0.2705]],

         [[ 0.4878,  0.2349, -1.4004,  ...,  0.6548,  0.0411, -0.5820],
          [ 1.1982, -1.5107, -0.9604,  ...,  1.6562,  0.1903,  0.3599],
          [-0.1597, -2.4551,  0.8125,  ...,  1.0488,  2.7207, -1.6689],
          ...,
          [ 0.3345, -1.1543, -0.1334,  ...,  0.1036, -2.0410, -0.4490],
          [ 1.1250, -1.9961, -0.9531,  ...,  0.3625,  0.5039, -1.2051],
          [-0.2157, -1.2324,  2.8887,  ..., -0.4939, -2.1270, -0.4790]],

         ...,

         [[ 0.3931,  0.2861, -1.4688,  ...,  0.6289,  0.1381, -0.7935],
          [ 1.3262, -1.5400, -0.9888,  ...,  1.8799,  0.2705,  0.3254],
          [-0.4343, -2.2754,  0.7871,  ...,  0.8921,  2.6914, -1.5664],
          ...,
          [ 0.3398, -1.0713,  0.1498,  ...,  0.3423, -2.1895, -0.4036],
          [ 0.9023, -1.8779, -0.8105,  ...,  0.4697,  0.7217, -1.0469],
          [ 0.0039, -0.8315,  2.7871,  ..., -0.3640, -2.0547, -0.4512]],

         [[ 0.4680,  0.3484, -1.5010,  ...,  0.6655,  0.1313, -0.8145],
          [ 1.3809, -1.5566, -1.0830,  ...,  2.0020,  0.2480,  0.3384],
          [-0.4377, -2.1113,  0.8413,  ...,  0.9307,  2.6602, -1.5176],
          ...,
          [ 0.3596, -1.0381,  0.0966,  ...,  0.3608, -2.3066, -0.3225],
          [ 0.7534, -1.8477, -0.7485,  ...,  0.5210,  0.7729, -0.9551],
          [ 0.1367, -0.8545,  2.7500,  ..., -0.3613, -2.0508, -0.4653]],

         [[ 0.5244,  0.3140, -1.4541,  ...,  0.7041,  0.0426, -0.7324],
          [ 1.4600, -1.4590, -1.0586,  ...,  1.9473,  0.2494,  0.3352],
          [-0.3691, -1.9336,  0.9453,  ...,  0.8892,  2.5996, -1.5752],
          ...,
          [ 0.3623, -1.0244,  0.0042,  ...,  0.3435, -2.3047, -0.3779],
          [ 0.8267, -1.9219, -0.8105,  ...,  0.4734,  0.7446, -0.9868],
          [ 0.1404, -0.8999,  2.7637,  ..., -0.3530, -2.0195, -0.5654]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[ 0.0399,  0.2137,  0.3271,  ..., -0.0146, -0.1615, -0.1609],
          [ 1.3438, -1.1543, -0.0302,  ...,  0.7021, -0.1709,  1.0371],
          [-1.2383,  0.7759,  0.9478,  ...,  0.9390,  0.3677, -1.8330],
          ...,
          [ 1.0283, -0.8062,  0.6621,  ...,  0.6509, -1.3740,  0.2839],
          [-0.6040,  0.7271, -0.5757,  ...,  0.7925,  0.5791, -0.5371],
          [ 0.3708, -1.4658,  1.7793,  ..., -2.1836, -1.9346, -0.6792]],

         [[-0.3679,  1.6357, -0.7173,  ...,  0.4890,  0.5273,  1.0195],
          [-1.3408, -0.9189, -3.8594,  ..., -1.2266, -0.6479, -2.1621],
          [ 1.2090, -0.4062,  2.0254,  ...,  0.9541, -0.9370,  0.1737],
          ...,
          [-1.2285, -0.5498, -1.3291,  ..., -0.2900,  0.3982, -0.3826],
          [ 1.7900, -0.5303,  1.2656,  ..., -0.1140, -1.8818,  1.9531],
          [-0.7593, -0.1313,  0.5688,  ..., -0.9194, -1.2832,  0.2979]],

         [[-0.3406,  1.4326, -0.6118,  ...,  0.4509,  0.6445,  0.8911],
          [-1.2402, -0.8052, -3.3867,  ..., -1.3857, -0.7026, -2.4082],
          [ 1.3750, -0.6680,  2.0176,  ...,  1.1455, -0.7603,  0.1240],
          ...,
          [-1.2656, -0.4980, -1.4668,  ..., -0.3394,  0.7002, -0.4392],
          [ 2.1250, -0.4832,  1.3594,  ..., -0.1954, -1.7793,  2.3574],
          [-0.8076,  0.1248,  0.5479,  ..., -0.8608, -1.3135,  0.7700]],

         ...,

         [[-0.2308,  1.2832, -0.5464,  ...,  0.3157,  0.5962,  0.9604],
          [-1.1670, -0.5669, -2.9727,  ..., -1.4961, -0.5977, -2.4883],
          [ 1.2852, -1.0176,  1.8369,  ...,  0.7852, -0.9561,  0.1326],
          ...,
          [-1.2188, -0.4021, -1.6035,  ..., -0.1921,  0.9849, -0.4758],
          [ 2.1699, -0.1891,  1.3408,  ...,  0.0409, -2.0605,  2.4395],
          [-1.0322,  0.3169,  0.5010,  ..., -0.9043, -1.4805,  0.8745]],

         [[-0.2405,  1.1621, -0.4849,  ...,  0.2932,  0.5742,  1.0176],
          [-1.2305, -0.5503, -2.9883,  ..., -1.5166, -0.4719, -2.4805],
          [ 1.3516, -0.9790,  1.7285,  ...,  0.6851, -0.9937,  0.2659],
          ...,
          [-1.2314, -0.4570, -1.5625,  ..., -0.2467,  1.0664, -0.4575],
          [ 2.0293,  0.0531,  1.4004,  ...,  0.0634, -2.1348,  2.5449],
          [-1.1074,  0.4226,  0.5273,  ..., -0.9863, -1.5020,  0.9121]],

         [[-0.2842,  1.0957, -0.4421,  ...,  0.3013,  0.5806,  0.9873],
          [-1.3438, -0.4473, -3.0117,  ..., -1.5820, -0.5103, -2.5527],
          [ 1.4961, -0.8643,  1.8398,  ...,  0.7446, -0.9199,  0.1938],
          ...,
          [-1.3252, -0.4048, -1.6621,  ..., -0.1481,  1.0684, -0.4810],
          [ 2.0391, -0.0474,  1.4404,  ...,  0.0536, -2.0332,  2.6582],
          [-1.1416,  0.4741,  0.4216,  ..., -0.9355, -1.4199,  0.9023]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 8.9569e-03,  8.2703e-03,  1.0765e-02,  ..., -1.2787e-02,
           -1.9882e-02,  2.3254e-02],
          [ 2.5654e-03,  9.5139e-03, -4.0588e-03,  ...,  1.4448e-03,
            1.0147e-03,  1.1360e-02],
          [-2.9354e-03, -4.4250e-03,  6.3934e-03,  ...,  1.0818e-02,
            7.0877e-03, -1.3084e-03],
          ...,
          [-2.3365e-03, -1.9479e-04,  1.7609e-02,  ..., -1.0399e-02,
           -8.0185e-03, -3.5915e-03],
          [ 1.0460e-02, -5.8403e-03,  3.5019e-03,  ..., -1.0338e-03,
           -2.3251e-03,  8.8730e-03],
          [ 4.9934e-03, -1.0147e-02, -4.7874e-03,  ..., -7.2861e-03,
           -3.5801e-03, -4.7607e-03]],

         [[ 1.3525e-01,  2.6562e-01,  7.2217e-01,  ..., -5.1562e-01,
           -6.5527e-01,  7.6270e-01],
          [-9.8877e-03, -2.7539e-01,  2.5681e-02,  ..., -2.5122e-01,
           -2.1045e-01,  1.3969e-02],
          [ 4.8389e-01,  1.5430e-01,  5.5359e-02,  ...,  5.5566e-01,
            2.4097e-01, -1.7664e-01],
          ...,
          [ 2.9810e-01, -2.7173e-01,  4.5996e-01,  ...,  4.9591e-03,
           -6.9092e-01, -9.5398e-02],
          [-1.2236e+00,  3.5986e-01,  4.1919e-01,  ...,  3.8818e-01,
           -5.6152e-01,  9.6985e-02],
          [ 1.6736e-01, -1.8066e-01,  2.4573e-01,  ..., -4.1718e-02,
            9.4177e-02,  5.4688e-02]],

         [[ 1.4824e-02,  1.8054e-01,  5.2393e-01,  ..., -6.0303e-01,
           -6.2695e-01,  7.8320e-01],
          [-3.0319e-02, -2.7344e-01, -4.8920e-02,  ..., -3.1421e-01,
           -2.0886e-01,  1.3794e-01],
          [ 4.5825e-01,  1.4612e-01, -4.5227e-02,  ...,  5.7617e-01,
            3.3521e-01, -1.9824e-01],
          ...,
          [ 2.0227e-01, -2.4927e-01,  3.7939e-01,  ..., -9.8267e-03,
           -6.4258e-01, -2.0752e-01],
          [-1.2402e+00,  3.2056e-01,  4.9365e-01,  ...,  2.5830e-01,
           -5.3613e-01,  2.8168e-02],
          [ 1.5356e-01, -7.3547e-02,  2.0532e-01,  ..., -2.6642e-02,
            1.3452e-01,  3.6987e-02]],

         ...,

         [[ 4.7394e-02,  2.2058e-01,  4.4434e-01,  ..., -5.8447e-01,
           -7.9980e-01,  6.7969e-01],
          [-5.4810e-02, -2.5659e-01, -6.7932e-02,  ..., -3.3301e-01,
           -2.3804e-01,  2.0496e-01],
          [ 5.3906e-01,  7.6355e-02, -1.0486e-01,  ...,  5.6494e-01,
            2.9150e-01, -1.6785e-01],
          ...,
          [ 1.5540e-01, -2.2864e-01,  3.7354e-01,  ..., -2.0691e-02,
           -6.6992e-01, -1.8494e-01],
          [-1.1660e+00,  2.1790e-01,  5.6396e-01,  ...,  2.3596e-01,
           -5.4150e-01,  7.8247e-02],
          [ 1.9031e-01, -1.0797e-01,  1.7627e-01,  ..., -3.7460e-03,
            1.0144e-01,  1.5640e-02]],

         [[ 8.9798e-03,  2.3657e-01,  4.6338e-01,  ..., -5.8789e-01,
           -8.0811e-01,  6.5430e-01],
          [-9.6558e-02, -2.4023e-01, -9.0210e-02,  ..., -3.2715e-01,
           -2.7612e-01,  2.2290e-01],
          [ 5.6641e-01,  1.0565e-01, -5.4108e-02,  ...,  5.6445e-01,
            2.7148e-01, -1.4905e-01],
          ...,
          [ 1.5625e-01, -2.2278e-01,  3.8745e-01,  ..., -5.7739e-02,
           -6.7871e-01, -1.4966e-01],
          [-1.1680e+00,  1.8677e-01,  5.6592e-01,  ...,  2.0715e-01,
           -5.4297e-01,  7.4951e-02],
          [ 2.3730e-01, -7.5195e-02,  1.8054e-01,  ..., -5.2704e-02,
            1.3025e-01,  7.9956e-03]],

         [[ 2.1271e-02,  2.1411e-01,  4.3286e-01,  ..., -6.1768e-01,
           -7.5098e-01,  6.6846e-01],
          [-8.3130e-02, -2.4561e-01, -7.5806e-02,  ..., -3.3740e-01,
           -2.7368e-01,  2.3242e-01],
          [ 5.8691e-01,  1.1139e-01, -9.4971e-02,  ...,  5.9375e-01,
            2.7393e-01, -1.2585e-01],
          ...,
          [ 1.4673e-01, -2.0227e-01,  3.5718e-01,  ..., -8.8257e-02,
           -7.0264e-01, -1.6357e-01],
          [-1.1885e+00,  1.9067e-01,  5.3076e-01,  ...,  2.2070e-01,
           -5.0586e-01,  8.0811e-02],
          [ 2.3169e-01, -4.5715e-02,  1.6736e-01,  ..., -4.6906e-02,
            1.2451e-01,  1.0353e-02]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[ 0.0361,  0.2218,  0.4978,  ..., -0.5845, -0.7388,  0.7041],
         [-0.0600, -0.2583, -0.0640,  ..., -0.3269, -0.2534,  0.1898],
         [ 0.5293,  0.1098, -0.0682,  ...,  0.5845,  0.2832, -0.1661],
         ...,
         [ 0.1720, -0.2325,  0.3767,  ..., -0.0427, -0.6719, -0.1727],
         [-1.1924,  0.2341,  0.5361,  ...,  0.2355, -0.5371,  0.0677],
         [ 0.1962, -0.0865,  0.1858,  ..., -0.0372,  0.1178,  0.0262]],

        [[ 0.0106,  0.0195,  0.0371,  ..., -0.0426, -0.0570,  0.0594],
         [-0.0188, -0.1245, -0.0243,  ..., -0.1512, -0.1146,  0.0786],
         [ 0.2534,  0.0530, -0.0273,  ...,  0.2949,  0.1450, -0.0875],
         ...,
         [ 0.0058, -0.0097,  0.0322,  ..., -0.0109, -0.0334, -0.0096],
         [-0.2900,  0.0617,  0.1307,  ...,  0.0633, -0.1367,  0.0228],
         [ 0.1493, -0.0723,  0.1448,  ..., -0.0299,  0.0898,  0.0212]],

        [[ 0.0107,  0.0201,  0.0385,  ..., -0.0442, -0.0591,  0.0613],
         [-0.0173, -0.1130, -0.0229,  ..., -0.1385, -0.1050,  0.0736],
         [ 0.1947,  0.0399, -0.0195,  ...,  0.2297,  0.1133, -0.0677],
         ...,
         [ 0.0068, -0.0109,  0.0341,  ..., -0.0110, -0.0366, -0.0104],
         [-0.3154,  0.0668,  0.1421,  ...,  0.0683, -0.1481,  0.0240],
         [ 0.1321, -0.0648,  0.1270,  ..., -0.0272,  0.0787,  0.0181]],

        ...,

        [[ 0.0105,  0.0185,  0.0348,  ..., -0.0400, -0.0539,  0.0562],
         [-0.0141, -0.0953, -0.0196,  ..., -0.1178, -0.0894,  0.0635],
         [ 0.1820,  0.0374, -0.0174,  ...,  0.2162,  0.1068, -0.0637],
         ...,
         [ 0.0072, -0.0115,  0.0349,  ..., -0.0110, -0.0382, -0.0108],
         [-0.2717,  0.0567,  0.1238,  ...,  0.0587, -0.1285,  0.0220],
         [ 0.1366, -0.0677,  0.1329,  ..., -0.0279,  0.0819,  0.0193]],

        [[ 0.0105,  0.0187,  0.0352,  ..., -0.0405, -0.0546,  0.0569],
         [-0.0140, -0.0947, -0.0194,  ..., -0.1170, -0.0888,  0.0630],
         [ 0.1753,  0.0360, -0.0164,  ...,  0.2087,  0.1032, -0.0615],
         ...,
         [ 0.0070, -0.0112,  0.0345,  ..., -0.0110, -0.0374, -0.0106],
         [-0.2576,  0.0534,  0.1179,  ...,  0.0555, -0.1221,  0.0213],
         [ 0.1392, -0.0690,  0.1359,  ..., -0.0283,  0.0836,  0.0199]],

        [[ 0.0105,  0.0188,  0.0355,  ..., -0.0408, -0.0550,  0.0573],
         [-0.0140, -0.0944, -0.0195,  ..., -0.1168, -0.0886,  0.0630],
         [ 0.1616,  0.0329, -0.0147,  ...,  0.1935,  0.0958, -0.0568],
         ...,
         [ 0.0073, -0.0115,  0.0350,  ..., -0.0110, -0.0384, -0.0108],
         [-0.3042,  0.0637,  0.1378,  ...,  0.0653, -0.1429,  0.0235],
         [ 0.1326, -0.0660,  0.1289,  ..., -0.0273,  0.0793,  0.0187]]],
       device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[ 2.1270, -1.5967, -1.8926,  ...,  0.8213, -1.2627, -2.1270],
          [-0.1897,  0.1013,  0.9556,  ..., -0.1089,  1.5811, -1.1641],
          [ 1.1602,  2.2480,  0.7974,  ...,  0.4709,  0.9233,  1.1768],
          ...,
          [-1.1738, -0.0595, -1.4062,  ..., -1.2754,  0.9204,  1.4492],
          [ 0.1425,  1.4170, -1.5674,  ...,  2.4883, -1.0283,  0.6001],
          [ 0.6606, -1.7598,  0.5454,  ..., -0.6938,  0.9824,  0.8389]],

         [[ 1.5586, -0.2996, -0.5015,  ...,  0.2419, -0.9551,  1.4326],
          [-1.3525, -0.4382,  1.0146,  ..., -1.0596, -1.1240,  1.9912],
          [-0.5767, -0.8677, -0.3350,  ...,  0.2642,  0.1991, -1.7402],
          ...,
          [ 0.3225,  0.6128,  0.0975,  ...,  1.3379,  0.4836, -0.6201],
          [-2.0840, -1.7949,  2.9785,  ..., -1.2939,  0.8188,  1.3320],
          [-2.2734,  1.6709, -0.8540,  ...,  1.3916, -0.3547, -0.6836]],

         [[ 1.5332, -0.4353, -0.6123,  ...,  0.3157, -1.3105,  1.5908],
          [-1.5469, -0.6069,  1.0996,  ..., -1.2334, -1.1406,  1.8252],
          [-0.7368, -0.7866, -0.3723,  ...,  0.1484,  0.1132, -1.7510],
          ...,
          [ 0.4172,  0.6094,  0.3120,  ...,  1.2314,  0.4443, -0.7285],
          [-2.2246, -1.8291,  3.1484,  ..., -1.4834,  0.5889,  1.5303],
          [-2.4375,  1.8350, -0.9355,  ...,  1.3135, -0.5879, -0.7139]],

         ...,

         [[ 1.2119, -0.3433, -0.6846,  ...,  0.5771, -1.3613,  1.5449],
          [-1.6562, -0.7310,  1.0811,  ..., -1.2539, -1.1035,  1.7646],
          [-0.8325, -1.1250, -0.3152,  ...,  0.0481,  0.0397, -1.7148],
          ...,
          [ 0.4690,  0.6831,  0.3640,  ...,  1.0635,  0.5215, -0.6528],
          [-2.4805, -1.8672,  3.2676,  ..., -1.5654,  0.5063,  1.5762],
          [-2.3379,  1.8281, -0.9971,  ...,  1.2646, -0.5654, -0.6753]],

         [[ 1.1650, -0.3293, -0.7568,  ...,  0.5811, -1.3574,  1.5400],
          [-1.7324, -0.6504,  1.0811,  ..., -1.3008, -1.1338,  1.7539],
          [-0.8325, -1.1064, -0.3428,  ...,  0.0511,  0.0621, -1.6699],
          ...,
          [ 0.4746,  0.7129,  0.3367,  ...,  1.0332,  0.5562, -0.6504],
          [-2.5059, -1.8799,  3.3125,  ..., -1.5596,  0.4553,  1.5928],
          [-2.2930,  1.8877, -1.0703,  ...,  1.2598, -0.5571, -0.6221]],

         [[ 1.1934, -0.3145, -0.7729,  ...,  0.5762, -1.4863,  1.5986],
          [-1.6699, -0.7651,  1.0801,  ..., -1.3145, -1.0713,  1.7256],
          [-0.8564, -1.0732, -0.3340,  ...,  0.0703,  0.0212, -1.6064],
          ...,
          [ 0.4612,  0.6216,  0.3418,  ...,  0.9663,  0.4644, -0.6694],
          [-2.6641, -1.9053,  3.3828,  ..., -1.6006,  0.4563,  1.6982],
          [-2.4082,  1.9863, -1.0654,  ...,  1.2393, -0.5913, -0.6719]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[-1.2324,  0.1561,  1.0498,  ..., -0.6191,  0.5073,  0.6665],
          [-0.0718, -0.3345, -0.2144,  ..., -0.0404, -1.0723,  1.1523],
          [-0.4434, -0.7202,  0.9287,  ...,  0.7236,  0.1963, -0.8667],
          ...,
          [ 0.4158,  0.2603,  1.0078,  ...,  0.9761, -0.5015, -0.9561],
          [-0.8535, -1.4736,  0.2234,  ..., -1.3047,  0.4138, -0.9126],
          [-0.5737,  1.7490,  0.2043,  ...,  0.4309,  0.4673, -0.6387]],

         [[ 1.6670, -2.3926, -3.6582,  ..., -0.2393, -2.3535,  0.3406],
          [-0.3936, -0.1195, -2.4219,  ..., -0.4688,  3.5352, -0.6724],
          [ 2.0859,  1.6895,  0.5820,  ..., -0.4802,  1.1904,  0.3167],
          ...,
          [-0.7358,  0.6226,  0.1819,  ..., -0.2145,  0.7192, -0.0994],
          [-0.9683,  0.9380, -0.8813,  ...,  1.6621, -3.9824,  0.7559],
          [ 0.5234, -1.3945, -1.0518,  ...,  0.0332,  0.2389,  0.4019]],

         [[ 1.8115, -2.6055, -3.9609,  ...,  0.1628, -2.5293,  0.1316],
          [-0.5762,  0.0741, -2.1465,  ..., -0.6548,  3.8066, -0.5396],
          [ 2.2266,  2.0430,  0.6865,  ..., -0.6201,  1.3818,  0.3586],
          ...,
          [-0.7212,  0.6729,  0.0389,  ..., -0.1724,  0.9541,  0.0734],
          [-0.7939,  0.9321, -0.9575,  ...,  1.9629, -4.2109,  0.7256],
          [ 0.6182, -1.4072, -1.1719,  ..., -0.2649, -0.0103,  0.5269]],

         ...,

         [[ 2.0078, -2.4629, -4.0312,  ...,  0.3928, -2.6230, -0.0314],
          [-0.8877, -0.0268, -2.0195,  ..., -0.7031,  3.9453, -0.5571],
          [ 2.4824,  2.2656,  0.8198,  ..., -0.7568,  1.4180,  0.4314],
          ...,
          [-0.6631,  0.7710,  0.0995,  ..., -0.4102,  1.2041,  0.1104],
          [-0.6851,  0.8525, -0.8359,  ...,  1.8408, -4.2070,  0.6758],
          [ 0.9272, -1.4375, -1.2812,  ..., -0.1965, -0.0509,  0.6494]],

         [[ 1.9775, -2.4375, -4.0273,  ...,  0.4202, -2.6250, -0.1180],
          [-0.8921, -0.0813, -2.0020,  ..., -0.6831,  3.9453, -0.5459],
          [ 2.5098,  2.2930,  0.7969,  ..., -0.7847,  1.3926,  0.4607],
          ...,
          [-0.5947,  0.7666,  0.1091,  ..., -0.4678,  1.2959,  0.1642],
          [-0.6860,  0.8706, -0.8296,  ...,  1.8242, -4.2266,  0.7529],
          [ 0.9463, -1.4404, -1.2598,  ..., -0.2015, -0.0875,  0.6924]],

         [[ 2.0195, -2.4785, -4.1094,  ...,  0.4285, -2.6602, -0.1426],
          [-0.7783, -0.0776, -1.9893,  ..., -0.7305,  3.9512, -0.4761],
          [ 2.5645,  2.3145,  0.7788,  ..., -0.7769,  1.4023,  0.4573],
          ...,
          [-0.5698,  0.7202,  0.0712,  ..., -0.4924,  1.2969,  0.1976],
          [-0.6987,  0.8813, -0.8394,  ...,  1.9580, -4.3828,  0.7339],
          [ 0.8887, -1.4062, -1.2588,  ..., -0.2246, -0.1571,  0.6514]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[-3.5210e-03,  1.4709e-02,  2.3975e-03,  ..., -1.6907e-02,
           -6.0692e-03, -1.3199e-02],
          [ 5.7106e-03, -4.7684e-03,  5.8708e-03,  ..., -1.0628e-02,
            3.9711e-03, -7.1793e-03],
          [ 9.1705e-03,  8.9951e-03,  1.1253e-03,  ...,  1.3504e-03,
           -3.2997e-03,  8.9111e-03],
          ...,
          [ 1.4572e-02, -6.8207e-03,  7.3318e-03,  ...,  2.3087e-02,
            4.0207e-03,  3.5453e-04],
          [ 1.8951e-02, -4.0359e-03,  9.0408e-03,  ..., -8.5983e-03,
           -1.2146e-02,  1.0223e-02],
          [ 1.8524e-02,  1.5869e-02, -7.1716e-03,  ..., -1.7181e-02,
           -7.5989e-03,  1.4130e-02]],

         [[ 3.8745e-01,  6.6699e-01,  5.0879e-01,  ..., -2.5024e-01,
           -1.1261e-02, -2.3401e-01],
          [ 1.9043e-01,  4.9194e-01, -4.6436e-01,  ..., -5.6006e-01,
            7.9712e-02, -2.9639e-01],
          [-3.4302e-01,  5.9375e-01,  4.4037e-02,  ...,  4.6899e-01,
           -5.1416e-01,  7.8125e-02],
          ...,
          [ 2.5220e-01, -3.4790e-02,  1.3147e-01,  ...,  6.8115e-01,
            4.0112e-01, -7.0496e-02],
          [-2.9175e-01, -3.4912e-01,  4.7339e-01,  ..., -1.7615e-01,
           -1.4490e-01,  1.3757e-01],
          [ 2.0239e-01,  7.4561e-01, -4.1309e-01,  ..., -3.4180e-01,
           -6.3477e-01, -3.4302e-01]],

         [[ 4.0991e-01,  6.0254e-01,  4.9585e-01,  ..., -3.5205e-01,
            3.6163e-02, -2.9419e-01],
          [ 6.8420e-02,  5.2490e-01, -4.7827e-01,  ..., -5.8203e-01,
            5.7343e-02, -3.2910e-01],
          [-3.6133e-01,  5.9814e-01,  5.3986e-02,  ...,  4.9976e-01,
           -4.3384e-01, -9.1095e-03],
          ...,
          [ 3.2910e-01, -1.5295e-01,  9.1370e-02,  ...,  6.8018e-01,
            3.7158e-01, -8.8196e-02],
          [-2.8735e-01, -3.8110e-01,  4.7437e-01,  ..., -1.5454e-01,
           -1.1438e-01,  1.3196e-01],
          [ 3.3667e-01,  6.2207e-01, -3.9258e-01,  ..., -3.1641e-01,
           -6.1182e-01, -3.3569e-01]],

         ...,

         [[ 4.8071e-01,  5.1709e-01,  4.0991e-01,  ..., -4.2505e-01,
            2.5833e-02, -2.9199e-01],
          [ 5.4810e-02,  5.3418e-01, -5.3125e-01,  ..., -6.1963e-01,
           -3.0411e-02, -4.1699e-01],
          [-2.3132e-01,  5.2734e-01,  4.2450e-02,  ...,  5.3516e-01,
           -4.8022e-01, -9.1171e-03],
          ...,
          [ 4.1406e-01, -1.6858e-01,  3.8696e-02,  ...,  7.1729e-01,
            2.6392e-01, -3.7506e-02],
          [-2.8735e-01, -4.0454e-01,  4.6045e-01,  ..., -1.4905e-01,
           -1.0938e-01,  5.0964e-02],
          [ 3.4619e-01,  6.1865e-01, -4.2554e-01,  ..., -3.8306e-01,
           -6.1133e-01, -3.6255e-01]],

         [[ 5.0635e-01,  5.0488e-01,  4.3091e-01,  ..., -4.1260e-01,
            1.6769e-02, -2.8027e-01],
          [ 9.0149e-02,  5.4248e-01, -6.0596e-01,  ..., -5.8350e-01,
           -3.4546e-02, -4.3335e-01],
          [-2.2998e-01,  5.6104e-01,  3.6072e-02,  ...,  5.6592e-01,
           -4.7803e-01,  3.7861e-03],
          ...,
          [ 4.1455e-01, -1.8103e-01,  3.8879e-02,  ...,  7.5293e-01,
            2.6074e-01, -6.3538e-02],
          [-3.1445e-01, -4.0771e-01,  4.5239e-01,  ..., -1.2939e-01,
           -1.0022e-01,  7.7454e-02],
          [ 3.3423e-01,  6.3965e-01, -4.3604e-01,  ..., -3.7036e-01,
           -6.1572e-01, -3.7573e-01]],

         [[ 5.2051e-01,  5.1221e-01,  4.2725e-01,  ..., -4.2993e-01,
            3.7251e-03, -2.6611e-01],
          [ 7.0984e-02,  5.1514e-01, -5.8301e-01,  ..., -5.7520e-01,
           -4.0131e-02, -4.3506e-01],
          [-2.3987e-01,  5.4492e-01,  3.9551e-02,  ...,  5.6445e-01,
           -4.8828e-01, -1.3458e-02],
          ...,
          [ 3.9844e-01, -2.0056e-01,  4.4495e-02,  ...,  7.1484e-01,
            2.7734e-01, -5.3253e-02],
          [-2.6929e-01, -3.9624e-01,  5.0391e-01,  ..., -1.5674e-01,
           -1.1499e-01,  8.2397e-02],
          [ 3.3618e-01,  6.2354e-01, -4.1064e-01,  ..., -3.2397e-01,
           -6.1230e-01, -3.9697e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[ 4.7412e-01,  5.4834e-01,  4.3604e-01,  ..., -3.9478e-01,
           1.9348e-02, -2.7979e-01],
         [ 7.6904e-02,  5.2734e-01, -5.3174e-01,  ..., -5.9863e-01,
          -1.6069e-03, -3.8330e-01],
         [-2.6758e-01,  5.5615e-01,  4.4098e-02,  ...,  5.2734e-01,
          -4.7363e-01, -6.2904e-03],
         ...,
         [ 3.7744e-01, -1.6296e-01,  5.7220e-02,  ...,  7.1191e-01,
           3.0786e-01, -5.8685e-02],
         [-2.8564e-01, -3.9038e-01,  4.6167e-01,  ..., -1.5149e-01,
          -1.1670e-01,  9.3628e-02],
         [ 3.2422e-01,  6.4014e-01, -4.2261e-01,  ..., -3.4741e-01,
          -6.1475e-01, -3.5913e-01]],

        [[ 2.4933e-02,  4.8950e-02,  2.9877e-02,  ..., -3.8940e-02,
          -4.5662e-03, -2.9465e-02],
         [ 1.1238e-02,  3.2257e-02, -3.0991e-02,  ..., -5.1636e-02,
           4.2152e-03, -3.2654e-02],
         [-1.1864e-03,  2.8168e-02,  2.6646e-03,  ...,  1.8829e-02,
          -1.9424e-02,  8.7357e-03],
         ...,
         [ 1.6373e-02, -7.5684e-03,  7.6180e-03,  ...,  2.6581e-02,
           5.6152e-03,  4.7505e-05],
         [-2.6230e-02, -6.1218e-02,  7.5928e-02,  ..., -2.9633e-02,
          -2.7618e-02,  2.2156e-02],
         [ 2.8870e-02,  3.8025e-02, -2.1698e-02,  ..., -2.8732e-02,
          -2.8885e-02,  1.1301e-03]],

        [[ 3.5553e-02,  6.1676e-02,  4.0100e-02,  ..., -4.7180e-02,
          -3.9978e-03, -3.5553e-02],
         [ 1.3145e-02,  4.5013e-02, -4.3640e-02,  ..., -6.5735e-02,
           4.3488e-03, -4.1412e-02],
         [-7.7343e-04,  2.7435e-02,  2.6054e-03,  ...,  1.8173e-02,
          -1.8799e-02,  8.7280e-03],
         ...,
         [ 1.5961e-02, -7.3929e-03,  7.5493e-03,  ...,  2.5772e-02,
           5.2452e-03,  1.1885e-04],
         [-1.6754e-02, -4.9286e-02,  6.1920e-02,  ..., -2.5192e-02,
          -2.4338e-02,  1.9577e-02],
         [ 2.8656e-02,  3.7415e-02, -2.1347e-02,  ..., -2.8442e-02,
          -2.8336e-02,  1.4420e-03]],

        ...,

        [[ 3.3142e-02,  5.8746e-02,  3.7750e-02,  ..., -4.5319e-02,
          -4.1313e-03, -3.4149e-02],
         [ 1.2909e-02,  4.3335e-02, -4.2023e-02,  ..., -6.3904e-02,
           4.3221e-03, -4.0283e-02],
         [ 1.3466e-03,  2.3483e-02,  2.2869e-03,  ...,  1.4557e-02,
          -1.5488e-02,  8.7814e-03],
         ...,
         [ 1.5884e-02, -7.3624e-03,  7.5378e-03,  ...,  2.5635e-02,
           5.1765e-03,  1.3173e-04],
         [-9.0714e-03, -3.9551e-02,  5.0537e-02,  ..., -2.1606e-02,
          -2.1713e-02,  1.7548e-02],
         [ 2.9282e-02,  3.8666e-02, -2.2186e-02,  ..., -2.9129e-02,
          -2.9572e-02,  6.7616e-04]],

        [[ 2.9648e-02,  5.4504e-02,  3.4332e-02,  ..., -4.2603e-02,
          -4.3182e-03, -3.2135e-02],
         [ 1.2978e-02,  4.3915e-02, -4.2572e-02,  ..., -6.4514e-02,
           4.3221e-03, -4.0680e-02],
         [ 1.5383e-03,  2.3132e-02,  2.2602e-03,  ...,  1.4236e-02,
          -1.5190e-02,  8.7891e-03],
         ...,
         [ 1.5884e-02, -7.3662e-03,  7.5378e-03,  ...,  2.5635e-02,
           5.1804e-03,  1.3137e-04],
         [-7.2098e-03, -3.7170e-02,  4.7791e-02,  ..., -2.0737e-02,
          -2.1072e-02,  1.7044e-02],
         [ 2.9922e-02,  4.0009e-02, -2.3071e-02,  ..., -2.9831e-02,
          -3.0869e-02, -1.1945e-04]],

        [[ 3.4241e-02,  6.0059e-02,  3.8818e-02,  ..., -4.6143e-02,
          -4.0779e-03, -3.4760e-02],
         [ 1.3344e-02,  4.6265e-02, -4.4891e-02,  ..., -6.7139e-02,
           4.3602e-03, -4.2267e-02],
         [ 1.8990e-04,  2.5635e-02,  2.4605e-03,  ...,  1.6525e-02,
          -1.7303e-02,  8.7585e-03],
         ...,
         [ 1.5976e-02, -7.4043e-03,  7.5531e-03,  ...,  2.5818e-02,
           5.2605e-03,  1.1569e-04],
         [-9.6436e-03, -4.0283e-02,  5.1422e-02,  ..., -2.1881e-02,
          -2.1896e-02,  1.7685e-02],
         [ 3.0090e-02,  4.0344e-02, -2.3300e-02,  ..., -3.0014e-02,
          -3.1189e-02, -3.2115e-04]]], device='cuda:0', dtype=torch.float16)
num_prefill_tokens 2048
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[ 1.2109,  0.2395, -1.7393,  ...,  1.1514,  1.1533, -0.5981],
          [ 3.2441, -0.5161,  0.1639,  ...,  1.9834,  0.0388,  1.0303],
          [ 0.3918, -0.3743, -1.7295,  ...,  0.6743,  2.1836, -0.4644],
          ...,
          [-0.0576,  0.8867, -0.6445,  ...,  2.0859,  0.2566,  2.2598],
          [-1.5801,  0.2578,  2.0020,  ..., -1.2051, -0.0812,  1.0596],
          [-0.0810, -0.2281, -0.8184,  ...,  0.3660, -0.6309, -2.0527]],

         [[ 0.9604, -0.7314,  1.5771,  ..., -1.2021,  0.3296,  0.4248],
          [ 1.3691, -0.2935, -1.2500,  ...,  0.5815, -2.4766, -1.8164],
          [-2.3672,  0.8872, -0.9058,  ..., -1.7207, -1.8301,  1.5391],
          ...,
          [ 0.3892, -0.0950, -0.2532,  ..., -0.8853, -1.6289,  0.1571],
          [-0.5742, -0.7720, -1.6572,  ...,  1.5010,  1.0576,  1.5459],
          [-0.1274, -0.0094,  1.2568,  ..., -0.0983, -0.6260, -0.0542]],

         [[ 0.8540, -0.8892,  1.6465,  ..., -0.8613,  0.7109,  0.2418],
          [ 1.2373, -0.2201, -1.3584,  ...,  0.6357, -2.9121, -1.5645],
          [-2.2422,  1.1924, -0.8213,  ..., -1.4551, -1.7119,  1.6582],
          ...,
          [ 0.5083, -0.0339, -0.6279,  ..., -0.9287, -1.3906,  0.2368],
          [-0.6812, -0.7271, -1.8154,  ...,  1.2676,  0.7681,  1.7324],
          [-0.1423,  0.3655,  1.2627,  ..., -0.0823, -0.7275,  0.2086]],

         ...,

         [[ 1.0137, -0.8071,  1.6240,  ..., -0.6372,  1.0498,  0.1880],
          [ 1.4082, -0.2318, -1.4141,  ...,  0.7446, -3.1465, -1.3301],
          [-2.0195,  1.3936, -0.7280,  ..., -1.5859, -1.5088,  1.6455],
          ...,
          [ 0.5732,  0.1204, -0.8975,  ..., -0.9390, -1.3506,  0.1670],
          [-0.8857, -0.8081, -1.8936,  ...,  1.2559,  0.6255,  1.8047],
          [-0.0850,  0.3608,  1.3467,  ..., -0.1033, -0.7666,  0.3420]],

         [[ 1.0596, -0.8628,  1.6699,  ..., -0.6196,  1.1680,  0.1959],
          [ 1.4082, -0.2148, -1.5088,  ...,  0.8013, -3.1602, -1.3203],
          [-1.9736,  1.3662, -0.6938,  ..., -1.7031, -1.4756,  1.6709],
          ...,
          [ 0.5659,  0.1128, -0.9448,  ..., -0.9448, -1.3730,  0.1368],
          [-0.9414, -0.8545, -1.9189,  ...,  1.3037,  0.6289,  1.7852],
          [-0.0999,  0.2949,  1.3271,  ..., -0.1122, -0.8135,  0.2620]],

         [[ 0.9937, -0.9512,  1.6777,  ..., -0.5767,  1.1533,  0.1344],
          [ 1.2627, -0.1349, -1.4678,  ...,  0.7974, -3.1738, -1.3301],
          [-1.9541,  1.3652, -0.6392,  ..., -1.6182, -1.4951,  1.6670],
          ...,
          [ 0.5703,  0.1128, -0.9282,  ..., -0.8857, -1.2969,  0.0952],
          [-0.8931, -0.8887, -1.9287,  ...,  1.2285,  0.5718,  1.8184],
          [-0.1368,  0.3149,  1.2910,  ..., -0.1381, -0.7671,  0.3342]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[ 1.4375,  1.0420,  0.8315,  ...,  0.5483, -0.4790,  0.0951],
          [ 0.4038,  0.4482, -1.6279,  ..., -1.5732, -0.1721, -1.4814],
          [ 0.3196,  1.6660, -1.5205,  ..., -2.3281, -0.9326,  0.5083],
          ...,
          [ 1.6953,  0.7417,  0.5815,  ..., -0.3430, -0.0756,  0.5059],
          [ 0.3547, -0.5938, -1.1523,  ...,  0.7246,  0.6377,  0.5381],
          [-0.8677,  0.6567,  0.4600,  ...,  1.1035,  0.5098, -0.2925]],

         [[ 1.3525, -1.5225, -0.5239,  ...,  2.4102, -3.4980,  1.1865],
          [ 4.0938, -3.0723, -1.9473,  ...,  1.7607, -1.1289, -0.5493],
          [ 0.1868,  1.8301, -1.1162,  ..., -0.5942,  1.3271,  1.5117],
          ...,
          [ 2.0371,  2.1953, -1.4209,  ...,  0.1281, -0.6733,  2.6855],
          [-1.5225,  0.4526,  2.8359,  ...,  0.2710,  0.6406,  1.6572],
          [ 0.9932,  1.8379, -2.7207,  ...,  1.6797, -0.9243, -1.5166]],

         [[ 1.5283, -1.5723, -0.6240,  ...,  2.3203, -3.5234,  1.3174],
          [ 4.4805, -3.0840, -1.9316,  ...,  1.9199, -0.8989, -0.3516],
          [ 0.1864,  1.6660, -1.2412,  ..., -0.4795,  1.4580,  1.7578],
          ...,
          [ 1.9248,  2.1738, -1.6309,  ...,  0.0102, -0.6792,  2.7168],
          [-1.5684,  0.5347,  2.9570,  ...,  0.2896,  0.4871,  1.6387],
          [ 1.1260,  2.0176, -2.8457,  ...,  1.4697, -0.9165, -1.7061]],

         ...,

         [[ 1.7705, -1.7676, -0.5566,  ...,  2.1973, -3.6660,  1.3496],
          [ 4.3789, -3.0254, -1.5566,  ...,  1.8213, -0.7852,  0.0746],
          [ 0.3594,  1.5000, -1.3135,  ..., -0.3921,  1.5049,  1.9639],
          ...,
          [ 1.8867,  2.2871, -1.6738,  ...,  0.1768, -0.4807,  2.7988],
          [-1.5420,  0.5322,  2.9707,  ...,  0.2457,  0.3396,  1.7793],
          [ 1.3701,  2.1816, -2.7207,  ...,  1.4404, -0.9941, -1.4697]],

         [[ 1.8789, -1.7939, -0.5415,  ...,  2.1465, -3.7168,  1.3916],
          [ 4.4023, -3.0371, -1.5000,  ...,  1.7441, -0.7598,  0.2098],
          [ 0.3293,  1.5225, -1.3086,  ..., -0.4937,  1.4717,  2.0527],
          ...,
          [ 1.8564,  2.3848, -1.7598,  ...,  0.1763, -0.4250,  2.8105],
          [-1.4814,  0.5298,  2.9590,  ...,  0.2196,  0.2832,  1.9014],
          [ 1.4199,  2.3047, -2.6582,  ...,  1.5254, -1.0195, -1.4678]],

         [[ 1.8691, -1.9287, -0.6895,  ...,  2.1758, -3.7305,  1.3574],
          [ 4.5586, -3.0859, -1.6084,  ...,  1.8564, -0.7495,  0.1984],
          [ 0.3301,  1.5137, -1.3477,  ..., -0.5278,  1.5410,  2.0215],
          ...,
          [ 1.9238,  2.3926, -1.7803,  ...,  0.1368, -0.4612,  2.8496],
          [-1.5410,  0.5786,  3.0156,  ...,  0.1602,  0.3086,  1.8818],
          [ 1.3340,  2.3516, -2.6855,  ...,  1.3975, -1.0156, -1.4766]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 4.8599e-03, -1.0963e-02,  3.7003e-04,  ..., -1.1261e-02,
            4.4899e-03,  2.3937e-03],
          [-1.7334e-02, -8.7051e-03, -3.2158e-03,  ..., -1.2222e-02,
           -5.5504e-03,  1.0262e-02],
          [-4.2389e-02, -1.2035e-03,  3.7060e-03,  ...,  4.3182e-03,
           -9.6130e-03, -8.2474e-03],
          ...,
          [ 1.9547e-02, -1.2465e-03, -7.1678e-03,  ..., -4.5990e-02,
            3.3073e-03,  1.2962e-02],
          [ 4.7035e-03,  6.0043e-03, -1.1116e-02,  ..., -2.1744e-02,
            3.1708e-02, -8.1787e-03],
          [-2.5055e-02, -2.4307e-02,  4.4136e-03,  ...,  6.3667e-03,
           -1.2611e-02,  2.0950e-02]],

         [[ 1.7456e-02,  2.0959e-01,  1.4091e-02,  ..., -3.4790e-01,
            3.0273e-01,  2.9053e-01],
          [ 5.1727e-03, -4.8242e-01, -4.7461e-01,  ..., -2.8345e-01,
           -3.6255e-01,  4.8828e-01],
          [-7.3633e-01, -2.6416e-01, -6.1768e-01,  ...,  6.2378e-02,
            4.7803e-01, -1.2402e-01],
          ...,
          [ 3.2861e-01, -1.4099e-01,  1.9275e-01,  ..., -1.3066e+00,
           -2.7161e-02,  6.2805e-02],
          [ 4.8279e-02,  5.1709e-01, -4.6118e-01,  ...,  1.5063e-01,
            6.2402e-01, -2.0264e-01],
          [-2.9297e-01, -4.6289e-01, -1.4816e-02,  ...,  9.1187e-02,
           -2.4646e-01,  6.9946e-02]],

         [[ 1.5053e-02,  2.1838e-01, -5.0629e-02,  ..., -3.8696e-01,
            3.5791e-01,  2.2974e-01],
          [-5.7953e-02, -4.8657e-01, -6.2061e-01,  ..., -2.0691e-01,
           -3.4912e-01,  4.0454e-01],
          [-7.2998e-01, -3.2007e-01, -6.0742e-01,  ..., -5.0903e-02,
            5.1611e-01, -2.6099e-01],
          ...,
          [ 3.1665e-01, -1.7554e-01,  2.1973e-01,  ..., -1.2715e+00,
            4.4098e-02,  1.6650e-01],
          [ 9.3384e-02,  5.0391e-01, -4.4751e-01,  ...,  1.5381e-01,
            5.7178e-01, -1.9702e-01],
          [-2.3877e-01, -4.4727e-01, -6.3232e-02,  ...,  1.3635e-01,
           -1.0583e-01,  1.1456e-01]],

         ...,

         [[ 7.6843e-02,  2.1179e-01, -9.4788e-02,  ..., -4.3945e-01,
            3.4082e-01,  1.8994e-01],
          [-1.0736e-01, -4.3164e-01, -6.1865e-01,  ..., -2.0105e-01,
           -4.3481e-01,  3.2715e-01],
          [-8.8770e-01, -3.5547e-01, -6.4502e-01,  ..., -4.7119e-02,
            4.8657e-01, -2.9541e-01],
          ...,
          [ 3.5156e-01, -6.6284e-02,  2.5879e-01,  ..., -1.3301e+00,
            7.0618e-02,  1.8640e-01],
          [ 1.4563e-01,  5.5176e-01, -3.7134e-01,  ...,  1.4148e-01,
            5.4297e-01, -2.4976e-01],
          [-2.4866e-01, -4.0869e-01, -1.8448e-02,  ...,  1.4771e-01,
           -5.5786e-02,  2.0959e-01]],

         [[ 9.0576e-02,  2.4963e-01, -1.0925e-01,  ..., -4.5093e-01,
            3.5645e-01,  1.5698e-01],
          [-8.2764e-02, -4.2749e-01, -6.1426e-01,  ..., -2.0032e-01,
           -4.1724e-01,  3.7622e-01],
          [-9.2432e-01, -3.6523e-01, -6.3916e-01,  ..., -3.0411e-02,
            4.9268e-01, -2.8052e-01],
          ...,
          [ 3.3179e-01, -2.3376e-02,  2.5708e-01,  ..., -1.3770e+00,
            7.8857e-02,  1.7468e-01],
          [ 1.5027e-01,  5.4883e-01, -3.5669e-01,  ...,  7.5439e-02,
            5.2783e-01, -2.6392e-01],
          [-2.4890e-01, -4.1650e-01, -1.0353e-02,  ...,  1.7346e-01,
           -3.6377e-02,  1.9812e-01]],

         [[ 1.1304e-01,  2.3206e-01, -1.3599e-01,  ..., -4.3726e-01,
            3.3521e-01,  1.6663e-01],
          [-8.2397e-02, -4.5654e-01, -6.0352e-01,  ..., -1.8262e-01,
           -4.3604e-01,  3.8599e-01],
          [-9.3701e-01, -3.9478e-01, -6.2402e-01,  ..., -3.6774e-02,
            5.2588e-01, -3.0615e-01],
          ...,
          [ 3.5913e-01, -1.2741e-02,  2.2571e-01,  ..., -1.3604e+00,
            8.4839e-02,  1.6870e-01],
          [ 1.4282e-01,  5.7520e-01, -3.8159e-01,  ...,  5.1941e-02,
            5.3613e-01, -2.6196e-01],
          [-2.1716e-01, -3.9355e-01, -4.5471e-02,  ...,  1.4978e-01,
           -6.4514e-02,  2.2327e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[ 6.3904e-02,  2.2473e-01, -8.4167e-02,  ..., -4.2065e-01,
           3.4546e-01,  1.9849e-01],
         [-8.6609e-02, -4.5068e-01, -6.1475e-01,  ..., -2.0435e-01,
          -4.1357e-01,  3.7061e-01],
         [-8.5547e-01, -3.4888e-01, -6.2500e-01,  ..., -3.8666e-02,
           4.8755e-01, -2.7417e-01],
         ...,
         [ 3.3838e-01, -7.1350e-02,  2.4097e-01,  ..., -1.3418e+00,
           6.9397e-02,  1.6382e-01],
         [ 1.2866e-01,  5.4541e-01, -3.9258e-01,  ...,  1.1273e-01,
           5.4590e-01, -2.4109e-01],
         [-2.4707e-01, -4.2456e-01, -3.8788e-02,  ...,  1.4221e-01,
          -9.0576e-02,  1.6626e-01]],

        [[ 2.1332e-02,  6.1127e-02, -2.2659e-02,  ..., -1.3574e-01,
           1.0864e-01,  6.5002e-02],
         [-5.3558e-02, -3.4131e-01, -4.3506e-01,  ..., -1.6663e-01,
          -2.9126e-01,  2.9321e-01],
         [-1.4014e-01, -4.2511e-02, -7.5134e-02,  ...,  8.2493e-04,
           5.2551e-02, -3.8239e-02],
         ...,
         [ 6.3721e-02, -1.7593e-02,  2.6871e-02,  ..., -2.2815e-01,
           9.5825e-03,  3.1830e-02],
         [ 1.2794e-02,  4.5502e-02, -4.0863e-02,  ..., -1.0490e-02,
           7.1167e-02, -2.4719e-02],
         [-3.6743e-02, -4.5135e-02,  2.3937e-03,  ...,  1.3695e-02,
          -1.6266e-02,  2.9114e-02]],

        [[ 2.1164e-02,  6.0516e-02, -2.2446e-02,  ..., -1.3464e-01,
           1.0779e-01,  6.4575e-02],
         [-5.7678e-02, -3.8013e-01, -4.8511e-01,  ..., -1.8457e-01,
          -3.2422e-01,  3.2617e-01],
         [-1.9836e-01, -6.7200e-02, -1.2195e-01,  ..., -1.3971e-03,
           8.9478e-02, -5.6274e-02],
         ...,
         [ 7.3792e-02, -2.1286e-02,  3.4637e-02,  ..., -2.6953e-01,
           1.1055e-02,  3.6194e-02],
         [ 1.3382e-02,  4.8401e-02, -4.3030e-02,  ..., -9.6741e-03,
           7.4036e-02, -2.5925e-02],
         [-3.4424e-02, -4.1016e-02,  2.7981e-03,  ...,  1.2238e-02,
          -1.5541e-02,  2.7496e-02]],

        ...,

        [[ 1.6510e-02,  4.0344e-02, -1.5930e-02,  ..., -9.9854e-02,
           7.8674e-02,  4.7089e-02],
         [-5.9631e-02, -4.0381e-01, -5.1465e-01,  ..., -1.9604e-01,
          -3.4424e-01,  3.4717e-01],
         [-2.0264e-01, -6.8970e-02, -1.2549e-01,  ..., -1.4219e-03,
           9.2285e-02, -5.7434e-02],
         ...,
         [ 7.6050e-02, -2.2110e-02,  3.6346e-02,  ..., -2.7881e-01,
           1.1314e-02,  3.7079e-02],
         [ 1.2077e-02,  4.1962e-02, -3.8208e-02,  ..., -1.1505e-02,
           6.7627e-02, -2.3254e-02],
         [-3.2593e-02, -3.7750e-02,  3.1204e-03,  ...,  1.1108e-02,
          -1.4946e-02,  2.6260e-02]],

        [[ 1.5282e-02,  3.4821e-02, -1.4206e-02,  ..., -9.0271e-02,
           7.0679e-02,  4.2267e-02],
         [-5.9601e-02, -4.0796e-01, -5.1904e-01,  ..., -1.9812e-01,
          -3.4717e-01,  3.5083e-01],
         [-1.9934e-01, -6.7566e-02, -1.2292e-01,  ..., -1.2770e-03,
           9.0210e-02, -5.6396e-02],
         ...,
         [ 7.5989e-02, -2.2156e-02,  3.6255e-02,  ..., -2.7856e-01,
           1.1238e-02,  3.6987e-02],
         [ 1.1787e-02,  4.0558e-02, -3.7109e-02,  ..., -1.1917e-02,
           6.6223e-02, -2.2644e-02],
         [-3.1647e-02, -3.6072e-02,  3.2806e-03,  ...,  1.0521e-02,
          -1.4656e-02,  2.5604e-02]],

        [[ 1.5625e-02,  3.6438e-02, -1.4656e-02,  ..., -9.3018e-02,
           7.2998e-02,  4.3732e-02],
         [-6.0150e-02, -4.1187e-01, -5.2441e-01,  ..., -1.9995e-01,
          -3.5083e-01,  3.5425e-01],
         [-2.2131e-01, -7.6843e-02, -1.4050e-01,  ..., -2.1210e-03,
           1.0413e-01, -6.3232e-02],
         ...,
         [ 8.0688e-02, -2.3849e-02,  3.9886e-02,  ..., -2.9785e-01,
           1.1940e-02,  3.9032e-02],
         [ 1.2390e-02,  4.3579e-02, -3.9398e-02,  ..., -1.1047e-02,
           6.9214e-02, -2.3911e-02],
         [-3.2196e-02, -3.7018e-02,  3.1891e-03,  ...,  1.0857e-02,
          -1.4824e-02,  2.5970e-02]]], device='cuda:0', dtype=torch.float16)
hidden_states torch.Size([256, 768])
INFO 06-19 06:43:03 spec_decode_llm_engine.py:167] # GPU blocks: 36524, # CPU blocks: 3640
tensor([[[[ 4.8599e-03, -1.0963e-02,  3.7003e-04,  ..., -1.1261e-02,
            4.4899e-03,  2.3937e-03],
          [-1.7334e-02, -8.7051e-03, -3.2158e-03,  ..., -1.2222e-02,
           -5.5504e-03,  1.0262e-02],
          [-4.2389e-02, -1.2035e-03,  3.7060e-03,  ...,  4.3182e-03,
           -9.6130e-03, -8.2474e-03],
          ...,
          [ 1.9547e-02, -1.2465e-03, -7.1678e-03,  ..., -4.5990e-02,
            3.3073e-03,  1.2962e-02],
          [ 4.7035e-03,  6.0043e-03, -1.1116e-02,  ..., -2.1744e-02,
            3.1708e-02, -8.1787e-03],
          [-2.5055e-02, -2.4307e-02,  4.4136e-03,  ...,  6.3667e-03,
           -1.2611e-02,  2.0950e-02]],

         [[ 1.7456e-02,  2.0959e-01,  1.4091e-02,  ..., -3.4790e-01,
            3.0273e-01,  2.9053e-01],
          [ 5.1727e-03, -4.8242e-01, -4.7461e-01,  ..., -2.8345e-01,
           -3.6255e-01,  4.8828e-01],
          [-7.3633e-01, -2.6416e-01, -6.1768e-01,  ...,  6.2378e-02,
            4.7803e-01, -1.2402e-01],
          ...,
          [ 3.2861e-01, -1.4099e-01,  1.9275e-01,  ..., -1.3066e+00,
           -2.7161e-02,  6.2805e-02],
          [ 4.8279e-02,  5.1709e-01, -4.6118e-01,  ...,  1.5063e-01,
            6.2402e-01, -2.0264e-01],
          [-2.9297e-01, -4.6289e-01, -1.4816e-02,  ...,  9.1187e-02,
           -2.4646e-01,  6.9946e-02]],

         [[ 1.5053e-02,  2.1838e-01, -5.0629e-02,  ..., -3.8696e-01,
            3.5791e-01,  2.2974e-01],
          [-5.7953e-02, -4.8657e-01, -6.2061e-01,  ..., -2.0691e-01,
           -3.4912e-01,  4.0454e-01],
          [-7.2998e-01, -3.2007e-01, -6.0742e-01,  ..., -5.0903e-02,
            5.1611e-01, -2.6099e-01],
          ...,
          [ 3.1665e-01, -1.7554e-01,  2.1973e-01,  ..., -1.2715e+00,
            4.4098e-02,  1.6650e-01],
          [ 9.3384e-02,  5.0391e-01, -4.4751e-01,  ...,  1.5381e-01,
            5.7178e-01, -1.9702e-01],
          [-2.3877e-01, -4.4727e-01, -6.3232e-02,  ...,  1.3635e-01,
           -1.0583e-01,  1.1456e-01]],

         ...,

         [[ 7.6843e-02,  2.1179e-01, -9.4788e-02,  ..., -4.3945e-01,
            3.4082e-01,  1.8994e-01],
          [-1.0736e-01, -4.3164e-01, -6.1865e-01,  ..., -2.0105e-01,
           -4.3481e-01,  3.2715e-01],
          [-8.8770e-01, -3.5547e-01, -6.4502e-01,  ..., -4.7119e-02,
            4.8657e-01, -2.9541e-01],
          ...,
          [ 3.5156e-01, -6.6284e-02,  2.5879e-01,  ..., -1.3301e+00,
            7.0618e-02,  1.8640e-01],
          [ 1.4563e-01,  5.5176e-01, -3.7134e-01,  ...,  1.4148e-01,
            5.4297e-01, -2.4976e-01],
          [-2.4866e-01, -4.0869e-01, -1.8448e-02,  ...,  1.4771e-01,
           -5.5786e-02,  2.0959e-01]],

         [[ 9.0576e-02,  2.4963e-01, -1.0925e-01,  ..., -4.5093e-01,
            3.5645e-01,  1.5698e-01],
          [-8.2764e-02, -4.2749e-01, -6.1426e-01,  ..., -2.0032e-01,
           -4.1724e-01,  3.7622e-01],
          [-9.2432e-01, -3.6523e-01, -6.3916e-01,  ..., -3.0411e-02,
            4.9268e-01, -2.8052e-01],
          ...,
          [ 3.3179e-01, -2.3376e-02,  2.5708e-01,  ..., -1.3770e+00,
            7.8857e-02,  1.7468e-01],
          [ 1.5027e-01,  5.4883e-01, -3.5669e-01,  ...,  7.5439e-02,
            5.2783e-01, -2.6392e-01],
          [-2.4890e-01, -4.1650e-01, -1.0353e-02,  ...,  1.7346e-01,
           -3.6377e-02,  1.9812e-01]],

         [[ 1.1304e-01,  2.3206e-01, -1.3599e-01,  ..., -4.3726e-01,
            3.3521e-01,  1.6663e-01],
          [-8.2397e-02, -4.5654e-01, -6.0352e-01,  ..., -1.8262e-01,
           -4.3604e-01,  3.8599e-01],
          [-9.3701e-01, -3.9478e-01, -6.2402e-01,  ..., -3.6774e-02,
            5.2588e-01, -3.0615e-01],
          ...,
          [ 3.5913e-01, -1.2741e-02,  2.2571e-01,  ..., -1.3604e+00,
            8.4839e-02,  1.6870e-01],
          [ 1.4282e-01,  5.7520e-01, -3.8159e-01,  ...,  5.1941e-02,
            5.3613e-01, -2.6196e-01],
          [-2.1716e-01, -3.9355e-01, -4.5471e-02,  ...,  1.4978e-01,
           -6.4514e-02,  2.2327e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[ 6.3904e-02,  2.2473e-01, -8.4167e-02,  ..., -4.2065e-01,
           3.4546e-01,  1.9849e-01],
         [-8.6609e-02, -4.5068e-01, -6.1475e-01,  ..., -2.0435e-01,
          -4.1357e-01,  3.7061e-01],
         [-8.5547e-01, -3.4888e-01, -6.2500e-01,  ..., -3.8666e-02,
           4.8755e-01, -2.7417e-01],
         ...,
         [ 3.3838e-01, -7.1350e-02,  2.4097e-01,  ..., -1.3418e+00,
           6.9397e-02,  1.6382e-01],
         [ 1.2866e-01,  5.4541e-01, -3.9258e-01,  ...,  1.1273e-01,
           5.4590e-01, -2.4109e-01],
         [-2.4707e-01, -4.2456e-01, -3.8788e-02,  ...,  1.4221e-01,
          -9.0576e-02,  1.6626e-01]],

        [[ 2.1332e-02,  6.1127e-02, -2.2659e-02,  ..., -1.3574e-01,
           1.0864e-01,  6.5002e-02],
         [-5.3558e-02, -3.4131e-01, -4.3506e-01,  ..., -1.6663e-01,
          -2.9126e-01,  2.9321e-01],
         [-1.4014e-01, -4.2511e-02, -7.5134e-02,  ...,  8.2493e-04,
           5.2551e-02, -3.8239e-02],
         ...,
         [ 6.3721e-02, -1.7593e-02,  2.6871e-02,  ..., -2.2815e-01,
           9.5825e-03,  3.1830e-02],
         [ 1.2794e-02,  4.5502e-02, -4.0863e-02,  ..., -1.0490e-02,
           7.1167e-02, -2.4719e-02],
         [-3.6743e-02, -4.5135e-02,  2.3937e-03,  ...,  1.3695e-02,
          -1.6266e-02,  2.9114e-02]],

        [[ 2.1164e-02,  6.0516e-02, -2.2446e-02,  ..., -1.3464e-01,
           1.0779e-01,  6.4575e-02],
         [-5.7678e-02, -3.8013e-01, -4.8511e-01,  ..., -1.8457e-01,
          -3.2422e-01,  3.2617e-01],
         [-1.9836e-01, -6.7200e-02, -1.2195e-01,  ..., -1.3971e-03,
           8.9478e-02, -5.6274e-02],
         ...,
         [ 7.3792e-02, -2.1286e-02,  3.4637e-02,  ..., -2.6953e-01,
           1.1055e-02,  3.6194e-02],
         [ 1.3382e-02,  4.8401e-02, -4.3030e-02,  ..., -9.6741e-03,
           7.4036e-02, -2.5925e-02],
         [-3.4424e-02, -4.1016e-02,  2.7981e-03,  ...,  1.2238e-02,
          -1.5541e-02,  2.7496e-02]],

        ...,

        [[ 1.6510e-02,  4.0344e-02, -1.5930e-02,  ..., -9.9854e-02,
           7.8674e-02,  4.7089e-02],
         [-5.9631e-02, -4.0381e-01, -5.1465e-01,  ..., -1.9604e-01,
          -3.4424e-01,  3.4717e-01],
         [-2.0264e-01, -6.8970e-02, -1.2549e-01,  ..., -1.4219e-03,
           9.2285e-02, -5.7434e-02],
         ...,
         [ 7.6050e-02, -2.2110e-02,  3.6346e-02,  ..., -2.7881e-01,
           1.1314e-02,  3.7079e-02],
         [ 1.2077e-02,  4.1962e-02, -3.8208e-02,  ..., -1.1505e-02,
           6.7627e-02, -2.3254e-02],
         [-3.2593e-02, -3.7750e-02,  3.1204e-03,  ...,  1.1108e-02,
          -1.4946e-02,  2.6260e-02]],

        [[ 1.5282e-02,  3.4821e-02, -1.4206e-02,  ..., -9.0271e-02,
           7.0679e-02,  4.2267e-02],
         [-5.9601e-02, -4.0796e-01, -5.1904e-01,  ..., -1.9812e-01,
          -3.4717e-01,  3.5083e-01],
         [-1.9934e-01, -6.7566e-02, -1.2292e-01,  ..., -1.2770e-03,
           9.0210e-02, -5.6396e-02],
         ...,
         [ 7.5989e-02, -2.2156e-02,  3.6255e-02,  ..., -2.7856e-01,
           1.1238e-02,  3.6987e-02],
         [ 1.1787e-02,  4.0558e-02, -3.7109e-02,  ..., -1.1917e-02,
           6.6223e-02, -2.2644e-02],
         [-3.1647e-02, -3.6072e-02,  3.2806e-03,  ...,  1.0521e-02,
          -1.4656e-02,  2.5604e-02]],

        [[ 1.5625e-02,  3.6438e-02, -1.4656e-02,  ..., -9.3018e-02,
           7.2998e-02,  4.3732e-02],
         [-6.0150e-02, -4.1187e-01, -5.2441e-01,  ..., -1.9995e-01,
          -3.5083e-01,  3.5425e-01],
         [-2.2131e-01, -7.6843e-02, -1.4050e-01,  ..., -2.1210e-03,
           1.0413e-01, -6.3232e-02],
         ...,
         [ 8.0688e-02, -2.3849e-02,  3.9886e-02,  ..., -2.9785e-01,
           1.1940e-02,  3.9032e-02],
         [ 1.2390e-02,  4.3579e-02, -3.9398e-02,  ..., -1.1047e-02,
           6.9214e-02, -2.3911e-02],
         [-3.2196e-02, -3.7018e-02,  3.1891e-03,  ...,  1.0857e-02,
          -1.4824e-02,  2.5970e-02]]], device='cuda:0', dtype=torch.float16)
hidden_states torch.Size([256, 768])
slot mapping []
block_tables []
context_lens []
input_tokens tensor([   2, 3592,    2, 3592], device='cuda:0')
input_positions tensor([0, 1, 0, 1], device='cuda:0')
reshape and cache tensor([[[ 1.2490, -0.6074,  1.6533,  ...,  1.0781,  0.1641,  0.5864],
         [-0.1107,  1.6562,  0.9907,  ...,  0.2576,  0.4729, -0.3135],
         [-0.4695, -0.5835,  0.9097,  ..., -0.1359, -1.4346, -2.1836],
         ...,
         [ 1.1484,  0.5938, -0.2031,  ...,  1.1279, -0.9639, -0.3901],
         [-0.3562, -0.0911, -1.0508,  ..., -0.4099,  0.7515,  0.2812],
         [ 1.1504,  0.3208, -0.6401,  ..., -0.4910,  0.7871,  0.8521]],

        [[ 1.9961, -1.4277,  1.0459,  ...,  0.9521,  0.2734,  0.6821],
         [-2.3359,  0.1725,  0.5815,  ...,  1.3428, -0.1888,  0.5205],
         [-1.0322,  0.1895, -0.0627,  ...,  0.3230, -1.8330, -2.5020],
         ...,
         [-0.5664, -0.7373, -0.2908,  ...,  1.4463, -1.6113, -1.0098],
         [-1.7217, -0.7700, -1.2480,  ...,  0.3464, -0.5073, -0.3938],
         [-1.2090,  0.6284, -0.2764,  ..., -0.3174, -1.3506,  1.2998]],

        [[ 1.2490, -0.6074,  1.6533,  ...,  1.0781,  0.1641,  0.5864],
         [-0.1107,  1.6562,  0.9907,  ...,  0.2576,  0.4729, -0.3135],
         [-0.4695, -0.5835,  0.9097,  ..., -0.1359, -1.4346, -2.1836],
         ...,
         [ 1.1484,  0.5938, -0.2031,  ...,  1.1279, -0.9639, -0.3901],
         [-0.3562, -0.0911, -1.0508,  ..., -0.4099,  0.7515,  0.2812],
         [ 1.1504,  0.3208, -0.6401,  ..., -0.4910,  0.7871,  0.8521]],

        [[ 1.9961, -1.4277,  1.0459,  ...,  0.9521,  0.2734,  0.6821],
         [-2.3359,  0.1725,  0.5815,  ...,  1.3428, -0.1888,  0.5205],
         [-1.0322,  0.1895, -0.0627,  ...,  0.3230, -1.8330, -2.5020],
         ...,
         [-0.5664, -0.7373, -0.2908,  ...,  1.4463, -1.6113, -1.0098],
         [-1.7217, -0.7700, -1.2480,  ...,  0.3464, -0.5073, -0.3938],
         [-1.2090,  0.6284, -0.2764,  ..., -0.3174, -1.3506,  1.2998]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584352, 584353], device='cuda:0')
num_prefill_tokens 4
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[-0.4041,  0.3794, -0.1658,  ...,  0.8179,  0.7495, -0.0809],
          [ 0.7373, -0.1254,  1.2832,  ...,  0.1711,  0.1720,  0.0699],
          [ 0.3311,  0.3052,  0.8809,  ...,  0.0830,  0.1407,  0.2241],
          ...,
          [-0.1759,  0.9771,  0.3738,  ..., -0.2776,  0.1520, -0.0056],
          [ 0.3037, -0.3608, -0.1107,  ...,  0.0096, -0.0524, -0.2184],
          [ 0.4678,  0.3157, -0.9243,  ..., -0.1656,  0.1252, -0.3840]],

         [[-1.2617,  0.7290,  0.9121,  ...,  1.3613, -0.5059,  0.1674],
          [ 1.2666,  0.8311, -0.1871,  ...,  0.9048, -0.3262, -0.4819],
          [ 1.0742, -1.6650, -0.2382,  ...,  1.4453,  1.7803,  0.7500],
          ...,
          [ 0.9238,  1.1807,  0.5376,  ...,  0.4736,  0.2454, -1.2344],
          [ 0.1226, -0.7114, -0.5264,  ..., -1.5088,  0.6685, -0.9634],
          [ 0.6963,  0.8291, -0.0489,  ..., -0.0597,  0.3894,  0.1411]],

         [[-0.4041,  0.3794, -0.1658,  ...,  0.8179,  0.7495, -0.0809],
          [ 0.7373, -0.1254,  1.2832,  ...,  0.1711,  0.1720,  0.0699],
          [ 0.3311,  0.3052,  0.8809,  ...,  0.0830,  0.1407,  0.2241],
          ...,
          [-0.1759,  0.9771,  0.3738,  ..., -0.2776,  0.1520, -0.0056],
          [ 0.3037, -0.3608, -0.1107,  ...,  0.0096, -0.0524, -0.2184],
          [ 0.4678,  0.3157, -0.9243,  ..., -0.1656,  0.1252, -0.3840]],

         [[-1.2617,  0.7290,  0.9121,  ...,  1.3613, -0.5059,  0.1674],
          [ 1.2666,  0.8311, -0.1871,  ...,  0.9048, -0.3262, -0.4819],
          [ 1.0742, -1.6650, -0.2382,  ...,  1.4453,  1.7803,  0.7500],
          ...,
          [ 0.9238,  1.1807,  0.5376,  ...,  0.4736,  0.2454, -1.2344],
          [ 0.1226, -0.7114, -0.5264,  ..., -1.5088,  0.6685, -0.9634],
          [ 0.6963,  0.8291, -0.0489,  ..., -0.0597,  0.3894,  0.1411]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[ 1.2490, -0.6074,  1.6533,  ...,  1.0781,  0.1641,  0.5864],
          [-0.1107,  1.6562,  0.9907,  ...,  0.2576,  0.4729, -0.3135],
          [-0.4695, -0.5835,  0.9097,  ..., -0.1359, -1.4346, -2.1836],
          ...,
          [ 1.1484,  0.5938, -0.2031,  ...,  1.1279, -0.9639, -0.3901],
          [-0.3562, -0.0911, -1.0508,  ..., -0.4099,  0.7515,  0.2812],
          [ 1.1504,  0.3208, -0.6401,  ..., -0.4910,  0.7871,  0.8521]],

         [[ 1.9961, -1.4277,  1.0459,  ...,  0.9521,  0.2734,  0.6821],
          [-2.3359,  0.1725,  0.5815,  ...,  1.3428, -0.1888,  0.5205],
          [-1.0322,  0.1895, -0.0627,  ...,  0.3230, -1.8330, -2.5020],
          ...,
          [-0.5664, -0.7373, -0.2908,  ...,  1.4463, -1.6113, -1.0098],
          [-1.7217, -0.7700, -1.2480,  ...,  0.3464, -0.5073, -0.3938],
          [-1.2090,  0.6284, -0.2764,  ..., -0.3174, -1.3506,  1.2998]],

         [[ 1.2490, -0.6074,  1.6533,  ...,  1.0781,  0.1641,  0.5864],
          [-0.1107,  1.6562,  0.9907,  ...,  0.2576,  0.4729, -0.3135],
          [-0.4695, -0.5835,  0.9097,  ..., -0.1359, -1.4346, -2.1836],
          ...,
          [ 1.1484,  0.5938, -0.2031,  ...,  1.1279, -0.9639, -0.3901],
          [-0.3562, -0.0911, -1.0508,  ..., -0.4099,  0.7515,  0.2812],
          [ 1.1504,  0.3208, -0.6401,  ..., -0.4910,  0.7871,  0.8521]],

         [[ 1.9961, -1.4277,  1.0459,  ...,  0.9521,  0.2734,  0.6821],
          [-2.3359,  0.1725,  0.5815,  ...,  1.3428, -0.1888,  0.5205],
          [-1.0322,  0.1895, -0.0627,  ...,  0.3230, -1.8330, -2.5020],
          ...,
          [-0.5664, -0.7373, -0.2908,  ...,  1.4463, -1.6113, -1.0098],
          [-1.7217, -0.7700, -1.2480,  ...,  0.3464, -0.5073, -0.3938],
          [-1.2090,  0.6284, -0.2764,  ..., -0.3174, -1.3506,  1.2998]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 0.0964, -0.0034,  0.0489,  ...,  0.0067,  0.0776, -0.0527],
          [ 0.0010,  0.0086, -0.0715,  ..., -0.0173, -0.0196, -0.0293],
          [ 0.0236,  0.0055, -0.0435,  ...,  0.0006, -0.0510, -0.0329],
          ...,
          [ 0.0125,  0.0521, -0.0141,  ..., -0.0082, -0.0531,  0.0111],
          [ 0.0767, -0.0281, -0.0373,  ...,  0.0597,  0.0055,  0.0195],
          [ 0.0079, -0.0688, -0.0328,  ..., -0.0134, -0.0382,  0.0846]],

         [[-0.1182,  0.1104,  0.1166,  ...,  0.0684,  0.0768,  0.0452],
          [-0.0610, -0.1610, -0.0490,  ..., -0.0066,  0.0493, -0.1589],
          [-0.0300, -0.0168, -0.1296,  ...,  0.0119, -0.0391,  0.0244],
          ...,
          [-0.1089, -0.1753,  0.0171,  ..., -0.0696, -0.0319,  0.1914],
          [-0.1201, -0.0190,  0.0832,  ..., -0.0093,  0.0638,  0.0114],
          [-0.0467, -0.0754, -0.0193,  ..., -0.0589, -0.0144,  0.1802]],

         [[ 0.0964, -0.0034,  0.0489,  ...,  0.0067,  0.0776, -0.0527],
          [ 0.0010,  0.0086, -0.0715,  ..., -0.0173, -0.0196, -0.0293],
          [ 0.0236,  0.0055, -0.0435,  ...,  0.0006, -0.0510, -0.0329],
          ...,
          [ 0.0125,  0.0521, -0.0141,  ..., -0.0082, -0.0531,  0.0111],
          [ 0.0767, -0.0281, -0.0373,  ...,  0.0597,  0.0055,  0.0195],
          [ 0.0079, -0.0688, -0.0328,  ..., -0.0134, -0.0382,  0.0846]],

         [[-0.1182,  0.1104,  0.1166,  ...,  0.0684,  0.0768,  0.0452],
          [-0.0610, -0.1610, -0.0490,  ..., -0.0066,  0.0493, -0.1589],
          [-0.0300, -0.0168, -0.1296,  ...,  0.0119, -0.0391,  0.0244],
          ...,
          [-0.1089, -0.1753,  0.0171,  ..., -0.0696, -0.0319,  0.1914],
          [-0.1201, -0.0190,  0.0832,  ..., -0.0093,  0.0638,  0.0114],
          [-0.0467, -0.0754, -0.0193,  ..., -0.0589, -0.0144,  0.1802]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[-0.0248,  0.0609,  0.0872,  ...,  0.0415,  0.0771,  0.0026],
         [-0.0113, -0.0252, -0.0670,  ..., -0.0152, -0.0059, -0.0551],
         [-0.0148, -0.0105, -0.1052,  ...,  0.0087, -0.0425,  0.0081],
         ...,
         [-0.0544, -0.0733,  0.0031,  ..., -0.0421, -0.0414,  0.1105],
         [-0.0545, -0.0220,  0.0431,  ...,  0.0136,  0.0444,  0.0141],
         [-0.0258, -0.0729, -0.0245,  ..., -0.0414, -0.0236,  0.1436]],

        [[ 0.0690,  0.0111,  0.0575,  ...,  0.0146,  0.0775, -0.0402],
         [ 0.0006,  0.0074, -0.0713,  ..., -0.0173, -0.0191, -0.0302],
         [ 0.0229,  0.0052, -0.0446,  ...,  0.0007, -0.0508, -0.0321],
         ...,
         [ 0.0051,  0.0383, -0.0122,  ..., -0.0119, -0.0518,  0.0220],
         [ 0.0385, -0.0263, -0.0139,  ...,  0.0463,  0.0168,  0.0179],
         [ 0.0011, -0.0696, -0.0311,  ..., -0.0191, -0.0352,  0.0966]],

        [[-0.0248,  0.0609,  0.0872,  ...,  0.0415,  0.0771,  0.0026],
         [-0.0113, -0.0252, -0.0670,  ..., -0.0152, -0.0059, -0.0551],
         [-0.0148, -0.0105, -0.1052,  ...,  0.0087, -0.0425,  0.0081],
         ...,
         [-0.0544, -0.0733,  0.0031,  ..., -0.0421, -0.0414,  0.1105],
         [-0.0545, -0.0220,  0.0431,  ...,  0.0136,  0.0444,  0.0141],
         [-0.0258, -0.0729, -0.0245,  ..., -0.0414, -0.0236,  0.1436]],

        [[ 0.0690,  0.0111,  0.0575,  ...,  0.0146,  0.0775, -0.0402],
         [ 0.0006,  0.0074, -0.0713,  ..., -0.0173, -0.0191, -0.0302],
         [ 0.0229,  0.0052, -0.0446,  ...,  0.0007, -0.0508, -0.0321],
         ...,
         [ 0.0051,  0.0383, -0.0122,  ..., -0.0119, -0.0518,  0.0220],
         [ 0.0385, -0.0263, -0.0139,  ...,  0.0463,  0.0168,  0.0179],
         [ 0.0011, -0.0696, -0.0311,  ..., -0.0191, -0.0352,  0.0966]]],
       device='cuda:0', dtype=torch.float16)
reshape and cache tensor([[[ 0.9941,  0.3301, -0.8472,  ..., -0.2974, -0.1327,  0.2415],
         [ 0.7480,  1.4775, -0.4438,  ...,  1.0410,  0.4324, -0.4326],
         [-0.0895,  0.5483,  0.5342,  ...,  0.1148, -1.5020,  1.4688],
         ...,
         [ 1.9492, -0.0598, -0.7217,  ...,  0.7725,  1.8057,  1.2061],
         [ 0.7734,  0.3367, -1.7910,  ..., -1.3516, -1.3721,  1.1270],
         [-1.0488,  2.0898, -1.4004,  ...,  2.1934,  1.1055, -0.6143]],

        [[ 1.6465,  0.2974,  0.1486,  ..., -1.3516,  0.2886, -1.9248],
         [ 0.1420, -0.4893,  1.0586,  ...,  1.0088, -1.0488,  1.0537],
         [ 2.1035, -0.3779,  1.4561,  ..., -0.7549, -0.2625, -0.8462],
         ...,
         [ 0.9736, -2.4980, -2.2598,  ..., -0.1703, -1.4629, -0.1467],
         [-1.8096, -1.3838, -0.1487,  ...,  2.1621, -0.3484, -0.5171],
         [ 1.4775,  0.4797,  0.2214,  ..., -0.6816,  0.4600, -1.0498]],

        [[ 0.9941,  0.3301, -0.8472,  ..., -0.2974, -0.1327,  0.2415],
         [ 0.7480,  1.4775, -0.4438,  ...,  1.0410,  0.4324, -0.4326],
         [-0.0895,  0.5483,  0.5342,  ...,  0.1148, -1.5020,  1.4688],
         ...,
         [ 1.9492, -0.0598, -0.7217,  ...,  0.7725,  1.8057,  1.2061],
         [ 0.7734,  0.3367, -1.7910,  ..., -1.3516, -1.3721,  1.1270],
         [-1.0488,  2.0898, -1.4004,  ...,  2.1934,  1.1055, -0.6143]],

        [[ 1.6465,  0.2974,  0.1486,  ..., -1.3516,  0.2886, -1.9248],
         [ 0.1420, -0.4893,  1.0586,  ...,  1.0088, -1.0488,  1.0537],
         [ 2.1035, -0.3779,  1.4561,  ..., -0.7549, -0.2625, -0.8462],
         ...,
         [ 0.9736, -2.4980, -2.2598,  ..., -0.1703, -1.4629, -0.1467],
         [-1.8096, -1.3838, -0.1487,  ...,  2.1621, -0.3484, -0.5171],
         [ 1.4775,  0.4797,  0.2214,  ..., -0.6816,  0.4600, -1.0498]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584352, 584353], device='cuda:0')
num_prefill_tokens 4
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[-0.4963, -0.0184, -0.1958,  ..., -0.1248,  0.1157, -0.1285],
          [-0.1719, -0.2935,  0.2312,  ..., -0.4346, -0.2162,  0.2148],
          [ 0.3813, -0.1537, -0.2274,  ..., -0.4939,  0.6382, -0.5820],
          ...,
          [ 0.4231, -0.3169, -0.4724,  ...,  0.3040, -0.9028, -0.5200],
          [-0.4309, -0.5210,  0.4143,  ...,  0.6523,  0.0359, -0.0222],
          [ 0.8916, -0.4038,  0.4158,  ..., -0.4763, -0.1709, -0.0553]],

         [[ 1.2549, -0.7329,  0.5156,  ...,  1.0850,  0.8701,  1.2529],
          [ 0.3706, -0.6514, -1.5752,  ...,  0.3384,  1.5400, -1.5391],
          [ 0.0997, -0.9365,  1.9404,  ...,  0.8008, -1.1572,  0.9639],
          ...,
          [ 0.1874, -0.3391, -1.3281,  ..., -0.5371,  0.0162,  0.0565],
          [ 1.1455, -0.2411, -0.8906,  ...,  0.8311,  0.6660, -0.7437],
          [-1.0986,  1.3633, -0.1119,  ...,  0.4719,  0.2494,  0.5449]],

         [[-0.4963, -0.0184, -0.1958,  ..., -0.1248,  0.1157, -0.1285],
          [-0.1719, -0.2935,  0.2312,  ..., -0.4346, -0.2162,  0.2148],
          [ 0.3813, -0.1537, -0.2274,  ..., -0.4939,  0.6382, -0.5820],
          ...,
          [ 0.4231, -0.3169, -0.4724,  ...,  0.3040, -0.9028, -0.5200],
          [-0.4309, -0.5210,  0.4143,  ...,  0.6523,  0.0359, -0.0222],
          [ 0.8916, -0.4038,  0.4158,  ..., -0.4763, -0.1709, -0.0553]],

         [[ 1.2549, -0.7329,  0.5156,  ...,  1.0850,  0.8701,  1.2529],
          [ 0.3706, -0.6514, -1.5752,  ...,  0.3384,  1.5400, -1.5391],
          [ 0.0997, -0.9365,  1.9404,  ...,  0.8008, -1.1572,  0.9639],
          ...,
          [ 0.1874, -0.3391, -1.3281,  ..., -0.5371,  0.0162,  0.0565],
          [ 1.1455, -0.2411, -0.8906,  ...,  0.8311,  0.6660, -0.7437],
          [-1.0986,  1.3633, -0.1119,  ...,  0.4719,  0.2494,  0.5449]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[ 0.9941,  0.3301, -0.8472,  ..., -0.2974, -0.1327,  0.2415],
          [ 0.7480,  1.4775, -0.4438,  ...,  1.0410,  0.4324, -0.4326],
          [-0.0895,  0.5483,  0.5342,  ...,  0.1148, -1.5020,  1.4688],
          ...,
          [ 1.9492, -0.0598, -0.7217,  ...,  0.7725,  1.8057,  1.2061],
          [ 0.7734,  0.3367, -1.7910,  ..., -1.3516, -1.3721,  1.1270],
          [-1.0488,  2.0898, -1.4004,  ...,  2.1934,  1.1055, -0.6143]],

         [[ 1.6465,  0.2974,  0.1486,  ..., -1.3516,  0.2886, -1.9248],
          [ 0.1420, -0.4893,  1.0586,  ...,  1.0088, -1.0488,  1.0537],
          [ 2.1035, -0.3779,  1.4561,  ..., -0.7549, -0.2625, -0.8462],
          ...,
          [ 0.9736, -2.4980, -2.2598,  ..., -0.1703, -1.4629, -0.1467],
          [-1.8096, -1.3838, -0.1487,  ...,  2.1621, -0.3484, -0.5171],
          [ 1.4775,  0.4797,  0.2214,  ..., -0.6816,  0.4600, -1.0498]],

         [[ 0.9941,  0.3301, -0.8472,  ..., -0.2974, -0.1327,  0.2415],
          [ 0.7480,  1.4775, -0.4438,  ...,  1.0410,  0.4324, -0.4326],
          [-0.0895,  0.5483,  0.5342,  ...,  0.1148, -1.5020,  1.4688],
          ...,
          [ 1.9492, -0.0598, -0.7217,  ...,  0.7725,  1.8057,  1.2061],
          [ 0.7734,  0.3367, -1.7910,  ..., -1.3516, -1.3721,  1.1270],
          [-1.0488,  2.0898, -1.4004,  ...,  2.1934,  1.1055, -0.6143]],

         [[ 1.6465,  0.2974,  0.1486,  ..., -1.3516,  0.2886, -1.9248],
          [ 0.1420, -0.4893,  1.0586,  ...,  1.0088, -1.0488,  1.0537],
          [ 2.1035, -0.3779,  1.4561,  ..., -0.7549, -0.2625, -0.8462],
          ...,
          [ 0.9736, -2.4980, -2.2598,  ..., -0.1703, -1.4629, -0.1467],
          [-1.8096, -1.3838, -0.1487,  ...,  2.1621, -0.3484, -0.5171],
          [ 1.4775,  0.4797,  0.2214,  ..., -0.6816,  0.4600, -1.0498]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[-4.6310e-03,  6.5193e-03, -4.2534e-03,  ...,  5.6088e-05,
            9.9087e-04, -4.9744e-03],
          [ 5.6763e-03, -9.6512e-03, -5.6038e-03,  ..., -3.4523e-03,
            4.0245e-03,  2.5520e-03],
          [ 2.3689e-03,  4.3182e-03,  6.2675e-03,  ...,  3.2578e-03,
           -5.5313e-03,  7.5493e-03],
          ...,
          [-4.2915e-03, -3.9215e-03, -1.1452e-02,  ...,  1.5917e-03,
            4.8370e-03, -5.4283e-03],
          [-5.1651e-03,  1.9445e-03,  6.3181e-04,  ..., -5.4779e-03,
            1.1986e-02,  3.7460e-03],
          [ 6.9008e-03, -1.4915e-02,  5.2299e-03,  ..., -9.1400e-03,
           -1.6956e-03,  1.1444e-03]],

         [[ 2.1155e-01, -7.3181e-02, -3.9398e-02,  ...,  1.0596e-01,
            3.3417e-02,  1.6345e-01],
          [-7.5378e-02, -3.8452e-02, -1.3435e-02,  ...,  6.1401e-02,
           -9.5764e-02, -3.6804e-02],
          [ 4.8157e-02, -2.0776e-01, -6.6345e-02,  ..., -3.2532e-02,
            3.3521e-01, -1.8420e-01],
          ...,
          [-5.3101e-02, -1.2756e-01, -2.4612e-02,  ..., -1.0992e-01,
            2.8290e-02, -5.2399e-02],
          [ 2.1875e-01,  3.2471e-02, -7.6538e-02,  ..., -8.2886e-02,
            1.7242e-02, -3.9612e-02],
          [-7.5012e-02, -1.5671e-02, -1.0101e-01,  ...,  7.0068e-02,
           -4.5868e-02,  9.6619e-02]],

         [[-4.6310e-03,  6.5193e-03, -4.2534e-03,  ...,  5.6088e-05,
            9.9087e-04, -4.9744e-03],
          [ 5.6763e-03, -9.6512e-03, -5.6038e-03,  ..., -3.4523e-03,
            4.0245e-03,  2.5520e-03],
          [ 2.3689e-03,  4.3182e-03,  6.2675e-03,  ...,  3.2578e-03,
           -5.5313e-03,  7.5493e-03],
          ...,
          [-4.2915e-03, -3.9215e-03, -1.1452e-02,  ...,  1.5917e-03,
            4.8370e-03, -5.4283e-03],
          [-5.1651e-03,  1.9445e-03,  6.3181e-04,  ..., -5.4779e-03,
            1.1986e-02,  3.7460e-03],
          [ 6.9008e-03, -1.4915e-02,  5.2299e-03,  ..., -9.1400e-03,
           -1.6956e-03,  1.1444e-03]],

         [[ 2.1155e-01, -7.3181e-02, -3.9398e-02,  ...,  1.0596e-01,
            3.3417e-02,  1.6345e-01],
          [-7.5378e-02, -3.8452e-02, -1.3435e-02,  ...,  6.1401e-02,
           -9.5764e-02, -3.6804e-02],
          [ 4.8157e-02, -2.0776e-01, -6.6345e-02,  ..., -3.2532e-02,
            3.3521e-01, -1.8420e-01],
          ...,
          [-5.3101e-02, -1.2756e-01, -2.4612e-02,  ..., -1.0992e-01,
            2.8290e-02, -5.2399e-02],
          [ 2.1875e-01,  3.2471e-02, -7.6538e-02,  ..., -8.2886e-02,
            1.7242e-02, -3.9612e-02],
          [-7.5012e-02, -1.5671e-02, -1.0101e-01,  ...,  7.0068e-02,
           -4.5868e-02,  9.6619e-02]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[ 1.6162e-01, -5.4749e-02, -3.1281e-02,  ...,  8.1482e-02,
           2.5925e-02,  1.2451e-01],
         [-6.8054e-02, -3.5858e-02, -1.2726e-02,  ...,  5.5573e-02,
          -8.6792e-02, -3.3264e-02],
         [ 4.6417e-02, -1.9971e-01, -6.3599e-02,  ..., -3.1174e-02,
           3.2227e-01, -1.7688e-01],
         ...,
         [-5.1239e-02, -1.2286e-01, -2.4109e-02,  ..., -1.0571e-01,
           2.7405e-02, -5.0629e-02],
         [ 2.1155e-01,  3.1494e-02, -7.4036e-02,  ..., -8.0383e-02,
           1.7075e-02, -3.8208e-02],
         [-7.4585e-02, -1.5671e-02, -1.0046e-01,  ...,  6.9641e-02,
          -4.5624e-02,  9.6130e-02]],

        [[ 6.4697e-03,  2.4261e-03, -6.0577e-03,  ...,  5.4932e-03,
           2.6569e-03,  3.6755e-03],
         [ 2.2736e-03, -1.0864e-02, -5.9319e-03,  ..., -7.2956e-04,
          -1.6499e-04,  8.9979e-04],
         [ 2.8133e-03,  2.2583e-03,  5.5618e-03,  ...,  2.9106e-03,
          -2.2202e-03,  5.6877e-03],
         ...,
         [-2.1744e-02, -4.8126e-02, -1.6159e-02,  ..., -3.8269e-02,
           1.3222e-02, -2.2217e-02],
         [ 3.4618e-03,  3.1204e-03, -2.3403e-03,  ..., -8.4610e-03,
           1.2192e-02,  2.0752e-03],
         [-1.1093e-02, -1.5083e-02, -1.8112e-02,  ...,  8.2626e-03,
          -1.1398e-02,  2.2110e-02]],

        [[ 1.6162e-01, -5.4749e-02, -3.1281e-02,  ...,  8.1482e-02,
           2.5925e-02,  1.2451e-01],
         [-6.8054e-02, -3.5858e-02, -1.2726e-02,  ...,  5.5573e-02,
          -8.6792e-02, -3.3264e-02],
         [ 4.6417e-02, -1.9971e-01, -6.3599e-02,  ..., -3.1174e-02,
           3.2227e-01, -1.7688e-01],
         ...,
         [-5.1239e-02, -1.2286e-01, -2.4109e-02,  ..., -1.0571e-01,
           2.7405e-02, -5.0629e-02],
         [ 2.1155e-01,  3.1494e-02, -7.4036e-02,  ..., -8.0383e-02,
           1.7075e-02, -3.8208e-02],
         [-7.4585e-02, -1.5671e-02, -1.0046e-01,  ...,  6.9641e-02,
          -4.5624e-02,  9.6130e-02]],

        [[ 6.4697e-03,  2.4261e-03, -6.0577e-03,  ...,  5.4932e-03,
           2.6569e-03,  3.6755e-03],
         [ 2.2736e-03, -1.0864e-02, -5.9319e-03,  ..., -7.2956e-04,
          -1.6499e-04,  8.9979e-04],
         [ 2.8133e-03,  2.2583e-03,  5.5618e-03,  ...,  2.9106e-03,
          -2.2202e-03,  5.6877e-03],
         ...,
         [-2.1744e-02, -4.8126e-02, -1.6159e-02,  ..., -3.8269e-02,
           1.3222e-02, -2.2217e-02],
         [ 3.4618e-03,  3.1204e-03, -2.3403e-03,  ..., -8.4610e-03,
           1.2192e-02,  2.0752e-03],
         [-1.1093e-02, -1.5083e-02, -1.8112e-02,  ...,  8.2626e-03,
          -1.1398e-02,  2.2110e-02]]], device='cuda:0', dtype=torch.float16)
reshape and cache tensor([[[-0.7246, -0.8438, -1.3955,  ..., -0.5151, -0.6670,  0.2703],
         [ 1.4336, -1.3779, -0.4961,  ..., -1.2031,  0.4319, -1.3838],
         [-1.1270, -0.2666, -0.9526,  ...,  0.5576, -0.3020,  0.2708],
         ...,
         [ 0.4185, -0.1940, -0.4656,  ..., -0.3159,  0.0951,  0.1617],
         [-0.0492, -0.0358, -0.0460,  ..., -0.0643,  0.5396,  0.0398],
         [-0.3306,  0.3735, -0.9150,  ..., -0.7773, -0.5977,  0.5229]],

        [[ 1.2588,  2.2441,  3.1992,  ...,  1.3281,  1.9502,  0.1153],
         [-0.9097,  0.6079,  0.2317,  ..., -0.2252,  1.2119,  1.3760],
         [ 0.8345, -1.0654,  0.6089,  ..., -0.7964,  0.8857,  2.2051],
         ...,
         [-0.2793,  1.4414,  0.3965,  ...,  1.2783,  0.1179,  0.1191],
         [-0.3479,  1.2676,  0.1685,  ...,  0.2693, -3.2559,  0.0722],
         [-0.5400, -0.3252, -1.7695,  ...,  1.7979,  0.2124, -1.3545]],

        [[-0.7246, -0.8438, -1.3955,  ..., -0.5151, -0.6670,  0.2703],
         [ 1.4336, -1.3779, -0.4961,  ..., -1.2031,  0.4319, -1.3838],
         [-1.1270, -0.2666, -0.9526,  ...,  0.5576, -0.3020,  0.2708],
         ...,
         [ 0.4185, -0.1940, -0.4656,  ..., -0.3159,  0.0951,  0.1617],
         [-0.0492, -0.0358, -0.0460,  ..., -0.0643,  0.5396,  0.0398],
         [-0.3306,  0.3735, -0.9150,  ..., -0.7773, -0.5977,  0.5229]],

        [[ 1.2588,  2.2441,  3.1992,  ...,  1.3281,  1.9502,  0.1153],
         [-0.9097,  0.6079,  0.2317,  ..., -0.2252,  1.2119,  1.3760],
         [ 0.8345, -1.0654,  0.6089,  ..., -0.7964,  0.8857,  2.2051],
         ...,
         [-0.2793,  1.4414,  0.3965,  ...,  1.2783,  0.1179,  0.1191],
         [-0.3479,  1.2676,  0.1685,  ...,  0.2693, -3.2559,  0.0722],
         [-0.5400, -0.3252, -1.7695,  ...,  1.7979,  0.2124, -1.3545]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584352, 584353], device='cuda:0')
num_prefill_tokens 4
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[ 0.2678,  0.2310,  0.5293,  ...,  0.3784,  0.3418, -0.3767],
          [-0.3306,  0.4373,  0.0293,  ...,  0.1763, -0.2422,  0.6475],
          [ 0.3462,  0.0879,  0.4355,  ..., -0.3010,  0.0362,  0.1196],
          ...,
          [-0.0994,  0.1849,  0.1039,  ...,  0.1573, -0.0089,  0.0784],
          [ 0.1350, -0.1063, -0.1020,  ...,  0.0688, -0.2625, -0.0086],
          [ 0.2167, -0.1026,  0.1268,  ...,  0.4229,  0.1797, -0.2244]],

         [[-1.0479, -0.3767,  0.6167,  ...,  0.0953, -0.4734,  0.0731],
          [ 1.0371, -0.7744,  0.1882,  ..., -1.2510,  1.3271,  0.8916],
          [-0.6396,  0.7798,  0.1772,  ...,  0.2328, -0.5327, -0.6265],
          ...,
          [-0.2510,  1.2207,  0.2939,  ..., -0.4114, -2.3750, -0.9150],
          [-1.0645, -1.2158,  0.8262,  ..., -1.7725, -0.6797,  0.1455],
          [-1.4014, -0.0498, -0.0535,  ..., -0.6802,  0.1705,  0.9121]],

         [[ 0.2678,  0.2310,  0.5293,  ...,  0.3784,  0.3418, -0.3767],
          [-0.3306,  0.4373,  0.0293,  ...,  0.1763, -0.2422,  0.6475],
          [ 0.3462,  0.0879,  0.4355,  ..., -0.3010,  0.0362,  0.1196],
          ...,
          [-0.0994,  0.1849,  0.1039,  ...,  0.1573, -0.0089,  0.0784],
          [ 0.1350, -0.1063, -0.1020,  ...,  0.0688, -0.2625, -0.0086],
          [ 0.2167, -0.1026,  0.1268,  ...,  0.4229,  0.1797, -0.2244]],

         [[-1.0479, -0.3767,  0.6167,  ...,  0.0953, -0.4734,  0.0731],
          [ 1.0371, -0.7744,  0.1882,  ..., -1.2510,  1.3271,  0.8916],
          [-0.6396,  0.7798,  0.1772,  ...,  0.2328, -0.5327, -0.6265],
          ...,
          [-0.2510,  1.2207,  0.2939,  ..., -0.4114, -2.3750, -0.9150],
          [-1.0645, -1.2158,  0.8262,  ..., -1.7725, -0.6797,  0.1455],
          [-1.4014, -0.0498, -0.0535,  ..., -0.6802,  0.1705,  0.9121]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[-0.7246, -0.8438, -1.3955,  ..., -0.5151, -0.6670,  0.2703],
          [ 1.4336, -1.3779, -0.4961,  ..., -1.2031,  0.4319, -1.3838],
          [-1.1270, -0.2666, -0.9526,  ...,  0.5576, -0.3020,  0.2708],
          ...,
          [ 0.4185, -0.1940, -0.4656,  ..., -0.3159,  0.0951,  0.1617],
          [-0.0492, -0.0358, -0.0460,  ..., -0.0643,  0.5396,  0.0398],
          [-0.3306,  0.3735, -0.9150,  ..., -0.7773, -0.5977,  0.5229]],

         [[ 1.2588,  2.2441,  3.1992,  ...,  1.3281,  1.9502,  0.1153],
          [-0.9097,  0.6079,  0.2317,  ..., -0.2252,  1.2119,  1.3760],
          [ 0.8345, -1.0654,  0.6089,  ..., -0.7964,  0.8857,  2.2051],
          ...,
          [-0.2793,  1.4414,  0.3965,  ...,  1.2783,  0.1179,  0.1191],
          [-0.3479,  1.2676,  0.1685,  ...,  0.2693, -3.2559,  0.0722],
          [-0.5400, -0.3252, -1.7695,  ...,  1.7979,  0.2124, -1.3545]],

         [[-0.7246, -0.8438, -1.3955,  ..., -0.5151, -0.6670,  0.2703],
          [ 1.4336, -1.3779, -0.4961,  ..., -1.2031,  0.4319, -1.3838],
          [-1.1270, -0.2666, -0.9526,  ...,  0.5576, -0.3020,  0.2708],
          ...,
          [ 0.4185, -0.1940, -0.4656,  ..., -0.3159,  0.0951,  0.1617],
          [-0.0492, -0.0358, -0.0460,  ..., -0.0643,  0.5396,  0.0398],
          [-0.3306,  0.3735, -0.9150,  ..., -0.7773, -0.5977,  0.5229]],

         [[ 1.2588,  2.2441,  3.1992,  ...,  1.3281,  1.9502,  0.1153],
          [-0.9097,  0.6079,  0.2317,  ..., -0.2252,  1.2119,  1.3760],
          [ 0.8345, -1.0654,  0.6089,  ..., -0.7964,  0.8857,  2.2051],
          ...,
          [-0.2793,  1.4414,  0.3965,  ...,  1.2783,  0.1179,  0.1191],
          [-0.3479,  1.2676,  0.1685,  ...,  0.2693, -3.2559,  0.0722],
          [-0.5400, -0.3252, -1.7695,  ...,  1.7979,  0.2124, -1.3545]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 1.3123e-03,  2.5520e-03, -1.6699e-03,  ...,  6.1111e-03,
            1.1625e-03, -8.5373e-03],
          [ 9.8190e-03,  9.3818e-05,  4.0588e-03,  ...,  2.5806e-03,
            1.2388e-03,  3.8681e-03],
          [ 2.7752e-03,  4.2140e-05, -1.0386e-03,  ..., -2.6970e-03,
            8.2245e-03,  1.9779e-03],
          ...,
          [-2.6093e-03,  4.2763e-03, -6.1684e-03,  ...,  1.0500e-03,
           -2.6798e-03, -4.2839e-03],
          [ 1.5430e-03, -9.8991e-04, -2.1305e-03,  ..., -3.3689e-04,
            2.7885e-03,  4.7150e-03],
          [ 9.4414e-04,  1.2465e-03, -8.4639e-06,  ...,  1.6308e-03,
            5.2261e-04,  4.1413e-04]],

         [[-1.2231e-01, -2.1521e-01, -1.2115e-01,  ...,  2.7954e-01,
           -5.0201e-02,  1.8750e-01],
          [ 7.7393e-02, -1.3977e-01, -1.2085e-01,  ...,  3.6560e-02,
           -1.1029e-01, -1.2939e-01],
          [ 7.3425e-02,  2.6636e-01,  9.1492e-02,  ...,  2.8296e-01,
           -3.8135e-01, -3.4302e-01],
          ...,
          [ 9.8877e-02, -6.1707e-02,  6.2752e-03,  ...,  1.5039e-01,
            1.1768e-01,  2.4182e-01],
          [ 6.1684e-03, -2.1362e-02,  7.2021e-01,  ...,  2.4719e-01,
           -2.7979e-01, -8.3008e-02],
          [-2.7664e-02,  1.2073e-01,  1.6626e-01,  ...,  2.3279e-01,
           -1.0022e-01, -1.1383e-01]],

         [[ 1.3123e-03,  2.5520e-03, -1.6699e-03,  ...,  6.1111e-03,
            1.1625e-03, -8.5373e-03],
          [ 9.8190e-03,  9.3818e-05,  4.0588e-03,  ...,  2.5806e-03,
            1.2388e-03,  3.8681e-03],
          [ 2.7752e-03,  4.2140e-05, -1.0386e-03,  ..., -2.6970e-03,
            8.2245e-03,  1.9779e-03],
          ...,
          [-2.6093e-03,  4.2763e-03, -6.1684e-03,  ...,  1.0500e-03,
           -2.6798e-03, -4.2839e-03],
          [ 1.5430e-03, -9.8991e-04, -2.1305e-03,  ..., -3.3689e-04,
            2.7885e-03,  4.7150e-03],
          [ 9.4414e-04,  1.2465e-03, -8.4639e-06,  ...,  1.6308e-03,
            5.2261e-04,  4.1413e-04]],

         [[-1.2231e-01, -2.1521e-01, -1.2115e-01,  ...,  2.7954e-01,
           -5.0201e-02,  1.8750e-01],
          [ 7.7393e-02, -1.3977e-01, -1.2085e-01,  ...,  3.6560e-02,
           -1.1029e-01, -1.2939e-01],
          [ 7.3425e-02,  2.6636e-01,  9.1492e-02,  ...,  2.8296e-01,
           -3.8135e-01, -3.4302e-01],
          ...,
          [ 9.8877e-02, -6.1707e-02,  6.2752e-03,  ...,  1.5039e-01,
            1.1768e-01,  2.4182e-01],
          [ 6.1684e-03, -2.1362e-02,  7.2021e-01,  ...,  2.4719e-01,
           -2.7979e-01, -8.3008e-02],
          [-2.7664e-02,  1.2073e-01,  1.6626e-01,  ...,  2.3279e-01,
           -1.0022e-01, -1.1383e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[-1.1798e-01, -2.0764e-01, -1.1694e-01,  ...,  2.7002e-01,
          -4.8401e-02,  1.8066e-01],
         [ 7.4463e-02, -1.3367e-01, -1.1542e-01,  ...,  3.5095e-02,
          -1.0547e-01, -1.2360e-01],
         [ 7.1960e-02,  2.6074e-01,  8.9539e-02,  ...,  2.7686e-01,
          -3.7305e-01, -3.3569e-01],
         ...,
         [ 9.5642e-02, -5.9601e-02,  5.8784e-03,  ...,  1.4563e-01,
           1.1383e-01,  2.3401e-01],
         [ 5.0545e-03, -1.6449e-02,  5.4590e-01,  ...,  1.8750e-01,
          -2.1167e-01, -6.1859e-02],
         [-2.6642e-02,  1.1646e-01,  1.6028e-01,  ...,  2.2449e-01,
          -9.6619e-02, -1.0974e-01]],

        [[-2.3376e-02, -4.0924e-02, -2.5528e-02,  ...,  6.0699e-02,
          -9.0942e-03,  3.0609e-02],
         [ 1.0109e-02, -5.0163e-04,  3.5267e-03,  ...,  2.7256e-03,
           7.6389e-04,  3.2997e-03],
         [ 5.3062e-03,  9.5825e-03,  2.2755e-03,  ...,  7.5340e-03,
          -5.7259e-03, -1.0376e-02],
         ...,
         [-9.8228e-04,  3.2177e-03, -5.9700e-03,  ...,  3.4447e-03,
          -7.5006e-04, -3.3760e-04],
         [ 1.7290e-03, -1.8072e-03,  2.6855e-02,  ...,  9.5978e-03,
          -8.5526e-03,  1.1950e-03],
         [-5.8794e-04,  7.6447e-03,  8.8959e-03,  ...,  1.4008e-02,
          -4.8714e-03, -5.7030e-03]],

        [[-1.1798e-01, -2.0764e-01, -1.1694e-01,  ...,  2.7002e-01,
          -4.8401e-02,  1.8066e-01],
         [ 7.4463e-02, -1.3367e-01, -1.1542e-01,  ...,  3.5095e-02,
          -1.0547e-01, -1.2360e-01],
         [ 7.1960e-02,  2.6074e-01,  8.9539e-02,  ...,  2.7686e-01,
          -3.7305e-01, -3.3569e-01],
         ...,
         [ 9.5642e-02, -5.9601e-02,  5.8784e-03,  ...,  1.4563e-01,
           1.1383e-01,  2.3401e-01],
         [ 5.0545e-03, -1.6449e-02,  5.4590e-01,  ...,  1.8750e-01,
          -2.1167e-01, -6.1859e-02],
         [-2.6642e-02,  1.1646e-01,  1.6028e-01,  ...,  2.2449e-01,
          -9.6619e-02, -1.0974e-01]],

        [[-2.3376e-02, -4.0924e-02, -2.5528e-02,  ...,  6.0699e-02,
          -9.0942e-03,  3.0609e-02],
         [ 1.0109e-02, -5.0163e-04,  3.5267e-03,  ...,  2.7256e-03,
           7.6389e-04,  3.2997e-03],
         [ 5.3062e-03,  9.5825e-03,  2.2755e-03,  ...,  7.5340e-03,
          -5.7259e-03, -1.0376e-02],
         ...,
         [-9.8228e-04,  3.2177e-03, -5.9700e-03,  ...,  3.4447e-03,
          -7.5006e-04, -3.3760e-04],
         [ 1.7290e-03, -1.8072e-03,  2.6855e-02,  ...,  9.5978e-03,
          -8.5526e-03,  1.1950e-03],
         [-5.8794e-04,  7.6447e-03,  8.8959e-03,  ...,  1.4008e-02,
          -4.8714e-03, -5.7030e-03]]], device='cuda:0', dtype=torch.float16)
reshape and cache tensor([[[ 0.1705,  0.0330,  0.3574,  ...,  0.2915, -0.1649,  0.2798],
         [-0.5127, -0.0372,  0.2456,  ...,  0.0954,  0.4417, -0.1213],
         [-0.1092,  0.3643,  0.3530,  ...,  0.2487, -0.3494, -0.2842],
         ...,
         [ 0.4551,  0.0329, -0.3855,  ...,  0.4607, -0.1016,  0.3306],
         [ 0.0668, -0.4255,  0.2786,  ...,  0.5308,  0.5278,  0.8687],
         [ 0.1833, -0.3035,  0.2891,  ..., -0.4958, -0.0064,  0.1864]],

        [[-0.3721, -2.3184, -2.4941,  ...,  0.7939,  2.5215,  0.5850],
         [ 1.5088, -1.7266, -2.0039,  ..., -2.9121, -2.4473,  0.3020],
         [-1.7188, -1.6631, -2.1621,  ..., -1.3779,  1.6045,  0.5991],
         ...,
         [-0.5947, -0.3386,  2.9102,  ..., -2.1816, -0.8994, -3.0410],
         [ 0.0218, -1.8584, -0.0063,  ...,  0.9077, -2.4980, -2.8496],
         [-0.4260, -0.0934, -1.2197,  ...,  0.3015, -1.5781, -0.5181]],

        [[ 0.1705,  0.0330,  0.3574,  ...,  0.2915, -0.1649,  0.2798],
         [-0.5127, -0.0372,  0.2456,  ...,  0.0954,  0.4417, -0.1213],
         [-0.1092,  0.3643,  0.3530,  ...,  0.2487, -0.3494, -0.2842],
         ...,
         [ 0.4551,  0.0329, -0.3855,  ...,  0.4607, -0.1016,  0.3306],
         [ 0.0668, -0.4255,  0.2786,  ...,  0.5308,  0.5278,  0.8687],
         [ 0.1833, -0.3035,  0.2891,  ..., -0.4958, -0.0064,  0.1864]],

        [[-0.3721, -2.3184, -2.4941,  ...,  0.7939,  2.5215,  0.5850],
         [ 1.5088, -1.7266, -2.0039,  ..., -2.9121, -2.4473,  0.3020],
         [-1.7188, -1.6631, -2.1621,  ..., -1.3779,  1.6045,  0.5991],
         ...,
         [-0.5947, -0.3386,  2.9102,  ..., -2.1816, -0.8994, -3.0410],
         [ 0.0218, -1.8584, -0.0063,  ...,  0.9077, -2.4980, -2.8496],
         [-0.4260, -0.0934, -1.2197,  ...,  0.3015, -1.5781, -0.5181]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584352, 584353], device='cuda:0')
num_prefill_tokens 4
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[-1.3403e-01,  3.0518e-02, -3.9551e-01,  ...,  8.4412e-02,
            2.3364e-01,  9.3445e-02],
          [ 2.2253e-01,  2.9297e-03, -1.8274e-01,  ..., -2.8491e-01,
           -2.3328e-01,  1.6956e-01],
          [ 1.7322e-01, -3.2104e-01, -2.6245e-01,  ..., -2.2119e-01,
            4.1351e-02,  1.4392e-01],
          ...,
          [-2.6685e-01,  1.9135e-02,  2.3169e-01,  ..., -2.7954e-01,
            2.7065e-03, -2.5415e-01],
          [ 3.0319e-02,  1.6516e-01, -2.0056e-01,  ...,  5.2429e-02,
           -1.9055e-01, -2.7832e-01],
          [-3.3508e-02,  1.6333e-01, -1.8188e-01,  ...,  1.7017e-01,
           -7.1167e-02, -1.1322e-02]],

         [[-1.0370e-01,  3.3643e-01,  3.7781e-02,  ..., -2.9062e+00,
           -2.2500e+00, -3.0645e+00],
          [-1.2617e+00,  8.1006e-01,  5.6885e-01,  ..., -1.0146e+00,
           -8.0505e-02, -1.0781e+00],
          [-7.5830e-01,  1.8689e-01,  8.6426e-01,  ...,  7.1826e-01,
           -1.4873e+00, -2.0840e+00],
          ...,
          [ 9.4223e-03, -1.1025e+00, -1.3018e+00,  ..., -1.0968e-01,
           -1.2910e+00,  1.9873e-01],
          [ 3.2898e-02, -1.3203e+00,  5.6396e-01,  ..., -2.6270e+00,
           -2.1545e-01, -7.2949e-01],
          [ 1.2393e+00, -8.6133e-01,  9.4531e-01,  ..., -8.9893e-01,
            3.5156e-01,  2.7563e-01]],

         [[-1.3403e-01,  3.0518e-02, -3.9551e-01,  ...,  8.4412e-02,
            2.3364e-01,  9.3445e-02],
          [ 2.2253e-01,  2.9297e-03, -1.8274e-01,  ..., -2.8491e-01,
           -2.3328e-01,  1.6956e-01],
          [ 1.7322e-01, -3.2104e-01, -2.6245e-01,  ..., -2.2119e-01,
            4.1351e-02,  1.4392e-01],
          ...,
          [-2.6685e-01,  1.9135e-02,  2.3169e-01,  ..., -2.7954e-01,
            2.7065e-03, -2.5415e-01],
          [ 3.0319e-02,  1.6516e-01, -2.0056e-01,  ...,  5.2429e-02,
           -1.9055e-01, -2.7832e-01],
          [-3.3508e-02,  1.6333e-01, -1.8188e-01,  ...,  1.7017e-01,
           -7.1167e-02, -1.1322e-02]],

         [[-1.0370e-01,  3.3643e-01,  3.7781e-02,  ..., -2.9062e+00,
           -2.2500e+00, -3.0645e+00],
          [-1.2617e+00,  8.1006e-01,  5.6885e-01,  ..., -1.0146e+00,
           -8.0505e-02, -1.0781e+00],
          [-7.5830e-01,  1.8689e-01,  8.6426e-01,  ...,  7.1826e-01,
           -1.4873e+00, -2.0840e+00],
          ...,
          [ 9.4223e-03, -1.1025e+00, -1.3018e+00,  ..., -1.0968e-01,
           -1.2910e+00,  1.9873e-01],
          [ 3.2898e-02, -1.3203e+00,  5.6396e-01,  ..., -2.6270e+00,
           -2.1545e-01, -7.2949e-01],
          [ 1.2393e+00, -8.6133e-01,  9.4531e-01,  ..., -8.9893e-01,
            3.5156e-01,  2.7563e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[ 0.1705,  0.0330,  0.3574,  ...,  0.2915, -0.1649,  0.2798],
          [-0.5127, -0.0372,  0.2456,  ...,  0.0954,  0.4417, -0.1213],
          [-0.1092,  0.3643,  0.3530,  ...,  0.2487, -0.3494, -0.2842],
          ...,
          [ 0.4551,  0.0329, -0.3855,  ...,  0.4607, -0.1016,  0.3306],
          [ 0.0668, -0.4255,  0.2786,  ...,  0.5308,  0.5278,  0.8687],
          [ 0.1833, -0.3035,  0.2891,  ..., -0.4958, -0.0064,  0.1864]],

         [[-0.3721, -2.3184, -2.4941,  ...,  0.7939,  2.5215,  0.5850],
          [ 1.5088, -1.7266, -2.0039,  ..., -2.9121, -2.4473,  0.3020],
          [-1.7188, -1.6631, -2.1621,  ..., -1.3779,  1.6045,  0.5991],
          ...,
          [-0.5947, -0.3386,  2.9102,  ..., -2.1816, -0.8994, -3.0410],
          [ 0.0218, -1.8584, -0.0063,  ...,  0.9077, -2.4980, -2.8496],
          [-0.4260, -0.0934, -1.2197,  ...,  0.3015, -1.5781, -0.5181]],

         [[ 0.1705,  0.0330,  0.3574,  ...,  0.2915, -0.1649,  0.2798],
          [-0.5127, -0.0372,  0.2456,  ...,  0.0954,  0.4417, -0.1213],
          [-0.1092,  0.3643,  0.3530,  ...,  0.2487, -0.3494, -0.2842],
          ...,
          [ 0.4551,  0.0329, -0.3855,  ...,  0.4607, -0.1016,  0.3306],
          [ 0.0668, -0.4255,  0.2786,  ...,  0.5308,  0.5278,  0.8687],
          [ 0.1833, -0.3035,  0.2891,  ..., -0.4958, -0.0064,  0.1864]],

         [[-0.3721, -2.3184, -2.4941,  ...,  0.7939,  2.5215,  0.5850],
          [ 1.5088, -1.7266, -2.0039,  ..., -2.9121, -2.4473,  0.3020],
          [-1.7188, -1.6631, -2.1621,  ..., -1.3779,  1.6045,  0.5991],
          ...,
          [-0.5947, -0.3386,  2.9102,  ..., -2.1816, -0.8994, -3.0410],
          [ 0.0218, -1.8584, -0.0063,  ...,  0.9077, -2.4980, -2.8496],
          [-0.4260, -0.0934, -1.2197,  ...,  0.3015, -1.5781, -0.5181]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 6.2828e-03, -4.3564e-03, -1.9350e-03,  ...,  5.1079e-03,
           -7.0381e-03,  1.2398e-03],
          [ 3.5267e-03, -1.0777e-03, -2.4307e-04,  ...,  1.3809e-03,
            8.9645e-04, -2.0790e-03],
          [-1.9875e-03,  5.8212e-03, -5.3864e-03,  ...,  7.1764e-04,
            1.1406e-03, -3.2673e-03],
          ...,
          [-2.6150e-03, -2.2221e-03,  3.3498e-05,  ...,  1.2140e-03,
           -3.9177e-03,  2.0874e-02],
          [ 2.1858e-03,  2.4014e-03, -8.2159e-04,  ..., -5.9462e-04,
            7.2212e-03, -1.5831e-03],
          [-4.8459e-05,  3.5839e-03, -4.4174e-03,  ..., -4.3983e-03,
           -5.3558e-03, -5.6343e-03]],

         [[-1.7944e-01,  2.1960e-01,  1.8129e-03,  ...,  3.5156e-02,
            1.0605e+00,  5.2094e-02],
          [-2.2202e-02,  1.7761e-01,  4.2651e-01,  ..., -1.0895e-01,
            1.6052e-01, -9.4757e-03],
          [ 1.4331e-01, -3.8501e-01, -2.3926e-01,  ..., -3.4839e-01,
           -9.2957e-02,  4.8071e-01],
          ...,
          [-1.1162e-02, -5.0079e-02, -3.5950e-02,  ...,  1.1536e-01,
           -1.7236e-01, -2.7539e-01],
          [-2.9395e-01, -1.1066e-01, -2.5732e-01,  ...,  2.4658e-02,
            4.1479e-01,  2.9694e-02],
          [-1.9885e-01,  2.6416e-01,  2.6147e-01,  ..., -6.0498e-01,
            3.5083e-01,  2.3767e-01]],

         [[ 6.2828e-03, -4.3564e-03, -1.9350e-03,  ...,  5.1079e-03,
           -7.0381e-03,  1.2398e-03],
          [ 3.5267e-03, -1.0777e-03, -2.4307e-04,  ...,  1.3809e-03,
            8.9645e-04, -2.0790e-03],
          [-1.9875e-03,  5.8212e-03, -5.3864e-03,  ...,  7.1764e-04,
            1.1406e-03, -3.2673e-03],
          ...,
          [-2.6150e-03, -2.2221e-03,  3.3498e-05,  ...,  1.2140e-03,
           -3.9177e-03,  2.0874e-02],
          [ 2.1858e-03,  2.4014e-03, -8.2159e-04,  ..., -5.9462e-04,
            7.2212e-03, -1.5831e-03],
          [-4.8459e-05,  3.5839e-03, -4.4174e-03,  ..., -4.3983e-03,
           -5.3558e-03, -5.6343e-03]],

         [[-1.7944e-01,  2.1960e-01,  1.8129e-03,  ...,  3.5156e-02,
            1.0605e+00,  5.2094e-02],
          [-2.2202e-02,  1.7761e-01,  4.2651e-01,  ..., -1.0895e-01,
            1.6052e-01, -9.4757e-03],
          [ 1.4331e-01, -3.8501e-01, -2.3926e-01,  ..., -3.4839e-01,
           -9.2957e-02,  4.8071e-01],
          ...,
          [-1.1162e-02, -5.0079e-02, -3.5950e-02,  ...,  1.1536e-01,
           -1.7236e-01, -2.7539e-01],
          [-2.9395e-01, -1.1066e-01, -2.5732e-01,  ...,  2.4658e-02,
            4.1479e-01,  2.9694e-02],
          [-1.9885e-01,  2.6416e-01,  2.6147e-01,  ..., -6.0498e-01,
            3.5083e-01,  2.3767e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[-1.5417e-01,  1.8909e-01,  1.3027e-03,  ...,  3.1067e-02,
           9.1504e-01,  4.5166e-02],
         [-2.0432e-02,  1.6541e-01,  3.9722e-01,  ..., -1.0138e-01,
           1.4954e-01, -8.9722e-03],
         [ 1.2469e-01, -3.3496e-01, -2.0923e-01,  ..., -3.0371e-01,
          -8.0872e-02,  4.1870e-01],
         ...,
         [-1.0910e-02, -4.8676e-02, -3.4912e-02,  ...,  1.1200e-01,
          -1.6748e-01, -2.6685e-01],
         [-2.6172e-01, -9.8328e-02, -2.2937e-01,  ...,  2.1896e-02,
           3.7036e-01,  2.6276e-02],
         [-1.6687e-01,  2.2229e-01,  2.1875e-01,  ..., -5.0830e-01,
           2.9346e-01,  1.9849e-01]],

        [[ 2.2030e-03,  5.6362e-04, -1.8530e-03,  ...,  5.7678e-03,
           1.6418e-02,  2.3575e-03],
         [ 3.1137e-04,  2.1255e-02,  5.3101e-02,  ..., -1.2405e-02,
           2.0844e-02, -3.0041e-03],
         [ 3.9101e-05,  3.7003e-04, -8.6517e-03,  ..., -4.1504e-03,
          -1.7178e-04,  3.4828e-03],
         ...,
         [-3.0193e-03, -4.4899e-03, -1.6708e-03,  ...,  6.6185e-03,
          -1.1894e-02,  6.8436e-03],
         [-8.5831e-03, -1.7118e-03, -1.0155e-02,  ...,  3.2401e-04,
           2.2049e-02, -4.4537e-04],
         [-9.8343e-03,  1.6418e-02,  8.6746e-03,  ..., -3.3966e-02,
           1.2184e-02,  6.3438e-03]],

        [[-1.5417e-01,  1.8909e-01,  1.3027e-03,  ...,  3.1067e-02,
           9.1504e-01,  4.5166e-02],
         [-2.0432e-02,  1.6541e-01,  3.9722e-01,  ..., -1.0138e-01,
           1.4954e-01, -8.9722e-03],
         [ 1.2469e-01, -3.3496e-01, -2.0923e-01,  ..., -3.0371e-01,
          -8.0872e-02,  4.1870e-01],
         ...,
         [-1.0910e-02, -4.8676e-02, -3.4912e-02,  ...,  1.1200e-01,
          -1.6748e-01, -2.6685e-01],
         [-2.6172e-01, -9.8328e-02, -2.2937e-01,  ...,  2.1896e-02,
           3.7036e-01,  2.6276e-02],
         [-1.6687e-01,  2.2229e-01,  2.1875e-01,  ..., -5.0830e-01,
           2.9346e-01,  1.9849e-01]],

        [[ 2.2030e-03,  5.6362e-04, -1.8530e-03,  ...,  5.7678e-03,
           1.6418e-02,  2.3575e-03],
         [ 3.1137e-04,  2.1255e-02,  5.3101e-02,  ..., -1.2405e-02,
           2.0844e-02, -3.0041e-03],
         [ 3.9101e-05,  3.7003e-04, -8.6517e-03,  ..., -4.1504e-03,
          -1.7178e-04,  3.4828e-03],
         ...,
         [-3.0193e-03, -4.4899e-03, -1.6708e-03,  ...,  6.6185e-03,
          -1.1894e-02,  6.8436e-03],
         [-8.5831e-03, -1.7118e-03, -1.0155e-02,  ...,  3.2401e-04,
           2.2049e-02, -4.4537e-04],
         [-9.8343e-03,  1.6418e-02,  8.6746e-03,  ..., -3.3966e-02,
           1.2184e-02,  6.3438e-03]]], device='cuda:0', dtype=torch.float16)
reshape and cache tensor([[[-0.0146, -0.8110, -0.2703,  ...,  1.8672, -0.3289,  0.2510],
         [ 0.9072, -0.1389,  0.0759,  ...,  1.2080, -0.5142,  0.2130],
         [-1.0137, -0.3945, -1.1221,  ..., -0.8589,  0.6479,  1.5889],
         ...,
         [ 0.6265,  0.7168,  0.5503,  ...,  0.3669, -0.3191,  0.9546],
         [-0.5410, -0.3550, -0.7568,  ..., -0.9873,  0.2676, -1.1084],
         [ 0.9009,  0.3030, -0.0052,  ..., -0.9448, -0.9556,  0.1648]],

        [[ 0.4253,  0.3396,  0.4087,  ...,  0.6782,  2.8613, -0.8716],
         [-0.7046, -0.6060, -0.1299,  ...,  0.8047, -0.1547, -1.0820],
         [ 0.6011, -0.2805,  2.0879,  ...,  0.7119, -0.3904, -2.7031],
         ...,
         [-0.6377,  0.3279, -2.8594,  ..., -0.1471,  0.6387, -3.1738],
         [ 2.9277,  2.2617, -1.0488,  ..., -0.2876, -0.3577,  0.2450],
         [-2.5527,  1.9150, -0.0491,  ...,  0.6499,  0.8662, -1.3438]],

        [[-0.0146, -0.8110, -0.2703,  ...,  1.8672, -0.3289,  0.2510],
         [ 0.9072, -0.1389,  0.0759,  ...,  1.2080, -0.5142,  0.2130],
         [-1.0137, -0.3945, -1.1221,  ..., -0.8589,  0.6479,  1.5889],
         ...,
         [ 0.6265,  0.7168,  0.5503,  ...,  0.3669, -0.3191,  0.9546],
         [-0.5410, -0.3550, -0.7568,  ..., -0.9873,  0.2676, -1.1084],
         [ 0.9009,  0.3030, -0.0052,  ..., -0.9448, -0.9556,  0.1648]],

        [[ 0.4253,  0.3396,  0.4087,  ...,  0.6782,  2.8613, -0.8716],
         [-0.7046, -0.6060, -0.1299,  ...,  0.8047, -0.1547, -1.0820],
         [ 0.6011, -0.2805,  2.0879,  ...,  0.7119, -0.3904, -2.7031],
         ...,
         [-0.6377,  0.3279, -2.8594,  ..., -0.1471,  0.6387, -3.1738],
         [ 2.9277,  2.2617, -1.0488,  ..., -0.2876, -0.3577,  0.2450],
         [-2.5527,  1.9150, -0.0491,  ...,  0.6499,  0.8662, -1.3438]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584352, 584353], device='cuda:0')
num_prefill_tokens 4
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[-0.3181,  0.6274, -0.1120,  ..., -0.8462,  0.1970, -0.3015],
          [-1.0518,  0.6997, -0.0250,  ..., -0.4336,  0.9185,  0.1907],
          [ 0.5361,  0.2231,  1.1143,  ...,  0.8301,  0.0406, -0.5464],
          ...,
          [-1.1660, -0.5264, -0.2542,  ..., -0.4363,  0.4731, -0.8564],
          [ 0.6177,  0.2385,  0.7051,  ...,  0.0357,  0.2993,  0.8994],
          [-0.1606, -0.3542,  0.1696,  ...,  0.4785,  0.7500,  0.0754]],

         [[ 0.3247, -0.7900, -1.7061,  ...,  0.6270, -0.7285, -0.3342],
          [ 1.6084, -1.4971,  1.0410,  ..., -2.1270,  0.1093, -0.3918],
          [ 0.0154,  0.8892, -1.7021,  ..., -0.0836,  0.7441,  0.7310],
          ...,
          [ 1.3760,  2.8594, -0.5835,  ...,  1.4619, -0.8989, -0.3877],
          [-0.1655,  0.4097, -0.5688,  ...,  0.8198, -0.9150, -0.8691],
          [ 0.6572,  1.3662, -0.9663,  ..., -1.0557, -0.2881,  1.4873]],

         [[-0.3181,  0.6274, -0.1120,  ..., -0.8462,  0.1970, -0.3015],
          [-1.0518,  0.6997, -0.0250,  ..., -0.4336,  0.9185,  0.1907],
          [ 0.5361,  0.2231,  1.1143,  ...,  0.8301,  0.0406, -0.5464],
          ...,
          [-1.1660, -0.5264, -0.2542,  ..., -0.4363,  0.4731, -0.8564],
          [ 0.6177,  0.2385,  0.7051,  ...,  0.0357,  0.2993,  0.8994],
          [-0.1606, -0.3542,  0.1696,  ...,  0.4785,  0.7500,  0.0754]],

         [[ 0.3247, -0.7900, -1.7061,  ...,  0.6270, -0.7285, -0.3342],
          [ 1.6084, -1.4971,  1.0410,  ..., -2.1270,  0.1093, -0.3918],
          [ 0.0154,  0.8892, -1.7021,  ..., -0.0836,  0.7441,  0.7310],
          ...,
          [ 1.3760,  2.8594, -0.5835,  ...,  1.4619, -0.8989, -0.3877],
          [-0.1655,  0.4097, -0.5688,  ...,  0.8198, -0.9150, -0.8691],
          [ 0.6572,  1.3662, -0.9663,  ..., -1.0557, -0.2881,  1.4873]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[-0.0146, -0.8110, -0.2703,  ...,  1.8672, -0.3289,  0.2510],
          [ 0.9072, -0.1389,  0.0759,  ...,  1.2080, -0.5142,  0.2130],
          [-1.0137, -0.3945, -1.1221,  ..., -0.8589,  0.6479,  1.5889],
          ...,
          [ 0.6265,  0.7168,  0.5503,  ...,  0.3669, -0.3191,  0.9546],
          [-0.5410, -0.3550, -0.7568,  ..., -0.9873,  0.2676, -1.1084],
          [ 0.9009,  0.3030, -0.0052,  ..., -0.9448, -0.9556,  0.1648]],

         [[ 0.4253,  0.3396,  0.4087,  ...,  0.6782,  2.8613, -0.8716],
          [-0.7046, -0.6060, -0.1299,  ...,  0.8047, -0.1547, -1.0820],
          [ 0.6011, -0.2805,  2.0879,  ...,  0.7119, -0.3904, -2.7031],
          ...,
          [-0.6377,  0.3279, -2.8594,  ..., -0.1471,  0.6387, -3.1738],
          [ 2.9277,  2.2617, -1.0488,  ..., -0.2876, -0.3577,  0.2450],
          [-2.5527,  1.9150, -0.0491,  ...,  0.6499,  0.8662, -1.3438]],

         [[-0.0146, -0.8110, -0.2703,  ...,  1.8672, -0.3289,  0.2510],
          [ 0.9072, -0.1389,  0.0759,  ...,  1.2080, -0.5142,  0.2130],
          [-1.0137, -0.3945, -1.1221,  ..., -0.8589,  0.6479,  1.5889],
          ...,
          [ 0.6265,  0.7168,  0.5503,  ...,  0.3669, -0.3191,  0.9546],
          [-0.5410, -0.3550, -0.7568,  ..., -0.9873,  0.2676, -1.1084],
          [ 0.9009,  0.3030, -0.0052,  ..., -0.9448, -0.9556,  0.1648]],

         [[ 0.4253,  0.3396,  0.4087,  ...,  0.6782,  2.8613, -0.8716],
          [-0.7046, -0.6060, -0.1299,  ...,  0.8047, -0.1547, -1.0820],
          [ 0.6011, -0.2805,  2.0879,  ...,  0.7119, -0.3904, -2.7031],
          ...,
          [-0.6377,  0.3279, -2.8594,  ..., -0.1471,  0.6387, -3.1738],
          [ 2.9277,  2.2617, -1.0488,  ..., -0.2876, -0.3577,  0.2450],
          [-2.5527,  1.9150, -0.0491,  ...,  0.6499,  0.8662, -1.3438]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 2.0180e-03,  9.7942e-04, -7.2746e-03,  ..., -2.5845e-03,
            3.2864e-03,  1.7939e-03],
          [ 1.6098e-02, -2.3246e-05, -3.3741e-03,  ..., -6.0844e-03,
            4.0474e-03,  6.9923e-03],
          [ 1.4811e-03,  1.8282e-03, -4.2572e-03,  ..., -3.9444e-03,
            2.3270e-04,  1.4206e-02],
          ...,
          [ 1.2131e-02, -8.1635e-04,  1.6470e-03,  ..., -2.5005e-03,
            8.1482e-03,  4.4975e-03],
          [-8.0948e-03,  6.2418e-04,  5.6343e-03,  ...,  2.1095e-03,
            1.6012e-03,  1.0498e-02],
          [ 2.0008e-03, -5.1308e-03,  2.1420e-03,  ..., -4.0936e-04,
           -3.8052e-04, -2.0523e-03]],

         [[-8.6136e-03, -1.0846e-01,  3.5327e-01,  ...,  2.5781e-01,
            4.0845e-01,  3.7231e-02],
          [-3.0487e-02,  1.1395e-01, -8.5327e-02,  ..., -1.8152e-01,
            7.5226e-03,  9.7900e-02],
          [-1.2372e-01,  1.5457e-02,  9.6252e-02,  ...,  2.3514e-02,
           -1.1188e-01, -1.5405e-01],
          ...,
          [-4.6570e-02,  1.5173e-01, -3.6182e-01,  ..., -4.4897e-01,
           -2.1741e-01, -3.0273e-01],
          [ 6.6162e-02,  2.3270e-02,  4.1466e-03,  ..., -2.7612e-01,
            9.4299e-03,  5.1971e-02],
          [ 1.8518e-01,  1.8702e-03,  6.0913e-02,  ...,  5.8990e-02,
            7.0435e-02,  3.2898e-02]],

         [[ 2.0180e-03,  9.7942e-04, -7.2746e-03,  ..., -2.5845e-03,
            3.2864e-03,  1.7939e-03],
          [ 1.6098e-02, -2.3246e-05, -3.3741e-03,  ..., -6.0844e-03,
            4.0474e-03,  6.9923e-03],
          [ 1.4811e-03,  1.8282e-03, -4.2572e-03,  ..., -3.9444e-03,
            2.3270e-04,  1.4206e-02],
          ...,
          [ 1.2131e-02, -8.1635e-04,  1.6470e-03,  ..., -2.5005e-03,
            8.1482e-03,  4.4975e-03],
          [-8.0948e-03,  6.2418e-04,  5.6343e-03,  ...,  2.1095e-03,
            1.6012e-03,  1.0498e-02],
          [ 2.0008e-03, -5.1308e-03,  2.1420e-03,  ..., -4.0936e-04,
           -3.8052e-04, -2.0523e-03]],

         [[-8.6136e-03, -1.0846e-01,  3.5327e-01,  ...,  2.5781e-01,
            4.0845e-01,  3.7231e-02],
          [-3.0487e-02,  1.1395e-01, -8.5327e-02,  ..., -1.8152e-01,
            7.5226e-03,  9.7900e-02],
          [-1.2372e-01,  1.5457e-02,  9.6252e-02,  ...,  2.3514e-02,
           -1.1188e-01, -1.5405e-01],
          ...,
          [-4.6570e-02,  1.5173e-01, -3.6182e-01,  ..., -4.4897e-01,
           -2.1741e-01, -3.0273e-01],
          [ 6.6162e-02,  2.3270e-02,  4.1466e-03,  ..., -2.7612e-01,
            9.4299e-03,  5.1971e-02],
          [ 1.8518e-01,  1.8702e-03,  6.0913e-02,  ...,  5.8990e-02,
            7.0435e-02,  3.2898e-02]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[-8.5831e-03, -1.0815e-01,  3.5229e-01,  ...,  2.5708e-01,
           4.0747e-01,  3.7140e-02],
         [-3.0411e-02,  1.1377e-01, -8.5205e-02,  ..., -1.8115e-01,
           7.5150e-03,  9.7717e-02],
         [-1.2372e-01,  1.5457e-02,  9.6252e-02,  ...,  2.3514e-02,
          -1.1188e-01, -1.5405e-01],
         ...,
         [-4.6387e-02,  1.5125e-01, -3.6084e-01,  ..., -4.4775e-01,
          -2.1680e-01, -3.0176e-01],
         [ 6.6162e-02,  2.3270e-02,  4.1466e-03,  ..., -2.7612e-01,
           9.4299e-03,  5.1971e-02],
         [ 1.8506e-01,  1.8673e-03,  6.0883e-02,  ...,  5.8960e-02,
           7.0374e-02,  3.2867e-02]],

        [[ 1.5593e-03, -3.7441e-03,  8.2855e-03,  ...,  8.6517e-03,
           2.0767e-02,  3.3226e-03],
         [ 1.5793e-02,  7.3195e-04, -3.9177e-03,  ..., -7.2479e-03,
           4.0703e-03,  7.5951e-03],
         [-3.8147e-03,  2.4052e-03, -6.4969e-06,  ..., -2.7828e-03,
          -4.5090e-03,  7.0915e-03],
         ...,
         [ 4.4098e-03,  1.9257e-02, -4.6173e-02,  ..., -6.1249e-02,
          -2.1530e-02, -3.5919e-02],
         [-9.2030e-05,  3.0651e-03,  5.4741e-03,  ..., -2.7878e-02,
           2.4452e-03,  1.4969e-02],
         [ 8.7814e-03, -4.8714e-03,  4.3182e-03,  ...,  1.7900e-03,
           2.2411e-03, -7.5817e-04]],

        [[-8.5831e-03, -1.0815e-01,  3.5229e-01,  ...,  2.5708e-01,
           4.0747e-01,  3.7140e-02],
         [-3.0411e-02,  1.1377e-01, -8.5205e-02,  ..., -1.8115e-01,
           7.5150e-03,  9.7717e-02],
         [-1.2372e-01,  1.5457e-02,  9.6252e-02,  ...,  2.3514e-02,
          -1.1188e-01, -1.5405e-01],
         ...,
         [-4.6387e-02,  1.5125e-01, -3.6084e-01,  ..., -4.4775e-01,
          -2.1680e-01, -3.0176e-01],
         [ 6.6162e-02,  2.3270e-02,  4.1466e-03,  ..., -2.7612e-01,
           9.4299e-03,  5.1971e-02],
         [ 1.8506e-01,  1.8673e-03,  6.0883e-02,  ...,  5.8960e-02,
           7.0374e-02,  3.2867e-02]],

        [[ 1.5593e-03, -3.7441e-03,  8.2855e-03,  ...,  8.6517e-03,
           2.0767e-02,  3.3226e-03],
         [ 1.5793e-02,  7.3195e-04, -3.9177e-03,  ..., -7.2479e-03,
           4.0703e-03,  7.5951e-03],
         [-3.8147e-03,  2.4052e-03, -6.4969e-06,  ..., -2.7828e-03,
          -4.5090e-03,  7.0915e-03],
         ...,
         [ 4.4098e-03,  1.9257e-02, -4.6173e-02,  ..., -6.1249e-02,
          -2.1530e-02, -3.5919e-02],
         [-9.2030e-05,  3.0651e-03,  5.4741e-03,  ..., -2.7878e-02,
           2.4452e-03,  1.4969e-02],
         [ 8.7814e-03, -4.8714e-03,  4.3182e-03,  ...,  1.7900e-03,
           2.2411e-03, -7.5817e-04]]], device='cuda:0', dtype=torch.float16)
reshape and cache tensor([[[-0.8120,  0.9121, -0.3120,  ...,  0.7412, -0.5752, -0.3091],
         [ 0.8145,  0.4812, -0.5107,  ...,  0.7026,  0.4202, -0.6470],
         [-0.6445, -0.8389,  0.6187,  ..., -0.1532,  0.2251,  0.7344],
         ...,
         [ 0.6875,  0.5469,  1.0811,  ...,  0.8008,  0.9507,  0.5708],
         [-0.7593,  0.8730, -0.4133,  ..., -0.8345,  0.1903,  0.4216],
         [-0.3540, -0.4543, -0.7642,  ...,  0.4480, -0.2754,  0.6348]],

        [[ 0.4910, -0.9155, -0.5718,  ..., -1.5488,  1.5137, -0.5396],
         [-0.9458, -1.4287,  1.6846,  ...,  0.3210, -1.1143,  1.3271],
         [-1.8506,  1.3496,  0.5444,  ...,  1.6055,  1.4629, -3.1621],
         ...,
         [ 0.0778,  0.7446, -1.9141,  ..., -0.6597, -1.6484,  0.2842],
         [ 1.0127, -1.6436,  1.9863,  ..., -0.5171, -0.1919, -0.7915],
         [-0.8911,  0.4001, -0.3582,  ..., -0.6177, -0.2123, -0.4287]],

        [[-0.8120,  0.9121, -0.3120,  ...,  0.7412, -0.5752, -0.3091],
         [ 0.8145,  0.4812, -0.5107,  ...,  0.7026,  0.4202, -0.6470],
         [-0.6445, -0.8389,  0.6187,  ..., -0.1532,  0.2251,  0.7344],
         ...,
         [ 0.6875,  0.5469,  1.0811,  ...,  0.8008,  0.9507,  0.5708],
         [-0.7593,  0.8730, -0.4133,  ..., -0.8345,  0.1903,  0.4216],
         [-0.3540, -0.4543, -0.7642,  ...,  0.4480, -0.2754,  0.6348]],

        [[ 0.4910, -0.9155, -0.5718,  ..., -1.5488,  1.5137, -0.5396],
         [-0.9458, -1.4287,  1.6846,  ...,  0.3210, -1.1143,  1.3271],
         [-1.8506,  1.3496,  0.5444,  ...,  1.6055,  1.4629, -3.1621],
         ...,
         [ 0.0778,  0.7446, -1.9141,  ..., -0.6597, -1.6484,  0.2842],
         [ 1.0127, -1.6436,  1.9863,  ..., -0.5171, -0.1919, -0.7915],
         [-0.8911,  0.4001, -0.3582,  ..., -0.6177, -0.2123, -0.4287]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584352, 584353], device='cuda:0')
num_prefill_tokens 4
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[ 3.2739e-01, -3.1226e-01,  2.8687e-01,  ..., -2.4292e-01,
            2.8784e-01,  2.3633e-01],
          [-5.1709e-01, -4.5508e-01,  6.0156e-01,  ..., -2.5415e-01,
           -3.8232e-01,  4.4604e-01],
          [ 2.9346e-01,  3.0786e-01, -1.9629e-01,  ...,  3.3844e-02,
           -5.9853e-03, -4.6753e-01],
          ...,
          [ 1.0577e-01, -2.0776e-01, -5.5322e-01,  ..., -4.4336e-01,
           -2.4255e-01, -1.5710e-01],
          [ 4.6606e-01, -5.5371e-01,  3.4888e-01,  ...,  2.6660e-01,
           -1.7444e-01, -3.2178e-01],
          [ 1.1224e-01,  1.5076e-01,  3.9600e-01,  ..., -4.1455e-01,
            2.9346e-01, -2.7490e-01]],

         [[-2.1172e+00,  2.8984e+00, -1.1934e+00,  ...,  2.6360e-03,
           -1.0742e+00, -2.6050e-01],
          [ 1.8984e+00, -1.1255e-01, -4.0137e-01,  ...,  1.8604e+00,
           -1.9961e+00, -9.7314e-01],
          [-1.5215e+00, -3.6328e-01, -1.9421e-01,  ..., -1.1553e+00,
           -1.9375e+00,  1.9043e+00],
          ...,
          [-2.0059e+00,  5.4297e-01,  1.2783e+00,  ..., -3.0444e-01,
            1.7979e+00, -2.4634e-01],
          [-1.8398e+00,  1.5244e+00,  1.3513e-01,  ..., -2.1758e+00,
            1.0166e+00, -4.8145e-01],
          [ 3.2695e+00, -1.4521e+00, -1.5752e+00,  ...,  7.1387e-01,
           -2.0859e+00, -1.4502e+00]],

         [[ 3.2739e-01, -3.1226e-01,  2.8687e-01,  ..., -2.4292e-01,
            2.8784e-01,  2.3633e-01],
          [-5.1709e-01, -4.5508e-01,  6.0156e-01,  ..., -2.5415e-01,
           -3.8232e-01,  4.4604e-01],
          [ 2.9346e-01,  3.0786e-01, -1.9629e-01,  ...,  3.3844e-02,
           -5.9853e-03, -4.6753e-01],
          ...,
          [ 1.0577e-01, -2.0776e-01, -5.5322e-01,  ..., -4.4336e-01,
           -2.4255e-01, -1.5710e-01],
          [ 4.6606e-01, -5.5371e-01,  3.4888e-01,  ...,  2.6660e-01,
           -1.7444e-01, -3.2178e-01],
          [ 1.1224e-01,  1.5076e-01,  3.9600e-01,  ..., -4.1455e-01,
            2.9346e-01, -2.7490e-01]],

         [[-2.1172e+00,  2.8984e+00, -1.1934e+00,  ...,  2.6360e-03,
           -1.0742e+00, -2.6050e-01],
          [ 1.8984e+00, -1.1255e-01, -4.0137e-01,  ...,  1.8604e+00,
           -1.9961e+00, -9.7314e-01],
          [-1.5215e+00, -3.6328e-01, -1.9421e-01,  ..., -1.1553e+00,
           -1.9375e+00,  1.9043e+00],
          ...,
          [-2.0059e+00,  5.4297e-01,  1.2783e+00,  ..., -3.0444e-01,
            1.7979e+00, -2.4634e-01],
          [-1.8398e+00,  1.5244e+00,  1.3513e-01,  ..., -2.1758e+00,
            1.0166e+00, -4.8145e-01],
          [ 3.2695e+00, -1.4521e+00, -1.5752e+00,  ...,  7.1387e-01,
           -2.0859e+00, -1.4502e+00]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[-0.8120,  0.9121, -0.3120,  ...,  0.7412, -0.5752, -0.3091],
          [ 0.8145,  0.4812, -0.5107,  ...,  0.7026,  0.4202, -0.6470],
          [-0.6445, -0.8389,  0.6187,  ..., -0.1532,  0.2251,  0.7344],
          ...,
          [ 0.6875,  0.5469,  1.0811,  ...,  0.8008,  0.9507,  0.5708],
          [-0.7593,  0.8730, -0.4133,  ..., -0.8345,  0.1903,  0.4216],
          [-0.3540, -0.4543, -0.7642,  ...,  0.4480, -0.2754,  0.6348]],

         [[ 0.4910, -0.9155, -0.5718,  ..., -1.5488,  1.5137, -0.5396],
          [-0.9458, -1.4287,  1.6846,  ...,  0.3210, -1.1143,  1.3271],
          [-1.8506,  1.3496,  0.5444,  ...,  1.6055,  1.4629, -3.1621],
          ...,
          [ 0.0778,  0.7446, -1.9141,  ..., -0.6597, -1.6484,  0.2842],
          [ 1.0127, -1.6436,  1.9863,  ..., -0.5171, -0.1919, -0.7915],
          [-0.8911,  0.4001, -0.3582,  ..., -0.6177, -0.2123, -0.4287]],

         [[-0.8120,  0.9121, -0.3120,  ...,  0.7412, -0.5752, -0.3091],
          [ 0.8145,  0.4812, -0.5107,  ...,  0.7026,  0.4202, -0.6470],
          [-0.6445, -0.8389,  0.6187,  ..., -0.1532,  0.2251,  0.7344],
          ...,
          [ 0.6875,  0.5469,  1.0811,  ...,  0.8008,  0.9507,  0.5708],
          [-0.7593,  0.8730, -0.4133,  ..., -0.8345,  0.1903,  0.4216],
          [-0.3540, -0.4543, -0.7642,  ...,  0.4480, -0.2754,  0.6348]],

         [[ 0.4910, -0.9155, -0.5718,  ..., -1.5488,  1.5137, -0.5396],
          [-0.9458, -1.4287,  1.6846,  ...,  0.3210, -1.1143,  1.3271],
          [-1.8506,  1.3496,  0.5444,  ...,  1.6055,  1.4629, -3.1621],
          ...,
          [ 0.0778,  0.7446, -1.9141,  ..., -0.6597, -1.6484,  0.2842],
          [ 1.0127, -1.6436,  1.9863,  ..., -0.5171, -0.1919, -0.7915],
          [-0.8911,  0.4001, -0.3582,  ..., -0.6177, -0.2123, -0.4287]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 2.4166e-03,  2.1133e-03,  2.7142e-03,  ..., -7.9250e-04,
            5.3787e-03,  1.3428e-03],
          [ 2.3384e-03, -2.0447e-03, -9.4354e-05,  ..., -2.3079e-03,
           -4.4975e-03,  3.2787e-03],
          [ 1.3657e-02, -1.1612e-02,  3.7498e-03,  ..., -8.1253e-03,
            9.6512e-03,  2.4319e-03],
          ...,
          [ 2.1172e-04,  2.3136e-03,  1.1330e-03,  ..., -9.3889e-04,
           -3.3360e-03, -2.5101e-03],
          [ 1.9569e-03,  4.2343e-03, -6.6452e-03,  ..., -3.0193e-03,
            1.1734e-02,  9.6283e-03],
          [-2.0428e-03, -1.1244e-03, -5.4436e-03,  ...,  1.2810e-02,
           -6.0425e-03, -9.3994e-03]],

         [[-6.1722e-03, -3.5706e-02,  1.7029e-01,  ...,  2.6970e-03,
           -5.5603e-02,  1.9641e-01],
          [ 5.9143e-02,  1.1127e-01, -3.6255e-02,  ..., -2.4805e-01,
           -1.3367e-01, -5.5237e-02],
          [ 1.1609e-01, -6.1371e-02,  1.0291e-01,  ...,  6.4148e-02,
            7.6721e-02, -2.2791e-01],
          ...,
          [ 7.0923e-02, -3.5126e-02, -8.8928e-02,  ..., -1.2585e-01,
            1.1487e-01,  2.0679e-01],
          [ 3.8361e-02, -1.5002e-01,  1.3306e-01,  ...,  8.9951e-03,
            4.3884e-02, -2.4634e-01],
          [ 8.7219e-02,  3.6743e-02, -1.7151e-01,  ..., -2.1777e-01,
           -5.4352e-02,  9.6207e-03]],

         [[ 2.4166e-03,  2.1133e-03,  2.7142e-03,  ..., -7.9250e-04,
            5.3787e-03,  1.3428e-03],
          [ 2.3384e-03, -2.0447e-03, -9.4354e-05,  ..., -2.3079e-03,
           -4.4975e-03,  3.2787e-03],
          [ 1.3657e-02, -1.1612e-02,  3.7498e-03,  ..., -8.1253e-03,
            9.6512e-03,  2.4319e-03],
          ...,
          [ 2.1172e-04,  2.3136e-03,  1.1330e-03,  ..., -9.3889e-04,
           -3.3360e-03, -2.5101e-03],
          [ 1.9569e-03,  4.2343e-03, -6.6452e-03,  ..., -3.0193e-03,
            1.1734e-02,  9.6283e-03],
          [-2.0428e-03, -1.1244e-03, -5.4436e-03,  ...,  1.2810e-02,
           -6.0425e-03, -9.3994e-03]],

         [[-6.1722e-03, -3.5706e-02,  1.7029e-01,  ...,  2.6970e-03,
           -5.5603e-02,  1.9641e-01],
          [ 5.9143e-02,  1.1127e-01, -3.6255e-02,  ..., -2.4805e-01,
           -1.3367e-01, -5.5237e-02],
          [ 1.1609e-01, -6.1371e-02,  1.0291e-01,  ...,  6.4148e-02,
            7.6721e-02, -2.2791e-01],
          ...,
          [ 7.0923e-02, -3.5126e-02, -8.8928e-02,  ..., -1.2585e-01,
            1.1487e-01,  2.0679e-01],
          [ 3.8361e-02, -1.5002e-01,  1.3306e-01,  ...,  8.9951e-03,
            4.3884e-02, -2.4634e-01],
          [ 8.7219e-02,  3.6743e-02, -1.7151e-01,  ..., -2.1777e-01,
           -5.4352e-02,  9.6207e-03]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[-6.0959e-03, -3.5370e-02,  1.6882e-01,  ...,  2.6646e-03,
          -5.5054e-02,  1.9470e-01],
         [ 5.7709e-02,  1.0840e-01, -3.5339e-02,  ..., -2.4182e-01,
          -1.3037e-01, -5.3772e-02],
         [ 1.1591e-01, -6.1279e-02,  1.0272e-01,  ...,  6.4026e-02,
           7.6599e-02, -2.2742e-01],
         ...,
         [ 6.9397e-02, -3.4332e-02, -8.6975e-02,  ..., -1.2317e-01,
           1.1230e-01,  2.0227e-01],
         [ 3.8147e-02, -1.4917e-01,  1.3220e-01,  ...,  8.9264e-03,
           4.3701e-02, -2.4487e-01],
         [ 8.6182e-02,  3.6316e-02, -1.6956e-01,  ..., -2.1509e-01,
          -5.3802e-02,  9.3994e-03]],

        [[ 2.3098e-03,  1.6422e-03,  4.7989e-03,  ..., -7.4911e-04,
           4.6196e-03,  3.7708e-03],
         [ 2.5215e-03, -1.6804e-03, -2.1052e-04,  ..., -3.0975e-03,
          -4.9133e-03,  3.0899e-03],
         [ 1.5808e-02, -1.2657e-02,  5.8403e-03,  ..., -6.6032e-03,
           1.1063e-02, -2.4223e-03],
         ...,
         [ 3.7899e-03,  4.1866e-04, -3.4256e-03,  ..., -7.2632e-03,
           2.6474e-03,  8.0872e-03],
         [ 2.3556e-03,  2.5482e-03, -5.1193e-03,  ..., -2.8877e-03,
           1.2085e-02,  6.8283e-03],
         [ 4.0169e-03,  1.4458e-03, -1.6708e-02,  ..., -2.8400e-03,
          -9.3231e-03, -8.1100e-03]],

        [[-6.0959e-03, -3.5370e-02,  1.6882e-01,  ...,  2.6646e-03,
          -5.5054e-02,  1.9470e-01],
         [ 5.7709e-02,  1.0840e-01, -3.5339e-02,  ..., -2.4182e-01,
          -1.3037e-01, -5.3772e-02],
         [ 1.1591e-01, -6.1279e-02,  1.0272e-01,  ...,  6.4026e-02,
           7.6599e-02, -2.2742e-01],
         ...,
         [ 6.9397e-02, -3.4332e-02, -8.6975e-02,  ..., -1.2317e-01,
           1.1230e-01,  2.0227e-01],
         [ 3.8147e-02, -1.4917e-01,  1.3220e-01,  ...,  8.9264e-03,
           4.3701e-02, -2.4487e-01],
         [ 8.6182e-02,  3.6316e-02, -1.6956e-01,  ..., -2.1509e-01,
          -5.3802e-02,  9.3994e-03]],

        [[ 2.3098e-03,  1.6422e-03,  4.7989e-03,  ..., -7.4911e-04,
           4.6196e-03,  3.7708e-03],
         [ 2.5215e-03, -1.6804e-03, -2.1052e-04,  ..., -3.0975e-03,
          -4.9133e-03,  3.0899e-03],
         [ 1.5808e-02, -1.2657e-02,  5.8403e-03,  ..., -6.6032e-03,
           1.1063e-02, -2.4223e-03],
         ...,
         [ 3.7899e-03,  4.1866e-04, -3.4256e-03,  ..., -7.2632e-03,
           2.6474e-03,  8.0872e-03],
         [ 2.3556e-03,  2.5482e-03, -5.1193e-03,  ..., -2.8877e-03,
           1.2085e-02,  6.8283e-03],
         [ 4.0169e-03,  1.4458e-03, -1.6708e-02,  ..., -2.8400e-03,
          -9.3231e-03, -8.1100e-03]]], device='cuda:0', dtype=torch.float16)
reshape and cache tensor([[[-6.6064e-01,  1.3105e+00,  4.7900e-01,  ...,  9.3457e-01,
           1.0254e+00, -9.3799e-01],
         [ 1.7590e-01, -1.5820e-01, -3.6548e-01,  ...,  9.7607e-01,
           8.0273e-01,  1.1152e+00],
         [ 1.0020e+00, -1.1660e+00,  1.7822e+00,  ..., -2.7759e-01,
           9.2090e-01, -5.0000e-01],
         ...,
         [-1.4482e+00,  1.1289e+00, -1.3848e+00,  ..., -9.4287e-01,
           7.6172e-01, -7.6953e-01],
         [-1.5273e+00, -1.0420e+00, -4.2261e-01,  ..., -1.3096e+00,
          -6.0449e-01, -1.1484e+00],
         [ 3.8745e-01,  7.1875e-01, -2.8706e-03,  ..., -1.0996e+00,
           1.8311e-01,  1.2732e-01]],

        [[ 5.3906e-01, -1.6602e+00, -1.8125e+00,  ..., -1.9355e+00,
          -2.4316e+00,  3.8965e+00],
         [ 8.3862e-02,  3.7500e-01, -1.5498e+00,  ..., -5.0659e-02,
          -2.9419e-01, -1.4189e+00],
         [ 1.3320e+00,  2.6191e+00, -2.0820e+00,  ...,  7.5049e-01,
          -9.7510e-01,  3.2520e-01],
         ...,
         [ 1.7568e+00, -4.9062e+00,  1.5742e+00,  ...,  6.7139e-02,
          -4.6704e-01,  7.3438e-01],
         [ 1.4229e+00,  1.1072e-01,  2.0938e+00,  ..., -1.9355e+00,
           1.6992e-01,  9.0088e-01],
         [-6.5430e-02, -9.4629e-01, -4.8193e-01,  ...,  2.0957e+00,
          -2.7500e+00,  1.9495e-01]],

        [[-6.6064e-01,  1.3105e+00,  4.7900e-01,  ...,  9.3457e-01,
           1.0254e+00, -9.3799e-01],
         [ 1.7590e-01, -1.5820e-01, -3.6548e-01,  ...,  9.7607e-01,
           8.0273e-01,  1.1152e+00],
         [ 1.0020e+00, -1.1660e+00,  1.7822e+00,  ..., -2.7759e-01,
           9.2090e-01, -5.0000e-01],
         ...,
         [-1.4482e+00,  1.1289e+00, -1.3848e+00,  ..., -9.4287e-01,
           7.6172e-01, -7.6953e-01],
         [-1.5273e+00, -1.0420e+00, -4.2261e-01,  ..., -1.3096e+00,
          -6.0449e-01, -1.1484e+00],
         [ 3.8745e-01,  7.1875e-01, -2.8706e-03,  ..., -1.0996e+00,
           1.8311e-01,  1.2732e-01]],

        [[ 5.3906e-01, -1.6602e+00, -1.8125e+00,  ..., -1.9355e+00,
          -2.4316e+00,  3.8965e+00],
         [ 8.3862e-02,  3.7500e-01, -1.5498e+00,  ..., -5.0659e-02,
          -2.9419e-01, -1.4189e+00],
         [ 1.3320e+00,  2.6191e+00, -2.0820e+00,  ...,  7.5049e-01,
          -9.7510e-01,  3.2520e-01],
         ...,
         [ 1.7568e+00, -4.9062e+00,  1.5742e+00,  ...,  6.7139e-02,
          -4.6704e-01,  7.3438e-01],
         [ 1.4229e+00,  1.1072e-01,  2.0938e+00,  ..., -1.9355e+00,
           1.6992e-01,  9.0088e-01],
         [-6.5430e-02, -9.4629e-01, -4.8193e-01,  ...,  2.0957e+00,
          -2.7500e+00,  1.9495e-01]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584352, 584353], device='cuda:0')
num_prefill_tokens 4
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[ 0.7988,  0.4194, -1.0557,  ..., -1.2969, -0.9087,  0.8608],
          [-0.2581, -0.4160,  0.0945,  ..., -0.2004, -0.2429, -1.1094],
          [-0.3560,  1.4893, -1.7373,  ..., -0.1227, -0.9839,  0.8955],
          ...,
          [ 1.5918, -0.2448,  1.1924,  ...,  0.7456, -1.1895,  0.9585],
          [ 1.0010,  0.9111,  1.6807,  ...,  0.6274,  0.9189,  0.9614],
          [-0.5513, -2.9004, -0.4167,  ...,  1.2002, -0.2625, -0.2991]],

         [[-1.9912, -1.4521,  2.1484,  ...,  1.2959, -1.8965,  0.9390],
          [ 1.1328, -0.8247,  1.5801,  ...,  0.3381,  1.1006,  3.1562],
          [ 2.5645, -0.9243, -1.2803,  ..., -0.1545,  1.9492, -4.5664],
          ...,
          [-0.3384, -0.9873, -1.6660,  ..., -1.8779,  0.9609,  0.3472],
          [-1.8838, -2.2246,  0.9434,  ..., -2.9570, -0.5039, -0.4082],
          [ 0.0399,  2.9863, -0.0084,  ...,  0.3167,  2.3145,  0.7666]],

         [[ 0.7988,  0.4194, -1.0557,  ..., -1.2969, -0.9087,  0.8608],
          [-0.2581, -0.4160,  0.0945,  ..., -0.2004, -0.2429, -1.1094],
          [-0.3560,  1.4893, -1.7373,  ..., -0.1227, -0.9839,  0.8955],
          ...,
          [ 1.5918, -0.2448,  1.1924,  ...,  0.7456, -1.1895,  0.9585],
          [ 1.0010,  0.9111,  1.6807,  ...,  0.6274,  0.9189,  0.9614],
          [-0.5513, -2.9004, -0.4167,  ...,  1.2002, -0.2625, -0.2991]],

         [[-1.9912, -1.4521,  2.1484,  ...,  1.2959, -1.8965,  0.9390],
          [ 1.1328, -0.8247,  1.5801,  ...,  0.3381,  1.1006,  3.1562],
          [ 2.5645, -0.9243, -1.2803,  ..., -0.1545,  1.9492, -4.5664],
          ...,
          [-0.3384, -0.9873, -1.6660,  ..., -1.8779,  0.9609,  0.3472],
          [-1.8838, -2.2246,  0.9434,  ..., -2.9570, -0.5039, -0.4082],
          [ 0.0399,  2.9863, -0.0084,  ...,  0.3167,  2.3145,  0.7666]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[-6.6064e-01,  1.3105e+00,  4.7900e-01,  ...,  9.3457e-01,
            1.0254e+00, -9.3799e-01],
          [ 1.7590e-01, -1.5820e-01, -3.6548e-01,  ...,  9.7607e-01,
            8.0273e-01,  1.1152e+00],
          [ 1.0020e+00, -1.1660e+00,  1.7822e+00,  ..., -2.7759e-01,
            9.2090e-01, -5.0000e-01],
          ...,
          [-1.4482e+00,  1.1289e+00, -1.3848e+00,  ..., -9.4287e-01,
            7.6172e-01, -7.6953e-01],
          [-1.5273e+00, -1.0420e+00, -4.2261e-01,  ..., -1.3096e+00,
           -6.0449e-01, -1.1484e+00],
          [ 3.8745e-01,  7.1875e-01, -2.8706e-03,  ..., -1.0996e+00,
            1.8311e-01,  1.2732e-01]],

         [[ 5.3906e-01, -1.6602e+00, -1.8125e+00,  ..., -1.9355e+00,
           -2.4316e+00,  3.8965e+00],
          [ 8.3862e-02,  3.7500e-01, -1.5498e+00,  ..., -5.0659e-02,
           -2.9419e-01, -1.4189e+00],
          [ 1.3320e+00,  2.6191e+00, -2.0820e+00,  ...,  7.5049e-01,
           -9.7510e-01,  3.2520e-01],
          ...,
          [ 1.7568e+00, -4.9062e+00,  1.5742e+00,  ...,  6.7139e-02,
           -4.6704e-01,  7.3438e-01],
          [ 1.4229e+00,  1.1072e-01,  2.0938e+00,  ..., -1.9355e+00,
            1.6992e-01,  9.0088e-01],
          [-6.5430e-02, -9.4629e-01, -4.8193e-01,  ...,  2.0957e+00,
           -2.7500e+00,  1.9495e-01]],

         [[-6.6064e-01,  1.3105e+00,  4.7900e-01,  ...,  9.3457e-01,
            1.0254e+00, -9.3799e-01],
          [ 1.7590e-01, -1.5820e-01, -3.6548e-01,  ...,  9.7607e-01,
            8.0273e-01,  1.1152e+00],
          [ 1.0020e+00, -1.1660e+00,  1.7822e+00,  ..., -2.7759e-01,
            9.2090e-01, -5.0000e-01],
          ...,
          [-1.4482e+00,  1.1289e+00, -1.3848e+00,  ..., -9.4287e-01,
            7.6172e-01, -7.6953e-01],
          [-1.5273e+00, -1.0420e+00, -4.2261e-01,  ..., -1.3096e+00,
           -6.0449e-01, -1.1484e+00],
          [ 3.8745e-01,  7.1875e-01, -2.8706e-03,  ..., -1.0996e+00,
            1.8311e-01,  1.2732e-01]],

         [[ 5.3906e-01, -1.6602e+00, -1.8125e+00,  ..., -1.9355e+00,
           -2.4316e+00,  3.8965e+00],
          [ 8.3862e-02,  3.7500e-01, -1.5498e+00,  ..., -5.0659e-02,
           -2.9419e-01, -1.4189e+00],
          [ 1.3320e+00,  2.6191e+00, -2.0820e+00,  ...,  7.5049e-01,
           -9.7510e-01,  3.2520e-01],
          ...,
          [ 1.7568e+00, -4.9062e+00,  1.5742e+00,  ...,  6.7139e-02,
           -4.6704e-01,  7.3438e-01],
          [ 1.4229e+00,  1.1072e-01,  2.0938e+00,  ..., -1.9355e+00,
            1.6992e-01,  9.0088e-01],
          [-6.5430e-02, -9.4629e-01, -4.8193e-01,  ...,  2.0957e+00,
           -2.7500e+00,  1.9495e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 7.6332e-03, -5.2605e-03,  5.3740e-04,  ...,  8.6832e-04,
           -1.4277e-03,  3.5839e-03],
          [-9.3231e-03,  2.1782e-03, -1.1196e-03,  ..., -3.8853e-03,
           -1.5312e-02, -3.0384e-03],
          [ 1.4923e-02,  3.1452e-03, -3.3207e-03,  ..., -6.7635e-03,
           -7.2899e-03, -2.3327e-03],
          ...,
          [-3.0365e-03,  3.8681e-03, -1.1501e-03,  ...,  9.3613e-03,
           -5.4703e-03,  3.7346e-03],
          [-2.3746e-03, -3.2806e-03, -6.0959e-03,  ..., -1.5717e-03,
            3.7441e-03,  1.7881e-03],
          [-1.1597e-02,  1.6296e-02,  9.6703e-04,  ..., -9.1324e-03,
            1.4114e-02, -2.8801e-03]],

         [[ 9.3506e-02, -2.2803e-01,  2.7664e-02,  ..., -1.9263e-01,
            2.2839e-01,  1.4275e-02],
          [ 4.0869e-01,  2.3010e-01, -1.0577e-01,  ..., -3.2593e-01,
            5.4150e-01,  3.6865e-01],
          [ 4.1077e-02, -4.5435e-01, -3.4332e-02,  ..., -1.2451e-01,
            5.1025e-01,  3.4277e-01],
          ...,
          [ 9.3384e-02, -6.1371e-02,  3.8261e-03,  ...,  1.0419e-01,
           -4.1357e-01,  2.7466e-01],
          [-7.6660e-02, -1.2915e-01, -9.9060e-02,  ...,  9.9304e-02,
           -6.4148e-02, -1.3147e-01],
          [-6.6895e-01, -7.7393e-02, -5.2539e-01,  ...,  1.3611e-01,
            6.0254e-01, -3.5107e-01]],

         [[ 7.6332e-03, -5.2605e-03,  5.3740e-04,  ...,  8.6832e-04,
           -1.4277e-03,  3.5839e-03],
          [-9.3231e-03,  2.1782e-03, -1.1196e-03,  ..., -3.8853e-03,
           -1.5312e-02, -3.0384e-03],
          [ 1.4923e-02,  3.1452e-03, -3.3207e-03,  ..., -6.7635e-03,
           -7.2899e-03, -2.3327e-03],
          ...,
          [-3.0365e-03,  3.8681e-03, -1.1501e-03,  ...,  9.3613e-03,
           -5.4703e-03,  3.7346e-03],
          [-2.3746e-03, -3.2806e-03, -6.0959e-03,  ..., -1.5717e-03,
            3.7441e-03,  1.7881e-03],
          [-1.1597e-02,  1.6296e-02,  9.6703e-04,  ..., -9.1324e-03,
            1.4114e-02, -2.8801e-03]],

         [[ 9.3506e-02, -2.2803e-01,  2.7664e-02,  ..., -1.9263e-01,
            2.2839e-01,  1.4275e-02],
          [ 4.0869e-01,  2.3010e-01, -1.0577e-01,  ..., -3.2593e-01,
            5.4150e-01,  3.6865e-01],
          [ 4.1077e-02, -4.5435e-01, -3.4332e-02,  ..., -1.2451e-01,
            5.1025e-01,  3.4277e-01],
          ...,
          [ 9.3384e-02, -6.1371e-02,  3.8261e-03,  ...,  1.0419e-01,
           -4.1357e-01,  2.7466e-01],
          [-7.6660e-02, -1.2915e-01, -9.9060e-02,  ...,  9.9304e-02,
           -6.4148e-02, -1.3147e-01],
          [-6.6895e-01, -7.7393e-02, -5.2539e-01,  ...,  1.3611e-01,
            6.0254e-01, -3.5107e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[ 9.3506e-02, -2.2803e-01,  2.7664e-02,  ..., -1.9263e-01,
           2.2839e-01,  1.4275e-02],
         [ 4.0820e-01,  2.2986e-01, -1.0565e-01,  ..., -3.2568e-01,
           5.4102e-01,  3.6841e-01],
         [ 4.1077e-02, -4.5435e-01, -3.4332e-02,  ..., -1.2451e-01,
           5.1025e-01,  3.4277e-01],
         ...,
         [ 9.3384e-02, -6.1371e-02,  3.8261e-03,  ...,  1.0419e-01,
          -4.1357e-01,  2.7466e-01],
         [-7.6660e-02, -1.2915e-01, -9.9060e-02,  ...,  9.9304e-02,
          -6.4148e-02, -1.3147e-01],
         [-6.6895e-01, -7.7393e-02, -5.2539e-01,  ...,  1.3611e-01,
           6.0254e-01, -3.5107e-01]],

        [[ 1.1772e-02, -1.5991e-02,  1.8444e-03,  ..., -8.4534e-03,
           9.6436e-03,  4.1008e-03],
         [-1.5793e-03,  6.4011e-03, -3.0575e-03,  ..., -9.8495e-03,
          -4.9973e-03,  3.8471e-03],
         [ 1.5076e-02,  4.6468e-04, -3.5019e-03,  ..., -7.4539e-03,
          -4.2572e-03, -3.1066e-04],
         ...,
         [-2.7943e-03,  3.7041e-03, -1.1377e-03,  ...,  9.5978e-03,
          -6.4926e-03,  4.4136e-03],
         [-2.8095e-03, -4.0169e-03, -6.6414e-03,  ..., -9.8133e-04,
           3.3474e-03,  1.0090e-03],
         [-1.3252e-02,  1.6068e-02, -3.5882e-04,  ..., -8.7662e-03,
           1.5594e-02, -3.7575e-03]],

        [[ 9.3506e-02, -2.2803e-01,  2.7664e-02,  ..., -1.9263e-01,
           2.2839e-01,  1.4275e-02],
         [ 4.0820e-01,  2.2986e-01, -1.0565e-01,  ..., -3.2568e-01,
           5.4102e-01,  3.6841e-01],
         [ 4.1077e-02, -4.5435e-01, -3.4332e-02,  ..., -1.2451e-01,
           5.1025e-01,  3.4277e-01],
         ...,
         [ 9.3384e-02, -6.1371e-02,  3.8261e-03,  ...,  1.0419e-01,
          -4.1357e-01,  2.7466e-01],
         [-7.6660e-02, -1.2915e-01, -9.9060e-02,  ...,  9.9304e-02,
          -6.4148e-02, -1.3147e-01],
         [-6.6895e-01, -7.7393e-02, -5.2539e-01,  ...,  1.3611e-01,
           6.0254e-01, -3.5107e-01]],

        [[ 1.1772e-02, -1.5991e-02,  1.8444e-03,  ..., -8.4534e-03,
           9.6436e-03,  4.1008e-03],
         [-1.5793e-03,  6.4011e-03, -3.0575e-03,  ..., -9.8495e-03,
          -4.9973e-03,  3.8471e-03],
         [ 1.5076e-02,  4.6468e-04, -3.5019e-03,  ..., -7.4539e-03,
          -4.2572e-03, -3.1066e-04],
         ...,
         [-2.7943e-03,  3.7041e-03, -1.1377e-03,  ...,  9.5978e-03,
          -6.4926e-03,  4.4136e-03],
         [-2.8095e-03, -4.0169e-03, -6.6414e-03,  ..., -9.8133e-04,
           3.3474e-03,  1.0090e-03],
         [-1.3252e-02,  1.6068e-02, -3.5882e-04,  ..., -8.7662e-03,
           1.5594e-02, -3.7575e-03]]], device='cuda:0', dtype=torch.float16)
reshape and cache tensor([[[ 0.5757,  0.5347,  0.0676,  ...,  0.0177,  3.0996,  0.4792],
         [-1.3818,  1.9229,  2.0742,  ..., -0.9526,  1.7383,  0.6758],
         [ 0.3469,  1.2412,  0.0555,  ..., -1.1221,  0.8369, -0.6245],
         ...,
         [-1.6523,  1.1260, -0.5952,  ..., -0.3062,  0.1484, -1.2139],
         [-0.3284,  0.2313, -1.4688,  ...,  0.0999, -1.7617,  0.3052],
         [-0.1710, -0.9873,  0.2283,  ...,  0.2354,  0.2412, -0.6777]],

        [[-0.7852,  1.1816, -2.2715,  ...,  2.6621, -1.4912, -0.8062],
         [-3.2578,  0.5444,  0.3918,  ...,  0.2791,  0.2482, -0.8936],
         [-0.1049, -1.0684,  0.6680,  ..., -1.0205, -1.6123,  1.1260],
         ...,
         [ 1.3096, -5.1328,  1.1846,  ..., -3.1602,  1.8311,  5.5859],
         [ 0.2284,  1.2510,  0.1006,  ..., -2.0547,  0.7666,  1.8271],
         [-1.2715,  0.6021,  0.1866,  ..., -0.7979, -0.4993, -1.1445]],

        [[ 0.5757,  0.5347,  0.0676,  ...,  0.0177,  3.0996,  0.4792],
         [-1.3818,  1.9229,  2.0742,  ..., -0.9526,  1.7383,  0.6758],
         [ 0.3469,  1.2412,  0.0555,  ..., -1.1221,  0.8369, -0.6245],
         ...,
         [-1.6523,  1.1260, -0.5952,  ..., -0.3062,  0.1484, -1.2139],
         [-0.3284,  0.2313, -1.4688,  ...,  0.0999, -1.7617,  0.3052],
         [-0.1710, -0.9873,  0.2283,  ...,  0.2354,  0.2412, -0.6777]],

        [[-0.7852,  1.1816, -2.2715,  ...,  2.6621, -1.4912, -0.8062],
         [-3.2578,  0.5444,  0.3918,  ...,  0.2791,  0.2482, -0.8936],
         [-0.1049, -1.0684,  0.6680,  ..., -1.0205, -1.6123,  1.1260],
         ...,
         [ 1.3096, -5.1328,  1.1846,  ..., -3.1602,  1.8311,  5.5859],
         [ 0.2284,  1.2510,  0.1006,  ..., -2.0547,  0.7666,  1.8271],
         [-1.2715,  0.6021,  0.1866,  ..., -0.7979, -0.4993, -1.1445]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584352, 584353], device='cuda:0')
num_prefill_tokens 4
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[-0.7500, -0.0705, -1.1113,  ...,  0.6997, -1.0928, -0.9077],
          [ 1.0820, -1.2578, -1.6406,  ..., -0.0718, -0.9531, -0.4146],
          [-0.2683, -1.3760,  0.1138,  ...,  1.1855, -0.4829,  1.6475],
          ...,
          [ 1.5361, -1.2686,  1.2373,  ...,  0.4382, -0.2222,  1.2939],
          [-0.2023,  0.1891,  2.7305,  ...,  0.4390,  2.4180, -1.6123],
          [-0.5825,  1.3643, -1.1006,  ..., -0.1440,  0.4670,  0.4778]],

         [[ 0.5142, -0.0375, -0.0391,  ..., -1.6738, -0.2898, -0.5913],
          [-0.7070,  1.0566,  0.0339,  ..., -1.2178,  2.0859, -0.8223],
          [-0.0721,  3.8750, -0.7407,  ...,  0.6553,  0.5352, -0.6855],
          ...,
          [-2.0566, -0.8267, -0.3579,  ..., -2.8730,  2.7578,  0.5156],
          [ 0.9141,  0.5049, -1.4053,  ...,  0.9458, -1.6777,  2.1738],
          [-1.2520, -0.4136,  1.4590,  ...,  0.0772,  0.6729, -3.4629]],

         [[-0.7500, -0.0705, -1.1113,  ...,  0.6997, -1.0928, -0.9077],
          [ 1.0820, -1.2578, -1.6406,  ..., -0.0718, -0.9531, -0.4146],
          [-0.2683, -1.3760,  0.1138,  ...,  1.1855, -0.4829,  1.6475],
          ...,
          [ 1.5361, -1.2686,  1.2373,  ...,  0.4382, -0.2222,  1.2939],
          [-0.2023,  0.1891,  2.7305,  ...,  0.4390,  2.4180, -1.6123],
          [-0.5825,  1.3643, -1.1006,  ..., -0.1440,  0.4670,  0.4778]],

         [[ 0.5142, -0.0375, -0.0391,  ..., -1.6738, -0.2898, -0.5913],
          [-0.7070,  1.0566,  0.0339,  ..., -1.2178,  2.0859, -0.8223],
          [-0.0721,  3.8750, -0.7407,  ...,  0.6553,  0.5352, -0.6855],
          ...,
          [-2.0566, -0.8267, -0.3579,  ..., -2.8730,  2.7578,  0.5156],
          [ 0.9141,  0.5049, -1.4053,  ...,  0.9458, -1.6777,  2.1738],
          [-1.2520, -0.4136,  1.4590,  ...,  0.0772,  0.6729, -3.4629]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[ 0.5757,  0.5347,  0.0676,  ...,  0.0177,  3.0996,  0.4792],
          [-1.3818,  1.9229,  2.0742,  ..., -0.9526,  1.7383,  0.6758],
          [ 0.3469,  1.2412,  0.0555,  ..., -1.1221,  0.8369, -0.6245],
          ...,
          [-1.6523,  1.1260, -0.5952,  ..., -0.3062,  0.1484, -1.2139],
          [-0.3284,  0.2313, -1.4688,  ...,  0.0999, -1.7617,  0.3052],
          [-0.1710, -0.9873,  0.2283,  ...,  0.2354,  0.2412, -0.6777]],

         [[-0.7852,  1.1816, -2.2715,  ...,  2.6621, -1.4912, -0.8062],
          [-3.2578,  0.5444,  0.3918,  ...,  0.2791,  0.2482, -0.8936],
          [-0.1049, -1.0684,  0.6680,  ..., -1.0205, -1.6123,  1.1260],
          ...,
          [ 1.3096, -5.1328,  1.1846,  ..., -3.1602,  1.8311,  5.5859],
          [ 0.2284,  1.2510,  0.1006,  ..., -2.0547,  0.7666,  1.8271],
          [-1.2715,  0.6021,  0.1866,  ..., -0.7979, -0.4993, -1.1445]],

         [[ 0.5757,  0.5347,  0.0676,  ...,  0.0177,  3.0996,  0.4792],
          [-1.3818,  1.9229,  2.0742,  ..., -0.9526,  1.7383,  0.6758],
          [ 0.3469,  1.2412,  0.0555,  ..., -1.1221,  0.8369, -0.6245],
          ...,
          [-1.6523,  1.1260, -0.5952,  ..., -0.3062,  0.1484, -1.2139],
          [-0.3284,  0.2313, -1.4688,  ...,  0.0999, -1.7617,  0.3052],
          [-0.1710, -0.9873,  0.2283,  ...,  0.2354,  0.2412, -0.6777]],

         [[-0.7852,  1.1816, -2.2715,  ...,  2.6621, -1.4912, -0.8062],
          [-3.2578,  0.5444,  0.3918,  ...,  0.2791,  0.2482, -0.8936],
          [-0.1049, -1.0684,  0.6680,  ..., -1.0205, -1.6123,  1.1260],
          ...,
          [ 1.3096, -5.1328,  1.1846,  ..., -3.1602,  1.8311,  5.5859],
          [ 0.2284,  1.2510,  0.1006,  ..., -2.0547,  0.7666,  1.8271],
          [-1.2715,  0.6021,  0.1866,  ..., -0.7979, -0.4993, -1.1445]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 2.9190e-02, -1.4725e-02,  4.6468e-04,  ...,  8.1968e-04,
            9.6130e-03,  1.0187e-01],
          [-2.4548e-03,  1.3065e-03,  5.2338e-03,  ..., -3.9101e-03,
           -8.8835e-04, -6.6185e-03],
          [ 8.0032e-03, -6.8817e-03,  1.0361e-02,  ...,  7.8964e-03,
           -7.0572e-04, -2.3621e-02],
          ...,
          [-1.7271e-03,  3.1166e-03, -5.4283e-03,  ..., -1.0536e-02,
           -9.7580e-03, -3.2444e-03],
          [ 3.6583e-03,  1.7593e-02, -6.9237e-03,  ..., -1.7227e-02,
            4.5280e-03, -1.2543e-02],
          [ 2.1172e-04,  5.8136e-03, -8.8882e-04,  ..., -2.7256e-03,
           -5.2757e-03, -7.0839e-03]],

         [[-2.9199e-01,  7.7393e-02, -2.5854e-01,  ..., -1.0120e-01,
           -1.0840e-01, -4.1089e-01],
          [ 4.9858e-03, -3.7384e-02, -6.8970e-02,  ..., -2.4353e-01,
            4.1553e-01,  1.7810e-01],
          [ 2.6611e-01, -8.0872e-02, -8.7036e-02,  ...,  3.3447e-01,
            1.0229e-01, -2.7148e-01],
          ...,
          [-4.6631e-01,  1.5234e-01, -1.1359e-01,  ..., -2.2192e-01,
           -9.5398e-02, -5.4901e-02],
          [ 5.3467e-01,  1.3604e+00, -3.6572e-01,  ..., -6.2027e-03,
            2.4219e-01,  1.0950e-01],
          [ 8.4595e-02,  8.4619e-01,  4.8071e-01,  ...,  6.2378e-02,
            8.0338e-03, -2.4048e-01]],

         [[ 2.9190e-02, -1.4725e-02,  4.6468e-04,  ...,  8.1968e-04,
            9.6130e-03,  1.0187e-01],
          [-2.4548e-03,  1.3065e-03,  5.2338e-03,  ..., -3.9101e-03,
           -8.8835e-04, -6.6185e-03],
          [ 8.0032e-03, -6.8817e-03,  1.0361e-02,  ...,  7.8964e-03,
           -7.0572e-04, -2.3621e-02],
          ...,
          [-1.7271e-03,  3.1166e-03, -5.4283e-03,  ..., -1.0536e-02,
           -9.7580e-03, -3.2444e-03],
          [ 3.6583e-03,  1.7593e-02, -6.9237e-03,  ..., -1.7227e-02,
            4.5280e-03, -1.2543e-02],
          [ 2.1172e-04,  5.8136e-03, -8.8882e-04,  ..., -2.7256e-03,
           -5.2757e-03, -7.0839e-03]],

         [[-2.9199e-01,  7.7393e-02, -2.5854e-01,  ..., -1.0120e-01,
           -1.0840e-01, -4.1089e-01],
          [ 4.9858e-03, -3.7384e-02, -6.8970e-02,  ..., -2.4353e-01,
            4.1553e-01,  1.7810e-01],
          [ 2.6611e-01, -8.0872e-02, -8.7036e-02,  ...,  3.3447e-01,
            1.0229e-01, -2.7148e-01],
          ...,
          [-4.6631e-01,  1.5234e-01, -1.1359e-01,  ..., -2.2192e-01,
           -9.5398e-02, -5.4901e-02],
          [ 5.3467e-01,  1.3604e+00, -3.6572e-01,  ..., -6.2027e-03,
            2.4219e-01,  1.0950e-01],
          [ 8.4595e-02,  8.4619e-01,  4.8071e-01,  ...,  6.2378e-02,
            8.0338e-03, -2.4048e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[-2.9199e-01,  7.7393e-02, -2.5854e-01,  ..., -1.0120e-01,
          -1.0840e-01, -4.1089e-01],
         [ 4.9858e-03, -3.7384e-02, -6.8970e-02,  ..., -2.4353e-01,
           4.1553e-01,  1.7810e-01],
         [ 2.6611e-01, -8.0872e-02, -8.7036e-02,  ...,  3.3447e-01,
           1.0229e-01, -2.7148e-01],
         ...,
         [-4.6606e-01,  1.5234e-01, -1.1353e-01,  ..., -2.2180e-01,
          -9.5398e-02, -5.4871e-02],
         [ 5.2881e-01,  1.3447e+00, -3.6157e-01,  ..., -6.3286e-03,
           2.3950e-01,  1.0809e-01],
         [ 8.4595e-02,  8.4570e-01,  4.8047e-01,  ...,  6.2347e-02,
           8.0261e-03, -2.4036e-01]],

        [[ 2.6199e-02, -1.3863e-02, -1.9531e-03,  ..., -1.3256e-04,
           8.5144e-03,  9.7107e-02],
         [-2.4014e-03,  1.0252e-03,  4.6959e-03,  ..., -5.6534e-03,
           2.1400e-03, -5.2757e-03],
         [ 1.0529e-02, -7.6065e-03,  9.4070e-03,  ...,  1.1093e-02,
           3.0279e-04, -2.6047e-02],
         ...,
         [-1.9012e-02,  8.6670e-03, -9.4528e-03,  ..., -1.8402e-02,
          -1.2947e-02, -5.1651e-03],
         [ 5.0995e-02,  1.3721e-01, -3.8910e-02,  ..., -1.6251e-02,
           2.5711e-02, -1.6670e-03],
         [ 2.3003e-03,  2.6611e-02,  1.1032e-02,  ..., -1.1148e-03,
          -4.9477e-03, -1.2863e-02]],

        [[-2.9199e-01,  7.7393e-02, -2.5854e-01,  ..., -1.0120e-01,
          -1.0840e-01, -4.1089e-01],
         [ 4.9858e-03, -3.7384e-02, -6.8970e-02,  ..., -2.4353e-01,
           4.1553e-01,  1.7810e-01],
         [ 2.6611e-01, -8.0872e-02, -8.7036e-02,  ...,  3.3447e-01,
           1.0229e-01, -2.7148e-01],
         ...,
         [-4.6606e-01,  1.5234e-01, -1.1353e-01,  ..., -2.2180e-01,
          -9.5398e-02, -5.4871e-02],
         [ 5.2881e-01,  1.3447e+00, -3.6157e-01,  ..., -6.3286e-03,
           2.3950e-01,  1.0809e-01],
         [ 8.4595e-02,  8.4570e-01,  4.8047e-01,  ...,  6.2347e-02,
           8.0261e-03, -2.4036e-01]],

        [[ 2.6199e-02, -1.3863e-02, -1.9531e-03,  ..., -1.3256e-04,
           8.5144e-03,  9.7107e-02],
         [-2.4014e-03,  1.0252e-03,  4.6959e-03,  ..., -5.6534e-03,
           2.1400e-03, -5.2757e-03],
         [ 1.0529e-02, -7.6065e-03,  9.4070e-03,  ...,  1.1093e-02,
           3.0279e-04, -2.6047e-02],
         ...,
         [-1.9012e-02,  8.6670e-03, -9.4528e-03,  ..., -1.8402e-02,
          -1.2947e-02, -5.1651e-03],
         [ 5.0995e-02,  1.3721e-01, -3.8910e-02,  ..., -1.6251e-02,
           2.5711e-02, -1.6670e-03],
         [ 2.3003e-03,  2.6611e-02,  1.1032e-02,  ..., -1.1148e-03,
          -4.9477e-03, -1.2863e-02]]], device='cuda:0', dtype=torch.float16)
reshape and cache tensor([[[-0.2791, -1.4443,  0.5415,  ..., -2.3613, -1.7432,  1.6074],
         [-0.6484, -0.6230,  0.4456,  ..., -1.1924, -0.1002,  0.4546],
         [ 0.7822,  0.5850,  0.3770,  ..., -0.9209, -1.2910, -0.2023],
         ...,
         [-0.6436,  1.0234,  1.2363,  ..., -1.0732, -0.2268,  0.0449],
         [-1.2109,  1.4912, -0.3965,  ..., -1.3379,  1.2109, -0.2788],
         [ 0.7617,  1.8174, -1.8330,  ..., -1.0869, -0.2642, -0.0061]],

        [[-1.8965, -0.8218, -1.7246,  ...,  0.3625,  0.2744,  0.5278],
         [-2.1699,  0.5879,  1.1553,  ...,  1.2881, -2.7480, -2.0176],
         [-1.0039, -1.2451,  3.1484,  ...,  0.9448, -1.4531,  0.4299],
         ...,
         [ 1.7871,  0.1534, -0.5728,  ...,  0.4834,  0.5898, -1.0928],
         [ 2.2930,  0.0075,  0.0649,  ..., -0.6348,  1.1904,  0.1196],
         [ 0.1609,  1.9199, -1.2402,  ...,  1.9160,  0.4946, -1.7588]],

        [[-0.2791, -1.4443,  0.5415,  ..., -2.3613, -1.7432,  1.6074],
         [-0.6484, -0.6230,  0.4456,  ..., -1.1924, -0.1002,  0.4546],
         [ 0.7822,  0.5850,  0.3770,  ..., -0.9209, -1.2910, -0.2023],
         ...,
         [-0.6436,  1.0234,  1.2363,  ..., -1.0732, -0.2268,  0.0449],
         [-1.2109,  1.4912, -0.3965,  ..., -1.3379,  1.2109, -0.2788],
         [ 0.7617,  1.8174, -1.8330,  ..., -1.0869, -0.2642, -0.0061]],

        [[-1.8965, -0.8218, -1.7246,  ...,  0.3625,  0.2744,  0.5278],
         [-2.1699,  0.5879,  1.1553,  ...,  1.2881, -2.7480, -2.0176],
         [-1.0039, -1.2451,  3.1484,  ...,  0.9448, -1.4531,  0.4299],
         ...,
         [ 1.7871,  0.1534, -0.5728,  ...,  0.4834,  0.5898, -1.0928],
         [ 2.2930,  0.0075,  0.0649,  ..., -0.6348,  1.1904,  0.1196],
         [ 0.1609,  1.9199, -1.2402,  ...,  1.9160,  0.4946, -1.7588]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584352, 584353], device='cuda:0')
num_prefill_tokens 4
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[ 0.2998,  1.0703, -1.9658,  ...,  2.2031,  1.4980, -0.2001],
          [ 0.0296,  0.6860, -1.0420,  ...,  0.3645, -0.2422,  0.8291],
          [-3.2031, -2.5645,  0.2474,  ...,  2.2324, -0.4141, -0.3069],
          ...,
          [-1.3252, -1.2480, -2.2969,  ...,  2.0352,  0.3735,  0.6992],
          [ 0.7407, -2.2539,  0.1594,  ...,  0.5791, -0.5488,  1.4238],
          [-1.2812, -2.2305,  0.8203,  ..., -0.0476, -1.0693,  1.9248]],

         [[-0.3599, -0.1765, -1.1865,  ..., -1.3447, -1.5225,  2.2676],
          [-0.2671,  0.3828,  1.7725,  ..., -1.5781, -0.4619,  1.2334],
          [ 0.2751,  1.8545,  1.4961,  ..., -1.9707, -1.0332,  0.1410],
          ...,
          [ 0.5186,  0.8535, -0.1628,  ..., -2.9707,  1.4092, -0.0770],
          [ 0.1373,  0.0226, -0.9590,  ..., -2.1426,  0.7852, -0.1752],
          [ 3.0449,  2.1602, -0.6152,  ..., -0.1482,  1.0674, -1.3467]],

         [[ 0.2998,  1.0703, -1.9658,  ...,  2.2031,  1.4980, -0.2001],
          [ 0.0296,  0.6860, -1.0420,  ...,  0.3645, -0.2422,  0.8291],
          [-3.2031, -2.5645,  0.2474,  ...,  2.2324, -0.4141, -0.3069],
          ...,
          [-1.3252, -1.2480, -2.2969,  ...,  2.0352,  0.3735,  0.6992],
          [ 0.7407, -2.2539,  0.1594,  ...,  0.5791, -0.5488,  1.4238],
          [-1.2812, -2.2305,  0.8203,  ..., -0.0476, -1.0693,  1.9248]],

         [[-0.3599, -0.1765, -1.1865,  ..., -1.3447, -1.5225,  2.2676],
          [-0.2671,  0.3828,  1.7725,  ..., -1.5781, -0.4619,  1.2334],
          [ 0.2751,  1.8545,  1.4961,  ..., -1.9707, -1.0332,  0.1410],
          ...,
          [ 0.5186,  0.8535, -0.1628,  ..., -2.9707,  1.4092, -0.0770],
          [ 0.1373,  0.0226, -0.9590,  ..., -2.1426,  0.7852, -0.1752],
          [ 3.0449,  2.1602, -0.6152,  ..., -0.1482,  1.0674, -1.3467]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[-0.2791, -1.4443,  0.5415,  ..., -2.3613, -1.7432,  1.6074],
          [-0.6484, -0.6230,  0.4456,  ..., -1.1924, -0.1002,  0.4546],
          [ 0.7822,  0.5850,  0.3770,  ..., -0.9209, -1.2910, -0.2023],
          ...,
          [-0.6436,  1.0234,  1.2363,  ..., -1.0732, -0.2268,  0.0449],
          [-1.2109,  1.4912, -0.3965,  ..., -1.3379,  1.2109, -0.2788],
          [ 0.7617,  1.8174, -1.8330,  ..., -1.0869, -0.2642, -0.0061]],

         [[-1.8965, -0.8218, -1.7246,  ...,  0.3625,  0.2744,  0.5278],
          [-2.1699,  0.5879,  1.1553,  ...,  1.2881, -2.7480, -2.0176],
          [-1.0039, -1.2451,  3.1484,  ...,  0.9448, -1.4531,  0.4299],
          ...,
          [ 1.7871,  0.1534, -0.5728,  ...,  0.4834,  0.5898, -1.0928],
          [ 2.2930,  0.0075,  0.0649,  ..., -0.6348,  1.1904,  0.1196],
          [ 0.1609,  1.9199, -1.2402,  ...,  1.9160,  0.4946, -1.7588]],

         [[-0.2791, -1.4443,  0.5415,  ..., -2.3613, -1.7432,  1.6074],
          [-0.6484, -0.6230,  0.4456,  ..., -1.1924, -0.1002,  0.4546],
          [ 0.7822,  0.5850,  0.3770,  ..., -0.9209, -1.2910, -0.2023],
          ...,
          [-0.6436,  1.0234,  1.2363,  ..., -1.0732, -0.2268,  0.0449],
          [-1.2109,  1.4912, -0.3965,  ..., -1.3379,  1.2109, -0.2788],
          [ 0.7617,  1.8174, -1.8330,  ..., -1.0869, -0.2642, -0.0061]],

         [[-1.8965, -0.8218, -1.7246,  ...,  0.3625,  0.2744,  0.5278],
          [-2.1699,  0.5879,  1.1553,  ...,  1.2881, -2.7480, -2.0176],
          [-1.0039, -1.2451,  3.1484,  ...,  0.9448, -1.4531,  0.4299],
          ...,
          [ 1.7871,  0.1534, -0.5728,  ...,  0.4834,  0.5898, -1.0928],
          [ 2.2930,  0.0075,  0.0649,  ..., -0.6348,  1.1904,  0.1196],
          [ 0.1609,  1.9199, -1.2402,  ...,  1.9160,  0.4946, -1.7588]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[-1.7223e-03,  1.9592e-02, -2.0027e-03,  ..., -2.7714e-03,
            4.1313e-03, -1.1955e-02],
          [ 7.6256e-03, -2.0466e-03, -4.0894e-03,  ..., -1.5915e-02,
            1.4145e-02, -1.4687e-02],
          [-3.8719e-03, -5.3024e-03,  1.7365e-02,  ...,  2.4052e-03,
            9.4147e-03, -9.5673e-03],
          ...,
          [-5.9204e-03,  8.3313e-03,  3.8300e-03,  ..., -2.3163e-02,
           -1.0796e-03, -1.1833e-02],
          [ 1.9035e-03,  1.4496e-02, -2.7634e-02,  ...,  1.4526e-02,
            7.0114e-03, -1.2535e-02],
          [-9.6970e-03, -2.8114e-03, -7.0229e-03,  ...,  5.9795e-04,
            3.1877e-04,  3.8738e-03]],

         [[-3.6133e-01, -2.7856e-01, -1.8005e-01,  ..., -1.7685e-02,
            3.6475e-01, -2.3267e-01],
          [-1.6235e-01, -8.5205e-02, -1.2067e-01,  ...,  2.0374e-01,
            7.0508e-01, -2.1387e-01],
          [ 1.2366e-01,  6.2939e-01,  1.4319e-01,  ...,  1.4844e-01,
            2.2388e-01, -1.3953e-01],
          ...,
          [-5.8447e-01, -6.7993e-02, -1.5344e-01,  ..., -9.4141e-01,
            8.2275e-02,  1.5601e-01],
          [ 2.8296e-01,  3.6230e-01, -3.2910e-01,  ..., -2.3267e-01,
            4.2871e-01, -2.5635e-02],
          [-1.6272e-01,  1.5723e-01, -3.7769e-01,  ...,  1.4722e-01,
            2.0044e-01, -1.8982e-01]],

         [[-1.7223e-03,  1.9592e-02, -2.0027e-03,  ..., -2.7714e-03,
            4.1313e-03, -1.1955e-02],
          [ 7.6256e-03, -2.0466e-03, -4.0894e-03,  ..., -1.5915e-02,
            1.4145e-02, -1.4687e-02],
          [-3.8719e-03, -5.3024e-03,  1.7365e-02,  ...,  2.4052e-03,
            9.4147e-03, -9.5673e-03],
          ...,
          [-5.9204e-03,  8.3313e-03,  3.8300e-03,  ..., -2.3163e-02,
           -1.0796e-03, -1.1833e-02],
          [ 1.9035e-03,  1.4496e-02, -2.7634e-02,  ...,  1.4526e-02,
            7.0114e-03, -1.2535e-02],
          [-9.6970e-03, -2.8114e-03, -7.0229e-03,  ...,  5.9795e-04,
            3.1877e-04,  3.8738e-03]],

         [[-3.6133e-01, -2.7856e-01, -1.8005e-01,  ..., -1.7685e-02,
            3.6475e-01, -2.3267e-01],
          [-1.6235e-01, -8.5205e-02, -1.2067e-01,  ...,  2.0374e-01,
            7.0508e-01, -2.1387e-01],
          [ 1.2366e-01,  6.2939e-01,  1.4319e-01,  ...,  1.4844e-01,
            2.2388e-01, -1.3953e-01],
          ...,
          [-5.8447e-01, -6.7993e-02, -1.5344e-01,  ..., -9.4141e-01,
            8.2275e-02,  1.5601e-01],
          [ 2.8296e-01,  3.6230e-01, -3.2910e-01,  ..., -2.3267e-01,
            4.2871e-01, -2.5635e-02],
          [-1.6272e-01,  1.5723e-01, -3.7769e-01,  ...,  1.4722e-01,
            2.0044e-01, -1.8982e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[-3.6133e-01, -2.7856e-01, -1.8005e-01,  ..., -1.7685e-02,
           3.6475e-01, -2.3267e-01],
         [-1.6235e-01, -8.5205e-02, -1.2067e-01,  ...,  2.0374e-01,
           7.0508e-01, -2.1387e-01],
         [ 1.2366e-01,  6.2939e-01,  1.4319e-01,  ...,  1.4844e-01,
           2.2388e-01, -1.3953e-01],
         ...,
         [-5.8447e-01, -6.7993e-02, -1.5344e-01,  ..., -9.4141e-01,
           8.2275e-02,  1.5601e-01],
         [ 2.8296e-01,  3.6230e-01, -3.2910e-01,  ..., -2.3267e-01,
           4.2871e-01, -2.5635e-02],
         [-1.6272e-01,  1.5723e-01, -3.7769e-01,  ...,  1.4722e-01,
           2.0044e-01, -1.8982e-01]],

        [[-3.6793e-03,  1.7975e-02, -2.9716e-03,  ..., -2.8534e-03,
           6.0959e-03, -1.3153e-02],
         [ 6.1493e-03, -2.7695e-03, -5.1041e-03,  ..., -1.4008e-02,
           2.0142e-02, -1.6418e-02],
         [ 8.0347e-05,  1.4366e-02,  2.1271e-02,  ...,  6.9313e-03,
           1.6068e-02, -1.3596e-02],
         ...,
         [-1.7410e-02,  6.8169e-03,  7.0858e-04,  ..., -4.1382e-02,
           5.7459e-04, -8.4991e-03],
         [ 1.0887e-02,  2.5620e-02, -3.7262e-02,  ...,  6.6261e-03,
           2.0493e-02, -1.2955e-02],
         [-1.5839e-02,  3.6106e-03, -2.1896e-02,  ...,  6.4812e-03,
           8.3466e-03, -3.8986e-03]],

        [[-3.6133e-01, -2.7856e-01, -1.8005e-01,  ..., -1.7685e-02,
           3.6475e-01, -2.3267e-01],
         [-1.6235e-01, -8.5205e-02, -1.2067e-01,  ...,  2.0374e-01,
           7.0508e-01, -2.1387e-01],
         [ 1.2366e-01,  6.2939e-01,  1.4319e-01,  ...,  1.4844e-01,
           2.2388e-01, -1.3953e-01],
         ...,
         [-5.8447e-01, -6.7993e-02, -1.5344e-01,  ..., -9.4141e-01,
           8.2275e-02,  1.5601e-01],
         [ 2.8296e-01,  3.6230e-01, -3.2910e-01,  ..., -2.3267e-01,
           4.2871e-01, -2.5635e-02],
         [-1.6272e-01,  1.5723e-01, -3.7769e-01,  ...,  1.4722e-01,
           2.0044e-01, -1.8982e-01]],

        [[-3.6793e-03,  1.7975e-02, -2.9716e-03,  ..., -2.8534e-03,
           6.0959e-03, -1.3153e-02],
         [ 6.1493e-03, -2.7695e-03, -5.1041e-03,  ..., -1.4008e-02,
           2.0142e-02, -1.6418e-02],
         [ 8.0347e-05,  1.4366e-02,  2.1271e-02,  ...,  6.9313e-03,
           1.6068e-02, -1.3596e-02],
         ...,
         [-1.7410e-02,  6.8169e-03,  7.0858e-04,  ..., -4.1382e-02,
           5.7459e-04, -8.4991e-03],
         [ 1.0887e-02,  2.5620e-02, -3.7262e-02,  ...,  6.6261e-03,
           2.0493e-02, -1.2955e-02],
         [-1.5839e-02,  3.6106e-03, -2.1896e-02,  ...,  6.4812e-03,
           8.3466e-03, -3.8986e-03]]], device='cuda:0', dtype=torch.float16)
reshape and cache tensor([[[ 0.0072,  0.1755,  0.3572,  ..., -0.0219, -0.1542, -0.2006],
         [ 1.4346, -1.1670,  0.0253,  ...,  0.6650, -0.2678,  1.1631],
         [-1.3262,  0.9355,  0.9727,  ...,  0.9170,  0.4060, -1.9775],
         ...,
         [ 1.0596, -0.7046,  0.6899,  ...,  0.5771, -1.3633,  0.2233],
         [-0.6860,  0.7598, -0.7007,  ...,  0.8535,  0.6831, -0.6006],
         [ 0.4490, -1.4590,  1.7695,  ..., -2.1680, -1.8564, -0.7671]],

        [[ 0.0759, -0.3223,  0.4177,  ...,  0.2457, -0.0298,  0.2209],
         [ 0.5596, -1.5410, -0.3225,  ..., -1.1523, -2.0195,  0.0471],
         [-0.0102, -0.0728,  1.6172,  ...,  0.0875,  0.1609, -0.0064],
         ...,
         [-0.0416, -0.0567, -0.9038,  ..., -0.5586,  0.2394, -0.3586],
         [ 1.7305,  0.5005, -0.5962,  ..., -0.2125, -0.1710, -0.6777],
         [ 0.1813, -0.3159, -0.7363,  ..., -0.5186, -0.5161,  0.6201]],

        [[ 0.0072,  0.1755,  0.3572,  ..., -0.0219, -0.1542, -0.2006],
         [ 1.4346, -1.1670,  0.0253,  ...,  0.6650, -0.2678,  1.1631],
         [-1.3262,  0.9355,  0.9727,  ...,  0.9170,  0.4060, -1.9775],
         ...,
         [ 1.0596, -0.7046,  0.6899,  ...,  0.5771, -1.3633,  0.2233],
         [-0.6860,  0.7598, -0.7007,  ...,  0.8535,  0.6831, -0.6006],
         [ 0.4490, -1.4590,  1.7695,  ..., -2.1680, -1.8564, -0.7671]],

        [[ 0.0759, -0.3223,  0.4177,  ...,  0.2457, -0.0298,  0.2209],
         [ 0.5596, -1.5410, -0.3225,  ..., -1.1523, -2.0195,  0.0471],
         [-0.0102, -0.0728,  1.6172,  ...,  0.0875,  0.1609, -0.0064],
         ...,
         [-0.0416, -0.0567, -0.9038,  ..., -0.5586,  0.2394, -0.3586],
         [ 1.7305,  0.5005, -0.5962,  ..., -0.2125, -0.1710, -0.6777],
         [ 0.1813, -0.3159, -0.7363,  ..., -0.5186, -0.5161,  0.6201]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584352, 584353], device='cuda:0')
num_prefill_tokens 4
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[-0.6577, -0.1907, -0.5850,  ...,  1.2451,  0.6416, -0.4211],
          [-3.0273,  2.1211, -0.0596,  ..., -1.5557,  0.6211, -1.6465],
          [ 3.0176,  0.5205,  1.0459,  ..., -1.6133, -1.9492,  0.3289],
          ...,
          [-0.7007,  1.7158, -0.5757,  ..., -1.8418,  1.8809, -0.5894],
          [ 1.3994, -0.5557,  1.3379,  ...,  0.6416, -1.5166,  1.1641],
          [-1.4102,  2.0059, -3.1523,  ...,  1.5488,  2.8516,  0.2247]],

         [[ 1.2178,  0.1467,  0.0667,  ...,  0.3093,  0.1490, -0.4846],
          [ 2.8066, -1.9668, -0.3506,  ..., -0.3901, -0.4622,  0.9219],
          [-0.7095,  2.5039,  1.7939,  ...,  0.6523,  0.7236, -2.3105],
          ...,
          [-0.0196, -0.2712,  0.3748,  ...,  0.2489, -0.4421, -0.6060],
          [-2.1953, -0.7720, -2.2148,  ...,  0.4468,  1.3086, -2.2031],
          [ 0.1772, -1.8076,  0.6797,  ..., -1.1670, -2.9102, -2.7559]],

         [[-0.6577, -0.1907, -0.5850,  ...,  1.2451,  0.6416, -0.4211],
          [-3.0273,  2.1211, -0.0596,  ..., -1.5557,  0.6211, -1.6465],
          [ 3.0176,  0.5205,  1.0459,  ..., -1.6133, -1.9492,  0.3289],
          ...,
          [-0.7007,  1.7158, -0.5757,  ..., -1.8418,  1.8809, -0.5894],
          [ 1.3994, -0.5557,  1.3379,  ...,  0.6416, -1.5166,  1.1641],
          [-1.4102,  2.0059, -3.1523,  ...,  1.5488,  2.8516,  0.2247]],

         [[ 1.2178,  0.1467,  0.0667,  ...,  0.3093,  0.1490, -0.4846],
          [ 2.8066, -1.9668, -0.3506,  ..., -0.3901, -0.4622,  0.9219],
          [-0.7095,  2.5039,  1.7939,  ...,  0.6523,  0.7236, -2.3105],
          ...,
          [-0.0196, -0.2712,  0.3748,  ...,  0.2489, -0.4421, -0.6060],
          [-2.1953, -0.7720, -2.2148,  ...,  0.4468,  1.3086, -2.2031],
          [ 0.1772, -1.8076,  0.6797,  ..., -1.1670, -2.9102, -2.7559]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[ 0.0072,  0.1755,  0.3572,  ..., -0.0219, -0.1542, -0.2006],
          [ 1.4346, -1.1670,  0.0253,  ...,  0.6650, -0.2678,  1.1631],
          [-1.3262,  0.9355,  0.9727,  ...,  0.9170,  0.4060, -1.9775],
          ...,
          [ 1.0596, -0.7046,  0.6899,  ...,  0.5771, -1.3633,  0.2233],
          [-0.6860,  0.7598, -0.7007,  ...,  0.8535,  0.6831, -0.6006],
          [ 0.4490, -1.4590,  1.7695,  ..., -2.1680, -1.8564, -0.7671]],

         [[ 0.0759, -0.3223,  0.4177,  ...,  0.2457, -0.0298,  0.2209],
          [ 0.5596, -1.5410, -0.3225,  ..., -1.1523, -2.0195,  0.0471],
          [-0.0102, -0.0728,  1.6172,  ...,  0.0875,  0.1609, -0.0064],
          ...,
          [-0.0416, -0.0567, -0.9038,  ..., -0.5586,  0.2394, -0.3586],
          [ 1.7305,  0.5005, -0.5962,  ..., -0.2125, -0.1710, -0.6777],
          [ 0.1813, -0.3159, -0.7363,  ..., -0.5186, -0.5161,  0.6201]],

         [[ 0.0072,  0.1755,  0.3572,  ..., -0.0219, -0.1542, -0.2006],
          [ 1.4346, -1.1670,  0.0253,  ...,  0.6650, -0.2678,  1.1631],
          [-1.3262,  0.9355,  0.9727,  ...,  0.9170,  0.4060, -1.9775],
          ...,
          [ 1.0596, -0.7046,  0.6899,  ...,  0.5771, -1.3633,  0.2233],
          [-0.6860,  0.7598, -0.7007,  ...,  0.8535,  0.6831, -0.6006],
          [ 0.4490, -1.4590,  1.7695,  ..., -2.1680, -1.8564, -0.7671]],

         [[ 0.0759, -0.3223,  0.4177,  ...,  0.2457, -0.0298,  0.2209],
          [ 0.5596, -1.5410, -0.3225,  ..., -1.1523, -2.0195,  0.0471],
          [-0.0102, -0.0728,  1.6172,  ...,  0.0875,  0.1609, -0.0064],
          ...,
          [-0.0416, -0.0567, -0.9038,  ..., -0.5586,  0.2394, -0.3586],
          [ 1.7305,  0.5005, -0.5962,  ..., -0.2125, -0.1710, -0.6777],
          [ 0.1813, -0.3159, -0.7363,  ..., -0.5186, -0.5161,  0.6201]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[-3.0060e-03,  1.1093e-02, -4.9973e-03,  ..., -3.2043e-03,
           -1.0330e-02,  2.2049e-02],
          [-5.8250e-03,  7.7744e-03, -4.3793e-03,  ...,  6.2714e-03,
            1.8845e-02, -7.2136e-03],
          [-8.9493e-03, -8.1863e-03,  6.0272e-03,  ...,  5.2681e-03,
            3.3808e-04,  2.0714e-03],
          ...,
          [-8.8730e-03, -9.4528e-03,  9.1934e-03,  ...,  3.3035e-03,
           -1.0628e-02, -1.3275e-02],
          [ 1.7786e-03,  5.6305e-03, -8.5068e-03,  ...,  6.8016e-03,
           -9.3460e-03,  6.9666e-04],
          [-3.6182e-03,  5.7220e-03, -3.7537e-03,  ...,  8.9874e-03,
           -3.7727e-03,  4.6253e-05]],

         [[ 2.6050e-01, -7.8011e-03, -3.2666e-01,  ..., -1.5149e-01,
           -1.0938e-01,  1.7957e-01],
          [ 5.0018e-02, -3.0859e-01,  4.5874e-01,  ..., -1.4880e-01,
            4.2627e-01, -2.8589e-01],
          [-3.3472e-01,  4.4141e-01, -8.7463e-02,  ...,  1.3721e-01,
            5.0586e-01,  3.2861e-01],
          ...,
          [-8.5876e-02, -7.6355e-02,  5.1483e-02,  ...,  3.5303e-01,
            2.3975e-01, -4.4849e-01],
          [ 2.8174e-01,  4.0161e-01, -4.7144e-01,  ...,  2.3291e-01,
           -5.7324e-01,  5.2979e-01],
          [ 1.1642e-02, -1.2427e-01,  1.9153e-01,  ..., -1.5491e-01,
           -4.7168e-01,  2.8271e-01]],

         [[-3.0060e-03,  1.1093e-02, -4.9973e-03,  ..., -3.2043e-03,
           -1.0330e-02,  2.2049e-02],
          [-5.8250e-03,  7.7744e-03, -4.3793e-03,  ...,  6.2714e-03,
            1.8845e-02, -7.2136e-03],
          [-8.9493e-03, -8.1863e-03,  6.0272e-03,  ...,  5.2681e-03,
            3.3808e-04,  2.0714e-03],
          ...,
          [-8.8730e-03, -9.4528e-03,  9.1934e-03,  ...,  3.3035e-03,
           -1.0628e-02, -1.3275e-02],
          [ 1.7786e-03,  5.6305e-03, -8.5068e-03,  ...,  6.8016e-03,
           -9.3460e-03,  6.9666e-04],
          [-3.6182e-03,  5.7220e-03, -3.7537e-03,  ...,  8.9874e-03,
           -3.7727e-03,  4.6253e-05]],

         [[ 2.6050e-01, -7.8011e-03, -3.2666e-01,  ..., -1.5149e-01,
           -1.0938e-01,  1.7957e-01],
          [ 5.0018e-02, -3.0859e-01,  4.5874e-01,  ..., -1.4880e-01,
            4.2627e-01, -2.8589e-01],
          [-3.3472e-01,  4.4141e-01, -8.7463e-02,  ...,  1.3721e-01,
            5.0586e-01,  3.2861e-01],
          ...,
          [-8.5876e-02, -7.6355e-02,  5.1483e-02,  ...,  3.5303e-01,
            2.3975e-01, -4.4849e-01],
          [ 2.8174e-01,  4.0161e-01, -4.7144e-01,  ...,  2.3291e-01,
           -5.7324e-01,  5.2979e-01],
          [ 1.1642e-02, -1.2427e-01,  1.9153e-01,  ..., -1.5491e-01,
           -4.7168e-01,  2.8271e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[ 0.2605, -0.0078, -0.3267,  ..., -0.1515, -0.1094,  0.1796],
         [ 0.0500, -0.3086,  0.4587,  ..., -0.1488,  0.4263, -0.2859],
         [-0.3347,  0.4414, -0.0875,  ...,  0.1372,  0.5059,  0.3286],
         ...,
         [-0.0859, -0.0764,  0.0515,  ...,  0.3530,  0.2397, -0.4485],
         [ 0.2817,  0.4016, -0.4714,  ...,  0.2329, -0.5732,  0.5298],
         [ 0.0116, -0.1243,  0.1915,  ..., -0.1549, -0.4717,  0.2827]],

        [[ 0.0041,  0.0106, -0.0137,  ..., -0.0072, -0.0130,  0.0263],
         [-0.0056,  0.0065, -0.0026,  ...,  0.0057,  0.0204, -0.0083],
         [-0.0103, -0.0063,  0.0056,  ...,  0.0058,  0.0025,  0.0035],
         ...,
         [-0.0091, -0.0097,  0.0093,  ...,  0.0045, -0.0098, -0.0147],
         [ 0.0047,  0.0098, -0.0134,  ...,  0.0092, -0.0153,  0.0063],
         [-0.0036,  0.0054, -0.0032,  ...,  0.0085, -0.0051,  0.0008]],

        [[ 0.2605, -0.0078, -0.3267,  ..., -0.1515, -0.1094,  0.1796],
         [ 0.0500, -0.3086,  0.4587,  ..., -0.1488,  0.4263, -0.2859],
         [-0.3347,  0.4414, -0.0875,  ...,  0.1372,  0.5059,  0.3286],
         ...,
         [-0.0859, -0.0764,  0.0515,  ...,  0.3530,  0.2397, -0.4485],
         [ 0.2817,  0.4016, -0.4714,  ...,  0.2329, -0.5732,  0.5298],
         [ 0.0116, -0.1243,  0.1915,  ..., -0.1549, -0.4717,  0.2827]],

        [[ 0.0041,  0.0106, -0.0137,  ..., -0.0072, -0.0130,  0.0263],
         [-0.0056,  0.0065, -0.0026,  ...,  0.0057,  0.0204, -0.0083],
         [-0.0103, -0.0063,  0.0056,  ...,  0.0058,  0.0025,  0.0035],
         ...,
         [-0.0091, -0.0097,  0.0093,  ...,  0.0045, -0.0098, -0.0147],
         [ 0.0047,  0.0098, -0.0134,  ...,  0.0092, -0.0153,  0.0063],
         [-0.0036,  0.0054, -0.0032,  ...,  0.0085, -0.0051,  0.0008]]],
       device='cuda:0', dtype=torch.float16)
reshape and cache tensor([[[-1.3008,  0.1956,  1.0996,  ..., -0.6812,  0.4363,  0.6670],
         [-0.0843, -0.2437, -0.2115,  ..., -0.0173, -1.1240,  1.1484],
         [-0.3962, -0.7969,  0.8955,  ...,  0.7397,  0.2092, -0.8608],
         ...,
         [ 0.4556,  0.2400,  0.9858,  ...,  0.9795, -0.5674, -1.0068],
         [-0.8447, -1.4834,  0.2406,  ..., -1.3174,  0.4124, -0.9243],
         [-0.6504,  1.8086,  0.2654,  ...,  0.4353,  0.5151, -0.6401]],

        [[ 0.4900, -2.3145, -3.1914,  ..., -0.3562, -2.9492, -0.5093],
         [-1.5752,  0.8359, -2.1660,  ..., -0.0877,  3.4277, -1.8760],
         [ 2.7930,  1.4600, -0.2457,  ..., -1.6338,  1.8652,  0.5366],
         ...,
         [-0.1151,  0.6890,  1.3877,  ..., -0.5581, -0.6313, -1.6328],
         [ 1.3857,  1.2832,  0.1718,  ...,  0.9312, -3.5293, -0.9282],
         [-1.0762, -0.5200, -0.8447,  ...,  0.4072,  1.1738, -1.2568]],

        [[-1.3008,  0.1956,  1.0996,  ..., -0.6812,  0.4363,  0.6670],
         [-0.0843, -0.2437, -0.2115,  ..., -0.0173, -1.1240,  1.1484],
         [-0.3962, -0.7969,  0.8955,  ...,  0.7397,  0.2092, -0.8608],
         ...,
         [ 0.4556,  0.2400,  0.9858,  ...,  0.9795, -0.5674, -1.0068],
         [-0.8447, -1.4834,  0.2406,  ..., -1.3174,  0.4124, -0.9243],
         [-0.6504,  1.8086,  0.2654,  ...,  0.4353,  0.5151, -0.6401]],

        [[ 0.4900, -2.3145, -3.1914,  ..., -0.3562, -2.9492, -0.5093],
         [-1.5752,  0.8359, -2.1660,  ..., -0.0877,  3.4277, -1.8760],
         [ 2.7930,  1.4600, -0.2457,  ..., -1.6338,  1.8652,  0.5366],
         ...,
         [-0.1151,  0.6890,  1.3877,  ..., -0.5581, -0.6313, -1.6328],
         [ 1.3857,  1.2832,  0.1718,  ...,  0.9312, -3.5293, -0.9282],
         [-1.0762, -0.5200, -0.8447,  ...,  0.4072,  1.1738, -1.2568]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584352, 584353], device='cuda:0')
num_prefill_tokens 4
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[ 2.1816, -1.5459, -1.8945,  ...,  0.8218, -1.3906, -2.0625],
          [-0.1981,  0.1087,  0.8970,  ..., -0.0600,  1.6133, -1.2129],
          [ 1.2178,  2.1621,  0.8296,  ...,  0.5098,  0.9370,  1.2129],
          ...,
          [-1.1836, -0.0300, -1.4219,  ..., -1.2471,  0.7627,  1.4619],
          [ 0.1539,  1.3799, -1.5547,  ...,  2.4785, -1.0635,  0.5742],
          [ 0.6099, -1.6846,  0.6631,  ..., -0.6943,  1.0352,  0.8706]],

         [[ 0.5000, -0.0989,  0.8999,  ..., -0.3059, -1.8867,  1.7109],
          [ 1.2715, -1.4971,  0.4883,  ..., -1.0664,  0.0245,  0.4814],
          [-0.2206, -1.4990,  0.3503,  ...,  1.6953,  0.4390, -1.1611],
          ...,
          [-0.0712,  0.3132,  0.4175,  ...,  1.0381, -2.4844, -1.2715],
          [-2.2031, -2.2051,  1.4912,  ..., -2.0684,  1.3584,  1.3057],
          [-3.2617,  2.5117, -0.1078,  ...,  2.0098,  0.5278, -1.3223]],

         [[ 2.1816, -1.5459, -1.8945,  ...,  0.8218, -1.3906, -2.0625],
          [-0.1981,  0.1087,  0.8970,  ..., -0.0600,  1.6133, -1.2129],
          [ 1.2178,  2.1621,  0.8296,  ...,  0.5098,  0.9370,  1.2129],
          ...,
          [-1.1836, -0.0300, -1.4219,  ..., -1.2471,  0.7627,  1.4619],
          [ 0.1539,  1.3799, -1.5547,  ...,  2.4785, -1.0635,  0.5742],
          [ 0.6099, -1.6846,  0.6631,  ..., -0.6943,  1.0352,  0.8706]],

         [[ 0.5000, -0.0989,  0.8999,  ..., -0.3059, -1.8867,  1.7109],
          [ 1.2715, -1.4971,  0.4883,  ..., -1.0664,  0.0245,  0.4814],
          [-0.2206, -1.4990,  0.3503,  ...,  1.6953,  0.4390, -1.1611],
          ...,
          [-0.0712,  0.3132,  0.4175,  ...,  1.0381, -2.4844, -1.2715],
          [-2.2031, -2.2051,  1.4912,  ..., -2.0684,  1.3584,  1.3057],
          [-3.2617,  2.5117, -0.1078,  ...,  2.0098,  0.5278, -1.3223]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[-1.3008,  0.1956,  1.0996,  ..., -0.6812,  0.4363,  0.6670],
          [-0.0843, -0.2437, -0.2115,  ..., -0.0173, -1.1240,  1.1484],
          [-0.3962, -0.7969,  0.8955,  ...,  0.7397,  0.2092, -0.8608],
          ...,
          [ 0.4556,  0.2400,  0.9858,  ...,  0.9795, -0.5674, -1.0068],
          [-0.8447, -1.4834,  0.2406,  ..., -1.3174,  0.4124, -0.9243],
          [-0.6504,  1.8086,  0.2654,  ...,  0.4353,  0.5151, -0.6401]],

         [[ 0.4900, -2.3145, -3.1914,  ..., -0.3562, -2.9492, -0.5093],
          [-1.5752,  0.8359, -2.1660,  ..., -0.0877,  3.4277, -1.8760],
          [ 2.7930,  1.4600, -0.2457,  ..., -1.6338,  1.8652,  0.5366],
          ...,
          [-0.1151,  0.6890,  1.3877,  ..., -0.5581, -0.6313, -1.6328],
          [ 1.3857,  1.2832,  0.1718,  ...,  0.9312, -3.5293, -0.9282],
          [-1.0762, -0.5200, -0.8447,  ...,  0.4072,  1.1738, -1.2568]],

         [[-1.3008,  0.1956,  1.0996,  ..., -0.6812,  0.4363,  0.6670],
          [-0.0843, -0.2437, -0.2115,  ..., -0.0173, -1.1240,  1.1484],
          [-0.3962, -0.7969,  0.8955,  ...,  0.7397,  0.2092, -0.8608],
          ...,
          [ 0.4556,  0.2400,  0.9858,  ...,  0.9795, -0.5674, -1.0068],
          [-0.8447, -1.4834,  0.2406,  ..., -1.3174,  0.4124, -0.9243],
          [-0.6504,  1.8086,  0.2654,  ...,  0.4353,  0.5151, -0.6401]],

         [[ 0.4900, -2.3145, -3.1914,  ..., -0.3562, -2.9492, -0.5093],
          [-1.5752,  0.8359, -2.1660,  ..., -0.0877,  3.4277, -1.8760],
          [ 2.7930,  1.4600, -0.2457,  ..., -1.6338,  1.8652,  0.5366],
          ...,
          [-0.1151,  0.6890,  1.3877,  ..., -0.5581, -0.6313, -1.6328],
          [ 1.3857,  1.2832,  0.1718,  ...,  0.9312, -3.5293, -0.9282],
          [-1.0762, -0.5200, -0.8447,  ...,  0.4072,  1.1738, -1.2568]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 1.1188e-04, -9.8724e-03, -9.4604e-03,  ..., -6.4087e-03,
           -4.1718e-02, -1.9348e-02],
          [-1.0042e-03, -3.3951e-03,  5.6267e-03,  ...,  1.1320e-03,
           -1.4984e-02,  1.1711e-03],
          [ 1.1093e-02, -3.6983e-03, -2.3666e-02,  ..., -1.6861e-02,
            7.2899e-03,  2.6413e-02],
          ...,
          [ 8.1406e-03, -3.6030e-03,  6.4850e-03,  ...,  1.5091e-02,
           -6.4545e-03, -1.0521e-02],
          [ 1.8372e-02, -8.2626e-03, -1.8646e-02,  ..., -2.5543e-02,
            4.4365e-03,  1.1587e-03],
          [ 1.0262e-02,  3.1708e-02,  3.9825e-03,  ..., -2.9678e-03,
           -1.9836e-02,  9.2850e-03]],

         [[ 4.1211e-01,  2.7588e-01, -2.7954e-01,  ..., -2.4866e-01,
           -1.3452e-01,  1.4966e-01],
          [ 3.5858e-03, -1.2317e-01, -9.3262e-02,  ..., -7.3438e-01,
            3.9209e-01, -1.5039e-01],
          [ 4.2822e-01, -3.7231e-01, -9.6484e-01,  ..., -1.2451e-01,
            2.1591e-02,  5.0391e-01],
          ...,
          [-1.3940e-01,  1.1578e-01,  4.8926e-01,  ...,  4.6362e-01,
            3.2324e-01,  1.6870e-01],
          [ 3.1738e-02, -5.3516e-01,  3.6182e-01,  ..., -1.6199e-01,
            1.1786e-01, -4.8755e-01],
          [ 1.1673e-02,  3.3691e-01, -1.6626e-01,  ...,  3.8666e-02,
           -4.0308e-01,  2.4365e-01]],

         [[ 1.1188e-04, -9.8724e-03, -9.4604e-03,  ..., -6.4087e-03,
           -4.1718e-02, -1.9348e-02],
          [-1.0042e-03, -3.3951e-03,  5.6267e-03,  ...,  1.1320e-03,
           -1.4984e-02,  1.1711e-03],
          [ 1.1093e-02, -3.6983e-03, -2.3666e-02,  ..., -1.6861e-02,
            7.2899e-03,  2.6413e-02],
          ...,
          [ 8.1406e-03, -3.6030e-03,  6.4850e-03,  ...,  1.5091e-02,
           -6.4545e-03, -1.0521e-02],
          [ 1.8372e-02, -8.2626e-03, -1.8646e-02,  ..., -2.5543e-02,
            4.4365e-03,  1.1587e-03],
          [ 1.0262e-02,  3.1708e-02,  3.9825e-03,  ..., -2.9678e-03,
           -1.9836e-02,  9.2850e-03]],

         [[ 4.1211e-01,  2.7588e-01, -2.7954e-01,  ..., -2.4866e-01,
           -1.3452e-01,  1.4966e-01],
          [ 3.5858e-03, -1.2317e-01, -9.3262e-02,  ..., -7.3438e-01,
            3.9209e-01, -1.5039e-01],
          [ 4.2822e-01, -3.7231e-01, -9.6484e-01,  ..., -1.2451e-01,
            2.1591e-02,  5.0391e-01],
          ...,
          [-1.3940e-01,  1.1578e-01,  4.8926e-01,  ...,  4.6362e-01,
            3.2324e-01,  1.6870e-01],
          [ 3.1738e-02, -5.3516e-01,  3.6182e-01,  ..., -1.6199e-01,
            1.1786e-01, -4.8755e-01],
          [ 1.1673e-02,  3.3691e-01, -1.6626e-01,  ...,  3.8666e-02,
           -4.0308e-01,  2.4365e-01]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output tensor([[[ 4.1211e-01,  2.7588e-01, -2.7954e-01,  ..., -2.4866e-01,
          -1.3452e-01,  1.4966e-01],
         [ 3.5858e-03, -1.2317e-01, -9.3262e-02,  ..., -7.3438e-01,
           3.9209e-01, -1.5039e-01],
         [ 4.2822e-01, -3.7231e-01, -9.6484e-01,  ..., -1.2451e-01,
           2.1591e-02,  5.0391e-01],
         ...,
         [-1.3940e-01,  1.1578e-01,  4.8926e-01,  ...,  4.6362e-01,
           3.2324e-01,  1.6870e-01],
         [ 3.1738e-02, -5.3516e-01,  3.6182e-01,  ..., -1.6199e-01,
           1.1786e-01, -4.8755e-01],
         [ 1.1673e-02,  3.3691e-01, -1.6626e-01,  ...,  3.8666e-02,
          -4.0308e-01,  2.4365e-01]],

        [[ 1.0498e-02, -2.6684e-03, -1.6266e-02,  ..., -1.2520e-02,
          -4.4067e-02, -1.5091e-02],
         [-9.8324e-04, -3.9330e-03,  5.1804e-03,  ..., -2.1744e-03,
          -1.3153e-02,  4.8971e-04],
         [ 1.3519e-02, -5.8441e-03, -2.9144e-02,  ..., -1.7487e-02,
           7.3738e-03,  2.9190e-02],
         ...,
         [ 5.5199e-03, -1.4830e-03,  1.5060e-02,  ...,  2.3056e-02,
          -5.9891e-04, -7.3395e-03],
         [ 1.8951e-02, -3.1403e-02, -1.9398e-03,  ..., -3.1525e-02,
           9.4147e-03, -2.0294e-02],
         [ 1.0445e-02,  7.1045e-02, -1.7960e-02,  ...,  2.3975e-03,
          -6.9214e-02,  3.9490e-02]],

        [[ 4.1211e-01,  2.7588e-01, -2.7954e-01,  ..., -2.4866e-01,
          -1.3452e-01,  1.4966e-01],
         [ 3.5858e-03, -1.2317e-01, -9.3262e-02,  ..., -7.3438e-01,
           3.9209e-01, -1.5039e-01],
         [ 4.2822e-01, -3.7231e-01, -9.6484e-01,  ..., -1.2451e-01,
           2.1591e-02,  5.0391e-01],
         ...,
         [-1.3940e-01,  1.1578e-01,  4.8926e-01,  ...,  4.6362e-01,
           3.2324e-01,  1.6870e-01],
         [ 3.1738e-02, -5.3516e-01,  3.6182e-01,  ..., -1.6199e-01,
           1.1786e-01, -4.8755e-01],
         [ 1.1673e-02,  3.3691e-01, -1.6626e-01,  ...,  3.8666e-02,
          -4.0308e-01,  2.4365e-01]],

        [[ 1.0498e-02, -2.6684e-03, -1.6266e-02,  ..., -1.2520e-02,
          -4.4067e-02, -1.5091e-02],
         [-9.8324e-04, -3.9330e-03,  5.1804e-03,  ..., -2.1744e-03,
          -1.3153e-02,  4.8971e-04],
         [ 1.3519e-02, -5.8441e-03, -2.9144e-02,  ..., -1.7487e-02,
           7.3738e-03,  2.9190e-02],
         ...,
         [ 5.5199e-03, -1.4830e-03,  1.5060e-02,  ...,  2.3056e-02,
          -5.9891e-04, -7.3395e-03],
         [ 1.8951e-02, -3.1403e-02, -1.9398e-03,  ..., -3.1525e-02,
           9.4147e-03, -2.0294e-02],
         [ 1.0445e-02,  7.1045e-02, -1.7960e-02,  ...,  2.3975e-03,
          -6.9214e-02,  3.9490e-02]]], device='cuda:0', dtype=torch.float16)
reshape and cache tensor([[[ 1.3467e+00,  1.0801e+00,  8.1445e-01,  ...,  5.7129e-01,
          -3.8745e-01, -3.4285e-04],
         [ 4.4727e-01,  5.1611e-01, -1.5762e+00,  ..., -1.4990e+00,
          -1.7932e-01, -1.5547e+00],
         [ 3.9844e-01,  1.7266e+00, -1.3896e+00,  ..., -2.3281e+00,
          -9.9902e-01,  4.3823e-01],
         ...,
         [ 1.6982e+00,  6.9434e-01,  6.5576e-01,  ..., -3.1104e-01,
           1.7899e-02,  4.6289e-01],
         [ 5.0488e-01, -5.9570e-01, -1.3115e+00,  ...,  6.5234e-01,
           8.1055e-01,  4.2212e-01],
         [-9.3604e-01,  6.2207e-01,  5.1123e-01,  ...,  1.0811e+00,
           5.1514e-01, -2.3865e-01]],

        [[ 2.5806e-01, -7.0703e-01, -1.9678e-01,  ...,  1.7910e+00,
          -1.8965e+00, -7.4646e-02],
         [ 3.3398e+00, -2.2241e-01, -7.0374e-02,  ...,  2.7793e+00,
           1.6406e+00, -5.8594e-01],
         [ 7.2461e-01,  1.6523e+00,  6.8506e-01,  ..., -2.9712e-01,
           1.1484e+00,  1.6191e+00],
         ...,
         [ 1.6357e+00,  1.7266e+00, -7.4365e-01,  ...,  5.7520e-01,
          -4.5435e-01,  1.3594e+00],
         [ 5.3329e-03,  1.1621e+00,  1.8298e-01,  ..., -8.6365e-02,
           3.1738e+00, -6.4990e-01],
         [ 1.0577e-01,  1.2129e+00, -1.1006e+00,  ...,  1.3086e+00,
          -9.2529e-01,  3.8727e-02]],

        [[ 1.3467e+00,  1.0801e+00,  8.1445e-01,  ...,  5.7129e-01,
          -3.8745e-01, -3.4285e-04],
         [ 4.4727e-01,  5.1611e-01, -1.5762e+00,  ..., -1.4990e+00,
          -1.7932e-01, -1.5547e+00],
         [ 3.9844e-01,  1.7266e+00, -1.3896e+00,  ..., -2.3281e+00,
          -9.9902e-01,  4.3823e-01],
         ...,
         [ 1.6982e+00,  6.9434e-01,  6.5576e-01,  ..., -3.1104e-01,
           1.7899e-02,  4.6289e-01],
         [ 5.0488e-01, -5.9570e-01, -1.3115e+00,  ...,  6.5234e-01,
           8.1055e-01,  4.2212e-01],
         [-9.3604e-01,  6.2207e-01,  5.1123e-01,  ...,  1.0811e+00,
           5.1514e-01, -2.3865e-01]],

        [[ 2.5806e-01, -7.0703e-01, -1.9678e-01,  ...,  1.7910e+00,
          -1.8965e+00, -7.4646e-02],
         [ 3.3398e+00, -2.2241e-01, -7.0374e-02,  ...,  2.7793e+00,
           1.6406e+00, -5.8594e-01],
         [ 7.2461e-01,  1.6523e+00,  6.8506e-01,  ..., -2.9712e-01,
           1.1484e+00,  1.6191e+00],
         ...,
         [ 1.6357e+00,  1.7266e+00, -7.4365e-01,  ...,  5.7520e-01,
          -4.5435e-01,  1.3594e+00],
         [ 5.3329e-03,  1.1621e+00,  1.8298e-01,  ..., -8.6365e-02,
           3.1738e+00, -6.4990e-01],
         [ 1.0577e-01,  1.2129e+00, -1.1006e+00,  ...,  1.3086e+00,
          -9.2529e-01,  3.8727e-02]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584352, 584353], device='cuda:0')
num_prefill_tokens 4
num_decode_tokens 0
!!!!!!!!!!!!!!!!!!!!! query tensor([[[[ 1.1514,  0.3228, -1.8174,  ...,  1.1621,  1.1387, -0.6460],
          [ 3.1641, -0.4146,  0.1572,  ...,  2.0410,  0.1108,  1.0557],
          [ 0.4709, -0.3044, -1.6670,  ...,  0.6724,  2.1094, -0.5249],
          ...,
          [-0.0613,  0.8379, -0.5942,  ...,  2.0410,  0.3274,  2.3145],
          [-1.5234,  0.2377,  1.9414,  ..., -1.2275, -0.0482,  0.9351],
          [-0.1437, -0.2162, -0.8901,  ...,  0.3125, -0.5581, -2.0527]],

         [[ 1.9170, -0.5752, -0.0723,  ..., -0.4619,  0.8271, -0.1384],
          [ 0.5791,  1.0088, -0.4604,  ..., -0.9727,  0.1753, -2.5488],
          [-0.4106,  1.7070,  1.0479,  ..., -2.3105, -2.4375,  0.7354],
          ...,
          [ 2.0664, -0.6113,  1.6250,  ..., -1.4658,  0.6494, -0.0678],
          [ 2.1855, -0.6943, -2.7109,  ...,  0.8496,  2.6133, -0.7119],
          [-1.9248,  0.4583,  0.6260,  ...,  0.5449,  0.2448,  0.6880]],

         [[ 1.1514,  0.3228, -1.8174,  ...,  1.1621,  1.1387, -0.6460],
          [ 3.1641, -0.4146,  0.1572,  ...,  2.0410,  0.1108,  1.0557],
          [ 0.4709, -0.3044, -1.6670,  ...,  0.6724,  2.1094, -0.5249],
          ...,
          [-0.0613,  0.8379, -0.5942,  ...,  2.0410,  0.3274,  2.3145],
          [-1.5234,  0.2377,  1.9414,  ..., -1.2275, -0.0482,  0.9351],
          [-0.1437, -0.2162, -0.8901,  ...,  0.3125, -0.5581, -2.0527]],

         [[ 1.9170, -0.5752, -0.0723,  ..., -0.4619,  0.8271, -0.1384],
          [ 0.5791,  1.0088, -0.4604,  ..., -0.9727,  0.1753, -2.5488],
          [-0.4106,  1.7070,  1.0479,  ..., -2.3105, -2.4375,  0.7354],
          ...,
          [ 2.0664, -0.6113,  1.6250,  ..., -1.4658,  0.6494, -0.0678],
          [ 2.1855, -0.6943, -2.7109,  ...,  0.8496,  2.6133, -0.7119],
          [-1.9248,  0.4583,  0.6260,  ...,  0.5449,  0.2448,  0.6880]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! key tensor([[[[ 1.3467e+00,  1.0801e+00,  8.1445e-01,  ...,  5.7129e-01,
           -3.8745e-01, -3.4285e-04],
          [ 4.4727e-01,  5.1611e-01, -1.5762e+00,  ..., -1.4990e+00,
           -1.7932e-01, -1.5547e+00],
          [ 3.9844e-01,  1.7266e+00, -1.3896e+00,  ..., -2.3281e+00,
           -9.9902e-01,  4.3823e-01],
          ...,
          [ 1.6982e+00,  6.9434e-01,  6.5576e-01,  ..., -3.1104e-01,
            1.7899e-02,  4.6289e-01],
          [ 5.0488e-01, -5.9570e-01, -1.3115e+00,  ...,  6.5234e-01,
            8.1055e-01,  4.2212e-01],
          [-9.3604e-01,  6.2207e-01,  5.1123e-01,  ...,  1.0811e+00,
            5.1514e-01, -2.3865e-01]],

         [[ 2.5806e-01, -7.0703e-01, -1.9678e-01,  ...,  1.7910e+00,
           -1.8965e+00, -7.4646e-02],
          [ 3.3398e+00, -2.2241e-01, -7.0374e-02,  ...,  2.7793e+00,
            1.6406e+00, -5.8594e-01],
          [ 7.2461e-01,  1.6523e+00,  6.8506e-01,  ..., -2.9712e-01,
            1.1484e+00,  1.6191e+00],
          ...,
          [ 1.6357e+00,  1.7266e+00, -7.4365e-01,  ...,  5.7520e-01,
           -4.5435e-01,  1.3594e+00],
          [ 5.3329e-03,  1.1621e+00,  1.8298e-01,  ..., -8.6365e-02,
            3.1738e+00, -6.4990e-01],
          [ 1.0577e-01,  1.2129e+00, -1.1006e+00,  ...,  1.3086e+00,
           -9.2529e-01,  3.8727e-02]],

         [[ 1.3467e+00,  1.0801e+00,  8.1445e-01,  ...,  5.7129e-01,
           -3.8745e-01, -3.4285e-04],
          [ 4.4727e-01,  5.1611e-01, -1.5762e+00,  ..., -1.4990e+00,
           -1.7932e-01, -1.5547e+00],
          [ 3.9844e-01,  1.7266e+00, -1.3896e+00,  ..., -2.3281e+00,
           -9.9902e-01,  4.3823e-01],
          ...,
          [ 1.6982e+00,  6.9434e-01,  6.5576e-01,  ..., -3.1104e-01,
            1.7899e-02,  4.6289e-01],
          [ 5.0488e-01, -5.9570e-01, -1.3115e+00,  ...,  6.5234e-01,
            8.1055e-01,  4.2212e-01],
          [-9.3604e-01,  6.2207e-01,  5.1123e-01,  ...,  1.0811e+00,
            5.1514e-01, -2.3865e-01]],

         [[ 2.5806e-01, -7.0703e-01, -1.9678e-01,  ...,  1.7910e+00,
           -1.8965e+00, -7.4646e-02],
          [ 3.3398e+00, -2.2241e-01, -7.0374e-02,  ...,  2.7793e+00,
            1.6406e+00, -5.8594e-01],
          [ 7.2461e-01,  1.6523e+00,  6.8506e-01,  ..., -2.9712e-01,
            1.1484e+00,  1.6191e+00],
          ...,
          [ 1.6357e+00,  1.7266e+00, -7.4365e-01,  ...,  5.7520e-01,
           -4.5435e-01,  1.3594e+00],
          [ 5.3329e-03,  1.1621e+00,  1.8298e-01,  ..., -8.6365e-02,
            3.1738e+00, -6.4990e-01],
          [ 1.0577e-01,  1.2129e+00, -1.1006e+00,  ...,  1.3086e+00,
           -9.2529e-01,  3.8727e-02]]]], device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! value tensor([[[[ 0.0136, -0.0030, -0.0053,  ...,  0.0181,  0.0089, -0.0122],
          [ 0.0037,  0.0012, -0.0257,  ..., -0.0329, -0.0117, -0.0061],
          [-0.0122,  0.0144,  0.0129,  ...,  0.0120, -0.0371,  0.0301],
          ...,
          [ 0.0013,  0.0055,  0.0172,  ...,  0.0062, -0.0067, -0.0125],
          [ 0.0049, -0.0231, -0.0101,  ..., -0.0284,  0.0217, -0.0203],
          [-0.0200,  0.0073,  0.0065,  ...,  0.0260, -0.0043, -0.0410]],

         [[-0.1414,  0.3235, -0.1862,  ...,  0.1230,  0.2433,  0.2529],
          [-0.5366,  0.7871, -0.5195,  ..., -0.4304, -0.1520, -0.4517],
          [ 0.0168,  0.3848, -0.0062,  ..., -0.0684, -0.0270, -0.2202],
          ...,
          [ 0.1750,  0.1097,  0.1581,  ..., -0.7358, -0.0937, -0.0343],
          [ 0.3965, -0.0490, -0.2223,  ..., -0.1260, -0.0233, -0.3201],
          [ 0.4216, -0.1588,  0.3574,  ..., -0.1337,  0.4263,  1.0078]],

         [[ 0.0136, -0.0030, -0.0053,  ...,  0.0181,  0.0089, -0.0122],
          [ 0.0037,  0.0012, -0.0257,  ..., -0.0329, -0.0117, -0.0061],
          [-0.0122,  0.0144,  0.0129,  ...,  0.0120, -0.0371,  0.0301],
          ...,
          [ 0.0013,  0.0055,  0.0172,  ...,  0.0062, -0.0067, -0.0125],
          [ 0.0049, -0.0231, -0.0101,  ..., -0.0284,  0.0217, -0.0203],
          [-0.0200,  0.0073,  0.0065,  ...,  0.0260, -0.0043, -0.0410]],

         [[-0.1414,  0.3235, -0.1862,  ...,  0.1230,  0.2433,  0.2529],
          [-0.5366,  0.7871, -0.5195,  ..., -0.4304, -0.1520, -0.4517],
          [ 0.0168,  0.3848, -0.0062,  ..., -0.0684, -0.0270, -0.2202],
          ...,
          [ 0.1750,  0.1097,  0.1581,  ..., -0.7358, -0.0937, -0.0343],
          [ 0.3965, -0.0490, -0.2223,  ..., -0.1260, -0.0233, -0.3201],
          [ 0.4216, -0.1588,  0.3574,  ..., -0.1337,  0.4263,  1.0078]]]],
       device='cuda:0', dtype=torch.float16)
!!!!!!!!!!!!!!!!!!!!! output seq_id 0 generation_tokens [2, 3592, 6]
seq_id 1 generation_tokens [2, 3592, 6]
reshape and cache tensor([[[ 1.2490, -0.6074,  1.6533,  ...,  1.0781,  0.1641,  0.5864],
         [-0.1107,  1.6562,  0.9907,  ...,  0.2576,  0.4729, -0.3135],
         [-0.4695, -0.5835,  0.9097,  ..., -0.1359, -1.4346, -2.1836],
         ...,
         [ 1.1484,  0.5938, -0.2031,  ...,  1.1279, -0.9639, -0.3901],
         [-0.3562, -0.0911, -1.0508,  ..., -0.4099,  0.7515,  0.2812],
         [ 1.1504,  0.3208, -0.6401,  ..., -0.4910,  0.7871,  0.8521]],

        [[ 1.9961, -1.4277,  1.0459,  ...,  0.9521,  0.2734,  0.6821],
         [-2.3359,  0.1725,  0.5815,  ...,  1.3428, -0.1888,  0.5205],
         [-1.0322,  0.1895, -0.0627,  ...,  0.3230, -1.8330, -2.5020],
         ...,
         [-0.5664, -0.7373, -0.2908,  ...,  1.4463, -1.6113, -1.0098],
         [-1.7217, -0.7700, -1.2480,  ...,  0.3464, -0.5073, -0.3938],
         [-1.2090,  0.6284, -0.2764,  ..., -0.3174, -1.3506,  1.2998]],

        [[ 1.0303, -1.2637,  1.2246,  ...,  1.3184,  0.3813,  0.4885],
         [-0.4868, -0.8901,  0.1081,  ...,  0.4517, -0.6978, -0.3389],
         [-1.3467, -0.2759,  0.5293,  ..., -0.7568, -1.6387, -2.8613],
         ...,
         [-1.3076,  0.3958,  0.0648,  ...,  0.7837, -2.0508, -0.6279],
         [-1.9316, -0.6055, -0.7798,  ...,  0.3135,  1.0625, -0.3030],
         [-1.2188, -0.0958,  0.2793,  ...,  0.0264,  0.6553,  0.0735]],

        [[ 1.2490, -0.6074,  1.6533,  ...,  1.0781,  0.1641,  0.5864],
         [-0.1107,  1.6562,  0.9907,  ...,  0.2576,  0.4729, -0.3135],
         [-0.4695, -0.5835,  0.9097,  ..., -0.1359, -1.4346, -2.1836],
         ...,
         [ 1.1484,  0.5938, -0.2031,  ...,  1.1279, -0.9639, -0.3901],
         [-0.3562, -0.0911, -1.0508,  ..., -0.4099,  0.7515,  0.2812],
         [ 1.1504,  0.3208, -0.6401,  ..., -0.4910,  0.7871,  0.8521]],

        [[ 1.9961, -1.4277,  1.0459,  ...,  0.9521,  0.2734,  0.6821],
         [-2.3359,  0.1725,  0.5815,  ...,  1.3428, -0.1888,  0.5205],
         [-1.0322,  0.1895, -0.0627,  ...,  0.3230, -1.8330, -2.5020],
         ...,
         [-0.5664, -0.7373, -0.2908,  ...,  1.4463, -1.6113, -1.0098],
         [-1.7217, -0.7700, -1.2480,  ...,  0.3464, -0.5073, -0.3938],
         [-1.2090,  0.6284, -0.2764,  ..., -0.3174, -1.3506,  1.2998]],

        [[ 1.0303, -1.2637,  1.2246,  ...,  1.3184,  0.3813,  0.4885],
         [-0.4868, -0.8901,  0.1081,  ...,  0.4517, -0.6978, -0.3389],
         [-1.3467, -0.2759,  0.5293,  ..., -0.7568, -1.6387, -2.8613],
         ...,
         [-1.3076,  0.3958,  0.0648,  ...,  0.7837, -2.0508, -0.6279],
         [-1.9316, -0.6055, -0.7798,  ...,  0.3135,  1.0625, -0.3030],
         [-1.2188, -0.0958,  0.2793,  ...,  0.0264,  0.6553,  0.0735]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584370, 584352, 584353, 584354], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[ 1.0156,  0.3433, -0.8545,  ..., -0.3035, -0.1346,  0.2539],
         [ 0.7534,  1.4941, -0.4443,  ...,  1.0537,  0.4326, -0.4329],
         [-0.0887,  0.5547,  0.5430,  ...,  0.1147, -1.5146,  1.4814],
         ...,
         [ 1.9414, -0.0582, -0.7222,  ...,  0.7715,  1.8115,  1.2109],
         [ 0.7886,  0.3413, -1.8018,  ..., -1.3457, -1.3770,  1.1230],
         [-1.0508,  2.0918, -1.3965,  ...,  2.1973,  1.1172, -0.6069]],

        [[ 1.6465,  0.2976,  0.1482,  ..., -1.3516,  0.2886, -1.9248],
         [ 0.1421, -0.4900,  1.0586,  ...,  1.0078, -1.0488,  1.0537],
         [ 2.1035, -0.3777,  1.4561,  ..., -0.7554, -0.2632, -0.8457],
         ...,
         [ 0.9731, -2.4961, -2.2598,  ..., -0.1707, -1.4629, -0.1469],
         [-1.8086, -1.3838, -0.1489,  ...,  2.1602, -0.3486, -0.5166],
         [ 1.4775,  0.4800,  0.2208,  ..., -0.6816,  0.4607, -1.0498]],

        [[-1.5605, -1.6094,  0.0929,  ..., -0.5625,  0.6235, -2.1992],
         [ 0.3425, -5.8711,  0.8447,  ..., -3.2402, -0.8301,  0.8291],
         [ 1.2734, -1.5352,  0.3242,  ..., -0.9077, -0.0327, -0.7114],
         ...,
         [ 0.9517, -1.6279, -1.5850,  ..., -1.1748, -0.3411,  1.0420],
         [-1.8164, -3.0918,  0.6841,  ...,  1.9521, -0.7036,  0.4607],
         [ 1.5977,  0.8081, -1.5605,  ...,  0.3823,  0.3296, -1.2012]],

        [[ 1.0156,  0.3433, -0.8545,  ..., -0.3035, -0.1346,  0.2539],
         [ 0.7534,  1.4941, -0.4443,  ...,  1.0537,  0.4326, -0.4329],
         [-0.0887,  0.5547,  0.5430,  ...,  0.1147, -1.5146,  1.4814],
         ...,
         [ 1.9414, -0.0582, -0.7222,  ...,  0.7715,  1.8115,  1.2109],
         [ 0.7886,  0.3413, -1.8018,  ..., -1.3457, -1.3770,  1.1230],
         [-1.0508,  2.0918, -1.3965,  ...,  2.1973,  1.1172, -0.6069]],

        [[ 1.6465,  0.2976,  0.1482,  ..., -1.3516,  0.2886, -1.9248],
         [ 0.1421, -0.4900,  1.0586,  ...,  1.0078, -1.0488,  1.0537],
         [ 2.1035, -0.3777,  1.4561,  ..., -0.7554, -0.2632, -0.8457],
         ...,
         [ 0.9731, -2.4961, -2.2598,  ..., -0.1707, -1.4629, -0.1469],
         [-1.8086, -1.3838, -0.1489,  ...,  2.1602, -0.3486, -0.5166],
         [ 1.4775,  0.4800,  0.2208,  ..., -0.6816,  0.4607, -1.0498]],

        [[-1.5605, -1.6094,  0.0929,  ..., -0.5625,  0.6235, -2.1992],
         [ 0.3425, -5.8711,  0.8447,  ..., -3.2402, -0.8301,  0.8291],
         [ 1.2734, -1.5352,  0.3242,  ..., -0.9077, -0.0327, -0.7114],
         ...,
         [ 0.9517, -1.6279, -1.5850,  ..., -1.1748, -0.3411,  1.0420],
         [-1.8164, -3.0918,  0.6841,  ...,  1.9521, -0.7036,  0.4607],
         [ 1.5977,  0.8081, -1.5605,  ...,  0.3823,  0.3296, -1.2012]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584370, 584352, 584353, 584354], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-7.2559e-01, -8.3252e-01, -1.4219e+00,  ..., -5.0635e-01,
          -6.4795e-01,  2.6611e-01],
         [ 1.4395e+00, -1.3877e+00, -4.9683e-01,  ..., -1.1729e+00,
           4.2090e-01, -1.3984e+00],
         [-1.1221e+00, -2.6709e-01, -9.5703e-01,  ...,  5.6055e-01,
          -3.0542e-01,  2.8540e-01],
         ...,
         [ 4.1650e-01, -1.9666e-01, -4.6631e-01,  ..., -3.1445e-01,
           9.6069e-02,  1.7407e-01],
         [-6.0059e-02, -4.0558e-02, -2.5681e-02,  ..., -6.8237e-02,
           5.7959e-01,  4.7791e-02],
         [-3.1519e-01,  3.7598e-01, -9.0137e-01,  ..., -7.7490e-01,
          -6.0693e-01,  5.2734e-01]],

        [[ 1.2568e+00,  2.2441e+00,  3.2031e+00,  ...,  1.3291e+00,
           1.9502e+00,  1.2000e-01],
         [-9.0576e-01,  6.0645e-01,  2.2754e-01,  ..., -2.2778e-01,
           1.2148e+00,  1.3730e+00],
         [ 8.3789e-01, -1.0703e+00,  6.0693e-01,  ..., -7.9834e-01,
           8.9062e-01,  2.1992e+00],
         ...,
         [-2.7808e-01,  1.4424e+00,  3.9478e-01,  ...,  1.2900e+00,
           1.1328e-01,  1.1420e-01],
         [-3.5034e-01,  1.2676e+00,  1.7188e-01,  ...,  2.7148e-01,
          -3.2559e+00,  6.6772e-02],
         [-5.4297e-01, -3.2056e-01, -1.7705e+00,  ...,  1.7969e+00,
           2.2144e-01, -1.3555e+00]],

        [[ 1.1338e+00,  2.8848e+00,  4.7656e+00,  ...,  1.2363e+00,
           7.5977e-01,  2.6074e-01],
         [-1.0879e+00,  1.0544e-02, -4.8256e-04,  ..., -1.9873e+00,
           1.1094e+00,  2.6782e-01],
         [ 1.5195e+00,  7.6074e-01,  6.6797e-01,  ..., -1.6592e+00,
           1.1455e+00,  2.1094e+00],
         ...,
         [-8.6853e-02,  2.0137e+00,  4.2065e-01,  ...,  9.8682e-01,
          -1.0156e+00,  7.0374e-02],
         [-4.5923e-01,  4.3140e-01,  3.3423e-01,  ..., -6.8848e-01,
          -4.5273e+00,  9.7021e-01],
         [-1.8037e+00, -1.7471e+00, -2.0137e+00,  ...,  8.9404e-01,
           8.4277e-01, -3.8204e-03]],

        [[-7.2559e-01, -8.3252e-01, -1.4219e+00,  ..., -5.0635e-01,
          -6.4795e-01,  2.6611e-01],
         [ 1.4395e+00, -1.3877e+00, -4.9683e-01,  ..., -1.1729e+00,
           4.2090e-01, -1.3984e+00],
         [-1.1221e+00, -2.6709e-01, -9.5703e-01,  ...,  5.6055e-01,
          -3.0542e-01,  2.8540e-01],
         ...,
         [ 4.1650e-01, -1.9666e-01, -4.6631e-01,  ..., -3.1445e-01,
           9.6069e-02,  1.7407e-01],
         [-6.0059e-02, -4.0558e-02, -2.5681e-02,  ..., -6.8237e-02,
           5.7959e-01,  4.7791e-02],
         [-3.1519e-01,  3.7598e-01, -9.0137e-01,  ..., -7.7490e-01,
          -6.0693e-01,  5.2734e-01]],

        [[ 1.2568e+00,  2.2441e+00,  3.2031e+00,  ...,  1.3291e+00,
           1.9502e+00,  1.2000e-01],
         [-9.0576e-01,  6.0645e-01,  2.2754e-01,  ..., -2.2778e-01,
           1.2148e+00,  1.3730e+00],
         [ 8.3789e-01, -1.0703e+00,  6.0693e-01,  ..., -7.9834e-01,
           8.9062e-01,  2.1992e+00],
         ...,
         [-2.7808e-01,  1.4424e+00,  3.9478e-01,  ...,  1.2900e+00,
           1.1328e-01,  1.1420e-01],
         [-3.5034e-01,  1.2676e+00,  1.7188e-01,  ...,  2.7148e-01,
          -3.2559e+00,  6.6772e-02],
         [-5.4297e-01, -3.2056e-01, -1.7705e+00,  ...,  1.7969e+00,
           2.2144e-01, -1.3555e+00]],

        [[ 1.1338e+00,  2.8848e+00,  4.7656e+00,  ...,  1.2363e+00,
           7.5977e-01,  2.6074e-01],
         [-1.0879e+00,  1.0544e-02, -4.8256e-04,  ..., -1.9873e+00,
           1.1094e+00,  2.6782e-01],
         [ 1.5195e+00,  7.6074e-01,  6.6797e-01,  ..., -1.6592e+00,
           1.1455e+00,  2.1094e+00],
         ...,
         [-8.6853e-02,  2.0137e+00,  4.2065e-01,  ...,  9.8682e-01,
          -1.0156e+00,  7.0374e-02],
         [-4.5923e-01,  4.3140e-01,  3.3423e-01,  ..., -6.8848e-01,
          -4.5273e+00,  9.7021e-01],
         [-1.8037e+00, -1.7471e+00, -2.0137e+00,  ...,  8.9404e-01,
           8.4277e-01, -3.8204e-03]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584370, 584352, 584353, 584354], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[ 0.1733,  0.0456,  0.3704,  ...,  0.2859, -0.1699,  0.2764],
         [-0.5186, -0.0303,  0.2372,  ...,  0.1089,  0.4443, -0.1225],
         [-0.1257,  0.3823,  0.3623,  ...,  0.2593, -0.3545, -0.2852],
         ...,
         [ 0.4709,  0.0667, -0.3789,  ...,  0.4639, -0.0771,  0.3447],
         [ 0.0729, -0.4319,  0.2815,  ...,  0.5239,  0.5249,  0.8901],
         [ 0.1832, -0.3044,  0.2944,  ..., -0.5107, -0.0295,  0.1957]],

        [[-0.3760, -2.3320, -2.4941,  ...,  0.8018,  2.5039,  0.5918],
         [ 1.5078, -1.7412, -2.0039,  ..., -2.9141, -2.4785,  0.3062],
         [-1.7021, -1.6562, -2.1621,  ..., -1.3877,  1.6191,  0.5913],
         ...,
         [-0.5820, -0.3228,  2.9023,  ..., -2.1699, -0.8945, -3.0449],
         [ 0.0307, -1.8643, -0.0120,  ...,  0.9175, -2.4883, -2.8516],
         [-0.4038, -0.0966, -1.2178,  ...,  0.3108, -1.5811, -0.5171]],

        [[-0.3032, -2.3379, -3.2598,  ...,  0.9727,  0.8794,  0.7168],
         [ 1.2656, -1.8359, -2.2070,  ..., -3.1387, -3.4629, -0.2761],
         [ 0.0677, -2.3281, -2.1504,  ..., -1.6875,  1.7842,  0.4951],
         ...,
         [-2.0996, -1.5479,  1.3086,  ..., -2.2207, -1.9873, -3.0703],
         [ 0.8862, -0.8311, -0.7231,  ...,  1.3193, -0.8018, -3.3066],
         [-1.2783, -0.6387, -1.0674,  ...,  0.4248,  0.2223,  0.8618]],

        [[ 0.1733,  0.0456,  0.3704,  ...,  0.2859, -0.1699,  0.2764],
         [-0.5186, -0.0303,  0.2372,  ...,  0.1089,  0.4443, -0.1225],
         [-0.1257,  0.3823,  0.3623,  ...,  0.2593, -0.3545, -0.2852],
         ...,
         [ 0.4709,  0.0667, -0.3789,  ...,  0.4639, -0.0771,  0.3447],
         [ 0.0729, -0.4319,  0.2815,  ...,  0.5239,  0.5249,  0.8901],
         [ 0.1832, -0.3044,  0.2944,  ..., -0.5107, -0.0295,  0.1957]],

        [[-0.3760, -2.3320, -2.4941,  ...,  0.8018,  2.5039,  0.5918],
         [ 1.5078, -1.7412, -2.0039,  ..., -2.9141, -2.4785,  0.3062],
         [-1.7021, -1.6562, -2.1621,  ..., -1.3877,  1.6191,  0.5913],
         ...,
         [-0.5820, -0.3228,  2.9023,  ..., -2.1699, -0.8945, -3.0449],
         [ 0.0307, -1.8643, -0.0120,  ...,  0.9175, -2.4883, -2.8516],
         [-0.4038, -0.0966, -1.2178,  ...,  0.3108, -1.5811, -0.5171]],

        [[-0.3032, -2.3379, -3.2598,  ...,  0.9727,  0.8794,  0.7168],
         [ 1.2656, -1.8359, -2.2070,  ..., -3.1387, -3.4629, -0.2761],
         [ 0.0677, -2.3281, -2.1504,  ..., -1.6875,  1.7842,  0.4951],
         ...,
         [-2.0996, -1.5479,  1.3086,  ..., -2.2207, -1.9873, -3.0703],
         [ 0.8862, -0.8311, -0.7231,  ...,  1.3193, -0.8018, -3.3066],
         [-1.2783, -0.6387, -1.0674,  ...,  0.4248,  0.2223,  0.8618]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584370, 584352, 584353, 584354], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-1.4702e-02, -7.8027e-01, -2.6147e-01,  ...,  1.8418e+00,
          -3.3521e-01,  2.5439e-01],
         [ 9.1357e-01, -1.3928e-01,  7.1167e-02,  ...,  1.1953e+00,
          -4.9536e-01,  2.2815e-01],
         [-1.0264e+00, -4.1846e-01, -1.1113e+00,  ..., -8.4082e-01,
           6.3428e-01,  1.6045e+00],
         ...,
         [ 6.3574e-01,  6.9287e-01,  5.9229e-01,  ...,  3.5815e-01,
          -3.2910e-01,  9.8584e-01],
         [-5.5469e-01, -3.5669e-01, -7.0996e-01,  ..., -9.7461e-01,
           2.7197e-01, -1.1104e+00],
         [ 9.1016e-01,  3.1909e-01,  1.0509e-03,  ..., -9.0234e-01,
          -9.6045e-01,  1.7358e-01]],

        [[ 4.0771e-01,  3.5181e-01,  4.1528e-01,  ...,  6.5088e-01,
           2.8789e+00, -8.6768e-01],
         [-7.2510e-01, -6.0986e-01, -1.3318e-01,  ...,  8.1738e-01,
          -1.7004e-01, -1.0957e+00],
         [ 6.0596e-01, -2.7197e-01,  2.1055e+00,  ...,  7.0850e-01,
          -3.3618e-01, -2.7109e+00],
         ...,
         [-6.5869e-01,  3.2837e-01, -2.8770e+00,  ..., -1.4233e-01,
           6.3721e-01, -3.1797e+00],
         [ 2.9434e+00,  2.2949e+00, -1.0576e+00,  ..., -2.9688e-01,
          -3.6328e-01,  2.7124e-01],
         [-2.5703e+00,  1.9199e+00, -5.6122e-02,  ...,  6.5430e-01,
           8.9453e-01, -1.3438e+00]],

        [[-1.6956e-01,  3.9380e-01,  4.0649e-01,  ...,  8.1934e-01,
           2.1973e+00, -4.1577e-01],
         [-1.1895e+00, -4.4409e-01, -2.1082e-01,  ...,  1.0840e+00,
           1.8433e-01, -1.1465e+00],
         [ 1.1426e+00,  7.9297e-01,  2.0195e+00,  ...,  6.6992e-01,
          -8.1152e-01, -3.0195e+00],
         ...,
         [-1.2686e+00,  5.7178e-01, -3.7852e+00,  ...,  4.1284e-01,
           1.6123e+00, -3.6250e+00],
         [ 3.1973e+00,  2.1191e-01,  2.5244e-01,  ..., -1.0632e-01,
          -2.7070e+00,  1.4004e+00],
         [-3.2812e+00, -1.5332e-01, -8.6230e-01,  ...,  2.0288e-01,
           2.1543e+00, -5.0830e-01]],

        [[-1.4702e-02, -7.8027e-01, -2.6147e-01,  ...,  1.8418e+00,
          -3.3521e-01,  2.5439e-01],
         [ 9.1357e-01, -1.3928e-01,  7.1167e-02,  ...,  1.1953e+00,
          -4.9536e-01,  2.2815e-01],
         [-1.0264e+00, -4.1846e-01, -1.1113e+00,  ..., -8.4082e-01,
           6.3428e-01,  1.6045e+00],
         ...,
         [ 6.3574e-01,  6.9287e-01,  5.9229e-01,  ...,  3.5815e-01,
          -3.2910e-01,  9.8584e-01],
         [-5.5469e-01, -3.5669e-01, -7.0996e-01,  ..., -9.7461e-01,
           2.7197e-01, -1.1104e+00],
         [ 9.1016e-01,  3.1909e-01,  1.0509e-03,  ..., -9.0234e-01,
          -9.6045e-01,  1.7358e-01]],

        [[ 4.0771e-01,  3.5181e-01,  4.1528e-01,  ...,  6.5088e-01,
           2.8789e+00, -8.6768e-01],
         [-7.2510e-01, -6.0986e-01, -1.3318e-01,  ...,  8.1738e-01,
          -1.7004e-01, -1.0957e+00],
         [ 6.0596e-01, -2.7197e-01,  2.1055e+00,  ...,  7.0850e-01,
          -3.3618e-01, -2.7109e+00],
         ...,
         [-6.5869e-01,  3.2837e-01, -2.8770e+00,  ..., -1.4233e-01,
           6.3721e-01, -3.1797e+00],
         [ 2.9434e+00,  2.2949e+00, -1.0576e+00,  ..., -2.9688e-01,
          -3.6328e-01,  2.7124e-01],
         [-2.5703e+00,  1.9199e+00, -5.6122e-02,  ...,  6.5430e-01,
           8.9453e-01, -1.3438e+00]],

        [[-1.6956e-01,  3.9380e-01,  4.0649e-01,  ...,  8.1934e-01,
           2.1973e+00, -4.1577e-01],
         [-1.1895e+00, -4.4409e-01, -2.1082e-01,  ...,  1.0840e+00,
           1.8433e-01, -1.1465e+00],
         [ 1.1426e+00,  7.9297e-01,  2.0195e+00,  ...,  6.6992e-01,
          -8.1152e-01, -3.0195e+00],
         ...,
         [-1.2686e+00,  5.7178e-01, -3.7852e+00,  ...,  4.1284e-01,
           1.6123e+00, -3.6250e+00],
         [ 3.1973e+00,  2.1191e-01,  2.5244e-01,  ..., -1.0632e-01,
          -2.7070e+00,  1.4004e+00],
         [-3.2812e+00, -1.5332e-01, -8.6230e-01,  ...,  2.0288e-01,
           2.1543e+00, -5.0830e-01]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584370, 584352, 584353, 584354], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-0.8359,  0.9194, -0.3135,  ...,  0.7681, -0.5728, -0.2739],
         [ 0.8066,  0.5376, -0.5615,  ...,  0.6479,  0.5049, -0.7212],
         [-0.6899, -0.8398,  0.5977,  ..., -0.1375,  0.2097,  0.7261],
         ...,
         [ 0.6841,  0.5596,  1.0889,  ...,  0.8306,  0.9702,  0.6016],
         [-0.7817,  0.8687, -0.4102,  ..., -0.8521,  0.1700,  0.4165],
         [-0.3445, -0.4941, -0.7710,  ...,  0.4395, -0.2922,  0.6240]],

        [[ 0.5649, -0.9341, -0.5630,  ..., -1.5234,  1.5625, -0.5469],
         [-0.9253, -1.4951,  1.6943,  ...,  0.4370, -1.2207,  1.3994],
         [-1.8389,  1.3320,  0.5479,  ...,  1.6494,  1.5127, -3.1895],
         ...,
         [ 0.0795,  0.7158, -1.9268,  ..., -0.6792, -1.6689,  0.2686],
         [ 1.0547, -1.6543,  2.0117,  ..., -0.4956, -0.2003, -0.8140],
         [-0.9014,  0.4509, -0.3213,  ..., -0.5820, -0.1792, -0.4297]],

        [[ 1.1543, -1.4434, -0.4136,  ..., -0.6362,  2.5234, -0.7637],
         [-0.7222, -1.4209,  1.9443,  ...,  1.2451, -3.3809,  2.9238],
         [-2.7715, -0.6040, -0.4216,  ..., -0.6689,  0.9912, -2.4336],
         ...,
         [ 0.4729,  0.5332, -2.1895,  ..., -1.4658, -2.7734, -0.5645],
         [ 0.9844, -2.6914,  2.8262,  ...,  1.1807, -0.1935, -0.3057],
         [-1.7217,  1.6875,  0.9517,  ..., -1.0312,  0.3096, -0.6504]],

        [[-0.8359,  0.9194, -0.3135,  ...,  0.7681, -0.5728, -0.2739],
         [ 0.8066,  0.5376, -0.5615,  ...,  0.6479,  0.5049, -0.7212],
         [-0.6899, -0.8398,  0.5977,  ..., -0.1375,  0.2097,  0.7261],
         ...,
         [ 0.6841,  0.5596,  1.0889,  ...,  0.8306,  0.9702,  0.6016],
         [-0.7817,  0.8687, -0.4102,  ..., -0.8521,  0.1700,  0.4165],
         [-0.3445, -0.4941, -0.7710,  ...,  0.4395, -0.2922,  0.6240]],

        [[ 0.5649, -0.9341, -0.5630,  ..., -1.5234,  1.5625, -0.5469],
         [-0.9253, -1.4951,  1.6943,  ...,  0.4370, -1.2207,  1.3994],
         [-1.8389,  1.3320,  0.5479,  ...,  1.6494,  1.5127, -3.1895],
         ...,
         [ 0.0795,  0.7158, -1.9268,  ..., -0.6792, -1.6689,  0.2686],
         [ 1.0547, -1.6543,  2.0117,  ..., -0.4956, -0.2003, -0.8140],
         [-0.9014,  0.4509, -0.3213,  ..., -0.5820, -0.1792, -0.4297]],

        [[ 1.1543, -1.4434, -0.4136,  ..., -0.6362,  2.5234, -0.7637],
         [-0.7222, -1.4209,  1.9443,  ...,  1.2451, -3.3809,  2.9238],
         [-2.7715, -0.6040, -0.4216,  ..., -0.6689,  0.9912, -2.4336],
         ...,
         [ 0.4729,  0.5332, -2.1895,  ..., -1.4658, -2.7734, -0.5645],
         [ 0.9844, -2.6914,  2.8262,  ...,  1.1807, -0.1935, -0.3057],
         [-1.7217,  1.6875,  0.9517,  ..., -1.0312,  0.3096, -0.6504]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584370, 584352, 584353, 584354], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-6.4648e-01,  1.3506e+00,  5.1367e-01,  ...,  8.8379e-01,
           1.0781e+00, -9.4336e-01],
         [ 1.3220e-01, -1.7065e-01, -3.4668e-01,  ...,  9.7412e-01,
           7.8174e-01,  1.1035e+00],
         [ 9.7168e-01, -1.2510e+00,  1.8145e+00,  ..., -2.7979e-01,
           9.3701e-01, -4.9023e-01],
         ...,
         [-1.4326e+00,  1.1426e+00, -1.3838e+00,  ..., -9.3848e-01,
           7.9102e-01, -8.0273e-01],
         [-1.5244e+00, -1.0723e+00, -4.2871e-01,  ..., -1.2891e+00,
          -5.7959e-01, -1.1436e+00],
         [ 3.4204e-01,  7.2607e-01, -8.1539e-05,  ..., -1.0957e+00,
           1.7981e-01,  9.9854e-02]],

        [[ 5.5371e-01, -1.6670e+00, -1.8594e+00,  ..., -1.9287e+00,
          -2.4238e+00,  3.9121e+00],
         [ 1.2549e-01,  3.6475e-01, -1.5674e+00,  ..., -1.4381e-02,
          -3.1738e-01, -1.4404e+00],
         [ 1.4258e+00,  2.7051e+00, -2.1055e+00,  ...,  7.9248e-01,
          -9.5898e-01,  3.1714e-01],
         ...,
         [ 1.7617e+00, -4.9336e+00,  1.5234e+00,  ...,  4.9255e-02,
          -5.0732e-01,  7.1875e-01],
         [ 1.4248e+00,  1.3501e-01,  2.0996e+00,  ..., -1.9326e+00,
           1.5967e-01,  9.0967e-01],
         [-5.5573e-02, -9.4336e-01, -4.7803e-01,  ...,  2.1016e+00,
          -2.7422e+00,  1.8005e-01]],

        [[-5.5420e-01, -4.5728e-01, -2.3022e-01,  ...,  8.1909e-02,
          -3.2188e+00,  3.5371e+00],
         [ 1.6006e+00,  7.4756e-01, -1.2842e+00,  ..., -7.1777e-01,
           5.3369e-01, -1.7061e+00],
         [ 1.5869e+00,  3.3223e+00, -3.0664e+00,  ..., -5.4855e-03,
          -1.3232e+00, -3.8403e-01],
         ...,
         [ 1.6982e+00, -5.2227e+00,  1.1562e+00,  ...,  6.1426e-01,
          -7.0557e-02,  1.6064e+00],
         [ 1.6934e+00,  6.8701e-01,  1.7246e+00,  ..., -7.9199e-01,
           1.3733e-01,  3.4351e-01],
         [ 1.4624e-01, -1.5459e+00, -4.7510e-01,  ...,  2.3379e+00,
          -6.8311e-01,  7.4902e-01]],

        [[-6.4648e-01,  1.3506e+00,  5.1367e-01,  ...,  8.8379e-01,
           1.0781e+00, -9.4336e-01],
         [ 1.3220e-01, -1.7065e-01, -3.4668e-01,  ...,  9.7412e-01,
           7.8174e-01,  1.1035e+00],
         [ 9.7168e-01, -1.2510e+00,  1.8145e+00,  ..., -2.7979e-01,
           9.3701e-01, -4.9023e-01],
         ...,
         [-1.4326e+00,  1.1426e+00, -1.3838e+00,  ..., -9.3848e-01,
           7.9102e-01, -8.0273e-01],
         [-1.5244e+00, -1.0723e+00, -4.2871e-01,  ..., -1.2891e+00,
          -5.7959e-01, -1.1436e+00],
         [ 3.4204e-01,  7.2607e-01, -8.1539e-05,  ..., -1.0957e+00,
           1.7981e-01,  9.9854e-02]],

        [[ 5.5371e-01, -1.6670e+00, -1.8594e+00,  ..., -1.9287e+00,
          -2.4238e+00,  3.9121e+00],
         [ 1.2549e-01,  3.6475e-01, -1.5674e+00,  ..., -1.4381e-02,
          -3.1738e-01, -1.4404e+00],
         [ 1.4258e+00,  2.7051e+00, -2.1055e+00,  ...,  7.9248e-01,
          -9.5898e-01,  3.1714e-01],
         ...,
         [ 1.7617e+00, -4.9336e+00,  1.5234e+00,  ...,  4.9255e-02,
          -5.0732e-01,  7.1875e-01],
         [ 1.4248e+00,  1.3501e-01,  2.0996e+00,  ..., -1.9326e+00,
           1.5967e-01,  9.0967e-01],
         [-5.5573e-02, -9.4336e-01, -4.7803e-01,  ...,  2.1016e+00,
          -2.7422e+00,  1.8005e-01]],

        [[-5.5420e-01, -4.5728e-01, -2.3022e-01,  ...,  8.1909e-02,
          -3.2188e+00,  3.5371e+00],
         [ 1.6006e+00,  7.4756e-01, -1.2842e+00,  ..., -7.1777e-01,
           5.3369e-01, -1.7061e+00],
         [ 1.5869e+00,  3.3223e+00, -3.0664e+00,  ..., -5.4855e-03,
          -1.3232e+00, -3.8403e-01],
         ...,
         [ 1.6982e+00, -5.2227e+00,  1.1562e+00,  ...,  6.1426e-01,
          -7.0557e-02,  1.6064e+00],
         [ 1.6934e+00,  6.8701e-01,  1.7246e+00,  ..., -7.9199e-01,
           1.3733e-01,  3.4351e-01],
         [ 1.4624e-01, -1.5459e+00, -4.7510e-01,  ...,  2.3379e+00,
          -6.8311e-01,  7.4902e-01]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584370, 584352, 584353, 584354], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[ 0.6440,  0.5107,  0.0831,  ...,  0.0264,  3.0723,  0.4946],
         [-1.3691,  1.9023,  2.1016,  ..., -0.9473,  1.6455,  0.7642],
         [ 0.3110,  1.2197,  0.0401,  ..., -1.1016,  0.8350, -0.6675],
         ...,
         [-1.6631,  1.1631, -0.6167,  ..., -0.2496,  0.1609, -1.2568],
         [-0.3804,  0.2583, -1.4814,  ...,  0.1414, -1.7041,  0.2629],
         [-0.1514, -1.0586,  0.2250,  ...,  0.2357,  0.2036, -0.6396]],

        [[-0.8638,  1.1650, -2.3223,  ...,  2.6680, -1.4834, -0.8354],
         [-3.3711,  0.6206,  0.3743,  ...,  0.2345,  0.2620, -0.9238],
         [-0.0975, -1.0820,  0.7153,  ..., -0.9951, -1.5879,  1.1846],
         ...,
         [ 1.3037, -5.1562,  1.1924,  ..., -3.0781,  1.8203,  5.6250],
         [ 0.2489,  1.3008,  0.1272,  ..., -2.0059,  0.7358,  1.8975],
         [-1.2061,  0.6338,  0.2408,  ..., -0.7637, -0.4255, -1.1221]],

        [[-1.0342, -0.1892, -0.2076,  ...,  2.5703, -1.0566, -0.3240],
         [-1.9941,  0.6831, -1.6846,  ..., -0.8433,  0.8569, -1.3320],
         [ 0.2224,  0.0941,  0.1758,  ..., -0.3276, -1.1455,  1.5146],
         ...,
         [ 2.1113, -5.9805,  1.5596,  ..., -2.5742,  1.0674,  5.5703],
         [ 0.7939,  1.1787,  0.4399,  ..., -0.9316,  0.1093,  1.2080],
         [-1.0381, -0.1321,  0.2256,  ..., -0.9971, -0.3555, -1.1689]],

        [[ 0.6440,  0.5107,  0.0831,  ...,  0.0264,  3.0723,  0.4946],
         [-1.3691,  1.9023,  2.1016,  ..., -0.9473,  1.6455,  0.7642],
         [ 0.3110,  1.2197,  0.0401,  ..., -1.1016,  0.8350, -0.6675],
         ...,
         [-1.6631,  1.1631, -0.6167,  ..., -0.2496,  0.1609, -1.2568],
         [-0.3804,  0.2583, -1.4814,  ...,  0.1414, -1.7041,  0.2629],
         [-0.1514, -1.0586,  0.2250,  ...,  0.2357,  0.2036, -0.6396]],

        [[-0.8638,  1.1650, -2.3223,  ...,  2.6680, -1.4834, -0.8354],
         [-3.3711,  0.6206,  0.3743,  ...,  0.2345,  0.2620, -0.9238],
         [-0.0975, -1.0820,  0.7153,  ..., -0.9951, -1.5879,  1.1846],
         ...,
         [ 1.3037, -5.1562,  1.1924,  ..., -3.0781,  1.8203,  5.6250],
         [ 0.2489,  1.3008,  0.1272,  ..., -2.0059,  0.7358,  1.8975],
         [-1.2061,  0.6338,  0.2408,  ..., -0.7637, -0.4255, -1.1221]],

        [[-1.0342, -0.1892, -0.2076,  ...,  2.5703, -1.0566, -0.3240],
         [-1.9941,  0.6831, -1.6846,  ..., -0.8433,  0.8569, -1.3320],
         [ 0.2224,  0.0941,  0.1758,  ..., -0.3276, -1.1455,  1.5146],
         ...,
         [ 2.1113, -5.9805,  1.5596,  ..., -2.5742,  1.0674,  5.5703],
         [ 0.7939,  1.1787,  0.4399,  ..., -0.9316,  0.1093,  1.2080],
         [-1.0381, -0.1321,  0.2256,  ..., -0.9971, -0.3555, -1.1689]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584370, 584352, 584353, 584354], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-0.1848, -1.4521,  0.5596,  ..., -2.3516, -1.7041,  1.5986],
         [-0.5771, -0.6450,  0.3889,  ..., -1.1484, -0.1186,  0.4172],
         [ 0.8076,  0.6313,  0.3198,  ..., -0.9287, -1.2334, -0.1740],
         ...,
         [-0.6763,  1.0068,  1.2217,  ..., -1.0459, -0.1963,  0.0720],
         [-1.2178,  1.4697, -0.4458,  ..., -1.3242,  1.1816, -0.2793],
         [ 0.7046,  1.7705, -1.8398,  ..., -1.1523, -0.2922,  0.0476]],

        [[-1.9795, -0.8628, -1.7715,  ...,  0.3467,  0.2842,  0.5366],
         [-2.2090,  0.5376,  1.2627,  ...,  1.2393, -2.7832, -2.0078],
         [-0.9766, -1.2539,  3.2012,  ...,  0.9287, -1.4814,  0.3237],
         ...,
         [ 1.8428,  0.1410, -0.5171,  ...,  0.4695,  0.5635, -1.1055],
         [ 2.2930, -0.0126,  0.0851,  ..., -0.5991,  1.1201,  0.1488],
         [ 0.1846,  1.8945, -1.2129,  ...,  1.8740,  0.5234, -1.7129]],

        [[-3.4922, -1.2461, -1.2373,  ..., -0.0228, -1.0684,  0.9160],
         [-3.0527,  0.6206,  2.4688,  ...,  0.0263, -1.7441, -1.3213],
         [-1.2598, -1.5576,  4.5078,  ...,  1.0635, -0.5537, -0.0936],
         ...,
         [ 1.9668,  0.4998,  0.6958,  ..., -0.7979,  0.0806, -1.0107],
         [ 0.8989,  1.3496,  0.3191,  ...,  0.1714,  0.1757, -0.9214],
         [-0.3618,  1.8438, -0.6338,  ...,  2.1309,  1.2021, -0.9194]],

        [[-0.1848, -1.4521,  0.5596,  ..., -2.3516, -1.7041,  1.5986],
         [-0.5771, -0.6450,  0.3889,  ..., -1.1484, -0.1186,  0.4172],
         [ 0.8076,  0.6313,  0.3198,  ..., -0.9287, -1.2334, -0.1740],
         ...,
         [-0.6763,  1.0068,  1.2217,  ..., -1.0459, -0.1963,  0.0720],
         [-1.2178,  1.4697, -0.4458,  ..., -1.3242,  1.1816, -0.2793],
         [ 0.7046,  1.7705, -1.8398,  ..., -1.1523, -0.2922,  0.0476]],

        [[-1.9795, -0.8628, -1.7715,  ...,  0.3467,  0.2842,  0.5366],
         [-2.2090,  0.5376,  1.2627,  ...,  1.2393, -2.7832, -2.0078],
         [-0.9766, -1.2539,  3.2012,  ...,  0.9287, -1.4814,  0.3237],
         ...,
         [ 1.8428,  0.1410, -0.5171,  ...,  0.4695,  0.5635, -1.1055],
         [ 2.2930, -0.0126,  0.0851,  ..., -0.5991,  1.1201,  0.1488],
         [ 0.1846,  1.8945, -1.2129,  ...,  1.8740,  0.5234, -1.7129]],

        [[-3.4922, -1.2461, -1.2373,  ..., -0.0228, -1.0684,  0.9160],
         [-3.0527,  0.6206,  2.4688,  ...,  0.0263, -1.7441, -1.3213],
         [-1.2598, -1.5576,  4.5078,  ...,  1.0635, -0.5537, -0.0936],
         ...,
         [ 1.9668,  0.4998,  0.6958,  ..., -0.7979,  0.0806, -1.0107],
         [ 0.8989,  1.3496,  0.3191,  ...,  0.1714,  0.1757, -0.9214],
         [-0.3618,  1.8438, -0.6338,  ...,  2.1309,  1.2021, -0.9194]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584370, 584352, 584353, 584354], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[ 0.0237,  0.1875,  0.3066,  ..., -0.0511, -0.1434, -0.1504],
         [ 1.3564, -1.1484,  0.0438,  ...,  0.7183, -0.2079,  1.0811],
         [-1.2939,  0.8018,  0.9390,  ...,  0.9204,  0.4087, -1.8662],
         ...,
         [ 1.0986, -0.7788,  0.6738,  ...,  0.6748, -1.4395,  0.2937],
         [-0.6426,  0.8105, -0.5938,  ...,  0.8159,  0.6162, -0.5986],
         [ 0.4199, -1.4707,  1.7891,  ..., -2.2109, -1.9082, -0.6890]],

        [[ 0.0283, -0.3352,  0.4124,  ...,  0.2852, -0.0500,  0.1571],
         [ 0.5981, -1.5391, -0.3315,  ..., -1.0947, -2.0273,  0.1710],
         [-0.0414,  0.0645,  1.5889,  ...,  0.1417,  0.2051,  0.0298],
         ...,
         [-0.0635, -0.0622, -0.9058,  ..., -0.5859,  0.2169, -0.3835],
         [ 1.6143,  0.5171, -0.5845,  ..., -0.2629, -0.1632, -0.6533],
         [ 0.2297, -0.3105, -0.7490,  ..., -0.5283, -0.4971,  0.5962]],

        [[ 0.6489, -0.6997,  0.8345,  ..., -0.2839,  0.1660, -1.8486],
         [ 0.7246, -0.3799, -0.2417,  ..., -2.2324, -1.7969,  0.9185],
         [ 0.3708,  1.8232,  1.9736,  ..., -1.3984, -0.9731, -0.9658],
         ...,
         [-1.8760,  0.4773, -0.5942,  ..., -1.0078, -0.2068, -0.6724],
         [ 0.3904, -0.6685, -1.1025,  ..., -0.3772,  1.2129,  0.2798],
         [ 0.2384,  0.5933, -2.2168,  ...,  1.2764,  0.6304, -1.5400]],

        [[ 0.0237,  0.1875,  0.3066,  ..., -0.0511, -0.1434, -0.1504],
         [ 1.3564, -1.1484,  0.0438,  ...,  0.7183, -0.2079,  1.0811],
         [-1.2939,  0.8018,  0.9390,  ...,  0.9204,  0.4087, -1.8662],
         ...,
         [ 1.0986, -0.7788,  0.6738,  ...,  0.6748, -1.4395,  0.2937],
         [-0.6426,  0.8105, -0.5938,  ...,  0.8159,  0.6162, -0.5986],
         [ 0.4199, -1.4707,  1.7891,  ..., -2.2109, -1.9082, -0.6890]],

        [[ 0.0283, -0.3352,  0.4124,  ...,  0.2852, -0.0500,  0.1571],
         [ 0.5981, -1.5391, -0.3315,  ..., -1.0947, -2.0273,  0.1710],
         [-0.0414,  0.0645,  1.5889,  ...,  0.1417,  0.2051,  0.0298],
         ...,
         [-0.0635, -0.0622, -0.9058,  ..., -0.5859,  0.2169, -0.3835],
         [ 1.6143,  0.5171, -0.5845,  ..., -0.2629, -0.1632, -0.6533],
         [ 0.2297, -0.3105, -0.7490,  ..., -0.5283, -0.4971,  0.5962]],

        [[ 0.6489, -0.6997,  0.8345,  ..., -0.2839,  0.1660, -1.8486],
         [ 0.7246, -0.3799, -0.2417,  ..., -2.2324, -1.7969,  0.9185],
         [ 0.3708,  1.8232,  1.9736,  ..., -1.3984, -0.9731, -0.9658],
         ...,
         [-1.8760,  0.4773, -0.5942,  ..., -1.0078, -0.2068, -0.6724],
         [ 0.3904, -0.6685, -1.1025,  ..., -0.3772,  1.2129,  0.2798],
         [ 0.2384,  0.5933, -2.2168,  ...,  1.2764,  0.6304, -1.5400]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584370, 584352, 584353, 584354], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-1.2783,  0.1615,  1.0820,  ..., -0.6592,  0.5317,  0.6279],
         [-0.1013, -0.3191, -0.2163,  ..., -0.0052, -1.1113,  1.1514],
         [-0.4102, -0.7700,  0.8887,  ...,  0.7036,  0.1632, -0.8896],
         ...,
         [ 0.4473,  0.2622,  0.9932,  ...,  0.9512, -0.5098, -1.0029],
         [-0.8477, -1.4746,  0.3213,  ..., -1.3633,  0.4734, -0.8706],
         [-0.6060,  1.8271,  0.2524,  ...,  0.4387,  0.4990, -0.6509]],

        [[ 0.4543, -2.2793, -3.1855,  ..., -0.3997, -2.9395, -0.5444],
         [-1.5156,  0.8638, -2.2383,  ..., -0.1168,  3.3984, -1.7998],
         [ 2.7852,  1.3916, -0.2900,  ..., -1.5801,  1.8604,  0.5239],
         ...,
         [-0.1456,  0.6655,  1.4512,  ..., -0.4614, -0.6030, -1.6035],
         [ 1.3857,  1.2734,  0.1349,  ...,  0.9380, -3.5566, -0.8779],
         [-1.0557, -0.4639, -0.8413,  ...,  0.4307,  1.1748, -1.2490]],

        [[ 0.5254, -2.0215, -2.3203,  ..., -0.0962, -2.6562, -1.1787],
         [-1.3057,  2.3789, -2.0430,  ...,  0.5811,  2.2754, -1.4229],
         [ 2.8789,  1.8164,  0.3591,  ..., -1.3262,  2.4766,  2.2754],
         ...,
         [-1.0234,  0.9131,  1.6816,  ...,  0.1122, -0.3611, -0.3547],
         [ 0.8530,  1.6426, -0.8745,  ...,  2.3750, -2.9375, -1.4854],
         [-1.4023, -0.0691, -0.9507,  ..., -0.8540,  1.5244, -0.0998]],

        [[-1.2783,  0.1615,  1.0820,  ..., -0.6592,  0.5317,  0.6279],
         [-0.1013, -0.3191, -0.2163,  ..., -0.0052, -1.1113,  1.1514],
         [-0.4102, -0.7700,  0.8887,  ...,  0.7036,  0.1632, -0.8896],
         ...,
         [ 0.4473,  0.2622,  0.9932,  ...,  0.9512, -0.5098, -1.0029],
         [-0.8477, -1.4746,  0.3213,  ..., -1.3633,  0.4734, -0.8706],
         [-0.6060,  1.8271,  0.2524,  ...,  0.4387,  0.4990, -0.6509]],

        [[ 0.4543, -2.2793, -3.1855,  ..., -0.3997, -2.9395, -0.5444],
         [-1.5156,  0.8638, -2.2383,  ..., -0.1168,  3.3984, -1.7998],
         [ 2.7852,  1.3916, -0.2900,  ..., -1.5801,  1.8604,  0.5239],
         ...,
         [-0.1456,  0.6655,  1.4512,  ..., -0.4614, -0.6030, -1.6035],
         [ 1.3857,  1.2734,  0.1349,  ...,  0.9380, -3.5566, -0.8779],
         [-1.0557, -0.4639, -0.8413,  ...,  0.4307,  1.1748, -1.2490]],

        [[ 0.5254, -2.0215, -2.3203,  ..., -0.0962, -2.6562, -1.1787],
         [-1.3057,  2.3789, -2.0430,  ...,  0.5811,  2.2754, -1.4229],
         [ 2.8789,  1.8164,  0.3591,  ..., -1.3262,  2.4766,  2.2754],
         ...,
         [-1.0234,  0.9131,  1.6816,  ...,  0.1122, -0.3611, -0.3547],
         [ 0.8530,  1.6426, -0.8745,  ...,  2.3750, -2.9375, -1.4854],
         [-1.4023, -0.0691, -0.9507,  ..., -0.8540,  1.5244, -0.0998]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584370, 584352, 584353, 584354], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[ 1.4473,  1.0469,  0.8647,  ...,  0.5977, -0.4043,  0.0663],
         [ 0.4001,  0.4817, -1.6133,  ..., -1.6074, -0.1553, -1.5166],
         [ 0.3481,  1.6699, -1.4736,  ..., -2.3145, -0.9321,  0.5024],
         ...,
         [ 1.6875,  0.7134,  0.6030,  ..., -0.3054,  0.0167,  0.4304],
         [ 0.4688, -0.6172, -1.2090,  ...,  0.7617,  0.6719,  0.4666],
         [-0.8696,  0.6348,  0.5024,  ...,  1.1133,  0.4792, -0.2450]],

        [[ 0.2788, -0.7451, -0.2505,  ...,  1.8594, -1.9229, -0.0405],
         [ 3.3281, -0.2462, -0.1385,  ...,  2.8223,  1.6934, -0.6440],
         [ 0.7383,  1.6016,  0.7070,  ..., -0.3406,  1.1113,  1.6309],
         ...,
         [ 1.6846,  1.7471, -0.6821,  ...,  0.5088, -0.3677,  1.3047],
         [ 0.0555,  1.2666,  0.2142,  ..., -0.0587,  3.2324, -0.6802],
         [ 0.0590,  1.3008, -1.0508,  ...,  1.3701, -0.9204,  0.0642]],

        [[ 0.0331, -1.4092, -0.6860,  ...,  2.3477, -2.6191, -0.9775],
         [ 3.4824,  0.0158, -0.5371,  ...,  3.7324,  1.5625, -1.0430],
         [ 0.1738,  1.2051, -0.3958,  ...,  0.3906,  1.5605,  1.6924],
         ...,
         [ 1.3281,  1.3057,  0.5415,  ...,  1.2441, -0.1860,  2.0840],
         [ 0.3611,  0.5337, -0.3167,  ..., -1.0283,  2.6836, -0.7725],
         [ 0.6357,  1.4023, -0.0399,  ...,  0.9424, -1.6025,  0.1844]],

        [[ 1.4473,  1.0469,  0.8647,  ...,  0.5977, -0.4043,  0.0663],
         [ 0.4001,  0.4817, -1.6133,  ..., -1.6074, -0.1553, -1.5166],
         [ 0.3481,  1.6699, -1.4736,  ..., -2.3145, -0.9321,  0.5024],
         ...,
         [ 1.6875,  0.7134,  0.6030,  ..., -0.3054,  0.0167,  0.4304],
         [ 0.4688, -0.6172, -1.2090,  ...,  0.7617,  0.6719,  0.4666],
         [-0.8696,  0.6348,  0.5024,  ...,  1.1133,  0.4792, -0.2450]],

        [[ 0.2788, -0.7451, -0.2505,  ...,  1.8594, -1.9229, -0.0405],
         [ 3.3281, -0.2462, -0.1385,  ...,  2.8223,  1.6934, -0.6440],
         [ 0.7383,  1.6016,  0.7070,  ..., -0.3406,  1.1113,  1.6309],
         ...,
         [ 1.6846,  1.7471, -0.6821,  ...,  0.5088, -0.3677,  1.3047],
         [ 0.0555,  1.2666,  0.2142,  ..., -0.0587,  3.2324, -0.6802],
         [ 0.0590,  1.3008, -1.0508,  ...,  1.3701, -0.9204,  0.0642]],

        [[ 0.0331, -1.4092, -0.6860,  ...,  2.3477, -2.6191, -0.9775],
         [ 3.4824,  0.0158, -0.5371,  ...,  3.7324,  1.5625, -1.0430],
         [ 0.1738,  1.2051, -0.3958,  ...,  0.3906,  1.5605,  1.6924],
         ...,
         [ 1.3281,  1.3057,  0.5415,  ...,  1.2441, -0.1860,  2.0840],
         [ 0.3611,  0.5337, -0.3167,  ..., -1.0283,  2.6836, -0.7725],
         [ 0.6357,  1.4023, -0.0399,  ...,  0.9424, -1.6025,  0.1844]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584368, 584369, 584370, 584352, 584353, 584354], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
hidden_states torch.Size([2, 768])
seq_id:  0 output_token:  939
seq_id:  1 output_token:  939
seq_id 0 generation_tokens [939]
seq_id 1 generation_tokens [939]
reshape and cache tensor([[[ 0.4260, -1.9180,  1.5742,  ...,  1.5400, -0.1164,  0.6235],
         [-0.9854, -0.7075,  1.3896,  ...,  0.1182, -0.0349, -2.0586],
         [-0.6372, -0.1802,  0.5410,  ...,  0.8218, -0.4307, -1.4160],
         ...,
         [-0.2693, -0.4695,  0.5786,  ...,  0.5532, -1.1787, -1.1807],
         [-2.4102, -0.1848, -0.3682,  ..., -0.4465, -0.3132,  0.1974],
         [ 1.2285, -0.7173, -0.0542,  ..., -3.4043, -1.1650, -0.4009]],

        [[ 0.4260, -1.9180,  1.5742,  ...,  1.5400, -0.1164,  0.6235],
         [-0.9854, -0.7075,  1.3896,  ...,  0.1182, -0.0349, -2.0586],
         [-0.6372, -0.1802,  0.5410,  ...,  0.8218, -0.4307, -1.4160],
         ...,
         [-0.2693, -0.4695,  0.5786,  ...,  0.5532, -1.1787, -1.1807],
         [-2.4102, -0.1848, -0.3682,  ..., -0.4465, -0.3132,  0.1974],
         [ 1.2285, -0.7173, -0.0542,  ..., -3.4043, -1.1650, -0.4009]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584371, 584355], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[ 1.0225e+00, -4.9878e-01, -3.6259e-03,  ..., -2.8467e-01,
           9.2627e-01, -2.0977e+00],
         [ 1.0118e-03, -1.6235e-01,  9.9805e-01,  ...,  8.6572e-01,
          -9.6875e-01,  9.7119e-01],
         [ 1.0820e+00, -1.6937e-02,  1.2927e-01,  ..., -8.6279e-01,
          -3.0444e-01, -6.8359e-01],
         ...,
         [ 1.8877e+00, -2.1855e+00, -1.8604e+00,  ...,  5.8252e-01,
          -2.0391e+00,  8.6963e-01],
         [-1.5918e+00, -2.2539e+00,  6.8164e-01,  ...,  1.9971e+00,
          -7.9102e-01, -4.5874e-01],
         [ 1.6895e+00,  3.2373e-01,  1.0830e+00,  ..., -1.6211e-01,
           1.1299e+00, -1.8965e+00]],

        [[ 1.0225e+00, -4.9878e-01, -3.6259e-03,  ..., -2.8467e-01,
           9.2627e-01, -2.0977e+00],
         [ 1.0118e-03, -1.6235e-01,  9.9805e-01,  ...,  8.6572e-01,
          -9.6875e-01,  9.7119e-01],
         [ 1.0820e+00, -1.6937e-02,  1.2927e-01,  ..., -8.6279e-01,
          -3.0444e-01, -6.8359e-01],
         ...,
         [ 1.8877e+00, -2.1855e+00, -1.8604e+00,  ...,  5.8252e-01,
          -2.0391e+00,  8.6963e-01],
         [-1.5918e+00, -2.2539e+00,  6.8164e-01,  ...,  1.9971e+00,
          -7.9102e-01, -4.5874e-01],
         [ 1.6895e+00,  3.2373e-01,  1.0830e+00,  ..., -1.6211e-01,
           1.1299e+00, -1.8965e+00]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584371, 584355], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[ 0.5264,  0.7817,  3.2051,  ...,  1.0752,  1.4287,  0.1160],
         [-2.3828,  1.1924,  0.4050,  ...,  0.6475,  1.9600,  1.3467],
         [ 1.1523,  0.3059,  2.0234,  ..., -0.5308, -0.0270,  0.4092],
         ...,
         [-0.3489,  2.6035,  0.5269,  ...,  0.4814,  2.1426, -0.9229],
         [-0.1761,  1.3291, -0.3306,  ..., -1.5088, -3.9590, -0.4905],
         [-0.1497, -0.7080, -2.5938,  ...,  1.1201,  0.6646, -1.6318]],

        [[ 0.5264,  0.7817,  3.2051,  ...,  1.0752,  1.4287,  0.1160],
         [-2.3828,  1.1924,  0.4050,  ...,  0.6475,  1.9600,  1.3467],
         [ 1.1523,  0.3059,  2.0234,  ..., -0.5308, -0.0270,  0.4092],
         ...,
         [-0.3489,  2.6035,  0.5269,  ...,  0.4814,  2.1426, -0.9229],
         [-0.1761,  1.3291, -0.3306,  ..., -1.5088, -3.9590, -0.4905],
         [-0.1497, -0.7080, -2.5938,  ...,  1.1201,  0.6646, -1.6318]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584371, 584355], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-1.0049e+00, -2.3066e+00, -3.6465e+00,  ...,  8.3057e-01,
           1.9727e+00,  5.7764e-01],
         [ 2.0176e+00, -1.7393e+00, -2.2852e+00,  ..., -3.8789e+00,
          -1.9746e+00, -2.3901e-01],
         [ 5.2344e-01, -2.8418e+00, -1.3398e+00,  ..., -1.9287e+00,
           1.0518e+00,  1.5515e-01],
         ...,
         [-3.8867e-01, -7.0264e-01,  4.1968e-01,  ..., -1.9961e+00,
          -5.7324e-01, -4.1602e+00],
         [-2.5269e-02,  6.8018e-01, -6.8808e-04,  ...,  1.0400e+00,
          -1.1172e+00, -3.5625e+00],
         [-9.8730e-01, -4.3774e-01, -1.4951e+00,  ...,  1.7979e+00,
          -2.2180e-01,  3.6713e-02]],

        [[-1.0049e+00, -2.3066e+00, -3.6465e+00,  ...,  8.3057e-01,
           1.9727e+00,  5.7764e-01],
         [ 2.0176e+00, -1.7393e+00, -2.2852e+00,  ..., -3.8789e+00,
          -1.9746e+00, -2.3901e-01],
         [ 5.2344e-01, -2.8418e+00, -1.3398e+00,  ..., -1.9287e+00,
           1.0518e+00,  1.5515e-01],
         ...,
         [-3.8867e-01, -7.0264e-01,  4.1968e-01,  ..., -1.9961e+00,
          -5.7324e-01, -4.1602e+00],
         [-2.5269e-02,  6.8018e-01, -6.8808e-04,  ...,  1.0400e+00,
          -1.1172e+00, -3.5625e+00],
         [-9.8730e-01, -4.3774e-01, -1.4951e+00,  ...,  1.7979e+00,
          -2.2180e-01,  3.6713e-02]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584371, 584355], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-1.7422, -1.8174, -0.3191,  ...,  0.4951,  1.8877, -0.4597],
         [-2.4980,  0.8228,  0.3767,  ...,  0.8013,  0.9722, -1.1152],
         [ 0.8193,  0.7847,  1.0625,  ...,  0.4705,  0.5586, -3.1289],
         ...,
         [-0.7827, -0.3894, -4.5273,  ...,  0.4873,  1.3848, -2.6445],
         [ 2.7598,  2.3398,  0.0151,  ..., -1.0029, -0.1302,  2.3281],
         [-3.1465, -0.5518, -0.4700,  ..., -0.0728,  0.7075, -0.5415]],

        [[-1.7422, -1.8174, -0.3191,  ...,  0.4951,  1.8877, -0.4597],
         [-2.4980,  0.8228,  0.3767,  ...,  0.8013,  0.9722, -1.1152],
         [ 0.8193,  0.7847,  1.0625,  ...,  0.4705,  0.5586, -3.1289],
         ...,
         [-0.7827, -0.3894, -4.5273,  ...,  0.4873,  1.3848, -2.6445],
         [ 2.7598,  2.3398,  0.0151,  ..., -1.0029, -0.1302,  2.3281],
         [-3.1465, -0.5518, -0.4700,  ..., -0.0728,  0.7075, -0.5415]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584371, 584355], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[ 1.0674, -0.1832, -0.1025,  ..., -2.5820,  2.2480, -0.8643],
         [-0.6948, -2.4023,  1.9023,  ...,  2.6523, -2.3164,  2.0547],
         [-1.1396,  1.5352, -0.4854,  ..., -1.3037,  0.1357, -1.0381],
         ...,
         [ 0.3193, -0.3613, -2.3027,  ..., -2.7617, -2.9492,  0.0115],
         [ 0.2269, -2.2793,  1.9521,  ...,  1.6221, -0.0842, -0.1909],
         [-1.1689, -0.1124,  2.3262,  ..., -0.9351,  0.2942, -0.5093]],

        [[ 1.0674, -0.1832, -0.1025,  ..., -2.5820,  2.2480, -0.8643],
         [-0.6948, -2.4023,  1.9023,  ...,  2.6523, -2.3164,  2.0547],
         [-1.1396,  1.5352, -0.4854,  ..., -1.3037,  0.1357, -1.0381],
         ...,
         [ 0.3193, -0.3613, -2.3027,  ..., -2.7617, -2.9492,  0.0115],
         [ 0.2269, -2.2793,  1.9521,  ...,  1.6221, -0.0842, -0.1909],
         [-1.1689, -0.1124,  2.3262,  ..., -0.9351,  0.2942, -0.5093]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584371, 584355], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-0.8789, -1.8896, -1.2686,  ..., -0.8408, -2.9688,  4.1875],
         [ 1.1377, -0.6089, -1.4580,  ..., -1.1045, -0.0180, -1.4707],
         [ 1.5244,  3.3613, -2.7344,  ...,  1.0381, -0.6133, -0.2820],
         ...,
         [ 1.5127, -5.7422,  0.2289,  ..., -0.0412,  0.1180,  1.0674],
         [ 1.9443,  1.7041,  1.2520,  ..., -1.9971,  0.2754,  0.3398],
         [ 0.8418, -0.9912,  0.1989,  ...,  2.7949, -1.7607,  1.1680]],

        [[-0.8789, -1.8896, -1.2686,  ..., -0.8408, -2.9688,  4.1875],
         [ 1.1377, -0.6089, -1.4580,  ..., -1.1045, -0.0180, -1.4707],
         [ 1.5244,  3.3613, -2.7344,  ...,  1.0381, -0.6133, -0.2820],
         ...,
         [ 1.5127, -5.7422,  0.2289,  ..., -0.0412,  0.1180,  1.0674],
         [ 1.9443,  1.7041,  1.2520,  ..., -1.9971,  0.2754,  0.3398],
         [ 0.8418, -0.9912,  0.1989,  ...,  2.7949, -1.7607,  1.1680]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584371, 584355], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-0.7373,  0.3149, -2.5723,  ...,  2.0820, -1.1035, -0.9717],
         [-2.4805,  0.3743, -0.4243,  ..., -0.7383,  1.3018, -2.0352],
         [ 0.3342, -0.3318,  0.7212,  ..., -1.0127,  0.2301,  2.3887],
         ...,
         [ 1.5889, -6.2070,  0.8442,  ..., -2.0312,  0.2805,  6.9961],
         [ 0.8872,  1.1221,  0.5522,  ..., -1.5420,  0.1614,  1.2334],
         [-1.4736,  0.4619,  1.1846,  ..., -0.6313, -1.4697, -0.8628]],

        [[-0.7373,  0.3149, -2.5723,  ...,  2.0820, -1.1035, -0.9717],
         [-2.4805,  0.3743, -0.4243,  ..., -0.7383,  1.3018, -2.0352],
         [ 0.3342, -0.3318,  0.7212,  ..., -1.0127,  0.2301,  2.3887],
         ...,
         [ 1.5889, -6.2070,  0.8442,  ..., -2.0312,  0.2805,  6.9961],
         [ 0.8872,  1.1221,  0.5522,  ..., -1.5420,  0.1614,  1.2334],
         [-1.4736,  0.4619,  1.1846,  ..., -0.6313, -1.4697, -0.8628]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584371, 584355], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-1.4136e-01,  3.2349e-01, -1.8616e-01,  ...,  1.2299e-01,
           2.4329e-01,  2.5293e-01],
         [-5.3662e-01,  7.8711e-01, -5.1953e-01,  ..., -4.3042e-01,
          -1.5198e-01, -4.5166e-01],
         [ 1.6815e-02,  3.8477e-01, -6.1531e-03,  ..., -6.8359e-02,
          -2.6978e-02, -2.2021e-01],
         ...,
         [ 1.7505e-01,  1.0968e-01,  1.5808e-01,  ..., -7.3584e-01,
          -9.3689e-02, -3.4332e-02],
         [ 3.9648e-01, -4.8950e-02, -2.2229e-01,  ..., -1.2598e-01,
          -2.3254e-02, -3.2007e-01],
         [ 4.2163e-01, -1.5881e-01,  3.5742e-01,  ..., -1.3367e-01,
           4.2627e-01,  1.0078e+00]],

        [[ 5.8327e-03,  1.3412e-02, -1.4366e-02,  ...,  2.3392e-02,
           2.0706e-02,  1.1034e-03],
         [ 2.4681e-03,  2.9736e-03, -2.6794e-02,  ..., -3.3844e-02,
          -1.2047e-02, -7.0686e-03],
         [-1.1887e-02,  1.8509e-02,  1.2733e-02,  ...,  1.1154e-02,
          -3.6987e-02,  2.7313e-02],
         ...,
         [ 2.8286e-03,  6.4278e-03,  1.8463e-02,  ..., -2.5535e-04,
          -7.4234e-03, -1.2650e-02],
         [ 9.6588e-03, -2.3422e-02, -1.2703e-02,  ..., -2.9541e-02,
           2.1118e-02, -2.3972e-02],
         [-1.3496e-02,  4.8103e-03,  1.1673e-02,  ...,  2.3682e-02,
           2.0428e-03, -2.5543e-02]],

        [[-1.4136e-01,  3.2349e-01, -1.8616e-01,  ...,  1.2299e-01,
           2.4329e-01,  2.5293e-01],
         [-5.3662e-01,  7.8711e-01, -5.1953e-01,  ..., -4.3042e-01,
          -1.5198e-01, -4.5166e-01],
         [ 1.6815e-02,  3.8477e-01, -6.1531e-03,  ..., -6.8359e-02,
          -2.6978e-02, -2.2021e-01],
         ...,
         [ 1.7505e-01,  1.0968e-01,  1.5808e-01,  ..., -7.3584e-01,
          -9.3689e-02, -3.4332e-02],
         [ 3.9648e-01, -4.8950e-02, -2.2229e-01,  ..., -1.2598e-01,
          -2.3254e-02, -3.2007e-01],
         [ 4.2163e-01, -1.5881e-01,  3.5742e-01,  ..., -1.3367e-01,
           4.2627e-01,  1.0078e+00]],

        [[ 5.8327e-03,  1.3412e-02, -1.4366e-02,  ...,  2.3392e-02,
           2.0706e-02,  1.1034e-03],
         [ 2.4681e-03,  2.9736e-03, -2.6794e-02,  ..., -3.3844e-02,
          -1.2047e-02, -7.0686e-03],
         [-1.1887e-02,  1.8509e-02,  1.2733e-02,  ...,  1.1154e-02,
          -3.6987e-02,  2.7313e-02],
         ...,
         [ 2.8286e-03,  6.4278e-03,  1.8463e-02,  ..., -2.5535e-04,
          -7.4234e-03, -1.2650e-02],
         [ 9.6588e-03, -2.3422e-02, -1.2703e-02,  ..., -2.9541e-02,
           2.1118e-02, -2.3972e-02],
         [-1.3496e-02,  4.8103e-03,  1.1673e-02,  ...,  2.3682e-02,
           2.0428e-03, -2.5543e-02]]], device='cuda:0', dtype=torch.float16)
hidden_states torch.Size([2, 768])
target decode seq_id 0 generation_tokens [6, 939, 33]
target decode seq_id 1 generation_tokens [6, 939, 33]
slot mapping [584370, 584371, 584372, 584354, 584355, 584356]
block_tables [[36523], [36523], [36523], [36522], [36522], [36522]]
context_lens [3, 4, 5, 3, 4, 5]
input_tokens tensor([  6, 939,  33,   6, 939,  33], device='cuda:0')
input_positions tensor([2, 3, 4, 2, 3, 4], device='cuda:0')
tensor([[36523],
        [36523],
        [36523],
        [36522],
        [36522],
        [36522]], device='cuda:0', dtype=torch.int32)
reshape and cache tensor([[[ 1.0303, -1.2637,  1.2246,  ...,  1.3184,  0.3813,  0.4885],
         [-0.4868, -0.8901,  0.1081,  ...,  0.4517, -0.6978, -0.3389],
         [-1.3467, -0.2759,  0.5293,  ..., -0.7568, -1.6387, -2.8613],
         ...,
         [-1.3076,  0.3958,  0.0648,  ...,  0.7837, -2.0508, -0.6279],
         [-1.9316, -0.6055, -0.7798,  ...,  0.3135,  1.0625, -0.3030],
         [-1.2188, -0.0958,  0.2793,  ...,  0.0264,  0.6553,  0.0735]],

        [[ 0.4260, -1.9180,  1.5742,  ...,  1.5400, -0.1164,  0.6235],
         [-0.9854, -0.7075,  1.3896,  ...,  0.1182, -0.0349, -2.0586],
         [-0.6372, -0.1802,  0.5410,  ...,  0.8218, -0.4307, -1.4160],
         ...,
         [-0.2693, -0.4695,  0.5786,  ...,  0.5532, -1.1787, -1.1807],
         [-2.4102, -0.1848, -0.3682,  ..., -0.4465, -0.3132,  0.1974],
         [ 1.2285, -0.7173, -0.0542,  ..., -3.4043, -1.1650, -0.4009]],

        [[ 1.1104, -1.0293,  1.1182,  ...,  1.8906, -0.0198,  0.4221],
         [-1.2061, -0.8311,  0.4019,  ..., -1.1621, -0.1141, -0.4121],
         [ 0.2627, -0.0579,  1.8740,  ..., -1.0498, -0.3467, -2.3613],
         ...,
         [-0.9233, -0.2472, -0.5381,  ..., -0.1710, -0.8232, -0.9971],
         [-2.1914, -0.7935, -1.5830,  ...,  0.0920, -0.4072, -1.0283],
         [-1.5576, -0.8306,  1.1016,  ...,  0.7988,  0.2452, -0.7461]],

        [[ 1.0303, -1.2637,  1.2246,  ...,  1.3184,  0.3813,  0.4885],
         [-0.4868, -0.8901,  0.1081,  ...,  0.4517, -0.6978, -0.3389],
         [-1.3467, -0.2759,  0.5293,  ..., -0.7568, -1.6387, -2.8613],
         ...,
         [-1.3076,  0.3958,  0.0648,  ...,  0.7837, -2.0508, -0.6279],
         [-1.9316, -0.6055, -0.7798,  ...,  0.3135,  1.0625, -0.3030],
         [-1.2188, -0.0958,  0.2793,  ...,  0.0264,  0.6553,  0.0735]],

        [[ 0.4260, -1.9180,  1.5742,  ...,  1.5400, -0.1164,  0.6235],
         [-0.9854, -0.7075,  1.3896,  ...,  0.1182, -0.0349, -2.0586],
         [-0.6372, -0.1802,  0.5410,  ...,  0.8218, -0.4307, -1.4160],
         ...,
         [-0.2693, -0.4695,  0.5786,  ...,  0.5532, -1.1787, -1.1807],
         [-2.4102, -0.1848, -0.3682,  ..., -0.4465, -0.3132,  0.1974],
         [ 1.2285, -0.7173, -0.0542,  ..., -3.4043, -1.1650, -0.4009]],

        [[ 1.1104, -1.0293,  1.1182,  ...,  1.8906, -0.0198,  0.4221],
         [-1.2061, -0.8311,  0.4019,  ..., -1.1621, -0.1141, -0.4121],
         [ 0.2627, -0.0579,  1.8740,  ..., -1.0498, -0.3467, -2.3613],
         ...,
         [-0.9233, -0.2472, -0.5381,  ..., -0.1710, -0.8232, -0.9971],
         [-2.1914, -0.7935, -1.5830,  ...,  0.0920, -0.4072, -1.0283],
         [-1.5576, -0.8306,  1.1016,  ...,  0.7988,  0.2452, -0.7461]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584370, 584371, 584372, 584354, 584355, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-1.5605e+00, -1.6094e+00,  9.2896e-02,  ..., -5.6250e-01,
           6.2354e-01, -2.1992e+00],
         [ 3.4253e-01, -5.8711e+00,  8.4473e-01,  ..., -3.2402e+00,
          -8.3008e-01,  8.2910e-01],
         [ 1.2734e+00, -1.5352e+00,  3.2422e-01,  ..., -9.0771e-01,
          -3.2715e-02, -7.1143e-01],
         ...,
         [ 9.5166e-01, -1.6279e+00, -1.5850e+00,  ..., -1.1748e+00,
          -3.4106e-01,  1.0420e+00],
         [-1.8164e+00, -3.0918e+00,  6.8408e-01,  ...,  1.9521e+00,
          -7.0361e-01,  4.6069e-01],
         [ 1.5977e+00,  8.0811e-01, -1.5605e+00,  ...,  3.8232e-01,
           3.2959e-01, -1.2012e+00]],

        [[ 1.0225e+00, -4.9878e-01, -3.5229e-03,  ..., -2.8467e-01,
           9.2627e-01, -2.0977e+00],
         [ 9.0694e-04, -1.6235e-01,  9.9805e-01,  ...,  8.6523e-01,
          -9.6875e-01,  9.7119e-01],
         [ 1.0820e+00, -1.6968e-02,  1.2976e-01,  ..., -8.6279e-01,
          -3.0444e-01, -6.8359e-01],
         ...,
         [ 1.8877e+00, -2.1855e+00, -1.8604e+00,  ...,  5.8252e-01,
          -2.0391e+00,  8.6963e-01],
         [-1.5918e+00, -2.2559e+00,  6.8164e-01,  ...,  1.9971e+00,
          -7.9102e-01, -4.5898e-01],
         [ 1.6895e+00,  3.2373e-01,  1.0820e+00,  ..., -1.6211e-01,
           1.1299e+00, -1.8965e+00]],

        [[-3.4219e+00,  1.0413e-01, -3.6068e-03,  ..., -1.0840e+00,
           1.0566e+00, -2.2266e+00],
         [-3.1055e-01, -2.7637e+00,  1.0020e+00,  ..., -9.6143e-01,
          -1.0791e+00,  1.0762e+00],
         [ 1.1006e+00, -1.5889e+00, -4.2822e-01,  ..., -1.2354e+00,
           3.8159e-01, -1.3535e+00],
         ...,
         [ 1.8906e+00, -4.0454e-01, -2.4824e+00,  ...,  3.2617e-01,
          -4.0820e-01,  8.6475e-01],
         [-4.1992e+00, -1.5273e+00,  2.6367e-01,  ...,  2.3418e+00,
          -6.4307e-01,  6.3428e-01],
         [ 1.6211e+00, -7.2656e-01, -2.9492e-01,  ..., -5.5225e-01,
           5.1270e-01, -1.3896e+00]],

        [[-1.5605e+00, -1.6094e+00,  9.2896e-02,  ..., -5.6250e-01,
           6.2354e-01, -2.1992e+00],
         [ 3.4253e-01, -5.8711e+00,  8.4473e-01,  ..., -3.2402e+00,
          -8.3008e-01,  8.2910e-01],
         [ 1.2734e+00, -1.5352e+00,  3.2422e-01,  ..., -9.0771e-01,
          -3.2715e-02, -7.1143e-01],
         ...,
         [ 9.5166e-01, -1.6279e+00, -1.5850e+00,  ..., -1.1748e+00,
          -3.4106e-01,  1.0420e+00],
         [-1.8164e+00, -3.0918e+00,  6.8408e-01,  ...,  1.9521e+00,
          -7.0361e-01,  4.6069e-01],
         [ 1.5977e+00,  8.0811e-01, -1.5605e+00,  ...,  3.8232e-01,
           3.2959e-01, -1.2012e+00]],

        [[ 1.0225e+00, -4.9878e-01, -3.5229e-03,  ..., -2.8467e-01,
           9.2627e-01, -2.0977e+00],
         [ 9.0694e-04, -1.6235e-01,  9.9805e-01,  ...,  8.6523e-01,
          -9.6875e-01,  9.7119e-01],
         [ 1.0820e+00, -1.6968e-02,  1.2976e-01,  ..., -8.6279e-01,
          -3.0444e-01, -6.8359e-01],
         ...,
         [ 1.8877e+00, -2.1855e+00, -1.8604e+00,  ...,  5.8252e-01,
          -2.0391e+00,  8.6963e-01],
         [-1.5918e+00, -2.2559e+00,  6.8164e-01,  ...,  1.9971e+00,
          -7.9102e-01, -4.5898e-01],
         [ 1.6895e+00,  3.2373e-01,  1.0820e+00,  ..., -1.6211e-01,
           1.1299e+00, -1.8965e+00]],

        [[-3.4219e+00,  1.0413e-01, -3.6068e-03,  ..., -1.0840e+00,
           1.0566e+00, -2.2266e+00],
         [-3.1055e-01, -2.7637e+00,  1.0020e+00,  ..., -9.6143e-01,
          -1.0791e+00,  1.0762e+00],
         [ 1.1006e+00, -1.5889e+00, -4.2822e-01,  ..., -1.2354e+00,
           3.8159e-01, -1.3535e+00],
         ...,
         [ 1.8906e+00, -4.0454e-01, -2.4824e+00,  ...,  3.2617e-01,
          -4.0820e-01,  8.6475e-01],
         [-4.1992e+00, -1.5273e+00,  2.6367e-01,  ...,  2.3418e+00,
          -6.4307e-01,  6.3428e-01],
         [ 1.6211e+00, -7.2656e-01, -2.9492e-01,  ..., -5.5225e-01,
           5.1270e-01, -1.3896e+00]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584370, 584371, 584372, 584354, 584355, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[ 1.1377e+00,  2.8848e+00,  4.7656e+00,  ...,  1.2275e+00,
           7.5879e-01,  2.5659e-01],
         [-1.0928e+00,  3.2997e-03,  2.5883e-03,  ..., -1.9912e+00,
           1.1172e+00,  2.7979e-01],
         [ 1.5186e+00,  7.6172e-01,  6.7041e-01,  ..., -1.6494e+00,
           1.1367e+00,  2.1172e+00],
         ...,
         [-8.8684e-02,  2.0039e+00,  4.2310e-01,  ...,  9.8193e-01,
          -1.0049e+00,  8.7036e-02],
         [-4.5337e-01,  4.3628e-01,  3.3521e-01,  ..., -6.8555e-01,
          -4.5312e+00,  9.7266e-01],
         [-1.7979e+00, -1.7441e+00, -2.0156e+00,  ...,  8.9600e-01,
           8.3301e-01, -4.1275e-03]],

        [[ 5.2783e-01,  7.8223e-01,  3.2109e+00,  ...,  1.0723e+00,
           1.4238e+00,  1.1035e-01],
         [-2.3828e+00,  1.1963e+00,  4.0308e-01,  ...,  6.5137e-01,
           1.9648e+00,  1.3516e+00],
         [ 1.1514e+00,  3.0591e-01,  2.0254e+00,  ..., -5.2686e-01,
          -3.0869e-02,  4.1260e-01],
         ...,
         [-3.5156e-01,  2.5938e+00,  5.2979e-01,  ...,  4.7461e-01,
           2.1465e+00, -9.2432e-01],
         [-1.7456e-01,  1.3262e+00, -3.3276e-01,  ..., -1.5088e+00,
          -3.9629e+00, -4.8682e-01],
         [-1.4673e-01, -7.0410e-01, -2.5898e+00,  ...,  1.1221e+00,
           6.5381e-01, -1.6299e+00]],

        [[-5.1849e-02,  3.8809e+00,  3.9727e+00,  ...,  8.5449e-01,
           1.4072e+00,  5.2686e-01],
         [-1.3086e+00, -2.2888e-01,  8.5156e-01,  ...,  1.2148e+00,
           2.3613e+00,  1.2783e+00],
         [ 1.4619e+00, -3.4607e-02,  1.7656e+00,  ..., -5.4980e-01,
           1.6248e-01,  1.2305e+00],
         ...,
         [-3.7720e-01,  1.0059e+00,  4.9780e-01,  ...,  6.6016e-01,
          -1.1299e+00,  2.4141e+00],
         [-3.0054e-01, -2.2791e-01, -7.5244e-01,  ..., -1.2822e+00,
          -4.3281e+00, -1.1152e+00],
         [-8.0811e-01, -4.7119e-01, -2.3086e+00,  ...,  9.2139e-01,
           7.1240e-01, -6.5381e-01]],

        [[ 1.1377e+00,  2.8848e+00,  4.7656e+00,  ...,  1.2275e+00,
           7.5879e-01,  2.5659e-01],
         [-1.0928e+00,  3.2997e-03,  2.5883e-03,  ..., -1.9912e+00,
           1.1172e+00,  2.7979e-01],
         [ 1.5186e+00,  7.6172e-01,  6.7041e-01,  ..., -1.6494e+00,
           1.1367e+00,  2.1172e+00],
         ...,
         [-8.8684e-02,  2.0039e+00,  4.2310e-01,  ...,  9.8193e-01,
          -1.0049e+00,  8.7036e-02],
         [-4.5337e-01,  4.3628e-01,  3.3521e-01,  ..., -6.8555e-01,
          -4.5312e+00,  9.7266e-01],
         [-1.7979e+00, -1.7441e+00, -2.0156e+00,  ...,  8.9600e-01,
           8.3301e-01, -4.1275e-03]],

        [[ 5.2783e-01,  7.8223e-01,  3.2109e+00,  ...,  1.0723e+00,
           1.4238e+00,  1.1035e-01],
         [-2.3828e+00,  1.1963e+00,  4.0308e-01,  ...,  6.5137e-01,
           1.9648e+00,  1.3516e+00],
         [ 1.1514e+00,  3.0591e-01,  2.0254e+00,  ..., -5.2686e-01,
          -3.0869e-02,  4.1260e-01],
         ...,
         [-3.5156e-01,  2.5938e+00,  5.2979e-01,  ...,  4.7461e-01,
           2.1465e+00, -9.2432e-01],
         [-1.7456e-01,  1.3262e+00, -3.3276e-01,  ..., -1.5088e+00,
          -3.9629e+00, -4.8682e-01],
         [-1.4673e-01, -7.0410e-01, -2.5898e+00,  ...,  1.1221e+00,
           6.5381e-01, -1.6299e+00]],

        [[-5.1849e-02,  3.8809e+00,  3.9727e+00,  ...,  8.5449e-01,
           1.4072e+00,  5.2686e-01],
         [-1.3086e+00, -2.2888e-01,  8.5156e-01,  ...,  1.2148e+00,
           2.3613e+00,  1.2783e+00],
         [ 1.4619e+00, -3.4607e-02,  1.7656e+00,  ..., -5.4980e-01,
           1.6248e-01,  1.2305e+00],
         ...,
         [-3.7720e-01,  1.0059e+00,  4.9780e-01,  ...,  6.6016e-01,
          -1.1299e+00,  2.4141e+00],
         [-3.0054e-01, -2.2791e-01, -7.5244e-01,  ..., -1.2822e+00,
          -4.3281e+00, -1.1152e+00],
         [-8.0811e-01, -4.7119e-01, -2.3086e+00,  ...,  9.2139e-01,
           7.1240e-01, -6.5381e-01]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584370, 584371, 584372, 584354, 584355, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-2.9541e-01, -2.3262e+00, -3.2637e+00,  ...,  9.6289e-01,
           8.9990e-01,  7.0703e-01],
         [ 1.2666e+00, -1.8193e+00, -2.2070e+00,  ..., -3.1465e+00,
          -3.4258e+00, -2.7197e-01],
         [ 5.6519e-02, -2.3438e+00, -2.1426e+00,  ..., -1.6885e+00,
           1.7725e+00,  4.9487e-01],
         ...,
         [-2.1191e+00, -1.5684e+00,  1.3145e+00,  ..., -2.2305e+00,
          -1.9980e+00, -3.0586e+00],
         [ 8.7402e-01, -8.1543e-01, -7.1484e-01,  ...,  1.3066e+00,
          -8.1152e-01, -3.3125e+00],
         [-1.2988e+00, -6.3428e-01, -1.0596e+00,  ...,  4.1968e-01,
           2.1814e-01,  8.6328e-01]],

        [[-9.9268e-01, -2.3008e+00, -3.6504e+00,  ...,  8.1982e-01,
           1.9844e+00,  5.6787e-01],
         [ 2.0137e+00, -1.7266e+00, -2.2871e+00,  ..., -3.8906e+00,
          -1.9512e+00, -2.2656e-01],
         [ 5.1562e-01, -2.8398e+00, -1.3301e+00,  ..., -1.9307e+00,
           1.0576e+00,  1.5796e-01],
         ...,
         [-3.9453e-01, -7.2412e-01,  4.1870e-01,  ..., -1.9971e+00,
          -5.7861e-01, -4.1562e+00],
         [-4.2175e-02,  6.7871e-01, -3.1757e-03,  ...,  1.0283e+00,
          -1.1348e+00, -3.5762e+00],
         [-9.9854e-01, -4.3457e-01, -1.4971e+00,  ...,  1.7939e+00,
          -2.2083e-01,  1.9653e-02]],

        [[-1.6172e+00, -2.4922e+00, -3.0977e+00,  ...,  8.5107e-01,
           1.0244e+00,  5.6836e-01],
         [ 9.1748e-01, -2.1465e+00, -1.5869e+00,  ..., -3.4512e+00,
          -3.0059e+00, -8.9551e-01],
         [-8.3801e-02, -2.8418e+00, -1.6182e+00,  ..., -1.9375e+00,
           4.6362e-01,  4.0649e-01],
         ...,
         [-1.1445e+00, -6.4307e-01,  4.1284e-01,  ..., -8.8477e-01,
          -3.2910e-01, -2.6035e+00],
         [ 3.6816e-01,  3.4546e-01, -2.1826e-01,  ...,  1.2891e+00,
          -1.2334e+00, -3.2207e+00],
         [ 2.0977e+00, -2.0781e+00, -1.0127e+00,  ...,  1.1172e+00,
           1.4795e-01,  3.0977e+00]],

        [[-2.9541e-01, -2.3262e+00, -3.2637e+00,  ...,  9.6289e-01,
           8.9990e-01,  7.0703e-01],
         [ 1.2666e+00, -1.8193e+00, -2.2070e+00,  ..., -3.1465e+00,
          -3.4258e+00, -2.7197e-01],
         [ 5.6519e-02, -2.3438e+00, -2.1426e+00,  ..., -1.6885e+00,
           1.7725e+00,  4.9487e-01],
         ...,
         [-2.1191e+00, -1.5684e+00,  1.3145e+00,  ..., -2.2305e+00,
          -1.9980e+00, -3.0586e+00],
         [ 8.7402e-01, -8.1543e-01, -7.1484e-01,  ...,  1.3066e+00,
          -8.1152e-01, -3.3125e+00],
         [-1.2988e+00, -6.3428e-01, -1.0596e+00,  ...,  4.1968e-01,
           2.1814e-01,  8.6328e-01]],

        [[-9.9268e-01, -2.3008e+00, -3.6504e+00,  ...,  8.1982e-01,
           1.9844e+00,  5.6787e-01],
         [ 2.0137e+00, -1.7266e+00, -2.2871e+00,  ..., -3.8906e+00,
          -1.9512e+00, -2.2656e-01],
         [ 5.1562e-01, -2.8398e+00, -1.3301e+00,  ..., -1.9307e+00,
           1.0576e+00,  1.5796e-01],
         ...,
         [-3.9453e-01, -7.2412e-01,  4.1870e-01,  ..., -1.9971e+00,
          -5.7861e-01, -4.1562e+00],
         [-4.2175e-02,  6.7871e-01, -3.1757e-03,  ...,  1.0283e+00,
          -1.1348e+00, -3.5762e+00],
         [-9.9854e-01, -4.3457e-01, -1.4971e+00,  ...,  1.7939e+00,
          -2.2083e-01,  1.9653e-02]],

        [[-1.6172e+00, -2.4922e+00, -3.0977e+00,  ...,  8.5107e-01,
           1.0244e+00,  5.6836e-01],
         [ 9.1748e-01, -2.1465e+00, -1.5869e+00,  ..., -3.4512e+00,
          -3.0059e+00, -8.9551e-01],
         [-8.3801e-02, -2.8418e+00, -1.6182e+00,  ..., -1.9375e+00,
           4.6362e-01,  4.0649e-01],
         ...,
         [-1.1445e+00, -6.4307e-01,  4.1284e-01,  ..., -8.8477e-01,
          -3.2910e-01, -2.6035e+00],
         [ 3.6816e-01,  3.4546e-01, -2.1826e-01,  ...,  1.2891e+00,
          -1.2334e+00, -3.2207e+00],
         [ 2.0977e+00, -2.0781e+00, -1.0127e+00,  ...,  1.1172e+00,
           1.4795e-01,  3.0977e+00]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584370, 584371, 584372, 584354, 584355, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-0.1516,  0.3940,  0.3889,  ...,  0.8530,  2.1953, -0.4319],
         [-1.1631, -0.4460, -0.2330,  ...,  1.0693,  0.2128, -1.1348],
         [ 1.1201,  0.7817,  2.0078,  ...,  0.6758, -0.8721, -3.0137],
         ...,
         [-1.2373,  0.5303, -3.7852,  ...,  0.4058,  1.6123, -3.5938],
         [ 3.1953,  0.1598,  0.2532,  ..., -0.0783, -2.7109,  1.3789],
         [-3.3027, -0.1547, -0.8608,  ...,  0.1913,  2.1348, -0.4844]],

        [[-1.7305, -1.8154, -0.3181,  ...,  0.5190,  1.8887, -0.4744],
         [-2.4805,  0.8311,  0.3691,  ...,  0.7915,  0.9868, -1.1113],
         [ 0.8057,  0.7783,  1.0410,  ...,  0.4800,  0.5020, -3.1152],
         ...,
         [-0.7563, -0.4146, -4.5352,  ...,  0.4734,  1.3848, -2.6504],
         [ 2.7656,  2.3047,  0.0313,  ..., -1.0039, -0.1184,  2.3184],
         [-3.1621, -0.5498, -0.4597,  ..., -0.0950,  0.6753, -0.5449]],

        [[-1.0469, -1.3086,  0.4819,  ...,  0.6055,  1.9004, -1.1084],
         [-1.3604,  0.1569, -0.4314,  ...,  1.0029, -0.2600, -0.4651],
         [-0.0847,  1.0664,  3.0586,  ...,  1.3691, -0.3965, -2.7441],
         ...,
         [-1.9189, -0.8828, -4.1289,  ...,  0.2729,  0.8081, -1.1592],
         [ 3.5234,  1.1689, -0.2939,  ...,  0.4885, -0.1453,  1.5596],
         [-3.5605, -1.2881,  0.6792,  ..., -0.4395,  0.5386, -1.6025]],

        [[-0.1516,  0.3940,  0.3889,  ...,  0.8530,  2.1953, -0.4319],
         [-1.1631, -0.4460, -0.2330,  ...,  1.0693,  0.2128, -1.1348],
         [ 1.1201,  0.7817,  2.0078,  ...,  0.6758, -0.8721, -3.0137],
         ...,
         [-1.2373,  0.5303, -3.7852,  ...,  0.4058,  1.6123, -3.5938],
         [ 3.1953,  0.1598,  0.2532,  ..., -0.0783, -2.7109,  1.3789],
         [-3.3027, -0.1547, -0.8608,  ...,  0.1913,  2.1348, -0.4844]],

        [[-1.7305, -1.8154, -0.3181,  ...,  0.5190,  1.8887, -0.4744],
         [-2.4805,  0.8311,  0.3691,  ...,  0.7915,  0.9868, -1.1113],
         [ 0.8057,  0.7783,  1.0410,  ...,  0.4800,  0.5020, -3.1152],
         ...,
         [-0.7563, -0.4146, -4.5352,  ...,  0.4734,  1.3848, -2.6504],
         [ 2.7656,  2.3047,  0.0313,  ..., -1.0039, -0.1184,  2.3184],
         [-3.1621, -0.5498, -0.4597,  ..., -0.0950,  0.6753, -0.5449]],

        [[-1.0469, -1.3086,  0.4819,  ...,  0.6055,  1.9004, -1.1084],
         [-1.3604,  0.1569, -0.4314,  ...,  1.0029, -0.2600, -0.4651],
         [-0.0847,  1.0664,  3.0586,  ...,  1.3691, -0.3965, -2.7441],
         ...,
         [-1.9189, -0.8828, -4.1289,  ...,  0.2729,  0.8081, -1.1592],
         [ 3.5234,  1.1689, -0.2939,  ...,  0.4885, -0.1453,  1.5596],
         [-3.5605, -1.2881,  0.6792,  ..., -0.4395,  0.5386, -1.6025]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584370, 584371, 584372, 584354, 584355, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[ 1.0986, -1.4365, -0.4243,  ..., -0.6426,  2.5039, -0.7617],
         [-0.7354, -1.3164,  1.8838,  ...,  1.1562, -3.2793,  2.8047],
         [-2.8691, -0.6128, -0.4250,  ..., -0.7041,  0.9692, -2.4414],
         ...,
         [ 0.4834,  0.5586, -2.1875,  ..., -1.4512, -2.7969, -0.5649],
         [ 0.9873, -2.7129,  2.8438,  ...,  1.1895, -0.1633, -0.2781],
         [-1.7383,  1.6709,  0.9448,  ..., -1.0674,  0.2482, -0.6606]],

        [[ 1.0361, -0.1884, -0.0922,  ..., -2.6074,  2.2383, -0.8540],
         [-0.7119, -2.3516,  1.8535,  ...,  2.5625, -2.2246,  1.9648],
         [-1.1846,  1.5479, -0.4895,  ..., -1.3291,  0.0897, -1.0479],
         ...,
         [ 0.3105, -0.3535, -2.3027,  ..., -2.7578, -2.9395,  0.0296],
         [ 0.2133, -2.3027,  1.9404,  ...,  1.6299, -0.0685, -0.1898],
         [-1.1689, -0.1227,  2.3340,  ..., -0.9575,  0.2661, -0.5103]],

        [[ 1.0742, -1.5400, -0.3716,  ..., -2.7617,  1.6299, -0.9546],
         [-1.4619, -1.2705,  3.2461,  ...,  1.3623, -2.1934,  2.7988],
         [ 0.0055,  0.7046, -1.2383,  ..., -0.7134,  0.1200, -1.6885],
         ...,
         [ 0.4065,  0.3210, -1.2012,  ..., -1.4717, -2.9531, -0.3274],
         [ 1.2920, -2.2754,  1.4082,  ...,  1.4756, -0.4131,  0.6230],
         [-0.8589,  0.3193,  3.5664,  ..., -1.0127,  0.0452, -0.6445]],

        [[ 1.0986, -1.4365, -0.4243,  ..., -0.6426,  2.5039, -0.7617],
         [-0.7354, -1.3164,  1.8838,  ...,  1.1562, -3.2793,  2.8047],
         [-2.8691, -0.6128, -0.4250,  ..., -0.7041,  0.9692, -2.4414],
         ...,
         [ 0.4834,  0.5586, -2.1875,  ..., -1.4512, -2.7969, -0.5649],
         [ 0.9873, -2.7129,  2.8438,  ...,  1.1895, -0.1633, -0.2781],
         [-1.7383,  1.6709,  0.9448,  ..., -1.0674,  0.2482, -0.6606]],

        [[ 1.0361, -0.1884, -0.0922,  ..., -2.6074,  2.2383, -0.8540],
         [-0.7119, -2.3516,  1.8535,  ...,  2.5625, -2.2246,  1.9648],
         [-1.1846,  1.5479, -0.4895,  ..., -1.3291,  0.0897, -1.0479],
         ...,
         [ 0.3105, -0.3535, -2.3027,  ..., -2.7578, -2.9395,  0.0296],
         [ 0.2133, -2.3027,  1.9404,  ...,  1.6299, -0.0685, -0.1898],
         [-1.1689, -0.1227,  2.3340,  ..., -0.9575,  0.2661, -0.5103]],

        [[ 1.0742, -1.5400, -0.3716,  ..., -2.7617,  1.6299, -0.9546],
         [-1.4619, -1.2705,  3.2461,  ...,  1.3623, -2.1934,  2.7988],
         [ 0.0055,  0.7046, -1.2383,  ..., -0.7134,  0.1200, -1.6885],
         ...,
         [ 0.4065,  0.3210, -1.2012,  ..., -1.4717, -2.9531, -0.3274],
         [ 1.2920, -2.2754,  1.4082,  ...,  1.4756, -0.4131,  0.6230],
         [-0.8589,  0.3193,  3.5664,  ..., -1.0127,  0.0452, -0.6445]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584370, 584371, 584372, 584354, 584355, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-5.9180e-01, -4.2090e-01, -1.5308e-01,  ...,  9.6680e-02,
          -3.2832e+00,  3.5879e+00],
         [ 1.5967e+00,  7.7734e-01, -1.2744e+00,  ..., -7.5781e-01,
           5.5176e-01, -1.6797e+00],
         [ 1.5146e+00,  3.3027e+00, -3.1094e+00,  ..., -7.8918e-02,
          -1.4072e+00, -4.0479e-01],
         ...,
         [ 1.7393e+00, -5.2500e+00,  1.1982e+00,  ...,  6.6699e-01,
          -2.4063e-02,  1.6562e+00],
         [ 1.6943e+00,  6.8506e-01,  1.7031e+00,  ..., -8.1152e-01,
           1.2561e-01,  3.0981e-01],
         [ 1.1884e-01, -1.5996e+00, -4.8535e-01,  ...,  2.3438e+00,
          -7.3438e-01,  7.5684e-01]],

        [[-9.3164e-01, -1.8857e+00, -1.2412e+00,  ..., -8.3398e-01,
          -3.0098e+00,  4.1914e+00],
         [ 1.1475e+00, -5.7666e-01, -1.4482e+00,  ..., -1.1445e+00,
          -1.3132e-03, -1.4570e+00],
         [ 1.5098e+00,  3.3516e+00, -2.7109e+00,  ...,  1.0020e+00,
          -6.5723e-01, -2.6636e-01],
         ...,
         [ 1.4971e+00, -5.7656e+00,  2.5464e-01,  ..., -3.6469e-02,
           1.3440e-01,  1.0801e+00],
         [ 1.9570e+00,  1.6953e+00,  1.2705e+00,  ..., -2.0156e+00,
           2.7100e-01,  3.4106e-01],
         [ 8.4424e-01, -1.0205e+00,  1.9250e-01,  ...,  2.8105e+00,
          -1.7783e+00,  1.1543e+00]],

        [[-1.6514e+00, -1.2080e+00, -1.3213e+00,  ..., -2.2188e+00,
          -2.6504e+00,  3.2383e+00],
         [ 3.8306e-01, -3.7231e-01, -2.7148e-01,  ...,  1.3770e-01,
           1.5771e-01, -1.7529e+00],
         [ 1.0566e+00,  3.7266e+00, -3.4551e+00,  ...,  3.9893e-01,
          -8.1543e-01,  7.7148e-01],
         ...,
         [ 3.3081e-01, -4.6641e+00,  1.3057e+00,  ...,  3.9368e-02,
           6.5137e-01,  4.2505e-01],
         [ 2.6914e+00,  1.8721e+00,  1.0635e+00,  ..., -1.4453e+00,
          -1.5918e-01,  7.1729e-01],
         [ 5.6152e-01, -6.3574e-01,  6.1475e-01,  ...,  2.4922e+00,
          -7.2949e-01,  8.3691e-01]],

        [[-5.9180e-01, -4.2090e-01, -1.5308e-01,  ...,  9.6680e-02,
          -3.2832e+00,  3.5879e+00],
         [ 1.5967e+00,  7.7734e-01, -1.2744e+00,  ..., -7.5781e-01,
           5.5176e-01, -1.6797e+00],
         [ 1.5146e+00,  3.3027e+00, -3.1094e+00,  ..., -7.8918e-02,
          -1.4072e+00, -4.0479e-01],
         ...,
         [ 1.7393e+00, -5.2500e+00,  1.1982e+00,  ...,  6.6699e-01,
          -2.4063e-02,  1.6562e+00],
         [ 1.6943e+00,  6.8506e-01,  1.7031e+00,  ..., -8.1152e-01,
           1.2561e-01,  3.0981e-01],
         [ 1.1884e-01, -1.5996e+00, -4.8535e-01,  ...,  2.3438e+00,
          -7.3438e-01,  7.5684e-01]],

        [[-9.3164e-01, -1.8857e+00, -1.2412e+00,  ..., -8.3398e-01,
          -3.0098e+00,  4.1914e+00],
         [ 1.1475e+00, -5.7666e-01, -1.4482e+00,  ..., -1.1445e+00,
          -1.3132e-03, -1.4570e+00],
         [ 1.5098e+00,  3.3516e+00, -2.7109e+00,  ...,  1.0020e+00,
          -6.5723e-01, -2.6636e-01],
         ...,
         [ 1.4971e+00, -5.7656e+00,  2.5464e-01,  ..., -3.6469e-02,
           1.3440e-01,  1.0801e+00],
         [ 1.9570e+00,  1.6953e+00,  1.2705e+00,  ..., -2.0156e+00,
           2.7100e-01,  3.4106e-01],
         [ 8.4424e-01, -1.0205e+00,  1.9250e-01,  ...,  2.8105e+00,
          -1.7783e+00,  1.1543e+00]],

        [[-1.6514e+00, -1.2080e+00, -1.3213e+00,  ..., -2.2188e+00,
          -2.6504e+00,  3.2383e+00],
         [ 3.8306e-01, -3.7231e-01, -2.7148e-01,  ...,  1.3770e-01,
           1.5771e-01, -1.7529e+00],
         [ 1.0566e+00,  3.7266e+00, -3.4551e+00,  ...,  3.9893e-01,
          -8.1543e-01,  7.7148e-01],
         ...,
         [ 3.3081e-01, -4.6641e+00,  1.3057e+00,  ...,  3.9368e-02,
           6.5137e-01,  4.2505e-01],
         [ 2.6914e+00,  1.8721e+00,  1.0635e+00,  ..., -1.4453e+00,
          -1.5918e-01,  7.1729e-01],
         [ 5.6152e-01, -6.3574e-01,  6.1475e-01,  ...,  2.4922e+00,
          -7.2949e-01,  8.3691e-01]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584370, 584371, 584372, 584354, 584355, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-0.9673, -0.1987, -0.1614,  ...,  2.6094, -1.0859, -0.2979],
         [-1.8789,  0.6616, -1.7041,  ..., -0.8052,  0.8740, -1.3438],
         [ 0.2037,  0.1265,  0.0914,  ..., -0.3037, -1.1338,  1.4658],
         ...,
         [ 2.1406, -6.0234,  1.5488,  ..., -2.7012,  1.0908,  5.6133],
         [ 0.7861,  1.1143,  0.3879,  ..., -0.9702,  0.1819,  1.1729],
         [-1.1152, -0.1910,  0.1936,  ..., -1.0811, -0.4192, -1.2588]],

        [[-0.7095,  0.2939, -2.5039,  ...,  2.1211, -1.1152, -0.9663],
         [-2.3965,  0.3447, -0.4385,  ..., -0.6978,  1.2910, -2.0176],
         [ 0.3469, -0.3567,  0.6660,  ..., -0.9990,  0.2595,  2.3613],
         ...,
         [ 1.5752, -6.2617,  0.8252,  ..., -2.1035,  0.2615,  7.0273],
         [ 0.8745,  1.1162,  0.5239,  ..., -1.5498,  0.2123,  1.2090],
         [-1.5156,  0.4360,  1.1396,  ..., -0.6934, -1.5215, -0.8926]],

        [[-2.0664, -0.7910, -3.0176,  ...,  0.8965, -1.4395,  2.0215],
         [-1.6172, -0.7007, -1.3633,  ..., -0.2607,  0.1185, -1.0137],
         [ 2.0293, -0.2181, -0.5957,  ..., -1.1113, -0.2876,  2.0977],
         ...,
         [ 1.2188, -5.8828,  0.7964,  ..., -2.6426,  0.7529,  6.9531],
         [ 1.7656,  0.8281,  0.9365,  ..., -2.4316,  0.7373,  2.1836],
         [-0.4858, -0.3130,  0.5391,  ..., -0.4128, -0.4124,  0.1115]],

        [[-0.9673, -0.1987, -0.1614,  ...,  2.6094, -1.0859, -0.2979],
         [-1.8789,  0.6616, -1.7041,  ..., -0.8052,  0.8740, -1.3438],
         [ 0.2037,  0.1265,  0.0914,  ..., -0.3037, -1.1338,  1.4658],
         ...,
         [ 2.1406, -6.0234,  1.5488,  ..., -2.7012,  1.0908,  5.6133],
         [ 0.7861,  1.1143,  0.3879,  ..., -0.9702,  0.1819,  1.1729],
         [-1.1152, -0.1910,  0.1936,  ..., -1.0811, -0.4192, -1.2588]],

        [[-0.7095,  0.2939, -2.5039,  ...,  2.1211, -1.1152, -0.9663],
         [-2.3965,  0.3447, -0.4385,  ..., -0.6978,  1.2910, -2.0176],
         [ 0.3469, -0.3567,  0.6660,  ..., -0.9990,  0.2595,  2.3613],
         ...,
         [ 1.5752, -6.2617,  0.8252,  ..., -2.1035,  0.2615,  7.0273],
         [ 0.8745,  1.1162,  0.5239,  ..., -1.5498,  0.2123,  1.2090],
         [-1.5156,  0.4360,  1.1396,  ..., -0.6934, -1.5215, -0.8926]],

        [[-2.0664, -0.7910, -3.0176,  ...,  0.8965, -1.4395,  2.0215],
         [-1.6172, -0.7007, -1.3633,  ..., -0.2607,  0.1185, -1.0137],
         [ 2.0293, -0.2181, -0.5957,  ..., -1.1113, -0.2876,  2.0977],
         ...,
         [ 1.2188, -5.8828,  0.7964,  ..., -2.6426,  0.7529,  6.9531],
         [ 1.7656,  0.8281,  0.9365,  ..., -2.4316,  0.7373,  2.1836],
         [-0.4858, -0.3130,  0.5391,  ..., -0.4128, -0.4124,  0.1115]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584370, 584371, 584372, 584354, 584355, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-3.4844, -1.2246, -1.1904,  ...,  0.0693, -1.1025,  0.9263],
         [-3.0332,  0.7280,  2.4180,  ...,  0.1005, -1.7090, -1.4023],
         [-1.2705, -1.5283,  4.5117,  ...,  1.1328, -0.5815, -0.0104],
         ...,
         [ 1.9141,  0.4617,  0.6553,  ..., -0.8223,  0.0142, -1.0146],
         [ 0.9214,  1.3330,  0.3230,  ...,  0.1400,  0.3252, -0.9746],
         [-0.3845,  1.8730, -0.6851,  ...,  2.2168,  1.2080, -0.9189]],

        [[-1.1270, -0.1691, -0.6060,  ..., -0.7686, -0.4312, -0.1769],
         [-1.3838,  1.2227,  2.9141,  ...,  0.5977, -1.6660, -0.2651],
         [-1.4092, -1.6631,  3.3105,  ...,  0.6333, -0.3398, -1.0049],
         ...,
         [ 2.0020,  0.8359,  0.9868,  ..., -0.6641,  0.2578, -2.0703],
         [ 0.7227, -0.3406, -0.5518,  ..., -0.2534, -0.1475, -0.5640],
         [-0.8022,  2.3184, -0.9023,  ...,  2.7227,  1.2129, -1.0088]],

        [[-1.6074, -0.6079, -0.8218,  ..., -0.2377,  0.3247,  0.7129],
         [-1.6914,  1.3320,  3.1621,  ...,  0.5698, -0.5269,  0.7183],
         [-1.5273, -1.8701,  2.7441,  ...,  1.6064, -0.5254, -0.6489],
         ...,
         [ 1.4170,  1.4375,  0.6958,  ...,  0.3608, -0.2186, -1.6963],
         [ 0.6982,  0.2456, -1.4619,  ...,  0.6377, -0.4241, -1.2275],
         [-1.1260,  1.8965,  0.1986,  ...,  2.4492,  0.7944, -1.9277]],

        [[-3.4844, -1.2246, -1.1904,  ...,  0.0693, -1.1025,  0.9263],
         [-3.0332,  0.7280,  2.4180,  ...,  0.1005, -1.7090, -1.4023],
         [-1.2705, -1.5283,  4.5117,  ...,  1.1328, -0.5815, -0.0104],
         ...,
         [ 1.9141,  0.4617,  0.6553,  ..., -0.8223,  0.0142, -1.0146],
         [ 0.9214,  1.3330,  0.3230,  ...,  0.1400,  0.3252, -0.9746],
         [-0.3845,  1.8730, -0.6851,  ...,  2.2168,  1.2080, -0.9189]],

        [[-1.1270, -0.1691, -0.6060,  ..., -0.7686, -0.4312, -0.1769],
         [-1.3838,  1.2227,  2.9141,  ...,  0.5977, -1.6660, -0.2651],
         [-1.4092, -1.6631,  3.3105,  ...,  0.6333, -0.3398, -1.0049],
         ...,
         [ 2.0020,  0.8359,  0.9868,  ..., -0.6641,  0.2578, -2.0703],
         [ 0.7227, -0.3406, -0.5518,  ..., -0.2534, -0.1475, -0.5640],
         [-0.8022,  2.3184, -0.9023,  ...,  2.7227,  1.2129, -1.0088]],

        [[-1.6074, -0.6079, -0.8218,  ..., -0.2377,  0.3247,  0.7129],
         [-1.6914,  1.3320,  3.1621,  ...,  0.5698, -0.5269,  0.7183],
         [-1.5273, -1.8701,  2.7441,  ...,  1.6064, -0.5254, -0.6489],
         ...,
         [ 1.4170,  1.4375,  0.6958,  ...,  0.3608, -0.2186, -1.6963],
         [ 0.6982,  0.2456, -1.4619,  ...,  0.6377, -0.4241, -1.2275],
         [-1.1260,  1.8965,  0.1986,  ...,  2.4492,  0.7944, -1.9277]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584370, 584371, 584372, 584354, 584355, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[ 0.6484, -0.7271,  0.8457,  ..., -0.3376,  0.2421, -1.8174],
         [ 0.6650, -0.3599, -0.2141,  ..., -2.3027, -1.7559,  0.8140],
         [ 0.3914,  1.7676,  1.9951,  ..., -1.4707, -0.9893, -1.0215],
         ...,
         [-1.8477,  0.4824, -0.5718,  ..., -0.9902, -0.2189, -0.5845],
         [ 0.4717, -0.7158, -1.1201,  ..., -0.3521,  1.1934,  0.2715],
         [ 0.2498,  0.6426, -2.2656,  ...,  1.3105,  0.6821, -1.5596]],

        [[ 0.9663,  0.3933,  0.8076,  ..., -0.4736, -0.7319, -1.8594],
         [-0.8433, -1.1338, -0.6782,  ..., -3.1250, -0.7178,  0.0272],
         [ 0.5239, -0.1713,  1.2217,  ...,  0.1193,  0.1584, -1.1318],
         ...,
         [-2.3223,  0.7954, -0.8428,  ..., -1.7764,  0.4019, -1.0459],
         [ 0.8765,  0.7676, -1.0107,  ...,  0.3413,  0.6299,  0.1770],
         [ 0.0630,  0.8613, -1.3477,  ...,  0.5459, -0.0178, -0.7925]],

        [[ 0.1923,  0.8770, -0.6963,  ...,  0.1460, -0.4778, -2.1055],
         [-1.5732, -1.1787, -0.6387,  ..., -1.7578, -1.1670, -0.3892],
         [ 0.3623,  0.7852,  2.8984,  ..., -0.9937,  0.4253, -0.9985],
         ...,
         [-1.2480,  0.9722, -0.4834,  ..., -1.1875,  0.6377, -1.5566],
         [ 0.5005,  0.0949, -1.7559,  ...,  0.6709,  1.3916,  0.8276],
         [-0.7793,  0.8555, -1.5928,  ...,  1.3896,  0.6318, -0.9214]],

        [[ 0.6484, -0.7271,  0.8457,  ..., -0.3376,  0.2421, -1.8174],
         [ 0.6650, -0.3599, -0.2141,  ..., -2.3027, -1.7559,  0.8140],
         [ 0.3914,  1.7676,  1.9951,  ..., -1.4707, -0.9893, -1.0215],
         ...,
         [-1.8477,  0.4824, -0.5718,  ..., -0.9902, -0.2189, -0.5845],
         [ 0.4717, -0.7158, -1.1201,  ..., -0.3521,  1.1934,  0.2715],
         [ 0.2498,  0.6426, -2.2656,  ...,  1.3105,  0.6821, -1.5596]],

        [[ 0.9663,  0.3933,  0.8076,  ..., -0.4736, -0.7319, -1.8594],
         [-0.8433, -1.1338, -0.6782,  ..., -3.1250, -0.7178,  0.0272],
         [ 0.5239, -0.1713,  1.2217,  ...,  0.1193,  0.1584, -1.1318],
         ...,
         [-2.3223,  0.7954, -0.8428,  ..., -1.7764,  0.4019, -1.0459],
         [ 0.8765,  0.7676, -1.0107,  ...,  0.3413,  0.6299,  0.1770],
         [ 0.0630,  0.8613, -1.3477,  ...,  0.5459, -0.0178, -0.7925]],

        [[ 0.1923,  0.8770, -0.6963,  ...,  0.1460, -0.4778, -2.1055],
         [-1.5732, -1.1787, -0.6387,  ..., -1.7578, -1.1670, -0.3892],
         [ 0.3623,  0.7852,  2.8984,  ..., -0.9937,  0.4253, -0.9985],
         ...,
         [-1.2480,  0.9722, -0.4834,  ..., -1.1875,  0.6377, -1.5566],
         [ 0.5005,  0.0949, -1.7559,  ...,  0.6709,  1.3916,  0.8276],
         [-0.7793,  0.8555, -1.5928,  ...,  1.3896,  0.6318, -0.9214]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584370, 584371, 584372, 584354, 584355, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[ 0.5508, -2.1035, -2.4082,  ..., -0.0829, -2.6582, -1.1416],
         [-1.3242,  2.2891, -2.0664,  ...,  0.6475,  2.3477, -1.4922],
         [ 2.9238,  1.8721,  0.4294,  ..., -1.4111,  2.5137,  2.3398],
         ...,
         [-0.9751,  0.9565,  1.6611,  ...,  0.0211, -0.3503, -0.4001],
         [ 0.8472,  1.6934, -0.7925,  ...,  2.3945, -2.9902, -1.6006],
         [-1.4180, -0.0391, -0.9351,  ..., -0.9160,  1.5762, -0.1602]],

        [[ 1.1553, -1.7441, -2.6562,  ...,  0.5801, -3.0176,  0.1078],
         [-0.5464,  2.0469, -1.5566,  ...,  0.0647,  2.4414, -1.9180],
         [ 3.1055,  1.3369,  0.1892,  ..., -0.7700,  2.1641,  0.8726],
         ...,
         [-0.0906, -0.6196,  0.5342,  ..., -0.3157,  0.8623,  0.3687],
         [ 0.6465,  1.2305, -0.7632,  ...,  2.5352, -3.6973,  0.1562],
         [-0.6665,  0.3059, -1.6348,  ..., -0.3491,  0.8896,  0.3970]],

        [[ 1.1699, -1.5156, -2.2559,  ..., -0.0375, -2.9336, -0.2112],
         [-0.4683,  1.4648, -0.6777,  ...,  1.6025,  2.8887, -1.3623],
         [ 3.1562,  1.5791,  0.5430,  ..., -1.7666,  2.7324,  0.7573],
         ...,
         [-2.2598,  0.7788,  0.8389,  ...,  0.6040,  0.0740,  1.7070],
         [ 1.9189,  0.6113, -1.2529,  ...,  1.0547, -3.5195, -0.1567],
         [-0.1689, -0.4441, -0.6924,  ..., -0.1146,  0.8916,  0.0551]],

        [[ 0.5508, -2.1035, -2.4082,  ..., -0.0829, -2.6582, -1.1416],
         [-1.3242,  2.2891, -2.0664,  ...,  0.6475,  2.3477, -1.4922],
         [ 2.9238,  1.8721,  0.4294,  ..., -1.4111,  2.5137,  2.3398],
         ...,
         [-0.9751,  0.9565,  1.6611,  ...,  0.0211, -0.3503, -0.4001],
         [ 0.8472,  1.6934, -0.7925,  ...,  2.3945, -2.9902, -1.6006],
         [-1.4180, -0.0391, -0.9351,  ..., -0.9160,  1.5762, -0.1602]],

        [[ 1.1553, -1.7441, -2.6562,  ...,  0.5801, -3.0176,  0.1078],
         [-0.5464,  2.0469, -1.5566,  ...,  0.0647,  2.4414, -1.9180],
         [ 3.1055,  1.3369,  0.1892,  ..., -0.7700,  2.1641,  0.8726],
         ...,
         [-0.0906, -0.6196,  0.5342,  ..., -0.3157,  0.8623,  0.3687],
         [ 0.6465,  1.2305, -0.7632,  ...,  2.5352, -3.6973,  0.1562],
         [-0.6665,  0.3059, -1.6348,  ..., -0.3491,  0.8896,  0.3970]],

        [[ 1.1699, -1.5156, -2.2559,  ..., -0.0375, -2.9336, -0.2112],
         [-0.4683,  1.4648, -0.6777,  ...,  1.6025,  2.8887, -1.3623],
         [ 3.1562,  1.5791,  0.5430,  ..., -1.7666,  2.7324,  0.7573],
         ...,
         [-2.2598,  0.7788,  0.8389,  ...,  0.6040,  0.0740,  1.7070],
         [ 1.9189,  0.6113, -1.2529,  ...,  1.0547, -3.5195, -0.1567],
         [-0.1689, -0.4441, -0.6924,  ..., -0.1146,  0.8916,  0.0551]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584370, 584371, 584372, 584354, 584355, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-1.1113, -0.1790, -0.6064,  ..., -0.8091, -0.3970, -0.1964],
         [-1.4258,  1.1348,  2.9473,  ...,  0.5420, -1.6738, -0.2175],
         [-1.3867, -1.6504,  3.3105,  ...,  0.5781, -0.3042, -1.0781],
         ...,
         [ 2.0723,  0.8218,  1.0137,  ..., -0.6509,  0.3423, -2.0645],
         [ 0.7041, -0.2961, -0.5625,  ..., -0.2466, -0.2295, -0.5718],
         [-0.7876,  2.2773, -0.8892,  ...,  2.6699,  1.2314, -1.0723]],

        [[-1.1113, -0.1790, -0.6064,  ..., -0.8091, -0.3970, -0.1964],
         [-1.4258,  1.1348,  2.9473,  ...,  0.5420, -1.6738, -0.2175],
         [-1.3867, -1.6504,  3.3105,  ...,  0.5781, -0.3042, -1.0781],
         ...,
         [ 2.0723,  0.8218,  1.0137,  ..., -0.6509,  0.3423, -2.0645],
         [ 0.7041, -0.2961, -0.5625,  ..., -0.2466, -0.2295, -0.5718],
         [-0.7876,  2.2773, -0.8892,  ...,  2.6699,  1.2314, -1.0723]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584371, 584355], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[ 0.9863,  0.4109,  0.7764,  ..., -0.4106, -0.7705, -1.8818],
         [-0.7876, -1.1240, -0.6450,  ..., -3.0508, -0.7593,  0.0768],
         [ 0.4839, -0.0859,  1.2012,  ...,  0.1517,  0.1686, -1.1094],
         ...,
         [-2.3047,  0.8418, -0.8247,  ..., -1.8154,  0.4004, -1.1299],
         [ 0.7583,  0.7866, -1.0137,  ...,  0.3535,  0.6567,  0.2001],
         [ 0.0400,  0.8159, -1.3379,  ...,  0.5596,  0.0152, -0.8057]],

        [[ 0.9863,  0.4109,  0.7764,  ..., -0.4106, -0.7705, -1.8818],
         [-0.7876, -1.1240, -0.6450,  ..., -3.0508, -0.7593,  0.0768],
         [ 0.4839, -0.0859,  1.2012,  ...,  0.1517,  0.1686, -1.1094],
         ...,
         [-2.3047,  0.8418, -0.8247,  ..., -1.8154,  0.4004, -1.1299],
         [ 0.7583,  0.7866, -1.0137,  ...,  0.3535,  0.6567,  0.2001],
         [ 0.0400,  0.8159, -1.3379,  ...,  0.5596,  0.0152, -0.8057]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584371, 584355], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[ 1.0908, -1.7070, -2.5918,  ...,  0.5190, -2.9961,  0.0372],
         [-0.5347,  2.0547, -1.5566,  ...,  0.0789,  2.4023, -1.8232],
         [ 3.0840,  1.2471,  0.1293,  ..., -0.7344,  2.1738,  0.8760],
         ...,
         [-0.1548, -0.5771,  0.5957,  ..., -0.2336,  0.8442,  0.3970],
         [ 0.6895,  1.1816, -0.7881,  ...,  2.5273, -3.6504,  0.1554],
         [-0.6841,  0.3289, -1.6045,  ..., -0.2822,  0.8706,  0.4397]],

        [[ 1.0908, -1.7070, -2.5918,  ...,  0.5190, -2.9961,  0.0372],
         [-0.5347,  2.0547, -1.5566,  ...,  0.0789,  2.4023, -1.8232],
         [ 3.0840,  1.2471,  0.1293,  ..., -0.7344,  2.1738,  0.8760],
         ...,
         [-0.1548, -0.5771,  0.5957,  ..., -0.2336,  0.8442,  0.3970],
         [ 0.6895,  1.1816, -0.7881,  ...,  2.5273, -3.6504,  0.1554],
         [-0.6841,  0.3289, -1.6045,  ..., -0.2822,  0.8706,  0.4397]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584371, 584355], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-1.4185e-01,  2.0275e-03, -1.6484e+00,  ...,  8.2178e-01,
          -3.4844e+00,  1.5469e+00],
         [ 3.2578e+00, -3.4454e-02, -4.5532e-01,  ...,  4.1367e+00,
           8.7891e-01, -6.3818e-01],
         [ 1.0723e+00,  4.6118e-01, -2.4133e-01,  ..., -2.1875e-01,
           1.9639e+00,  1.1211e+00],
         ...,
         [ 2.4043e+00,  2.3047e+00,  7.8711e-01,  ...,  1.3730e+00,
          -1.0469e+00,  1.3945e+00],
         [ 1.1780e-02,  1.0234e+00,  7.8223e-01,  ..., -4.4922e-01,
           3.0273e+00, -6.7480e-01],
         [ 6.6748e-01,  5.4004e-01, -6.7676e-01,  ...,  5.0468e-03,
          -7.0508e-01,  6.3379e-01]],

        [[-1.4185e-01,  2.0275e-03, -1.6484e+00,  ...,  8.2178e-01,
          -3.4844e+00,  1.5469e+00],
         [ 3.2578e+00, -3.4454e-02, -4.5532e-01,  ...,  4.1367e+00,
           8.7891e-01, -6.3818e-01],
         [ 1.0723e+00,  4.6118e-01, -2.4133e-01,  ..., -2.1875e-01,
           1.9639e+00,  1.1211e+00],
         ...,
         [ 2.4043e+00,  2.3047e+00,  7.8711e-01,  ...,  1.3730e+00,
          -1.0469e+00,  1.3945e+00],
         [ 1.1780e-02,  1.0234e+00,  7.8223e-01,  ..., -4.4922e-01,
           3.0273e+00, -6.7480e-01],
         [ 6.6748e-01,  5.4004e-01, -6.7676e-01,  ...,  5.0468e-03,
          -7.0508e-01,  6.3379e-01]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584371, 584355], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
hidden_states torch.Size([2, 768])
seq_id:  0 output_token:  33
seq_id:  1 output_token:  33
seq_id:  0
seq_id:  1
id:  0 draft_size:  2 accept_cnt:  2
10
id:  1 draft_size:  2 accept_cnt:  1
524
seq_id 0 generation_tokens [33]
seq_id 1 generation_tokens [524]
reshape and cache tensor([[[ 1.1104, -1.0293,  1.1182,  ...,  1.8906, -0.0198,  0.4221],
         [-1.2061, -0.8311,  0.4019,  ..., -1.1621, -0.1141, -0.4121],
         [ 0.2627, -0.0579,  1.8740,  ..., -1.0498, -0.3467, -2.3613],
         ...,
         [-0.9233, -0.2472, -0.5381,  ..., -0.1710, -0.8232, -0.9971],
         [-2.1914, -0.7935, -1.5830,  ...,  0.0920, -0.4072, -1.0283],
         [-1.5576, -0.8306,  1.1016,  ...,  0.7988,  0.2452, -0.7461]],

        [[ 0.8438, -1.0459,  1.0254,  ...,  0.2805,  1.4043,  0.3088],
         [-1.5635, -0.4785,  0.3213,  ..., -0.5195,  0.2164, -0.3350],
         [-0.4631, -1.0420,  1.4365,  ..., -0.0071,  0.3318, -2.1973],
         ...,
         [-0.8013, -0.2839, -0.1970,  ...,  0.4673, -0.8335, -1.4648],
         [-2.2949, -0.7598, -0.9868,  ..., -1.0107, -0.5503, -0.9077],
         [-1.2549, -0.8691,  0.7578,  ..., -0.9067, -0.7329, -0.5732]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-3.4219e+00,  1.0394e-01, -3.4847e-03,  ..., -1.0840e+00,
           1.0566e+00, -2.2266e+00],
         [-3.1030e-01, -2.7637e+00,  1.0020e+00,  ..., -9.6143e-01,
          -1.0791e+00,  1.0762e+00],
         [ 1.1006e+00, -1.5889e+00, -4.2847e-01,  ..., -1.2354e+00,
           3.8159e-01, -1.3535e+00],
         ...,
         [ 1.8906e+00, -4.0454e-01, -2.4824e+00,  ...,  3.2642e-01,
          -4.0771e-01,  8.6475e-01],
         [-4.1992e+00, -1.5273e+00,  2.6367e-01,  ...,  2.3418e+00,
          -6.4307e-01,  6.3428e-01],
         [ 1.6221e+00, -7.2656e-01, -2.9468e-01,  ..., -5.5225e-01,
           5.1221e-01, -1.3887e+00]],

        [[-3.6699e+00, -3.2593e-01, -5.7587e-02,  ..., -9.1162e-01,
           9.4873e-01, -2.1680e+00],
         [-1.3538e-01, -2.2715e+00,  9.7949e-01,  ..., -8.6084e-01,
          -1.0088e+00,  1.0068e+00],
         [ 1.1904e+00, -1.0566e+00, -9.6826e-01,  ..., -6.6357e-01,
           4.6729e-01, -1.3486e+00],
         ...,
         [ 2.6523e+00, -1.7188e+00, -2.0254e+00,  ...,  1.7373e+00,
          -8.1543e-01,  1.1914e+00],
         [-3.3789e+00, -1.3164e+00,  3.7988e-01,  ...,  2.0137e+00,
          -6.1133e-01,  1.5515e-01],
         [ 2.1562e+00, -1.1334e-01, -1.6650e-01,  ..., -9.0723e-01,
           4.4263e-01, -1.7549e+00]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-0.0548,  3.8848,  3.9668,  ...,  0.8594,  1.4102,  0.5322],
         [-1.3066, -0.2327,  0.8521,  ...,  1.2178,  2.3535,  1.2734],
         [ 1.4619, -0.0385,  1.7637,  ..., -0.5527,  0.1639,  1.2275],
         ...,
         [-0.3748,  1.0166,  0.4944,  ...,  0.6650, -1.1328,  2.4160],
         [-0.3035, -0.2273, -0.7505,  ..., -1.2842, -4.3203, -1.1201],
         [-0.8071, -0.4778, -2.3125,  ...,  0.9189,  0.7207, -0.6528]],

        [[-0.1697,  2.4180,  3.9082,  ...,  0.4141,  1.1748,  0.0395],
         [-1.0596, -0.7485, -0.5386,  ...,  0.2075,  1.9189,  0.9897],
         [ 1.0186, -1.0225,  1.8301,  ..., -0.6074, -0.0969,  0.7622],
         ...,
         [-0.3530,  1.1514,  0.4336,  ...,  0.7681, -0.0903,  1.7002],
         [-0.5156,  0.3616, -0.1429,  ..., -0.8237, -3.9980, -0.8096],
         [ 0.0670, -0.0569, -1.0791,  ...,  0.8628,  1.6562, -1.1514]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-1.6270e+00, -2.4961e+00, -3.0957e+00,  ...,  8.6035e-01,
           1.0127e+00,  5.7764e-01],
         [ 9.1748e-01, -2.1562e+00, -1.5830e+00,  ..., -3.4395e+00,
          -3.0312e+00, -9.0283e-01],
         [-7.6965e-02, -2.8359e+00, -1.6367e+00,  ..., -1.9375e+00,
           4.7119e-01,  4.0234e-01],
         ...,
         [-1.1357e+00, -6.1865e-01,  4.0869e-01,  ..., -8.8232e-01,
          -3.2349e-01, -2.6074e+00],
         [ 3.8086e-01,  3.4424e-01, -2.1716e-01,  ...,  1.2998e+00,
          -1.2178e+00, -3.2031e+00],
         [ 2.1348e+00, -2.0723e+00, -1.0156e+00,  ...,  1.1172e+00,
           1.3977e-01,  3.1309e+00]],

        [[-1.6582e+00, -2.2910e+00, -3.0234e+00,  ...,  8.7549e-01,
           1.1670e+00,  6.4111e-01],
         [ 1.2002e+00, -1.7041e+00, -8.4668e-01,  ..., -3.4004e+00,
          -2.5820e+00, -1.0615e+00],
         [-1.0120e-01, -2.5840e+00, -2.0547e+00,  ..., -1.9453e+00,
           6.9922e-01, -1.5268e-03],
         ...,
         [-1.5146e+00, -5.2783e-01, -1.1664e-01,  ...,  8.1592e-01,
          -5.0439e-01, -2.1836e+00],
         [ 1.2197e+00,  5.8228e-02,  7.8003e-02,  ...,  1.3076e+00,
          -1.8975e+00, -3.2617e+00],
         [ 8.7842e-01, -1.5293e+00, -1.1006e+00,  ...,  1.2559e+00,
           8.1604e-02,  2.5410e+00]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-1.0762, -1.3271,  0.4697,  ...,  0.5781,  1.8896, -1.1123],
         [-1.3906,  0.1519, -0.4133,  ...,  1.0117, -0.2773, -0.4758],
         [-0.0645,  1.0752,  3.0566,  ...,  1.3672, -0.3203, -2.7578],
         ...,
         [-1.9463, -0.8486, -4.1211,  ...,  0.3052,  0.7969, -1.1602],
         [ 3.5137,  1.2236, -0.2849,  ...,  0.4768, -0.1599,  1.5801],
         [-3.5391, -1.2871,  0.6724,  ..., -0.4131,  0.5640, -1.6162]],

        [[-0.0944, -1.1855,  0.1772,  ...,  0.6548,  2.2207, -0.3479],
         [-2.0664, -0.1268, -0.4290,  ...,  1.4307,  0.6333, -1.0020],
         [-0.5752,  1.1787,  2.6250,  ...,  0.4199,  0.2693, -3.0566],
         ...,
         [-2.4004, -0.5464, -3.8379,  ...,  0.0163,  1.3203, -1.4033],
         [ 3.4766,  1.2412, -0.2380,  ...,  0.1962,  0.3557,  1.8682],
         [-4.1797, -0.6992,  0.4026,  ..., -0.5776, -0.0051, -0.2488]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[ 1.1123, -1.5020, -0.3726,  ..., -2.7520,  1.6523, -0.9956],
         [-1.4414, -1.3311,  3.2695,  ...,  1.4307, -2.2832,  2.8691],
         [ 0.0532,  0.7139, -1.2197,  ..., -0.6611,  0.1708, -1.6895],
         ...,
         [ 0.4067,  0.3169, -1.2070,  ..., -1.4971, -2.9473, -0.3340],
         [ 1.2842, -2.2480,  1.4277,  ...,  1.4746, -0.4299,  0.5913],
         [-0.8574,  0.3093,  3.5391,  ..., -0.9883,  0.0587, -0.6514]],

        [[ 0.5449, -1.0518, -1.1533,  ..., -1.8604,  1.1846, -0.6616],
         [-1.8125, -1.3174,  2.9941,  ...,  2.3066, -1.9463,  2.6230],
         [ 0.4338,  2.7539, -1.3193,  ..., -0.6812, -0.7441, -1.9287],
         ...,
         [ 0.5586,  0.2273, -2.0430,  ..., -1.1650, -4.0312,  0.3193],
         [ 0.0058, -2.8965,  2.4355,  ...,  0.2810,  0.4482,  0.3809],
         [-0.9521,  0.3640,  3.4590,  ..., -2.1172, -0.2322, -1.4062]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-1.6123, -1.2393, -1.3633,  ..., -2.2305, -2.6016,  3.2207],
         [ 0.4028, -0.4163, -0.2639,  ...,  0.1750,  0.1395, -1.7598],
         [ 1.1250,  3.7422, -3.4551,  ...,  0.4336, -0.7402,  0.7886],
         ...,
         [ 0.3484, -4.6445,  1.2725,  ...,  0.0132,  0.6362,  0.4050],
         [ 2.6855,  1.8936,  1.0791,  ..., -1.4346, -0.1647,  0.7393],
         [ 0.5522, -0.6021,  0.6133,  ...,  2.4766, -0.7056,  0.8540]],

        [[-1.5977, -1.4912, -1.4600,  ..., -1.9854, -2.0664,  3.5859],
         [ 0.8389, -0.2239, -1.1846,  ..., -0.2009, -0.3857, -2.0527],
         [ 0.9595,  3.3848, -2.8926,  ..., -0.0702, -0.6650,  0.1538],
         ...,
         [ 1.6299, -4.8789,  0.9639,  ...,  0.7026,  0.4294,  0.9712],
         [ 2.8594,  2.1367,  0.9126,  ..., -1.8447,  0.0132,  0.8628],
         [-0.2542, -1.3369,  0.9575,  ...,  2.6992, -0.6455,  1.0664]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-2.0547, -0.7886, -3.1016,  ...,  0.8979, -1.4326,  2.0352],
         [-1.6934, -0.6616, -1.3311,  ..., -0.2910,  0.1001, -1.0508],
         [ 1.9902, -0.2003, -0.5342,  ..., -1.0840, -0.2727,  2.1543],
         ...,
         [ 1.2256, -5.8242,  0.8296,  ..., -2.5352,  0.7490,  6.9180],
         [ 1.8027,  0.8413,  0.9541,  ..., -2.4102,  0.6416,  2.2363],
         [-0.4478, -0.2944,  0.5879,  ..., -0.3450, -0.3267,  0.1356]],

        [[-1.8418, -2.7188, -2.6758,  ...,  0.3298, -1.4199, -0.5293],
         [-2.3906, -0.0199, -1.3193,  ..., -0.2664,  0.4270, -1.7822],
         [ 1.0859, -0.2291,  0.7168,  ..., -1.8662, -0.3179,  2.4883],
         ...,
         [ 1.5869, -6.1602,  1.2578,  ..., -1.7266,  0.7383,  6.2266],
         [ 2.3125,  0.9897,  1.0215,  ..., -2.1777,  0.7344,  1.8857],
         [-0.1504,  0.3994,  1.2373,  ..., -0.2434, -0.1238, -0.8936]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-1.6230e+00, -6.7480e-01, -8.4912e-01,  ..., -3.1055e-01,
           3.4473e-01,  7.1533e-01],
         [-1.7197e+00,  1.1797e+00,  3.1953e+00,  ...,  5.3711e-01,
          -5.3027e-01,  7.5781e-01],
         [-1.4668e+00, -1.8135e+00,  2.7871e+00,  ...,  1.5469e+00,
          -5.3271e-01, -7.0361e-01],
         ...,
         [ 1.4590e+00,  1.4238e+00,  7.0215e-01,  ...,  3.3472e-01,
          -1.4600e-01, -1.6660e+00],
         [ 6.8652e-01,  2.7393e-01, -1.4746e+00,  ...,  6.6748e-01,
          -5.2246e-01, -1.1699e+00],
         [-1.0957e+00,  1.8506e+00,  1.6162e-01,  ...,  2.3789e+00,
           8.1885e-01, -1.9990e+00]],

        [[-1.0996e+00, -4.2285e-01, -8.2910e-01,  ..., -4.2310e-01,
           4.9023e-01,  5.2295e-01],
         [-1.9395e+00,  1.2705e+00,  2.6230e+00,  ..., -2.9712e-01,
          -7.8613e-01,  9.9268e-01],
         [-6.8701e-01, -2.0879e+00,  3.4023e+00,  ...,  1.1035e+00,
          -9.5605e-01,  2.5368e-03],
         ...,
         [ 1.2188e+00,  1.2031e+00,  1.2285e+00,  ...,  4.1284e-01,
           1.2119e+00, -2.3008e+00],
         [ 6.7188e-01,  2.4377e-01, -6.2469e-02,  ...,  7.0508e-01,
          -3.7939e-01, -4.7021e-01],
         [-9.0137e-01,  2.3008e+00,  9.5398e-02,  ...,  1.6084e+00,
           6.2207e-01, -2.0742e+00]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[ 0.1583,  0.8960, -0.7344,  ...,  0.2036, -0.4834, -2.1055],
         [-1.5205, -1.1748, -0.5649,  ..., -1.6943, -1.2070, -0.3555],
         [ 0.2488,  0.8818,  2.8594,  ..., -0.8975,  0.4592, -1.0400],
         ...,
         [-1.2139,  0.9912, -0.5024,  ..., -1.2012,  0.6187, -1.5928],
         [ 0.4653,  0.1000, -1.7188,  ...,  0.6821,  1.4219,  0.8242],
         [-0.7905,  0.7642, -1.5469,  ...,  1.3867,  0.6265, -0.9595]],

        [[ 0.4653,  0.6094, -0.2373,  ..., -0.6963, -0.7959, -2.5566],
         [-1.1064, -1.1807, -0.7788,  ..., -2.2695, -0.9834, -0.1802],
         [ 0.3928,  0.6831,  1.7480,  ..., -1.0947,  0.6323, -0.5977],
         ...,
         [-1.0967,  0.2345, -0.3899,  ..., -1.3770,  0.4563, -1.4609],
         [-0.1771,  0.0562, -1.3984,  ...,  0.5332,  1.1094, -0.0121],
         [ 0.1978,  0.9131, -2.4160,  ...,  1.3164,  1.0957, -1.0244]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[ 1.1357, -1.4814, -2.1816,  ..., -0.1069, -2.9609, -0.2239],
         [-0.4705,  1.4932, -0.6782,  ...,  1.4990,  2.7832, -1.3057],
         [ 3.0898,  1.4990,  0.5010,  ..., -1.7129,  2.7266,  0.7378],
         ...,
         [-2.3555,  0.7881,  0.8823,  ...,  0.6270,  0.0643,  1.6621],
         [ 1.9795,  0.6064, -1.2490,  ...,  1.0439, -3.4219, -0.1434],
         [-0.2056, -0.4185, -0.6807,  ..., -0.0637,  0.8804,  0.1208]],

        [[ 1.0166, -1.6885, -2.5410,  ...,  0.7798, -3.1914, -0.7671],
         [-0.7378,  1.5576, -1.5312,  ...,  0.6812,  1.7217, -1.7480],
         [ 3.2109,  1.3018,  0.1354,  ..., -0.8003,  2.7441,  1.7021],
         ...,
         [-1.1387,  0.8213,  1.1191,  ...,  0.2568, -0.1519,  0.6558],
         [ 1.2979,  0.1646, -1.1748,  ...,  2.5312, -3.2539, -0.6816],
         [-0.3447,  0.1046, -0.0805,  ..., -0.7778,  0.6353,  1.1426]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-9.7021e-01, -2.8242e+00,  3.9844e-01,  ...,  8.0261e-02,
          -2.6660e+00,  8.6182e-01],
         [ 2.5469e+00, -1.5029e+00,  6.9141e-01,  ...,  4.6680e+00,
           1.3047e+00, -6.7188e-01],
         [ 1.7500e+00,  1.7334e+00, -1.3691e+00,  ..., -7.5537e-01,
           1.4512e+00,  1.3477e+00],
         ...,
         [ 2.1504e+00,  2.4316e+00, -6.5735e-02,  ...,  1.2422e+00,
          -6.2207e-01,  2.1641e+00],
         [ 2.2314e-01,  1.6445e+00,  4.4751e-01,  ..., -1.5439e+00,
           5.4840e-02,  3.8719e-03],
         [-4.0558e-02,  2.3105e+00, -1.2803e+00,  ...,  5.9668e-01,
          -2.0618e-01, -1.0840e+00]],

        [[-2.3254e-01, -1.0195e+00,  9.2529e-02,  ..., -2.2473e-01,
          -1.2236e+00, -3.0121e-02],
         [ 3.0898e+00, -5.3027e-01,  5.6006e-01,  ...,  4.0352e+00,
           9.5557e-01, -1.1729e+00],
         [ 1.3623e+00,  1.1279e+00, -7.8467e-01,  ..., -1.1025e+00,
           2.0703e+00,  1.5264e+00],
         ...,
         [ 1.9990e+00,  2.8496e+00,  5.1172e-01,  ...,  1.4355e+00,
          -1.1895e+00,  1.3838e+00],
         [-8.7988e-01,  9.1504e-01,  9.0723e-01,  ..., -1.1074e+00,
           1.2070e+00, -1.1748e+00],
         [ 5.7910e-01,  1.6797e+00, -7.9199e-01,  ...,  6.6016e-01,
           1.0150e-01,  3.4814e-01]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
hidden_states torch.Size([2, 768])
seq_id:  0 output_token:  10
seq_id:  1 output_token:  10
seq_id 0 generation_tokens [10]
seq_id 1 generation_tokens [10]
reshape and cache tensor([[[ 8.8428e-01, -1.5000e+00,  1.0791e+00,  ...,  1.4492e+00,
           4.3869e-05,  7.2363e-01],
         [-5.2783e-01, -9.5215e-01, -1.3516e+00,  ...,  2.9858e-01,
          -6.9482e-01, -1.3770e+00],
         [-9.6436e-01, -2.0129e-01,  1.0117e+00,  ..., -2.7783e-01,
          -7.5537e-01, -3.1523e+00],
         ...,
         [-4.8926e-01,  4.0869e-01,  3.2080e-01,  ...,  6.1816e-01,
          -1.6074e+00, -1.3242e+00],
         [-1.5146e+00, -6.2109e-01, -7.4121e-01,  ..., -5.8057e-01,
          -5.3174e-01,  3.5034e-02],
         [ 5.4395e-01,  2.1698e-02,  4.4043e-01,  ..., -1.7783e+00,
          -3.2949e+00,  9.1211e-01]],

        [[ 8.8428e-01, -1.5000e+00,  1.0791e+00,  ...,  1.4492e+00,
           4.3869e-05,  7.2363e-01],
         [-5.2783e-01, -9.5215e-01, -1.3516e+00,  ...,  2.9858e-01,
          -6.9482e-01, -1.3770e+00],
         [-9.6436e-01, -2.0129e-01,  1.0117e+00,  ..., -2.7783e-01,
          -7.5537e-01, -3.1523e+00],
         ...,
         [-4.8926e-01,  4.0869e-01,  3.2080e-01,  ...,  6.1816e-01,
          -1.6074e+00, -1.3242e+00],
         [-1.5146e+00, -6.2109e-01, -7.4121e-01,  ..., -5.8057e-01,
          -5.3174e-01,  3.5034e-02],
         [ 5.4395e-01,  2.1698e-02,  4.4043e-01,  ..., -1.7783e+00,
          -3.2949e+00,  9.1211e-01]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584373, 584357], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-1.1113, -0.0828, -0.3782,  ...,  1.3916,  0.8716, -2.3770],
         [-0.1282,  1.6934,  0.7593,  ...,  0.8271, -0.7915,  0.7896],
         [ 1.1904, -0.9321, -1.5703,  ..., -2.8750,  0.3706, -0.7168],
         ...,
         [ 1.3066, -1.2041, -2.3535,  ..., -0.4524, -0.3086,  1.4717],
         [ 1.3330,  0.3193, -0.1195,  ...,  2.1543, -1.1797, -0.1724],
         [ 1.7266,  0.0432,  0.8970,  ..., -0.5029,  0.2498, -1.6924]],

        [[-0.5166, -0.0989, -0.3809,  ...,  1.2949,  0.8833, -2.3906],
         [-0.1519,  1.5908,  0.7744,  ...,  0.7236, -0.8154,  0.8145],
         [ 1.1582, -1.0723, -1.9287,  ..., -2.8164,  0.3777, -0.7051],
         ...,
         [ 1.5557, -1.5000, -2.4316,  ..., -0.0759, -0.4561,  1.7939],
         [ 1.1553,  0.1602, -0.0799,  ...,  2.2285, -1.2119, -0.0307],
         [ 2.1016, -0.0084,  0.8745,  ..., -0.6729,  0.2744, -1.9619]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584373, 584357], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-0.1444,  3.2188,  4.1172,  ...,  0.4648,  0.7520, -0.1328],
         [-0.0448, -1.1611,  0.2383,  ..., -0.4819,  1.7607,  0.3877],
         [ 1.3340,  0.4299,  3.1133,  ..., -0.1937, -0.1307,  1.5576],
         ...,
         [-0.4956,  1.0010,  0.6860,  ...,  0.9927, -2.1465, -0.2126],
         [-1.1396, -1.1777, -0.3220,  ..., -0.7729, -4.1758, -0.1176],
         [-0.7441,  0.3491, -1.5107,  ...,  1.0449,  1.3408, -1.5674]],

        [[ 0.1887,  3.0840,  4.5273,  ...,  0.4744,  0.7949,  0.1028],
         [-0.5068, -0.1632, -0.3218,  ...,  0.2888,  2.1406,  2.1191],
         [ 1.1729, -0.7744,  2.9414,  ...,  0.3145, -0.4500,  0.6826],
         ...,
         [-0.4861,  0.9526,  0.6553,  ...,  0.5767, -1.5488, -0.1825],
         [-0.9951, -0.7173, -0.1588,  ..., -0.8613, -4.1172, -0.1669],
         [-0.8232,  0.2400, -1.6113,  ...,  0.2566,  1.1152, -1.5547]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584373, 584357], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-0.3901, -2.3301, -2.9883,  ...,  0.8027,  1.2217,  0.5537],
         [ 2.2285, -1.5117,  0.4866,  ..., -3.6309, -1.6709, -1.2139],
         [ 0.6484, -2.3887, -1.5947,  ..., -1.8867,  0.4639,  0.6230],
         ...,
         [-0.3481, -0.5586,  1.1826,  ..., -2.0254,  0.0408, -2.0703],
         [ 0.3127, -0.4331, -0.0493,  ...,  1.0723, -0.8442, -3.2539],
         [ 0.4695, -0.3428, -2.5527,  ...,  1.9297,  0.2458,  0.4023]],

        [[-0.7075, -2.4121, -3.1445,  ...,  0.8452,  1.2021,  0.5771],
         [ 3.3867, -1.2695, -0.4062,  ..., -3.3438, -2.0996, -1.1602],
         [-0.0345, -1.9385, -1.6523,  ..., -2.0234,  0.6641, -0.0714],
         ...,
         [-1.2461, -0.4521,  0.4551,  ..., -1.1436,  0.0948, -2.5469],
         [ 0.4307, -0.6758,  0.0324,  ...,  1.1104, -1.2861, -3.2617],
         [ 0.1661, -0.7021, -2.5918,  ...,  1.8867,  0.3271, -0.1595]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584373, 584357], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-0.6665, -0.9551,  0.4072,  ..., -0.7007,  1.8398, -1.3760],
         [-1.1533, -0.0723, -0.4973,  ...,  0.8096,  0.6406, -1.2949],
         [ 0.4487,  1.0693,  1.5420,  ...,  1.2139,  2.1113, -3.0098],
         ...,
         [-1.4902,  0.0970, -4.5273,  ..., -0.2734,  1.1826, -1.8232],
         [ 2.3613,  3.5078,  1.5986,  ..., -1.3789,  0.9150,  2.1836],
         [-3.7363, -0.4268, -0.6436,  ..., -0.9390,  2.4258, -2.3555]],

        [[-0.7822, -0.9893,  0.7788,  ...,  0.4270,  1.9814, -1.3750],
         [-1.0156, -0.4077, -0.7876,  ...,  0.8887,  0.8452, -1.1631],
         [-0.4993,  0.4600,  1.6592,  ...,  0.8857,  2.0684, -2.9941],
         ...,
         [-0.8730, -0.1396, -5.1445,  ..., -1.1416,  0.1689, -2.1426],
         [ 1.8467,  2.6855,  1.5977,  ..., -0.7803,  2.2363,  2.6250],
         [-4.0273, -0.4714, -1.3281,  ..., -1.4102,  2.6250, -1.6650]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584373, 584357], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[ 2.2422, -2.2324, -0.1746,  ..., -2.0859,  1.6855,  0.7314],
         [-1.3711, -1.4883,  2.1504,  ..., -2.0234, -1.7080,  2.9609],
         [ 0.1838,  1.3662, -1.1465,  ..., -0.9668,  0.7612, -2.5664],
         ...,
         [ 1.0732,  0.7222, -2.1426,  ..., -1.5273, -2.0645, -0.3127],
         [ 1.7607, -2.8438,  1.4463,  ...,  1.5049,  0.0148, -0.2209],
         [-0.6548,  0.4001,  0.9014,  ..., -0.2937,  0.0757, -0.2467]],

        [[ 2.1621, -1.8740, -0.3337,  ..., -2.6699,  1.4385, -0.5142],
         [ 0.5449, -3.0215,  1.9912,  ...,  0.3208, -1.9316,  2.3711],
         [ 0.6636,  2.5195, -1.9766,  ..., -1.3496, -0.7363, -2.4297],
         ...,
         [ 0.9790,  0.8252, -2.3203,  ..., -1.9355, -3.0488,  0.3877],
         [ 1.6436, -3.0762,  1.6963,  ...,  0.8252,  0.8130, -0.2847],
         [-0.8677,  0.5742,  0.5225,  ..., -1.6689,  0.4143, -0.4048]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584373, 584357], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-2.2051, -0.1174, -2.7383,  ..., -2.3125, -3.2793,  3.7168],
         [-0.0670, -1.2422, -0.2329,  ..., -0.8335,  0.3677, -2.2383],
         [ 2.2461,  2.0918, -2.5117,  ...,  0.2141, -0.6235,  0.8130],
         ...,
         [ 2.0684, -5.6133,  1.4297,  ...,  0.5474, -1.2842,  0.7402],
         [ 3.3086,  1.5010,  2.1602,  ..., -0.7563, -0.5850,  0.1392],
         [ 0.9941, -0.7866,  0.2798,  ...,  2.5000, -0.1139,  1.2139]],

        [[-1.8604, -0.4294, -3.2012,  ..., -1.9531, -2.6934,  4.5742],
         [ 0.3423, -0.8296, -0.5713,  ..., -0.7852,  0.1328, -2.5117],
         [ 2.2246,  2.1621, -3.0977,  ..., -0.0531, -0.7827,  1.0195],
         ...,
         [ 0.7539, -5.9922,  0.6514,  ...,  0.1002, -1.3174,  1.2441],
         [ 2.8262,  1.7100,  1.2617,  ..., -1.2061, -0.5830,  0.4050],
         [ 0.2184, -0.6987,  1.1309,  ...,  3.0371, -0.3335,  1.3965]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584373, 584357], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[ 0.1403, -0.5239, -1.9336,  ...,  0.3088, -0.9458,  1.4746],
         [-1.1885, -1.3682, -0.5010,  ...,  1.1533,  0.0816, -1.3965],
         [ 0.3513,  0.3630, -0.3635,  ..., -0.3918, -0.8242,  1.8486],
         ...,
         [ 1.7246, -5.8945,  0.9937,  ..., -1.8115,  0.4446,  5.8281],
         [ 0.4346,  1.1025,  1.9424,  ..., -1.6289,  0.4250,  1.2461],
         [-1.9199, -0.1090,  0.1072,  ..., -1.0908, -0.2834, -0.2069]],

        [[ 0.8330, -1.7236, -1.8623,  ...,  0.6099, -0.6484,  0.4426],
         [-1.7168, -0.7705, -0.9678,  ..., -0.3945, -0.5034, -1.8350],
         [-1.5391,  0.6318,  0.8325,  ..., -1.3037, -1.1406,  0.9116],
         ...,
         [ 1.9980, -6.1680,  1.0254,  ..., -0.7700,  0.0129,  5.2930],
         [ 1.5586,  1.1514,  0.9780,  ..., -0.5762,  0.2212,  1.2363],
         [-0.1165, -0.1711,  1.1328,  ..., -1.4346,  0.0175, -1.1143]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584373, 584357], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[-1.0381, -1.0215, -0.3491,  ..., -0.2281,  0.5752, -0.2603],
         [-1.1924,  0.9648,  3.1250,  ..., -0.1070, -0.6274,  0.4241],
         [-1.9619, -1.2695,  2.1523,  ...,  2.0742, -0.9507, -1.3057],
         ...,
         [ 1.8926,  0.6562,  1.2715,  ...,  1.0557,  0.2207, -1.5781],
         [ 1.2363, -0.3196, -1.3613,  ...,  0.7480,  0.3855, -0.8315],
         [-0.0424,  1.8955, -1.1592,  ...,  2.7812,  2.3789, -1.9004]],

        [[-0.5059, -0.7729, -0.2310,  ..., -0.2332,  0.2683,  1.2666],
         [-0.6323,  0.9497,  3.8613,  ..., -0.9360, -1.3594,  0.2727],
         [-1.7559, -1.4814,  2.1055,  ...,  1.5068, -0.2299, -0.7373],
         ...,
         [ 1.2158,  0.3237,  1.6816,  ...,  0.6548,  1.4512, -2.2324],
         [ 0.9248,  0.0444, -0.6035,  ...,  0.4810,  0.5859, -0.1716],
         [-0.9980,  2.4453, -0.7568,  ...,  2.0586,  0.7432, -2.6973]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584373, 584357], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[ 0.3098,  0.8403, -0.2114,  ...,  0.9531, -0.6025, -1.7891],
         [-1.2031, -0.6035, -0.4893,  ..., -2.2773, -1.8721, -0.0402],
         [ 0.6396,  0.5322,  1.9844,  ...,  0.3159,  0.9478, -0.5674],
         ...,
         [-1.8213,  1.2744, -0.0044,  ..., -1.2275,  0.4194, -1.8389],
         [-0.0287,  0.2339, -2.1016,  ...,  1.4346,  0.9873,  2.2695],
         [-0.5713,  0.2607, -0.8091,  ...,  0.3589,  0.9175, -0.6294]],

        [[ 0.4863,  0.6914,  0.2876,  ...,  0.4810, -1.0938, -1.8672],
         [-1.2930, -0.3508, -0.9751,  ..., -2.1055, -1.7666,  0.2330],
         [ 0.8730, -0.2759,  2.4668,  ...,  0.9590,  0.7300, -0.3875],
         ...,
         [-1.3037,  0.6699, -0.6611,  ..., -0.7651,  0.5840, -1.2988],
         [-0.2439, -0.2222, -0.9902,  ...,  0.0499,  1.0186,  1.3477],
         [-0.2966,  1.7188, -1.3047,  ...,  1.2002,  0.9204, -1.5479]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584373, 584357], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[ 6.5576e-01, -2.3203e+00, -1.4502e+00,  ...,  2.0850e-01,
          -3.1992e+00, -3.9209e-01],
         [-1.0742e+00,  2.7148e+00, -2.2986e-01,  ...,  1.0322e+00,
           2.8457e+00, -1.4873e+00],
         [ 2.8574e+00,  1.0488e+00,  5.4980e-01,  ..., -1.9678e+00,
           3.0254e+00,  1.6626e-01],
         ...,
         [-2.0234e+00,  1.2354e+00,  7.8174e-01,  ..., -8.9539e-02,
           6.0889e-01,  1.9824e+00],
         [ 8.4033e-01,  9.3652e-01, -1.4834e+00,  ...,  2.0703e+00,
          -2.8867e+00,  5.5957e-01],
         [-7.2070e-01, -3.5693e-01, -3.7793e-01,  ..., -1.6382e-01,
           1.1396e+00, -7.9492e-01]],

        [[ 1.0244e+00, -1.9492e+00, -2.1074e+00,  ...,  1.3281e+00,
          -2.7617e+00, -2.4084e-01],
         [-7.3340e-01,  1.9502e+00, -2.3499e-01,  ...,  4.4800e-01,
           1.1543e+00, -1.7383e+00],
         [ 2.4922e+00,  1.0215e+00,  4.6326e-02,  ..., -1.0654e+00,
           2.6699e+00,  1.1934e+00],
         ...,
         [-1.5039e+00,  1.2793e+00,  8.9478e-02,  ...,  6.9971e-01,
           1.2559e+00,  1.7712e-01],
         [ 8.0371e-01, -5.8651e-04, -1.4248e+00,  ...,  3.2891e+00,
          -2.6250e+00,  3.0054e-01],
         [ 2.5098e-01, -2.0801e-01,  4.6295e-02,  ..., -1.3994e+00,
           2.8809e-01,  2.6660e-01]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584373, 584357], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
reshape and cache tensor([[[ 0.0366, -1.4473, -0.6758,  ...,  2.4258, -2.5840, -0.8970],
         [ 3.5215,  0.0619, -0.5190,  ...,  3.6680,  1.5283, -1.0391],
         [ 0.1729,  1.2520, -0.4236,  ...,  0.4514,  1.5703,  1.6914],
         ...,
         [ 1.2627,  1.2334,  0.5127,  ...,  1.3047, -0.2627,  2.0879],
         [ 0.3494,  0.4983, -0.3220,  ..., -0.9814,  2.6699, -0.7974],
         [ 0.6865,  1.3525, -0.1058,  ...,  0.8984, -1.6963,  0.1660]],

        [[-0.1014, -0.0426, -1.7139,  ...,  0.8452, -3.4375,  1.5820],
         [ 3.2891,  0.0148, -0.4568,  ...,  4.1055,  0.8496, -0.6416],
         [ 1.0752,  0.4387, -0.2754,  ..., -0.1636,  1.9580,  1.1289],
         ...,
         [ 2.3965,  2.2637,  0.7393,  ...,  1.4121, -1.1182,  1.3643],
         [ 0.0587,  0.9790,  0.8306,  ..., -0.4309,  3.0820, -0.7207],
         [ 0.7832,  0.4624, -0.7632,  ..., -0.0936, -0.7056,  0.5996]],

        [[-0.9150, -2.8945,  0.3706,  ...,  0.1302, -2.6934,  0.9077],
         [ 2.5781, -1.4961,  0.6729,  ...,  4.6758,  1.2393, -0.7241],
         [ 1.7432,  1.7666, -1.4180,  ..., -0.6743,  1.4189,  1.3555],
         ...,
         [ 2.1035,  2.4414, -0.0681,  ...,  1.2764, -0.6758,  2.1582],
         [ 0.2427,  1.6064,  0.5322,  ..., -1.5518,  0.0787, -0.0449],
         [ 0.0385,  2.2969, -1.3203,  ...,  0.5342, -0.1750, -1.0859]],

        [[ 0.0366, -1.4473, -0.6758,  ...,  2.4258, -2.5840, -0.8970],
         [ 3.5215,  0.0619, -0.5190,  ...,  3.6680,  1.5283, -1.0391],
         [ 0.1729,  1.2520, -0.4236,  ...,  0.4514,  1.5703,  1.6914],
         ...,
         [ 1.2627,  1.2334,  0.5127,  ...,  1.3047, -0.2627,  2.0879],
         [ 0.3494,  0.4983, -0.3220,  ..., -0.9814,  2.6699, -0.7974],
         [ 0.6865,  1.3525, -0.1058,  ...,  0.8984, -1.6963,  0.1660]],

        [[-0.1014, -0.0426, -1.7139,  ...,  0.8452, -3.4375,  1.5820],
         [ 3.2891,  0.0148, -0.4568,  ...,  4.1055,  0.8496, -0.6416],
         [ 1.0752,  0.4387, -0.2754,  ..., -0.1636,  1.9580,  1.1289],
         ...,
         [ 2.3965,  2.2637,  0.7393,  ...,  1.4121, -1.1182,  1.3643],
         [ 0.0587,  0.9790,  0.8306,  ..., -0.4309,  3.0820, -0.7207],
         [ 0.7832,  0.4624, -0.7632,  ..., -0.0936, -0.7056,  0.5996]],

        [[-0.9150, -2.8945,  0.3706,  ...,  0.1302, -2.6934,  0.9077],
         [ 2.5781, -1.4961,  0.6729,  ...,  4.6758,  1.2393, -0.7241],
         [ 1.7432,  1.7666, -1.4180,  ..., -0.6743,  1.4189,  1.3555],
         ...,
         [ 2.1035,  2.4414, -0.0681,  ...,  1.2764, -0.6758,  2.1582],
         [ 0.2427,  1.6064,  0.5322,  ..., -1.5518,  0.0787, -0.0449],
         [ 0.0385,  2.2969, -1.3203,  ...,  0.5342, -0.1750, -1.0859]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584370, 584371, 584372, 584354, 584355, 584356], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
hidden_states torch.Size([6, 768])
num_prompts 0
decode probs shape torch.Size([6, 50272])
target_lens [3, 3]
sampled_draft_token_ids tensor([[939,  33],
        [939,  33]], device='cuda:0')
target probs[0] tensor([[2.2269e-09, 2.2619e-09, 8.4739e-06,  ..., 1.9806e-09, 2.0920e-09,
         2.5832e-09],
        [9.5745e-10, 9.6874e-10, 1.2366e-06,  ..., 8.8205e-10, 8.8896e-10,
         1.3036e-09],
        [1.9938e-08, 2.0016e-08, 5.2854e-06,  ..., 1.8584e-08, 1.8368e-08,
         2.0813e-08]], device='cuda:0')
target probs[1] tensor([[2.2269e-09, 2.2619e-09, 8.4739e-06,  ..., 1.9806e-09, 2.0920e-09,
         2.5832e-09],
        [9.5745e-10, 9.6874e-10, 1.2366e-06,  ..., 8.8205e-10, 8.8896e-10,
         1.3036e-09],
        [1.9938e-08, 2.0016e-08, 5.2854e-06,  ..., 1.8584e-08, 1.8368e-08,
         2.0813e-08]], device='cuda:0')
1 target tensor([0.2046, 0.2135], device='cuda:0')
2 target tensor([0.2046, 0.2135], device='cuda:0')
1 target sampled tensor(0.2046, device='cuda:0')
2 target sampled tensor(0.2046, device='cuda:0')
1 draft tensor([0.2114, 0.2277], device='cuda:0')
2 draft tensor([0.2114, 0.2277], device='cuda:0')
1 draft sampled tensor(0.2114, device='cuda:0')
2 draft sampled tensor(0.2114, device='cuda:0')
accept_prob tensor([[0.9678, 0.9376],
        [0.9678, 0.9376]], device='cuda:0')
target decode seq_id 0 generation_tokens [33, 10, 21199]
target decode seq_id 1 generation_tokens [524, 10, 92]
slot mapping [584372, 584373, 584374, 584356, 584357, 584358]
block_tables [[36523], [36523], [36523], [36522], [36522], [36522]]
context_lens [5, 6, 7, 5, 6, 7]
input_tokens tensor([   33,    10, 21199,   524,    10,    92], device='cuda:0')
input_positions tensor([4, 5, 6, 4, 5, 6], device='cuda:0')
tensor([[36523],
        [36523],
        [36523],
        [36522],
        [36522],
        [36522]], device='cuda:0', dtype=torch.int32)
reshape and cache tensor([[[ 1.1104e+00, -1.0293e+00,  1.1182e+00,  ...,  1.8906e+00,
          -1.9806e-02,  4.2212e-01],
         [-1.2061e+00, -8.3105e-01,  4.0186e-01,  ..., -1.1621e+00,
          -1.1414e-01, -4.1211e-01],
         [ 2.6270e-01, -5.7922e-02,  1.8740e+00,  ..., -1.0498e+00,
          -3.4668e-01, -2.3613e+00],
         ...,
         [-9.2334e-01, -2.4719e-01, -5.3809e-01,  ..., -1.7102e-01,
          -8.2324e-01, -9.9707e-01],
         [-2.1914e+00, -7.9346e-01, -1.5830e+00,  ...,  9.2041e-02,
          -4.0723e-01, -1.0283e+00],
         [-1.5576e+00, -8.3057e-01,  1.1016e+00,  ...,  7.9883e-01,
           2.4524e-01, -7.4609e-01]],

        [[ 8.8428e-01, -1.5000e+00,  1.0791e+00,  ...,  1.4492e+00,
           4.3869e-05,  7.2363e-01],
         [-5.2783e-01, -9.5215e-01, -1.3516e+00,  ...,  2.9858e-01,
          -6.9482e-01, -1.3770e+00],
         [-9.6436e-01, -2.0129e-01,  1.0117e+00,  ..., -2.7783e-01,
          -7.5537e-01, -3.1523e+00],
         ...,
         [-4.8926e-01,  4.0869e-01,  3.2080e-01,  ...,  6.1816e-01,
          -1.6074e+00, -1.3242e+00],
         [-1.5146e+00, -6.2109e-01, -7.4121e-01,  ..., -5.8057e-01,
          -5.3174e-01,  3.5034e-02],
         [ 5.4395e-01,  2.1698e-02,  4.4043e-01,  ..., -1.7783e+00,
          -3.2949e+00,  9.1211e-01]],

        [[ 1.1006e+00, -9.2236e-01,  6.1768e-01,  ...,  7.9492e-01,
           3.3325e-02,  1.4453e+00],
         [-1.6299e+00, -2.0374e-01,  1.4478e-01,  ...,  6.1084e-01,
           1.7041e-01,  3.2812e-01],
         [-1.7487e-02, -1.4026e-01,  1.3501e-01,  ..., -7.7197e-01,
          -9.8291e-01, -3.6230e+00],
         ...,
         [-7.6514e-01, -7.1533e-01, -3.6133e-01,  ...,  1.0820e+00,
          -1.3662e+00, -1.2852e+00],
         [-1.2500e+00, -3.7061e-01, -1.8005e-01,  ...,  1.2927e-01,
          -1.0215e+00, -5.3564e-01],
         [-1.1787e+00,  1.0918e+00,  7.2449e-02,  ..., -8.6243e-02,
          -2.5762e+00,  9.8975e-01]],

        [[ 8.4375e-01, -1.0459e+00,  1.0254e+00,  ...,  2.8052e-01,
           1.4043e+00,  3.0884e-01],
         [-1.5635e+00, -4.7852e-01,  3.2129e-01,  ..., -5.1953e-01,
           2.1643e-01, -3.3496e-01],
         [-4.6313e-01, -1.0420e+00,  1.4365e+00,  ..., -7.0763e-03,
           3.3179e-01, -2.1973e+00],
         ...,
         [-8.0127e-01, -2.8394e-01, -1.9702e-01,  ...,  4.6729e-01,
          -8.3350e-01, -1.4648e+00],
         [-2.2949e+00, -7.5977e-01, -9.8682e-01,  ..., -1.0107e+00,
          -5.5029e-01, -9.0771e-01],
         [-1.2549e+00, -8.6914e-01,  7.5781e-01,  ..., -9.0674e-01,
          -7.3291e-01, -5.7324e-01]],

        [[ 8.8428e-01, -1.5000e+00,  1.0791e+00,  ...,  1.4492e+00,
           4.3869e-05,  7.2363e-01],
         [-5.2783e-01, -9.5215e-01, -1.3516e+00,  ...,  2.9858e-01,
          -6.9482e-01, -1.3770e+00],
         [-9.6436e-01, -2.0129e-01,  1.0117e+00,  ..., -2.7783e-01,
          -7.5537e-01, -3.1523e+00],
         ...,
         [-4.8926e-01,  4.0869e-01,  3.2080e-01,  ...,  6.1816e-01,
          -1.6074e+00, -1.3242e+00],
         [-1.5146e+00, -6.2109e-01, -7.4121e-01,  ..., -5.8057e-01,
          -5.3174e-01,  3.5034e-02],
         [ 5.4395e-01,  2.1698e-02,  4.4043e-01,  ..., -1.7783e+00,
          -3.2949e+00,  9.1211e-01]],

        [[ 1.1641e+00, -3.0957e-01,  4.1719e+00,  ..., -2.6147e-01,
           5.5176e-01,  4.2651e-01],
         [-1.8535e+00, -3.2153e-01, -5.6055e-01,  ...,  7.0850e-01,
          -2.8174e-01, -1.4014e-01],
         [ 2.6709e-01,  8.3252e-01,  2.8052e-01,  ..., -5.8789e-01,
          -1.2314e+00, -3.7676e+00],
         ...,
         [-9.5459e-01, -1.0742e+00, -4.6704e-01,  ...,  1.1406e+00,
          -7.8857e-01, -9.6436e-01],
         [-1.2256e+00, -3.0542e-01, -7.3828e-01,  ..., -7.0215e-01,
          -6.4600e-01, -1.2054e-01],
         [-5.2344e-01,  7.5488e-01,  4.2407e-01,  ..., -2.3804e-01,
          -1.8154e+00,  1.3301e+00]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584373, 584374, 584356, 584357, 584358], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-3.4219e+00,  1.0413e-01, -3.6068e-03,  ..., -1.0840e+00,
           1.0566e+00, -2.2266e+00],
         [-3.1055e-01, -2.7637e+00,  1.0020e+00,  ..., -9.6143e-01,
          -1.0791e+00,  1.0762e+00],
         [ 1.1006e+00, -1.5889e+00, -4.2822e-01,  ..., -1.2354e+00,
           3.8159e-01, -1.3535e+00],
         ...,
         [ 1.8906e+00, -4.0454e-01, -2.4824e+00,  ...,  3.2617e-01,
          -4.0820e-01,  8.6475e-01],
         [-4.1992e+00, -1.5273e+00,  2.6367e-01,  ...,  2.3418e+00,
          -6.4307e-01,  6.3428e-01],
         [ 1.6211e+00, -7.2656e-01, -2.9492e-01,  ..., -5.5225e-01,
           5.1270e-01, -1.3896e+00]],

        [[-1.1113e+00, -8.2642e-02, -3.7817e-01,  ...,  1.3916e+00,
           8.7109e-01, -2.3770e+00],
         [-1.2805e-01,  1.6934e+00,  7.5977e-01,  ...,  8.2764e-01,
          -7.9150e-01,  7.8955e-01],
         [ 1.1895e+00, -9.3262e-01, -1.5703e+00,  ..., -2.8750e+00,
           3.7061e-01, -7.1680e-01],
         ...,
         [ 1.3066e+00, -1.2041e+00, -2.3555e+00,  ..., -4.5215e-01,
          -3.0811e-01,  1.4717e+00],
         [ 1.3320e+00,  3.1934e-01, -1.1938e-01,  ...,  2.1543e+00,
          -1.1797e+00, -1.7273e-01],
         [ 1.7266e+00,  4.2999e-02,  8.9746e-01,  ..., -5.0293e-01,
           2.4951e-01, -1.6924e+00]],

        [[ 4.3030e-03,  4.6411e-01,  1.3635e-01,  ..., -2.3547e-01,
           7.3535e-01, -2.0957e+00],
         [-3.3252e-01,  1.7988e+00,  9.5850e-01,  ...,  1.3291e+00,
          -9.3994e-01,  9.4580e-01],
         [ 2.4297e+00,  6.7969e-01, -2.8203e+00,  ..., -1.7603e-01,
          -5.0732e-01, -8.5742e-01],
         ...,
         [ 1.1709e+00, -2.0469e+00, -1.4521e+00,  ..., -6.8115e-02,
          -2.2852e+00,  3.6041e-02],
         [-2.0156e+00, -2.7754e+00,  2.5146e-01,  ...,  2.2520e+00,
          -2.3596e-01, -1.1094e+00],
         [ 7.4316e-01, -5.2734e-02,  9.0479e-01,  ..., -6.9189e-01,
           2.5952e-01, -1.9395e+00]],

        [[-3.6699e+00, -3.2593e-01, -5.7434e-02,  ..., -9.1162e-01,
           9.4873e-01, -2.1680e+00],
         [-1.3550e-01, -2.2715e+00,  9.7949e-01,  ..., -8.6133e-01,
          -1.0088e+00,  1.0068e+00],
         [ 1.1904e+00, -1.0566e+00, -9.6826e-01,  ..., -6.6406e-01,
           4.6753e-01, -1.3496e+00],
         ...,
         [ 2.6523e+00, -1.7197e+00, -2.0254e+00,  ...,  1.7383e+00,
          -8.1543e-01,  1.1914e+00],
         [-3.3809e+00, -1.3164e+00,  3.8037e-01,  ...,  2.0137e+00,
          -6.1084e-01,  1.5491e-01],
         [ 2.1562e+00, -1.1328e-01, -1.6663e-01,  ..., -9.0771e-01,
           4.4287e-01, -1.7559e+00]],

        [[-5.1709e-01, -9.9182e-02, -3.8086e-01,  ...,  1.2949e+00,
           8.8330e-01, -2.3906e+00],
         [-1.5173e-01,  1.5908e+00,  7.7441e-01,  ...,  7.2412e-01,
          -8.1543e-01,  8.1445e-01],
         [ 1.1592e+00, -1.0723e+00, -1.9287e+00,  ..., -2.8164e+00,
           3.7769e-01, -7.0557e-01],
         ...,
         [ 1.5557e+00, -1.5000e+00, -2.4316e+00,  ..., -7.5623e-02,
          -4.5581e-01,  1.7939e+00],
         [ 1.1553e+00,  1.6028e-01, -8.0017e-02,  ...,  2.2285e+00,
          -1.2119e+00, -3.0640e-02],
         [ 2.1016e+00, -8.6212e-03,  8.7451e-01,  ..., -6.7334e-01,
           2.7417e-01, -1.9619e+00]],

        [[ 8.5449e-01,  1.1797e+00, -1.2878e-01,  ...,  6.0791e-01,
           7.8760e-01, -2.1406e+00],
         [-2.1826e-01,  3.9375e+00,  8.5742e-01,  ...,  2.3262e+00,
          -8.3838e-01,  8.4473e-01],
         [ 2.4648e+00,  4.4678e-01, -1.4658e+00,  ..., -3.9917e-01,
           4.8730e-01, -1.7119e+00],
         ...,
         [ 1.8975e+00, -1.0889e+00, -2.6445e+00,  ...,  6.2256e-01,
          -1.1074e+00,  1.3447e+00],
         [-7.2119e-01, -2.0566e+00,  6.2256e-01,  ...,  2.4961e+00,
          -4.5459e-01, -1.0811e+00],
         [ 1.6094e+00, -4.2480e-02,  1.4043e+00,  ..., -8.1934e-01,
          -8.7708e-02, -2.0605e+00]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584373, 584374, 584356, 584357, 584358], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-0.0518,  3.8809,  3.9727,  ...,  0.8545,  1.4072,  0.5269],
         [-1.3086, -0.2289,  0.8516,  ...,  1.2148,  2.3613,  1.2783],
         [ 1.4619, -0.0346,  1.7656,  ..., -0.5498,  0.1625,  1.2305],
         ...,
         [-0.3772,  1.0059,  0.4978,  ...,  0.6602, -1.1299,  2.4141],
         [-0.3005, -0.2279, -0.7524,  ..., -1.2822, -4.3281, -1.1152],
         [-0.8081, -0.4712, -2.3086,  ...,  0.9214,  0.7124, -0.6538]],

        [[-0.1436,  3.2188,  4.1172,  ...,  0.4585,  0.7500, -0.1329],
         [-0.0494, -1.1611,  0.2418,  ..., -0.4824,  1.7686,  0.3970],
         [ 1.3311,  0.4324,  3.1113,  ..., -0.1877, -0.1342,  1.5605],
         ...,
         [-0.4971,  0.9893,  0.6880,  ...,  0.9873, -2.1426, -0.2053],
         [-1.1357, -1.1758, -0.3213,  ..., -0.7705, -4.1836, -0.1137],
         [-0.7471,  0.3501, -1.5117,  ...,  1.0469,  1.3320, -1.5645]],

        [[ 1.0908,  1.3027,  3.3613,  ...,  0.8257,  0.6577, -0.0760],
         [-1.1572,  0.0784, -0.4773,  ..., -0.0216,  2.1250, -1.0977],
         [ 0.9805,  0.0210,  0.1108,  ...,  0.2188,  0.2961,  0.8281],
         ...,
         [-0.4941,  0.2074,  0.4983,  ...,  0.6670, -1.5225, -1.0254],
         [-1.3428,  0.5767, -0.4617,  ...,  1.1758, -3.4121, -0.7134],
         [ 0.7588,  0.8306, -1.3467,  ...,  0.6919,  0.7500, -0.4851]],

        [[-0.1687,  2.4141,  3.9102,  ...,  0.4099,  1.1719,  0.0401],
         [-1.0625, -0.7495, -0.5356,  ...,  0.2061,  1.9287,  0.9980],
         [ 1.0166, -1.0205,  1.8330,  ..., -0.6025, -0.1011,  0.7603],
         ...,
         [-0.3550,  1.1387,  0.4365,  ...,  0.7607, -0.0843,  1.7021],
         [-0.5146,  0.3613, -0.1425,  ..., -0.8228, -4.0039, -0.8062],
         [ 0.0658, -0.0531, -1.0791,  ...,  0.8647,  1.6465, -1.1484]],

        [[ 0.1871,  3.0840,  4.5312,  ...,  0.4685,  0.7920,  0.1010],
         [-0.5078, -0.1658, -0.3210,  ...,  0.2896,  2.1484,  2.1230],
         [ 1.1709, -0.7720,  2.9434,  ...,  0.3188, -0.4517,  0.6851],
         ...,
         [-0.4878,  0.9458,  0.6577,  ...,  0.5684, -1.5469, -0.1747],
         [-0.9917, -0.7173, -0.1604,  ..., -0.8584, -4.1211, -0.1632],
         [-0.8247,  0.2417, -1.6113,  ...,  0.2600,  1.1055, -1.5537]],

        [[ 2.1641,  2.4277,  3.9785,  ...,  0.4878,  1.3574, -0.7466],
         [-1.0010, -0.4126,  0.0305,  ...,  0.6138,  2.2207,  0.9160],
         [ 1.0391, -0.1875,  0.4666,  ...,  0.6416,  1.0000,  0.2825],
         ...,
         [-0.3796, -0.4788,  0.4951,  ..., -0.0294, -1.4893,  0.4592],
         [-1.2314, -0.3008, -0.2937,  ...,  0.8970, -3.9277, -0.2595],
         [-0.4070,  0.3628, -1.2949,  ...,  1.6582,  0.4883, -1.4590]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584373, 584374, 584356, 584357, 584358], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-1.6172e+00, -2.4922e+00, -3.0977e+00,  ...,  8.5107e-01,
           1.0244e+00,  5.6836e-01],
         [ 9.1748e-01, -2.1465e+00, -1.5869e+00,  ..., -3.4512e+00,
          -3.0059e+00, -8.9551e-01],
         [-8.3801e-02, -2.8418e+00, -1.6182e+00,  ..., -1.9375e+00,
           4.6362e-01,  4.0649e-01],
         ...,
         [-1.1445e+00, -6.4307e-01,  4.1284e-01,  ..., -8.8477e-01,
          -3.2910e-01, -2.6035e+00],
         [ 3.6816e-01,  3.4546e-01, -2.1826e-01,  ...,  1.2891e+00,
          -1.2334e+00, -3.2207e+00],
         [ 2.0977e+00, -2.0781e+00, -1.0127e+00,  ...,  1.1172e+00,
           1.4795e-01,  3.0977e+00]],

        [[-3.8916e-01, -2.3223e+00, -2.9902e+00,  ...,  7.9395e-01,
           1.2363e+00,  5.4492e-01],
         [ 2.2227e+00, -1.5010e+00,  4.8315e-01,  ..., -3.6406e+00,
          -1.6514e+00, -1.2051e+00],
         [ 6.4551e-01, -2.3867e+00, -1.5908e+00,  ..., -1.8857e+00,
           4.5459e-01,  6.2695e-01],
         ...,
         [-3.5327e-01, -5.8203e-01,  1.1846e+00,  ..., -2.0371e+00,
           3.6316e-02, -2.0645e+00],
         [ 3.0542e-01, -4.3018e-01, -5.3040e-02,  ...,  1.0615e+00,
          -8.6768e-01, -3.2676e+00],
         [ 4.4434e-01, -3.4155e-01, -2.5547e+00,  ...,  1.9248e+00,
           2.3706e-01,  3.8745e-01]],

        [[-1.0645e+00, -2.3086e+00, -2.4512e+00,  ...,  7.0850e-01,
           1.4736e+00,  5.2441e-01],
         [ 3.0518e-01, -1.7129e+00, -1.1426e+00,  ..., -3.4102e+00,
          -1.7148e+00,  8.5059e-01],
         [-3.8892e-01, -2.8145e+00,  5.5811e-01,  ..., -1.8018e+00,
           2.9727e+00,  3.4985e-01],
         ...,
         [ 1.4502e-01, -1.3555e+00,  1.9336e+00,  ..., -2.0195e+00,
          -1.6445e+00, -2.0684e+00],
         [-1.3892e-01, -5.1514e-01, -5.6006e-01,  ...,  9.2529e-01,
          -2.0703e+00, -2.9375e+00],
         [-3.0502e-02, -1.8418e+00, -7.9443e-01,  ...,  1.3984e+00,
           1.8457e+00, -2.4727e+00]],

        [[-1.6494e+00, -2.2871e+00, -3.0273e+00,  ...,  8.6865e-01,
           1.1836e+00,  6.3379e-01],
         [ 1.1953e+00, -1.6953e+00, -8.4082e-01,  ..., -3.4141e+00,
          -2.5566e+00, -1.0557e+00],
         [-1.0602e-01, -2.5801e+00, -2.0430e+00,  ..., -1.9473e+00,
           6.9580e-01,  1.5106e-03],
         ...,
         [-1.5186e+00, -5.5176e-01, -1.2091e-01,  ...,  8.1494e-01,
          -5.1074e-01, -2.1777e+00],
         [ 1.2012e+00,  5.8899e-02,  7.2021e-02,  ...,  1.2998e+00,
          -1.9082e+00, -3.2793e+00],
         [ 8.5938e-01, -1.5186e+00, -1.0957e+00,  ...,  1.2559e+00,
           8.0078e-02,  2.5176e+00]],

        [[-7.0264e-01, -2.4062e+00, -3.1445e+00,  ...,  8.3594e-01,
           1.2109e+00,  5.6738e-01],
         [ 3.3848e+00, -1.2598e+00, -4.0430e-01,  ..., -3.3574e+00,
          -2.0820e+00, -1.1572e+00],
         [-4.0619e-02, -1.9414e+00, -1.6426e+00,  ..., -2.0254e+00,
           6.4893e-01, -7.2998e-02],
         ...,
         [-1.2539e+00, -4.7632e-01,  4.6509e-01,  ..., -1.1514e+00,
           8.7097e-02, -2.5449e+00],
         [ 4.1870e-01, -6.7236e-01,  2.8152e-02,  ...,  1.0996e+00,
          -1.3037e+00, -3.2754e+00],
         [ 1.3733e-01, -6.9824e-01, -2.5918e+00,  ...,  1.8779e+00,
           3.1714e-01, -1.6943e-01]],

        [[-1.4238e+00, -2.3457e+00, -2.9199e+00,  ...,  7.9883e-01,
           1.9316e+00,  5.5566e-01],
         [ 1.4395e+00, -2.0742e+00, -1.9053e+00,  ..., -4.0352e+00,
          -2.7969e+00,  1.0215e+00],
         [ 1.4412e-02, -2.1133e+00, -1.0566e+00,  ..., -2.1680e+00,
           2.3047e-01,  8.9648e-01],
         ...,
         [-6.1584e-02, -6.1768e-01,  2.8931e-01,  ..., -1.3691e+00,
          -1.3691e+00, -3.4746e+00],
         [ 4.8706e-01, -1.3398e+00,  3.9160e-01,  ...,  1.1484e+00,
          -2.0430e+00, -3.5820e+00],
         [-1.3647e-01,  6.4551e-01, -1.1064e+00,  ...,  5.8887e-01,
          -1.4746e-01, -8.1055e-01]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584373, 584374, 584356, 584357, 584358], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-1.0469, -1.3086,  0.4819,  ...,  0.6055,  1.9004, -1.1084],
         [-1.3604,  0.1569, -0.4314,  ...,  1.0029, -0.2600, -0.4651],
         [-0.0847,  1.0664,  3.0586,  ...,  1.3691, -0.3965, -2.7441],
         ...,
         [-1.9189, -0.8828, -4.1289,  ...,  0.2729,  0.8081, -1.1592],
         [ 3.5234,  1.1689, -0.2939,  ...,  0.4885, -0.1453,  1.5596],
         [-3.5605, -1.2881,  0.6792,  ..., -0.4395,  0.5386, -1.6025]],

        [[-0.6597, -0.9438,  0.4062,  ..., -0.6724,  1.8359, -1.3955],
         [-1.1260, -0.0694, -0.5044,  ...,  0.7974,  0.6597, -1.2900],
         [ 0.4358,  1.0596,  1.5254,  ...,  1.2227,  2.0449, -3.0000],
         ...,
         [-1.4727,  0.0591, -4.5273,  ..., -0.3042,  1.1836, -1.8242],
         [ 2.3672,  3.4609,  1.6006,  ..., -1.3711,  0.9360,  2.1562],
         [-3.7520, -0.4373, -0.6313,  ..., -0.9624,  2.3945, -2.3418]],

        [[-1.5098,  2.1934,  1.7998,  ...,  0.9438,  1.8330, -0.8516],
         [-1.5312,  0.7603, -1.0908,  ...,  0.0820, -0.4937,  0.3513],
         [-0.1226,  1.4570,  1.4258,  ...,  0.4431, -0.3733, -1.2949],
         ...,
         [-1.6855, -0.4648, -3.7500,  ..., -0.5474,  1.2168, -1.0801],
         [ 2.0703,  1.9922, -1.0527,  ...,  0.1891,  1.3613,  0.4949],
         [-3.4844,  0.6968, -1.3984,  ..., -0.7847,  0.5518,  0.6494]],

        [[-0.0718, -1.1855,  0.1880,  ...,  0.6807,  2.2227, -0.3533],
         [-2.0371, -0.1249, -0.4485,  ...,  1.4229,  0.6631, -0.9888],
         [-0.5898,  1.1748,  2.6211,  ...,  0.4292,  0.2236, -3.0430],
         ...,
         [-2.3828, -0.5928, -3.8418,  ..., -0.0154,  1.3311, -1.3926],
         [ 3.4844,  1.2090, -0.2310,  ...,  0.2063,  0.3638,  1.8652],
         [-4.1953, -0.7051,  0.4150,  ..., -0.6050, -0.0368, -0.2441]],

        [[-0.7725, -0.9829,  0.7793,  ...,  0.4573,  1.9834, -1.3838],
         [-0.9873, -0.4048, -0.8003,  ...,  0.8784,  0.8628, -1.1602],
         [-0.5107,  0.4402,  1.6465,  ...,  0.8931,  1.9971, -2.9824],
         ...,
         [-0.8457, -0.1803, -5.1445,  ..., -1.1553,  0.1711, -2.1406],
         [ 1.8438,  2.6348,  1.6025,  ..., -0.7695,  2.2637,  2.5938],
         [-4.0430, -0.4802, -1.3174,  ..., -1.4336,  2.5977, -1.6455]],

        [[ 0.3015, -0.9570,  0.5059,  ..., -0.3899,  3.0605, -2.0605],
         [-1.3193, -0.0523, -1.0938,  ...,  0.7871, -0.5830, -0.4963],
         [-0.9878,  1.2236,  1.6602,  ...,  1.9590,  1.4863, -1.2295],
         ...,
         [-1.2041, -0.0818, -5.2344,  ..., -0.5957,  0.4661, -2.3926],
         [ 2.2090,  3.0762,  2.3770,  ..., -1.1641,  3.3809,  2.5078],
         [-3.3711,  0.4644, -0.1951,  ..., -1.4766,  2.0059, -1.7363]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584373, 584374, 584356, 584357, 584358], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[ 1.0742e+00, -1.5400e+00, -3.7158e-01,  ..., -2.7617e+00,
           1.6299e+00, -9.5459e-01],
         [-1.4619e+00, -1.2705e+00,  3.2461e+00,  ...,  1.3623e+00,
          -2.1934e+00,  2.7988e+00],
         [ 5.4626e-03,  7.0459e-01, -1.2383e+00,  ..., -7.1338e-01,
           1.2000e-01, -1.6885e+00],
         ...,
         [ 4.0649e-01,  3.2104e-01, -1.2012e+00,  ..., -1.4717e+00,
          -2.9531e+00, -3.2739e-01],
         [ 1.2920e+00, -2.2754e+00,  1.4082e+00,  ...,  1.4756e+00,
          -4.1309e-01,  6.2305e-01],
         [-8.5889e-01,  3.1934e-01,  3.5664e+00,  ..., -1.0127e+00,
           4.5197e-02, -6.4453e-01]],

        [[ 2.2188e+00, -2.2695e+00, -1.6943e-01,  ..., -2.0918e+00,
           1.6738e+00,  7.7002e-01],
         [-1.3994e+00, -1.4287e+00,  2.1133e+00,  ..., -2.0996e+00,
          -1.6074e+00,  2.8887e+00],
         [ 1.2177e-01,  1.3555e+00, -1.1660e+00,  ..., -1.0020e+00,
           7.0898e-01, -2.5625e+00],
         ...,
         [ 1.0791e+00,  7.1387e-01, -2.1367e+00,  ..., -1.5098e+00,
          -2.0586e+00, -3.1006e-01],
         [ 1.7725e+00, -2.8574e+00,  1.4346e+00,  ...,  1.5088e+00,
           4.3762e-02, -1.8896e-01],
         [-6.4648e-01,  3.8525e-01,  9.2529e-01,  ..., -3.1860e-01,
           5.5359e-02, -2.3230e-01]],

        [[ 1.5215e+00, -1.5791e+00, -1.0215e+00,  ..., -1.8955e+00,
           9.0088e-01,  1.0166e+00],
         [ 1.6443e-01, -4.8242e-01,  2.1406e+00,  ..., -6.8542e-02,
          -1.4600e-01,  9.0820e-01],
         [-2.3315e-01,  2.5757e-01,  5.2295e-01,  ..., -8.2861e-01,
           2.7856e-01, -2.1445e+00],
         ...,
         [ 8.7305e-01, -1.0752e+00, -1.4629e+00,  ..., -1.0068e+00,
          -1.8662e+00, -2.0410e-01],
         [ 1.1533e+00, -1.6348e+00,  1.7305e+00,  ...,  2.7793e+00,
           7.5134e-02, -2.0703e+00],
         [-4.0955e-02,  1.1875e+00,  5.2295e-01,  ..., -2.7124e-01,
          -4.2529e-01, -5.6738e-01]],

        [[ 5.1904e-01, -1.0820e+00, -1.1650e+00,  ..., -1.8711e+00,
           1.1680e+00, -6.3672e-01],
         [-1.8301e+00, -1.2725e+00,  2.9551e+00,  ...,  2.2188e+00,
          -1.8623e+00,  2.5332e+00],
         [ 3.9648e-01,  2.7676e+00, -1.3398e+00,  ..., -7.2119e-01,
          -7.7783e-01, -1.9307e+00],
         ...,
         [ 5.6982e-01,  2.3657e-01, -2.0391e+00,  ..., -1.1455e+00,
          -4.0156e+00,  3.3301e-01],
         [ 3.7022e-03, -2.9082e+00,  2.4219e+00,  ...,  2.8027e-01,
           4.6558e-01,  3.9355e-01],
         [-9.5020e-01,  3.6499e-01,  3.4746e+00,  ..., -2.1367e+00,
          -2.5122e-01, -1.4072e+00]],

        [[ 2.1172e+00, -1.9160e+00, -3.3691e-01,  ..., -2.6738e+00,
           1.4248e+00, -4.8657e-01],
         [ 5.2295e-01, -2.9629e+00,  1.9541e+00,  ...,  2.2534e-01,
          -1.8281e+00,  2.2812e+00],
         [ 6.0059e-01,  2.5293e+00, -1.9854e+00,  ..., -1.3818e+00,
          -7.8516e-01, -2.4023e+00],
         ...,
         [ 9.8633e-01,  8.5547e-01, -2.3359e+00,  ..., -1.9053e+00,
          -3.0430e+00,  3.8867e-01],
         [ 1.6699e+00, -3.0840e+00,  1.6719e+00,  ...,  8.2764e-01,
           8.1543e-01, -2.5537e-01],
         [-8.5645e-01,  5.5664e-01,  5.1123e-01,  ..., -1.6982e+00,
           4.0723e-01, -3.9917e-01]],

        [[ 7.8906e-01, -1.8906e+00, -1.0361e+00,  ..., -2.2754e+00,
           1.3945e+00,  4.9390e-01],
         [-3.0469e-01, -2.1445e+00,  2.7344e+00,  ...,  9.8389e-01,
          -1.4121e+00,  1.5596e+00],
         [ 1.6982e+00, -8.5547e-01, -1.5635e+00,  ..., -7.5977e-01,
          -4.3506e-01, -9.0625e-01],
         ...,
         [ 6.9678e-01,  9.0576e-01, -1.5352e+00,  ..., -1.3594e+00,
          -3.0508e+00, -9.4824e-01],
         [ 1.4355e+00, -2.5215e+00,  1.7959e+00,  ...,  4.9658e-01,
           8.3887e-01, -2.3457e+00],
         [-2.6221e-01,  1.2783e+00,  3.6475e-01,  ..., -1.7881e+00,
           1.6333e-01, -1.2930e+00]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584373, 584374, 584356, 584357, 584358], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-1.6514e+00, -1.2080e+00, -1.3213e+00,  ..., -2.2188e+00,
          -2.6504e+00,  3.2383e+00],
         [ 3.8306e-01, -3.7231e-01, -2.7148e-01,  ...,  1.3770e-01,
           1.5771e-01, -1.7529e+00],
         [ 1.0566e+00,  3.7266e+00, -3.4551e+00,  ...,  3.9893e-01,
          -8.1543e-01,  7.7148e-01],
         ...,
         [ 3.3081e-01, -4.6641e+00,  1.3057e+00,  ...,  3.9368e-02,
           6.5137e-01,  4.2505e-01],
         [ 2.6914e+00,  1.8721e+00,  1.0635e+00,  ..., -1.4453e+00,
          -1.5918e-01,  7.1729e-01],
         [ 5.6152e-01, -6.3574e-01,  6.1475e-01,  ...,  2.4922e+00,
          -7.2949e-01,  8.3691e-01]],

        [[-2.2422e+00, -9.4727e-02, -2.7227e+00,  ..., -2.3262e+00,
          -3.3438e+00,  3.7441e+00],
         [-8.6426e-02, -1.2354e+00, -2.3425e-01,  ..., -8.8281e-01,
           3.7378e-01, -2.2188e+00],
         [ 2.1816e+00,  2.0586e+00, -2.4941e+00,  ...,  1.3135e-01,
          -6.9971e-01,  7.6855e-01],
         ...,
         [ 2.0703e+00, -5.6641e+00,  1.4521e+00,  ...,  5.9814e-01,
          -1.2773e+00,  7.4121e-01],
         [ 3.3242e+00,  1.4717e+00,  2.1621e+00,  ..., -7.8076e-01,
          -5.8545e-01,  9.5337e-02],
         [ 9.3359e-01, -8.2617e-01,  2.7271e-01,  ...,  2.5293e+00,
          -8.0933e-02,  1.1846e+00]],

        [[-1.4453e+00,  3.5675e-02, -3.2441e+00,  ..., -4.0308e-01,
          -2.0000e+00,  2.5645e+00],
         [-1.4270e-01,  7.5830e-01, -1.3779e+00,  ..., -2.3418e+00,
           1.6626e-01, -5.0439e-01],
         [ 1.0176e+00,  1.5410e+00, -1.7295e+00,  ..., -6.2061e-01,
          -4.8584e-01,  1.0479e+00],
         ...,
         [ 1.2715e+00, -4.3359e+00,  1.6445e+00,  ...,  1.4551e-01,
          -2.8223e-01,  1.5840e+00],
         [ 2.4238e+00,  1.0684e+00,  1.8174e+00,  ..., -2.3218e-01,
           3.5254e-01,  2.3572e-01],
         [ 3.0586e+00, -1.1670e+00, -3.3600e-02,  ...,  2.3555e+00,
           5.4102e-01,  1.5059e+00]],

        [[-1.6250e+00, -1.4756e+00, -1.4131e+00,  ..., -1.9775e+00,
          -2.1074e+00,  3.5918e+00],
         [ 8.2568e-01, -1.9617e-01, -1.1963e+00,  ..., -2.2766e-01,
          -3.7036e-01, -2.0566e+00],
         [ 9.3408e-01,  3.3574e+00, -2.8770e+00,  ..., -1.0645e-01,
          -7.1436e-01,  1.4087e-01],
         ...,
         [ 1.6016e+00, -4.8828e+00,  1.0020e+00,  ...,  7.2119e-01,
           4.5361e-01,  9.8047e-01],
         [ 2.8633e+00,  2.1191e+00,  9.1553e-01,  ..., -1.8369e+00,
          -4.1351e-03,  8.4619e-01],
         [-2.4182e-01, -1.3711e+00,  9.4727e-01,  ...,  2.6973e+00,
          -6.4648e-01,  1.0693e+00]],

        [[-1.9287e+00, -4.4531e-01, -3.1484e+00,  ..., -1.9473e+00,
          -2.7402e+00,  4.5703e+00],
         [ 3.0078e-01, -8.1689e-01, -5.5566e-01,  ..., -8.2959e-01,
           1.5430e-01, -2.4863e+00],
         [ 2.1348e+00,  2.1328e+00, -3.0684e+00,  ..., -1.0101e-01,
          -8.7842e-01,  1.0000e+00],
         ...,
         [ 7.5293e-01, -5.9844e+00,  6.8018e-01,  ...,  1.0175e-01,
          -1.2832e+00,  1.2334e+00],
         [ 2.8320e+00,  1.7168e+00,  1.2539e+00,  ..., -1.2275e+00,
          -6.0156e-01,  3.5132e-01],
         [ 2.1216e-01, -7.0898e-01,  1.1514e+00,  ...,  3.0371e+00,
          -2.9419e-01,  1.3984e+00]],

        [[-1.1689e+00, -3.6987e-01, -2.7812e+00,  ..., -5.6445e-01,
          -3.1602e+00,  4.5391e+00],
         [ 6.2695e-01, -8.2080e-01, -1.2803e+00,  ..., -1.9551e+00,
           1.3184e-01, -1.6191e+00],
         [ 8.1055e-01,  2.6113e+00, -2.6562e+00,  ..., -9.0137e-01,
          -7.0703e-01,  8.5205e-02],
         ...,
         [ 1.5986e+00, -5.3516e+00,  2.5723e+00,  ...,  2.3438e-02,
          -1.6982e+00,  2.4551e+00],
         [ 1.9180e+00, -2.6196e-01,  3.4888e-01,  ..., -1.1592e+00,
           2.8275e-02,  2.9175e-01],
         [ 4.7168e-01, -1.6904e+00, -8.6523e-01,  ...,  2.4902e+00,
          -3.4717e-01,  1.5664e+00]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584373, 584374, 584356, 584357, 584358], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-2.0664e+00, -7.9102e-01, -3.0176e+00,  ...,  8.9648e-01,
          -1.4395e+00,  2.0215e+00],
         [-1.6172e+00, -7.0068e-01, -1.3633e+00,  ..., -2.6074e-01,
           1.1847e-01, -1.0137e+00],
         [ 2.0293e+00, -2.1814e-01, -5.9570e-01,  ..., -1.1113e+00,
          -2.8760e-01,  2.0977e+00],
         ...,
         [ 1.2188e+00, -5.8828e+00,  7.9639e-01,  ..., -2.6426e+00,
           7.5293e-01,  6.9531e+00],
         [ 1.7656e+00,  8.2812e-01,  9.3652e-01,  ..., -2.4316e+00,
           7.3730e-01,  2.1836e+00],
         [-4.8584e-01, -3.1299e-01,  5.3906e-01,  ..., -4.1284e-01,
          -4.1235e-01,  1.1145e-01]],

        [[ 1.7700e-01, -5.2490e-01, -1.8398e+00,  ...,  3.3545e-01,
          -9.6729e-01,  1.5254e+00],
         [-1.1250e+00, -1.4014e+00, -5.5664e-01,  ...,  1.1748e+00,
           1.2299e-01, -1.3457e+00],
         [ 3.4277e-01,  3.5815e-01, -4.3872e-01,  ..., -4.0845e-01,
          -8.1250e-01,  1.8164e+00],
         ...,
         [ 1.7314e+00, -5.9844e+00,  9.2529e-01,  ..., -1.9355e+00,
           4.4531e-01,  5.8438e+00],
         [ 4.1797e-01,  1.1367e+00,  1.9580e+00,  ..., -1.5967e+00,
           5.2295e-01,  1.1553e+00],
         [-1.9590e+00, -1.1804e-01,  1.9745e-02,  ..., -1.1650e+00,
          -3.5718e-01, -2.2461e-01]],

        [[-1.7603e-01,  3.0591e-01,  1.1094e+00,  ..., -1.5088e+00,
          -6.7529e-01, -1.0752e+00],
         [ 1.2000e-01, -1.5369e-01,  3.1348e-01,  ...,  5.0244e-01,
          -2.7832e-01, -1.8086e+00],
         [-8.4814e-01,  1.2305e+00, -4.8657e-01,  ..., -1.8457e-01,
          -1.9473e+00,  1.6582e+00],
         ...,
         [ 1.0898e+00, -5.1914e+00,  1.6416e+00,  ..., -1.5117e+00,
           3.2397e-01,  5.6875e+00],
         [ 1.6260e+00,  2.1008e-01, -1.7603e-01,  ..., -2.7686e-01,
          -7.9407e-02,  1.0391e+00],
         [-1.6738e+00, -1.0889e+00,  1.6998e-02,  ..., -2.3718e-01,
           3.1616e-01, -1.0266e-01]],

        [[-1.8623e+00, -2.7383e+00, -2.6016e+00,  ...,  3.2446e-01,
          -1.4268e+00, -5.2686e-01],
         [-2.3145e+00, -5.6183e-02, -1.3193e+00,  ..., -2.2449e-01,
           4.4409e-01, -1.7637e+00],
         [ 1.1289e+00, -2.5366e-01,  6.6504e-01,  ..., -1.8770e+00,
          -3.3081e-01,  2.4355e+00],
         ...,
         [ 1.5596e+00, -6.2031e+00,  1.2334e+00,  ..., -1.8105e+00,
           7.2119e-01,  6.2422e+00],
         [ 2.2871e+00,  9.9756e-01,  1.0254e+00,  ..., -2.2070e+00,
           7.9883e-01,  1.8535e+00],
         [-1.6736e-01,  3.7793e-01,  1.1846e+00,  ..., -2.9712e-01,
          -1.6846e-01, -9.0771e-01]],

        [[ 8.6328e-01, -1.7168e+00, -1.7930e+00,  ...,  6.1719e-01,
          -6.5186e-01,  4.4580e-01],
         [-1.6270e+00, -8.1201e-01, -9.4971e-01,  ..., -3.6548e-01,
          -4.9194e-01, -1.8057e+00],
         [-1.4902e+00,  6.1523e-01,  8.0225e-01,  ..., -1.3164e+00,
          -1.1250e+00,  8.3691e-01],
         ...,
         [ 1.9971e+00, -6.2070e+00,  1.0088e+00,  ..., -8.6963e-01,
          -2.8973e-03,  5.3008e+00],
         [ 1.5049e+00,  1.1709e+00,  9.7656e-01,  ..., -5.6641e-01,
           2.8564e-01,  1.0986e+00],
         [-1.2866e-01, -1.7603e-01,  1.0488e+00,  ..., -1.4736e+00,
          -3.6530e-02, -1.1514e+00]],

        [[ 1.6650e+00, -4.8096e-01, -1.8152e-01,  ...,  1.4502e+00,
          -5.4346e-01, -6.3354e-02],
         [-1.6299e+00, -8.2324e-01, -7.4951e-01,  ..., -5.8350e-01,
           4.5435e-01, -1.2646e+00],
         [-4.1016e-01, -1.5236e-02,  6.9189e-01,  ..., -1.6680e+00,
          -2.3340e+00,  9.1016e-01],
         ...,
         [ 2.0137e+00, -5.7109e+00,  1.2500e+00,  ..., -1.6484e+00,
           5.6689e-01,  6.0469e+00],
         [ 1.8740e+00,  1.1328e+00, -2.4918e-02,  ..., -4.3506e-01,
           1.0127e+00,  4.8804e-01],
         [-2.2552e-02, -7.6172e-01,  1.0820e+00,  ..., -1.4326e+00,
           2.0496e-01, -5.9814e-01]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584373, 584374, 584356, 584357, 584358], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-1.6074, -0.6079, -0.8218,  ..., -0.2377,  0.3247,  0.7129],
         [-1.6914,  1.3320,  3.1621,  ...,  0.5698, -0.5269,  0.7183],
         [-1.5273, -1.8701,  2.7441,  ...,  1.6064, -0.5254, -0.6489],
         ...,
         [ 1.4170,  1.4375,  0.6958,  ...,  0.3608, -0.2186, -1.6963],
         [ 0.6982,  0.2456, -1.4619,  ...,  0.6377, -0.4241, -1.2275],
         [-1.1260,  1.8965,  0.1986,  ...,  2.4492,  0.7944, -1.9277]],

        [[-0.9785, -0.9980, -0.2754,  ..., -0.1742,  0.5269, -0.2969],
         [-1.2031,  1.1016,  3.0742,  ..., -0.0984, -0.5850,  0.3413],
         [-2.0078, -1.3057,  2.0859,  ...,  2.1758, -0.9683, -1.2412],
         ...,
         [ 1.8525,  0.6382,  1.3164,  ...,  1.0977,  0.1622, -1.5781],
         [ 1.2529, -0.2839, -1.3662,  ...,  0.7095,  0.4993, -0.8638],
         [-0.0571,  1.8994, -1.1484,  ...,  2.8301,  2.3516, -1.8555]],

        [[-2.0801, -1.8262,  0.1670,  ...,  0.1964, -0.1995, -1.3057],
         [-0.3853, -0.4861,  2.8691,  ...,  1.3232, -2.5645, -1.1572],
         [-2.0977, -1.1514,  0.3171,  ...,  0.8735, -1.8535, -2.1211],
         ...,
         [ 1.8486, -0.3196, -0.2820,  ..., -0.7974, -0.5894, -0.2832],
         [ 1.3037,  0.7769, -0.9116,  ...,  0.7485, -0.4653,  0.1587],
         [-0.6553,  1.6270, -1.3154,  ...,  3.9316,  1.3730, -1.4492]],

        [[-1.1104, -0.3936, -0.8232,  ..., -0.3596,  0.4609,  0.5234],
         [-1.9150,  1.3584,  2.5566,  ..., -0.2384, -0.7700,  0.9409],
         [-0.7285, -2.1113,  3.3945,  ...,  1.1855, -0.9946,  0.0583],
         ...,
         [ 1.1641,  1.1973,  1.2090,  ...,  0.4004,  1.1396, -2.2969],
         [ 0.6855,  0.2229, -0.0367,  ...,  0.7183, -0.2908, -0.5142],
         [-0.9204,  2.3281,  0.0817,  ...,  1.6406,  0.5732, -2.0215]],

        [[-0.4250, -0.7563, -0.1996,  ..., -0.1777,  0.2354,  1.2871],
         [-0.6211,  1.0957,  3.7695,  ..., -0.8838, -1.3418,  0.2286],
         [-1.8252, -1.4668,  2.0742,  ...,  1.6240, -0.2744, -0.7246],
         ...,
         [ 1.1309,  0.3008,  1.6562,  ...,  0.6577,  1.3613, -2.2363],
         [ 0.9106,  0.0547, -0.5737,  ...,  0.4788,  0.7236, -0.2136],
         [-1.0049,  2.4961, -0.7490,  ...,  2.0859,  0.7061, -2.6387]],

        [[-1.3008, -1.4170, -0.4221,  ...,  0.6865, -0.3689, -0.0942],
         [ 0.6406,  0.5444,  2.9297,  ..., -0.9287, -3.0000,  0.0590],
         [-1.8467, -2.3496,  2.0723,  ...,  2.0566, -0.5156, -1.0625],
         ...,
         [ 1.0449,  0.5127,  0.3787,  ...,  0.0930,  0.4517, -1.3066],
         [ 1.5547,  0.0938,  0.4651,  ..., -0.7612,  0.8945,  0.6860],
         [-1.6670,  2.0625, -0.8330,  ...,  3.4219,  0.1364, -3.4062]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584373, 584374, 584356, 584357, 584358], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[ 1.9226e-01,  8.7695e-01, -6.9629e-01,  ...,  1.4600e-01,
          -4.7778e-01, -2.1055e+00],
         [-1.5732e+00, -1.1787e+00, -6.3867e-01,  ..., -1.7578e+00,
          -1.1670e+00, -3.8916e-01],
         [ 3.6230e-01,  7.8516e-01,  2.8984e+00,  ..., -9.9365e-01,
           4.2529e-01, -9.9854e-01],
         ...,
         [-1.2480e+00,  9.7217e-01, -4.8340e-01,  ..., -1.1875e+00,
           6.3770e-01, -1.5566e+00],
         [ 5.0049e-01,  9.4910e-02, -1.7559e+00,  ...,  6.7090e-01,
           1.3916e+00,  8.2764e-01],
         [-7.7930e-01,  8.5547e-01, -1.5928e+00,  ...,  1.3896e+00,
           6.3184e-01, -9.2139e-01]],

        [[ 3.1226e-01,  8.2031e-01, -1.9702e-01,  ...,  8.8916e-01,
          -5.6396e-01, -1.7041e+00],
         [-1.2578e+00, -5.6592e-01, -5.0977e-01,  ..., -2.3613e+00,
          -1.8760e+00, -1.3879e-01],
         [ 7.7783e-01,  4.4507e-01,  2.0371e+00,  ...,  2.7344e-01,
           9.4043e-01, -5.6738e-01],
         ...,
         [-1.8877e+00,  1.2910e+00,  1.9089e-02,  ..., -1.1562e+00,
           4.7461e-01, -1.8096e+00],
         [ 3.8055e-02,  2.1387e-01, -2.1211e+00,  ...,  1.4619e+00,
           9.5752e-01,  2.2969e+00],
         [-5.6494e-01,  3.2935e-01, -8.3057e-01,  ...,  2.9150e-01,
           1.0205e+00, -5.8057e-01]],

        [[-2.9565e-01,  1.2412e+00, -3.0493e-01,  ...,  4.7266e-01,
          -6.8262e-01, -1.2998e+00],
         [ 2.9199e-01, -1.1738e+00, -2.1172e+00,  ..., -6.5186e-01,
          -3.5767e-01, -9.6777e-01],
         [-2.7344e-01,  4.3188e-01,  1.2793e+00,  ...,  1.0830e+00,
           6.7236e-01,  1.7441e+00],
         ...,
         [-1.5234e+00,  7.4316e-01, -6.7139e-01,  ..., -5.0146e-01,
           1.5703e+00, -9.4141e-01],
         [-1.1456e-01,  1.2445e-01, -1.1670e+00,  ...,  1.4502e+00,
          -1.3369e+00,  1.0361e+00],
         [-3.4668e-01, -3.0103e-01,  1.7843e-03,  ..., -5.9131e-01,
          -1.0596e+00, -7.8430e-02]],

        [[ 4.6509e-01,  5.8301e-01, -2.2388e-01,  ..., -7.5635e-01,
          -7.7637e-01, -2.5391e+00],
         [-1.1387e+00, -1.1836e+00, -8.0762e-01,  ..., -2.3203e+00,
          -9.2578e-01, -2.3535e-01],
         [ 4.6924e-01,  6.0986e-01,  1.7666e+00,  ..., -1.2070e+00,
           6.0645e-01, -5.8789e-01],
         ...,
         [-1.1133e+00,  1.5710e-01, -3.4277e-01,  ..., -1.3613e+00,
           4.6265e-01, -1.3574e+00],
         [-9.6863e-02,  6.8420e-02, -1.4297e+00,  ...,  5.6543e-01,
           1.0537e+00, -5.7526e-03],
         [ 2.0850e-01,  9.3115e-01, -2.4375e+00,  ...,  1.3223e+00,
           1.0957e+00, -9.8145e-01]],

        [[ 5.0830e-01,  6.7334e-01,  3.2837e-01,  ...,  3.9893e-01,
          -1.0771e+00, -1.8467e+00],
         [-1.3369e+00, -3.3301e-01, -1.0312e+00,  ..., -2.1816e+00,
          -1.8008e+00,  1.7261e-01],
         [ 9.5264e-01, -3.9087e-01,  2.5293e+00,  ...,  9.3750e-01,
           7.2461e-01, -4.1528e-01],
         ...,
         [-1.3750e+00,  5.9521e-01, -6.9678e-01,  ..., -7.1875e-01,
           6.1279e-01, -1.2471e+00],
         [-1.2744e-01, -2.3938e-01, -9.6387e-01,  ...,  4.8065e-02,
           9.7217e-01,  1.3555e+00],
         [-3.2397e-01,  1.7773e+00, -1.3359e+00,  ...,  1.2236e+00,
           9.7070e-01, -1.4883e+00]],

        [[-5.5420e-01,  1.1768e+00, -3.9917e-01,  ...,  4.8193e-01,
           1.7407e-01, -1.1221e+00],
         [ 2.6636e-01, -3.6792e-01, -1.9189e+00,  ..., -1.2178e+00,
          -1.9395e+00, -5.8936e-01],
         [ 9.9219e-01, -2.1606e-01,  1.9277e+00,  ...,  1.0510e-01,
           1.3760e+00,  1.7998e+00],
         ...,
         [-9.1553e-01,  6.7480e-01, -1.0547e+00,  ..., -3.5962e-01,
           1.2275e+00, -3.7329e-01],
         [-1.2363e+00,  8.2080e-01, -6.8994e-01,  ...,  2.0325e-01,
           7.7454e-02,  1.2451e+00],
         [-4.7778e-01,  1.4648e+00, -1.9150e+00,  ..., -8.7891e-02,
           2.3779e-01,  6.2598e-01]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584373, 584374, 584356, 584357, 584358], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[ 1.1699, -1.5156, -2.2559,  ..., -0.0375, -2.9336, -0.2112],
         [-0.4683,  1.4648, -0.6777,  ...,  1.6025,  2.8887, -1.3623],
         [ 3.1562,  1.5791,  0.5430,  ..., -1.7666,  2.7324,  0.7573],
         ...,
         [-2.2598,  0.7788,  0.8389,  ...,  0.6040,  0.0740,  1.7070],
         [ 1.9189,  0.6113, -1.2529,  ...,  1.0547, -3.5195, -0.1567],
         [-0.1689, -0.4441, -0.6924,  ..., -0.1146,  0.8916,  0.0551]],

        [[ 0.7002, -2.3652, -1.5107,  ...,  0.2327, -3.1836, -0.3325],
         [-1.0664,  2.7109, -0.1775,  ...,  1.0742,  2.9238, -1.5312],
         [ 2.9316,  1.1299,  0.6216,  ..., -1.9873,  3.0352,  0.1914],
         ...,
         [-1.9365,  1.2178,  0.7480,  ..., -0.1472,  0.6226,  2.0391],
         [ 0.7749,  0.9854, -1.4824,  ...,  2.1152, -2.9375,  0.5474],
         [-0.7251, -0.3459, -0.3647,  ..., -0.2158,  1.1777, -0.8184]],

        [[-0.1624, -0.1232, -1.2432,  ...,  0.1558, -3.2617, -0.4380],
         [-0.0541,  0.9531, -1.3535,  ..., -0.5508,  1.5928, -0.6377],
         [ 2.7266,  0.0700,  0.6709,  ..., -0.6636,  2.2500, -0.9224],
         ...,
         [-1.7598,  1.9316,  1.8584,  ..., -0.9795, -1.1064,  1.3018],
         [ 0.6758,  0.8232, -1.9746,  ...,  1.4609, -3.3457,  0.5732],
         [-0.2164, -1.2637, -0.0266,  ..., -0.0895,  1.8018, -0.5513]],

        [[ 1.1006, -1.7412, -2.6465,  ...,  0.8740, -3.2051, -0.7515],
         [-0.7764,  1.5283, -1.5664,  ...,  0.7002,  1.7646, -1.8525],
         [ 3.2695,  1.3838,  0.2107,  ..., -0.8843,  2.7305,  1.7246],
         ...,
         [-1.1162,  0.8379,  1.0742,  ...,  0.1417, -0.1415,  0.6387],
         [ 1.2715,  0.1227, -1.1934,  ...,  2.5664, -3.3203, -0.7505],
         [-0.3013,  0.0618, -0.0567,  ..., -0.8320,  0.6860,  1.1123]],

        [[ 1.0938, -2.0234, -2.1387,  ...,  1.4404, -2.7598, -0.2478],
         [-0.7241,  1.9424, -0.2042,  ...,  0.4558,  1.2002, -1.7734],
         [ 2.4785,  1.1055,  0.0945,  ..., -1.1240,  2.7051,  1.1641],
         ...,
         [-1.4619,  1.3115,  0.0706,  ...,  0.6421,  1.2812,  0.0854],
         [ 0.7705, -0.0471, -1.4590,  ...,  3.3203, -2.6270,  0.2498],
         [ 0.2457, -0.2476,  0.0362,  ..., -1.4561,  0.4255,  0.2622]],

        [[-0.4343, -1.9326, -1.5098,  ..., -0.1747, -2.7148,  0.1112],
         [-1.0908,  1.6299, -0.5264,  ...,  0.7910,  0.8794, -1.7861],
         [ 3.4258,  1.6992, -1.4893,  ...,  0.3342,  0.5273,  0.0545],
         ...,
         [-0.2435,  0.4985,  1.0527,  ...,  1.1514,  0.3103,  0.3198],
         [ 0.9380,  0.2642, -1.1221,  ...,  2.3770, -2.5078,  0.5049],
         [-0.1335, -0.3030, -0.0822,  ...,  0.2585,  1.6592, -0.1538]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584373, 584374, 584356, 584357, 584358], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
reshape and cache tensor([[[-9.1504e-01, -2.8945e+00,  3.7061e-01,  ...,  1.3025e-01,
          -2.6934e+00,  9.0771e-01],
         [ 2.5781e+00, -1.4961e+00,  6.7285e-01,  ...,  4.6758e+00,
           1.2393e+00, -7.2412e-01],
         [ 1.7432e+00,  1.7666e+00, -1.4180e+00,  ..., -6.7432e-01,
           1.4189e+00,  1.3555e+00],
         ...,
         [ 2.1035e+00,  2.4414e+00, -6.8054e-02,  ...,  1.2764e+00,
          -6.7578e-01,  2.1582e+00],
         [ 2.4268e-01,  1.6064e+00,  5.3223e-01,  ..., -1.5518e+00,
           7.8735e-02, -4.4861e-02],
         [ 3.8513e-02,  2.2969e+00, -1.3203e+00,  ...,  5.3418e-01,
          -1.7505e-01, -1.0859e+00]],

        [[ 6.2744e-02, -8.3057e-01,  1.5540e-01,  ..., -4.9243e-01,
          -1.1934e+00,  1.2266e+00],
         [ 3.1016e+00, -1.1729e+00,  5.0098e-01,  ...,  3.9141e+00,
           9.6631e-01, -7.5293e-01],
         [ 1.3105e+00,  2.2969e+00, -9.5996e-01,  ..., -3.5864e-01,
           1.0986e+00,  1.3672e+00],
         ...,
         [ 2.8457e+00,  2.3320e+00, -5.2539e-01,  ...,  7.3682e-01,
           1.0704e-02,  2.7305e+00],
         [ 6.1035e-01,  9.2773e-01,  1.3733e-01,  ..., -1.5283e+00,
           9.9561e-01,  7.4902e-01],
         [ 3.6450e-01,  2.1426e+00, -6.9580e-01,  ...,  4.4128e-02,
           2.0312e-01, -4.7632e-01]],

        [[ 1.3220e-01, -1.1367e+00,  1.1562e+00,  ..., -3.5913e-01,
          -3.0898e+00,  1.3838e+00],
         [ 1.8154e+00, -2.5254e+00,  3.3765e-01,  ...,  3.1895e+00,
           4.9854e-01,  5.0903e-02],
         [-5.4150e-01,  2.0430e+00, -1.0803e-01,  ..., -6.1133e-01,
           7.5049e-01,  5.0732e-01],
         ...,
         [ 2.8340e+00,  2.0840e+00, -1.2441e+00,  ..., -5.6445e-01,
           7.9980e-01,  2.1074e+00],
         [ 3.6646e-01,  7.2754e-01, -1.0014e-03,  ..., -1.3340e+00,
           6.0156e-01,  2.0781e+00],
         [ 5.7465e-02,  1.5615e+00, -1.5684e+00,  ...,  7.0117e-01,
          -3.5736e-02, -1.3147e-01]],

        [[-2.3633e-01, -1.0996e+00,  8.4473e-02,  ..., -2.2595e-01,
          -1.1709e+00, -2.1191e-03],
         [ 3.1523e+00, -5.0977e-01,  6.0498e-01,  ...,  3.9805e+00,
           9.1016e-01, -1.1865e+00],
         [ 1.3262e+00,  1.1748e+00, -8.0518e-01,  ..., -1.0615e+00,
           2.0918e+00,  1.6016e+00],
         ...,
         [ 1.9727e+00,  2.8262e+00,  4.7607e-01,  ...,  1.4629e+00,
          -1.2432e+00,  1.3896e+00],
         [-8.8281e-01,  8.2666e-01,  9.2676e-01,  ..., -1.0811e+00,
           1.2627e+00, -1.2295e+00],
         [ 6.8701e-01,  1.5908e+00, -9.1357e-01,  ...,  6.1865e-01,
           1.0431e-01,  3.5791e-01]],

        [[ 1.3389e+00,  7.8711e-01, -4.8877e-01,  ...,  3.9185e-01,
          -8.9307e-01,  9.1370e-02],
         [ 2.9551e+00, -5.5127e-01,  1.0674e+00,  ...,  3.7852e+00,
          -1.8103e-01, -5.6445e-01],
         [ 1.4922e+00,  1.5508e+00, -9.5557e-01,  ..., -3.5840e-01,
           1.8838e+00,  1.3311e+00],
         ...,
         [ 3.2051e+00,  2.0547e+00,  4.9683e-02,  ...,  1.8672e+00,
          -4.7363e-01,  2.3750e+00],
         [ 2.0752e-01,  9.3164e-01,  1.9443e+00,  ..., -1.4033e+00,
           1.0352e+00, -9.0088e-01],
         [ 1.0312e+00,  1.6777e+00, -5.0244e-01,  ...,  3.8428e-01,
          -3.5547e-01,  1.6235e-01]],

        [[ 1.3633e+00, -5.7800e-02,  8.1104e-01,  ...,  2.3574e+00,
          -2.6211e+00,  8.7012e-01],
         [ 2.3320e+00, -2.1816e+00,  5.3271e-01,  ...,  3.7246e+00,
           3.3813e-01, -7.7588e-01],
         [ 1.4453e+00,  1.0117e+00, -5.9473e-01,  ...,  2.0178e-01,
           1.1240e+00,  2.2961e-01],
         ...,
         [ 2.2168e+00,  1.2285e+00, -1.7861e+00,  ...,  6.0693e-01,
          -7.0557e-01,  2.2012e+00],
         [ 3.1647e-02,  6.2402e-01,  1.6719e+00,  ..., -7.7100e-01,
           7.2266e-01, -3.3813e-01],
         [ 7.3730e-01,  2.5723e+00, -1.3574e+00,  ...,  1.0410e+00,
          -4.1064e-01,  2.0782e-02]]], device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584372, 584373, 584374, 584356, 584357, 584358], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 6
hidden_states torch.Size([6, 768])
num_prompts 0
decode probs shape torch.Size([6, 50272])
target_lens [3, 3]
sampled_draft_token_ids tensor([[   10, 21199],
        [   10,    92]], device='cuda:0')
target probs[0] tensor([[1.9938e-08, 2.0016e-08, 5.2854e-06,  ..., 1.8584e-08, 1.8368e-08,
         2.0813e-08],
        [2.4313e-08, 2.4408e-08, 5.0194e-06,  ..., 2.1709e-08, 2.4029e-08,
         2.5679e-08],
        [2.2040e-08, 2.2040e-08, 1.8695e-05,  ..., 2.1868e-08, 2.6585e-08,
         2.3830e-08]], device='cuda:0')
target probs[1] tensor([[8.1545e-09, 8.2829e-09, 8.6167e-06,  ..., 7.6605e-09, 7.5417e-09,
         9.7597e-09],
        [4.9569e-08, 5.0153e-08, 3.0488e-06,  ..., 5.1142e-08, 4.3066e-08,
         5.3179e-08],
        [2.7029e-08, 2.7241e-08, 3.1486e-06,  ..., 2.9802e-08, 2.3946e-08,
         2.5590e-08]], device='cuda:0')
1 target tensor([0.3751, 0.0456], device='cuda:0')
2 target tensor([0.1386, 0.0545], device='cuda:0')
1 target sampled tensor(0.3751, device='cuda:0')
2 target sampled tensor(0.1386, device='cuda:0')
1 draft tensor([0.3719, 0.0527], device='cuda:0')
2 draft tensor([0.1433, 0.0499], device='cuda:0')
1 draft sampled tensor(0.3719, device='cuda:0')
2 draft sampled tensor(0.1433, device='cuda:0')
accept_prob tensor([[1.0086, 0.8661],
        [0.9672, 1.0929]], device='cuda:0')
tensor([[[ 0.0211, -0.8179,  0.1545,  ..., -0.5620, -1.2705,  1.1289],
         [ 3.0059, -1.1807,  0.5869,  ...,  3.9531,  1.0186, -0.7437],
         [ 1.3467,  2.2637, -0.9067,  ..., -0.3950,  1.0908,  1.3623],
         ...,
         [ 2.8574,  2.3438, -0.4805,  ...,  0.7524,  0.0693,  2.6758],
         [ 0.5308,  0.9297,  0.0942,  ..., -1.5244,  0.9204,  0.7427],
         [ 0.2546,  2.1367, -0.7104,  ...,  0.0671,  0.2335, -0.4626]],

        [[ 1.3398,  0.7783, -0.4609,  ...,  0.3533, -0.9878,  0.0662],
         [ 2.8867, -0.5845,  1.0977,  ...,  3.8125, -0.0864, -0.6084],
         [ 1.5225,  1.5527, -0.8516,  ..., -0.3826,  1.8516,  1.3398],
         ...,
         [ 3.2246,  2.1113,  0.0812,  ...,  1.8330, -0.4299,  2.3359],
         [ 0.1624,  1.0068,  1.8730,  ..., -1.3662,  1.0117, -0.8467],
         [ 0.9336,  1.7627, -0.4253,  ...,  0.4370, -0.3232,  0.2375]]],
       device='cuda:0', dtype=torch.float16)
slot_mapping tensor([584373, 584357], device='cuda:0')
num_prefill_tokens 0
num_decode_tokens 2
hidden_states torch.Size([2, 768])
seq_id:  0 output_token:  21199
seq_id:  1 output_token:  92
seq_id:  0
seq_id:  1
id:  0 draft_size:  2 accept_cnt:  2
21199
id:  1 draft_size:  2 accept_cnt:  2
12750
Throughput: 3.61 requests/s, 21.63 tokens/s

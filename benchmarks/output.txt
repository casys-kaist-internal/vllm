Running sps server at port 8888
INFO 01-09 04:26:06 sps_llm_engine.py:80] Initializing an SpS LLM engine with config: target_model='facebook/opt-6.7b', draft_model='facebook/opt-125m', tokenizer='facebook/opt-6.7b', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.float16, max_seq_len=2048, target_download_dir='/home/sjchoi/workspace/models', draft_download_dir='/home/sjchoi/workspace/models', load_format=auto, target_tensor_parallel_size=1, target_model_quantization=None, draft_model_quantization=None, seed=0)
+-------------------------------+---------+
| Parameter                     |   Value |
+===============================+=========+
| gpu_mem_util (%)              |    95   |
+-------------------------------+---------+
| total_gpu_memory (GiB)        |    23.7 |
+-------------------------------+---------+
| peak_memory (GiB)             |    13.4 |
+-------------------------------+---------+
| target_cache_block_size (KiB) |  8192   |
+-------------------------------+---------+
| draft_cache_block_size (KiB)  |   576   |
+-------------------------------+---------+
| block_size                    |    16   |
+-------------------------------+---------+
| num_gpu_blocks                |  1093   |
+-------------------------------+---------+
INFO 01-09 04:26:22 sps_llm_engine.py:244] # GPU blocks: 1093, # CPU blocks: 478
INFO 01-09 04:26:37 sps_llm_engine.py:776] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 0.0 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
accept_cnt:  tensor([3], device='cuda:0')
target_prob_at_reject_idx:  tensor([[3.9678e-09, 5.3811e-09, 6.6803e-06,  ..., 4.5313e-09, 5.6174e-09,
         4.5669e-09]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[8.9443e-08, 8.8746e-08, 9.6353e-05,  ..., 8.5347e-08, 8.4023e-08,
         8.4352e-08]], device='cuda:0')
x_max_sum:  tensor([[0.4381]], device='cuda:0')
target_prob:  tensor([[0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:0')
tensor(8839, device='cuda:0')
tensor([[0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:0')
tensor([9], device='cuda:0')
tensor([[[2.8442e-09, 3.5814e-09, 7.7272e-06,  ..., 4.1221e-09,
          3.6378e-09, 3.6806e-09],
         [2.4750e-09, 2.6761e-09, 1.2453e-05,  ..., 3.0922e-09,
          2.5837e-09, 2.5042e-09],
         [2.8773e-09, 3.4035e-09, 2.4469e-06,  ..., 3.1724e-09,
          3.4979e-09, 3.2350e-09],
         ...,
         [8.1085e-09, 9.1881e-09, 1.3561e-04,  ..., 1.0742e-08,
          9.2964e-09, 7.0448e-09],
         [2.8815e-09, 4.1558e-09, 2.0399e-07,  ..., 3.2811e-09,
          3.4554e-09, 5.4070e-09],
         [6.1520e-09, 5.3658e-09, 3.1139e-04,  ..., 3.0454e-09,
          5.0211e-09, 7.4497e-09]]], device='cuda:0')
tensor([[0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:0')
accept_cnt:  tensor([1, 0], device='cuda:0')
target_prob_at_reject_idx:  tensor([[6.7516e-09, 8.9444e-09, 2.9365e-06,  ..., 5.8659e-09, 8.1122e-09,
         9.1565e-09],
        [4.7702e-09, 6.1731e-09, 7.8682e-06,  ..., 4.0012e-09, 5.7991e-09,
         5.6869e-09]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[8.5212e-08, 8.3564e-08, 2.5394e-06,  ..., 8.5546e-08, 7.2886e-08,
         7.5789e-08],
        [1.4656e-07, 1.4656e-07, 9.2228e-05,  ..., 1.4599e-07, 1.5240e-07,
         1.2585e-07]], device='cuda:0')
x_max_sum:  tensor([[0.4367],
        [0.6844]], device='cuda:0')
target_prob:  tensor([[0.0000e+00, 0.0000e+00, 9.0938e-07,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
tensor(6583, device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 9.0938e-07,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
tensor([9, 9], device='cuda:0')
tensor([[[6.8900e-10, 1.2379e-09, 6.7344e-06,  ..., 7.6265e-10,
          1.3229e-09, 9.0922e-10],
         [6.7516e-09, 8.9444e-09, 2.9365e-06,  ..., 5.8659e-09,
          8.1122e-09, 9.1565e-09],
         [1.1281e-08, 1.4542e-08, 4.3180e-05,  ..., 1.2934e-08,
          2.1533e-08, 1.3930e-08],
         ...,
         [9.0282e-09, 8.7163e-09, 3.8632e-04,  ..., 7.1699e-09,
          1.0890e-08, 7.8746e-09],
         [1.1335e-08, 1.5105e-08, 6.0227e-06,  ..., 9.3421e-09,
          1.6364e-08, 1.4441e-08],
         [1.6785e-08, 1.4871e-08, 2.1395e-05,  ..., 1.0965e-08,
          1.5892e-08, 1.4190e-08]],

        [[4.7702e-09, 6.1731e-09, 7.8682e-06,  ..., 4.0012e-09,
          5.7991e-09, 5.6869e-09],
         [1.3981e-07, 1.2545e-07, 3.0963e-06,  ..., 1.0836e-07,
          1.6972e-07, 1.0309e-07],
         [1.8898e-09, 1.9921e-09, 9.0891e-07,  ..., 1.0355e-09,
          1.9574e-09, 1.6841e-09],
         ...,
         [3.9098e-09, 4.3489e-09, 1.0979e-06,  ..., 4.3873e-09,
          2.8188e-09, 5.4414e-09],
         [6.1585e-08, 6.0838e-08, 6.8881e-07,  ..., 5.0733e-08,
          3.5800e-08, 8.6215e-08],
         [1.2813e-08, 1.3963e-08, 1.3815e-06,  ..., 1.5822e-08,
          1.0336e-08, 1.6261e-08]]], device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 9.0938e-07,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
accept_cnt:  tensor([0, 0], device='cuda:0')
target_prob_at_reject_idx:  tensor([[2.1361e-09, 2.1112e-09, 2.7818e-06,  ..., 1.6507e-09, 1.8415e-09,
         2.8745e-09],
        [2.1287e-08, 2.3288e-08, 4.2012e-06,  ..., 2.2927e-08, 3.0255e-08,
         3.3884e-08]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[1.2765e-08, 1.2666e-08, 4.9331e-06,  ..., 1.3695e-08, 1.2765e-08,
         1.1532e-08],
        [3.1434e-07, 3.1311e-07, 9.6459e-06,  ..., 2.9994e-07, 3.1929e-07,
         2.7524e-07]], device='cuda:0')
x_max_sum:  tensor([[0.4548],
        [0.4440]], device='cuda:0')
target_prob:  tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:0')
tensor(14532, device='cuda:0')
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:0')
tensor([9, 9], device='cuda:0')
tensor([[[2.1361e-09, 2.1112e-09, 2.7818e-06,  ..., 1.6507e-09,
          1.8415e-09, 2.8745e-09],
         [6.8885e-09, 6.2232e-09, 4.9067e-05,  ..., 4.1133e-09,
          6.0790e-09, 8.2767e-09],
         [5.2536e-09, 5.6363e-09, 8.3580e-06,  ..., 3.5547e-09,
          4.9160e-09, 5.9998e-09],
         ...,
         [2.3341e-09, 3.2154e-09, 5.8945e-05,  ..., 1.9810e-09,
          3.2154e-09, 3.0682e-09],
         [8.9344e-09, 9.3631e-09, 2.0663e-06,  ..., 6.8770e-09,
          1.0084e-08, 1.1119e-08],
         [1.2549e-08, 1.4387e-08, 2.4532e-06,  ..., 1.1426e-08,
          1.6113e-08, 1.3516e-08]],

        [[2.1287e-08, 2.3288e-08, 4.2012e-06,  ..., 2.2927e-08,
          3.0255e-08, 3.3884e-08],
         [1.8855e-07, 1.2293e-07, 1.3638e-05,  ..., 1.5150e-07,
          1.6430e-07, 1.3687e-07],
         [6.0058e-08, 8.8760e-08, 1.2946e-04,  ..., 7.3012e-08,
          1.0256e-07, 8.2411e-08],
         ...,
         [9.6738e-09, 1.5519e-08, 1.0737e-03,  ..., 1.2134e-08,
          1.4925e-08, 1.2039e-08],
         [1.2887e-08, 1.5125e-08, 6.1147e-05,  ..., 1.7139e-08,
          1.2249e-08, 1.8897e-08],
         [4.9186e-08, 6.8288e-08, 4.4636e-04,  ..., 6.4654e-08,
          5.4871e-08, 9.6678e-08]]], device='cuda:0')
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:0')
accept_cnt:  tensor([2, 4], device='cuda:0')
target_prob_at_reject_idx:  tensor([[3.2612e-09, 3.7683e-09, 5.7993e-06,  ..., 2.7248e-09, 4.2368e-09,
         6.2861e-09],
        [5.3913e-09, 6.6055e-09, 2.0395e-05,  ..., 6.5798e-09, 6.7358e-09,
         9.0287e-09]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[8.3791e-09, 8.3791e-09, 5.8123e-06,  ..., 8.1849e-09, 1.0226e-08,
         6.7856e-09],
        [6.0065e-08, 5.9366e-08, 5.4813e-06,  ..., 6.4946e-08, 6.2215e-08,
         6.3939e-08]], device='cuda:0')
x_max_sum:  tensor([[0.3246],
        [0.4672]], device='cuda:0')
target_prob:  tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 3.1919e-05,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
tensor(30811, device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 3.1919e-05,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
tensor([9, 9], device='cuda:0')
tensor([[[5.7802e-10, 8.2636e-10, 7.6185e-05,  ..., 4.9634e-10,
          9.8709e-10, 8.8137e-10],
         [2.9736e-09, 3.4901e-09, 2.7406e-06,  ..., 3.7737e-09,
          4.4989e-09, 3.4629e-09],
         [3.2612e-09, 3.7683e-09, 5.7993e-06,  ..., 2.7248e-09,
          4.2368e-09, 6.2861e-09],
         ...,
         [3.0117e-10, 4.4163e-10, 1.3583e-06,  ..., 3.9588e-10,
          4.9654e-10, 4.3479e-10],
         [4.0839e-09, 3.6323e-09, 5.1097e-06,  ..., 2.7526e-09,
          2.9073e-09, 4.0364e-09],
         [5.0597e-10, 9.4068e-10, 5.5278e-06,  ..., 4.2441e-10,
          9.4068e-10, 7.0042e-10]],

        [[2.0224e-08, 2.8744e-08, 2.7768e-04,  ..., 2.7751e-08,
          4.1335e-08, 1.7434e-08],
         [1.0607e-09, 2.7837e-09, 4.2561e-04,  ..., 1.3149e-09,
          1.7150e-09, 1.6687e-09],
         [2.0501e-09, 2.9137e-09, 1.0813e-03,  ..., 1.6537e-09,
          3.1505e-09, 2.8241e-09],
         ...,
         [2.1013e-09, 1.9021e-09, 1.7634e-06,  ..., 1.9548e-09,
          1.9472e-09, 2.5248e-09],
         [1.0988e-09, 8.7947e-10, 5.3062e-06,  ..., 5.9974e-10,
          6.6127e-10, 9.7729e-10],
         [6.8046e-09, 7.4152e-09, 5.1487e-06,  ..., 7.5026e-09,
          7.6506e-09, 7.8934e-09]]], device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 3.1919e-05,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
accept_cnt:  tensor([3, 2, 1], device='cuda:0')
target_prob_at_reject_idx:  tensor([[2.0816e-10, 2.2639e-10, 2.0588e-05,  ..., 1.2142e-10, 1.4503e-10,
         1.9478e-10],
        [5.1019e-09, 7.6588e-09, 3.3901e-06,  ..., 5.9183e-09, 7.5401e-09,
         1.2578e-08],
        [1.8081e-08, 1.3809e-08, 1.0909e-06,  ..., 2.5499e-08, 1.7457e-08,
         2.2768e-08]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[5.0316e-11, 4.9924e-11, 1.5180e-05,  ..., 4.8768e-11, 5.4192e-11,
         4.4752e-11],
        [1.8524e-07, 1.8166e-07, 1.0006e-05,  ..., 1.8742e-07, 1.6347e-07,
         2.0186e-07],
        [4.7523e-09, 4.7523e-09, 7.1014e-07,  ..., 4.6786e-09, 3.7889e-09,
         4.5347e-09]], device='cuda:0')
x_max_sum:  tensor([[0.0242],
        [0.5656],
        [0.3688]], device='cuda:0')
target_prob:  tensor([[6.5348e-09, 7.3060e-09, 2.2391e-04,  ..., 3.0078e-09, 3.7609e-09,
         6.2115e-09],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [3.6144e-08, 2.4560e-08, 1.0324e-06,  ..., 5.6457e-08, 3.7063e-08,
         4.9442e-08]], device='cuda:0')
tensor(62866, device='cuda:0')
tensor([[6.5348e-09, 7.3060e-09, 2.2391e-04,  ..., 3.0078e-09, 3.7609e-09,
         6.2115e-09],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [3.6144e-08, 2.4560e-08, 1.0324e-06,  ..., 5.6457e-08, 3.7063e-08,
         4.9442e-08]], device='cuda:0')
tensor([9, 9, 9], device='cuda:0')
tensor([[[1.3157e-09, 1.7914e-09, 6.1592e-05,  ..., 8.2981e-10,
          1.8555e-09, 2.4011e-09],
         [2.7436e-10, 4.2328e-10, 3.7965e-06,  ..., 2.2568e-10,
          3.2327e-10, 5.8766e-10],
         [5.5887e-10, 5.3536e-10, 2.5606e-05,  ..., 2.8824e-10,
          4.4296e-10, 7.7440e-10],
         ...,
         [3.0283e-09, 3.5821e-09, 6.6822e-06,  ..., 2.5203e-09,
          3.1985e-09, 3.7394e-09],
         [1.8907e-09, 4.3448e-09, 1.1409e-04,  ..., 2.7403e-09,
          4.1621e-09, 4.1784e-09],
         [2.6638e-09, 2.7916e-09, 1.5338e-04,  ..., 2.0908e-09,
          3.9062e-09, 2.3600e-09]],

        [[2.7557e-08, 2.3617e-08, 2.1345e-05,  ..., 1.4895e-08,
          2.3848e-08, 2.5837e-08],
         [2.6109e-09, 3.3788e-09, 3.2255e-06,  ..., 3.0169e-09,
          3.5134e-09, 6.2632e-09],
         [5.1019e-09, 7.6588e-09, 3.3901e-06,  ..., 5.9183e-09,
          7.5401e-09, 1.2578e-08],
         ...,
         [2.9162e-08, 4.8339e-08, 9.4071e-06,  ..., 4.8457e-08,
          5.7825e-08, 3.7244e-08],
         [1.4507e-08, 3.3729e-08, 5.9804e-05,  ..., 4.0054e-08,
          4.4250e-08, 4.0447e-08],
         [2.7533e-10, 4.4865e-10, 8.1779e-05,  ..., 3.4265e-10,
          5.3907e-10, 4.7387e-10]],

        [[3.0197e-08, 2.0999e-08, 1.2496e-05,  ..., 2.7281e-08,
          1.8387e-08, 2.7602e-08],
         [1.8081e-08, 1.3809e-08, 1.0909e-06,  ..., 2.5499e-08,
          1.7457e-08, 2.2768e-08],
         [1.9076e-08, 1.4798e-08, 3.1322e-06,  ..., 1.6966e-08,
          1.2125e-08, 1.3956e-08],
         ...,
         [8.0713e-09, 6.4855e-09, 5.6381e-05,  ..., 7.2351e-09,
          8.8993e-09, 4.4924e-09],
         [1.2122e-08, 1.1750e-08, 1.7838e-06,  ..., 9.7407e-09,
          1.0129e-08, 9.8941e-09],
         [1.2007e-08, 7.3113e-09, 2.2091e-06,  ..., 8.2525e-09,
          6.2781e-09, 5.8291e-09]]], device='cuda:0')
tensor([[6.5348e-09, 7.3060e-09, 2.2391e-04,  ..., 3.0078e-09, 3.7609e-09,
         6.2115e-09],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [3.6144e-08, 2.4560e-08, 1.0324e-06,  ..., 5.6457e-08, 3.7063e-08,
         4.9442e-08]], device='cuda:0')
accept_cnt:  tensor([5, 1, 0], device='cuda:0')
target_prob_at_reject_idx:  tensor([[9.0098e-09, 7.7669e-09, 5.9467e-07,  ..., 6.1202e-09, 6.7480e-09,
         7.2113e-09],
        [6.0904e-10, 9.9244e-10, 4.8034e-04,  ..., 4.7804e-10, 1.2255e-09,
         9.0717e-10],
        [6.2923e-09, 8.2549e-09, 3.2404e-06,  ..., 1.1108e-08, 1.0579e-08,
         1.1848e-08]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[3.9014e-08, 3.9474e-08, 9.1627e-06,  ..., 3.5941e-08, 3.4564e-08,
         3.6082e-08],
        [6.1500e-09, 6.1982e-09, 4.0685e-03,  ..., 6.1021e-09, 5.4273e-09,
         6.3452e-09],
        [1.5967e-08, 1.6093e-08, 1.0376e-05,  ..., 1.5843e-08, 1.4653e-08,
         1.7064e-08]], device='cuda:0')
x_max_sum:  tensor([[0.3818],
        [0.1200],
        [0.6117]], device='cuda:0')
target_prob:  tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:0')
tensor(21551, device='cuda:0')
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:0')
tensor([9, 9, 9], device='cuda:0')
tensor([[[2.9453e-09, 3.1353e-09, 2.5658e-04,  ..., 2.1717e-09,
          4.0257e-09, 2.5689e-09],
         [3.1805e-10, 3.1681e-10, 4.1425e-06,  ..., 1.7841e-10,
          2.9186e-10, 2.5062e-10],
         [3.9251e-10, 4.3447e-10, 6.3616e-07,  ..., 2.9398e-10,
          3.1172e-10, 4.4652e-10],
         ...,
         [1.1001e-08, 8.8392e-09, 1.8842e-06,  ..., 1.3217e-08,
          8.1749e-09, 1.2320e-08],
         [6.9011e-10, 8.9307e-10, 2.2905e-06,  ..., 6.7084e-10,
          7.1690e-10, 1.2539e-09],
         [9.4949e-09, 6.4246e-09, 2.6122e-06,  ..., 8.5112e-09,
          8.7813e-09, 1.3080e-08]],

        [[2.1127e-10, 4.8172e-10, 6.0349e-05,  ..., 2.7989e-10,
          5.5446e-10, 4.9896e-10],
         [6.0904e-10, 9.9244e-10, 4.8034e-04,  ..., 4.7804e-10,
          1.2255e-09, 9.0717e-10],
         [1.9905e-09, 2.7635e-09, 2.4471e-06,  ..., 1.3208e-09,
          3.1071e-09, 2.5162e-09],
         ...,
         [5.5129e-08, 3.7595e-08, 2.1517e-04,  ..., 5.2604e-08,
          5.5345e-08, 7.7593e-08],
         [2.1608e-07, 1.2145e-07, 1.2392e-03,  ..., 9.4214e-08,
          1.4422e-07, 1.4199e-07],
         [2.7569e-08, 2.1980e-08, 8.4307e-04,  ..., 1.4247e-08,
          2.3581e-08, 2.0170e-08]],

        [[6.2923e-09, 8.2549e-09, 3.2404e-06,  ..., 1.1108e-08,
          1.0579e-08, 1.1848e-08],
         [1.4001e-08, 1.3597e-08, 5.8276e-06,  ..., 2.0016e-08,
          1.1836e-08, 1.6529e-08],
         [1.7340e-08, 1.4375e-08, 1.4198e-06,  ..., 1.6938e-08,
          1.6353e-08, 1.2836e-08],
         ...,
         [5.6939e-08, 6.2780e-08, 3.5578e-05,  ..., 7.2259e-08,
          4.3656e-08, 8.1561e-08],
         [2.5959e-08, 2.5656e-08, 1.8308e-05,  ..., 2.1437e-08,
          2.2290e-08, 3.8665e-08],
         [7.3730e-08, 9.8635e-08, 3.3443e-05,  ..., 4.9986e-08,
          6.4183e-08, 8.2574e-08]]], device='cuda:0')
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:0')
accept_cnt:  tensor([0, 3, 7, 1], device='cuda:0')
target_prob_at_reject_idx:  tensor([[2.0875e-09, 2.4597e-09, 1.2419e-06,  ..., 1.7038e-09, 2.0391e-09,
         2.2571e-09],
        [2.9872e-09, 5.2020e-09, 1.2124e-05,  ..., 4.6448e-09, 5.9874e-09,
         6.3985e-09],
        [4.8728e-08, 3.9616e-08, 3.5687e-06,  ..., 6.2568e-08, 4.8919e-08,
         6.1358e-08],
        [5.5898e-09, 7.2620e-09, 1.6568e-04,  ..., 6.9024e-09, 6.5607e-09,
         4.7440e-09]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[3.8693e-08, 3.9303e-08, 8.5203e-06,  ..., 3.5786e-08, 3.5926e-08,
         3.4281e-08],
        [1.4399e-08, 1.4399e-08, 4.3556e-05,  ..., 1.5508e-08, 1.2857e-08,
         1.5090e-08],
        [3.2809e-07, 3.2809e-07, 6.6546e-06,  ..., 3.0462e-07, 3.0107e-07,
         2.5552e-07],
        [2.1911e-08, 2.1997e-08, 1.9088e-03,  ..., 2.3233e-08, 2.4635e-08,
         2.1237e-08]], device='cuda:0')
x_max_sum:  tensor([[0.5386],
        [0.4761],
        [0.3929],
        [0.2702]], device='cuda:0')
target_prob:  tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:0')
tensor(42590, device='cuda:0')
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:0')
tensor([9, 9, 9, 9], device='cuda:0')
tensor([[[2.0875e-09, 2.4597e-09, 1.2419e-06,  ..., 1.7038e-09,
          2.0391e-09, 2.2571e-09],
         [8.5042e-09, 1.2229e-08, 6.1650e-05,  ..., 6.0540e-09,
          7.9890e-09, 1.1005e-08],
         [1.4474e-09, 1.8368e-09, 1.3471e-06,  ..., 1.3974e-09,
          1.7664e-09, 2.3310e-09],
         ...,
         [8.6392e-09, 8.2759e-09, 8.8879e-07,  ..., 5.0986e-09,
          9.0893e-09, 5.5997e-09],
         [6.2598e-10, 6.0200e-10, 5.1919e-07,  ..., 3.0627e-10,
          5.2303e-10, 4.8752e-10],
         [3.6911e-12, 3.2447e-12, 6.7930e-08,  ..., 2.8972e-12,
          2.6794e-12, 2.6690e-12]],

        [[1.9076e-08, 2.8608e-08, 1.3014e-05,  ..., 2.2653e-08,
          3.3775e-08, 2.7059e-08],
         [1.4616e-10, 2.4766e-10, 4.4350e-06,  ..., 3.4384e-10,
          2.1686e-10, 2.6570e-10],
         [2.1546e-09, 2.6092e-09, 4.5545e-06,  ..., 3.2219e-09,
          2.0400e-09, 3.4701e-09],
         ...,
         [4.0728e-10, 4.2682e-10, 8.3492e-03,  ..., 3.0148e-10,
          3.5247e-10, 5.3327e-10],
         [6.4041e-08, 9.8610e-08, 3.0861e-05,  ..., 8.3689e-08,
          8.4016e-08, 6.3295e-08],
         [1.4513e-09, 1.3661e-09, 1.6198e-06,  ..., 1.1869e-09,
          1.7404e-09, 1.2341e-09]],

        [[2.9049e-09, 2.9049e-09, 6.2616e-06,  ..., 2.6553e-09,
          3.1410e-09, 3.3305e-09],
         [2.0074e-09, 2.2394e-09, 4.1127e-06,  ..., 2.2047e-09,
          2.0630e-09, 2.2481e-09],
         [5.2042e-08, 5.5616e-08, 1.3162e-06,  ..., 7.5059e-08,
          6.3144e-08, 4.8794e-08],
         ...,
         [4.8728e-08, 3.9616e-08, 3.5687e-06,  ..., 6.2568e-08,
          4.8919e-08, 6.1358e-08],
         [4.4297e-08, 7.4328e-08, 1.3476e-05,  ..., 8.0211e-08,
          7.6091e-08, 7.3033e-08],
         [1.7004e-09, 1.8675e-09, 5.2700e-07,  ..., 1.6225e-09,
          2.2091e-09, 1.9957e-09]],

        [[4.7592e-08, 4.5590e-08, 4.5879e-05,  ..., 3.7944e-08,
          5.4352e-08, 5.4034e-08],
         [5.5898e-09, 7.2620e-09, 1.6568e-04,  ..., 6.9024e-09,
          6.5607e-09, 4.7440e-09],
         [2.4476e-08, 1.9977e-08, 4.0092e-06,  ..., 2.1770e-08,
          2.0936e-08, 1.9212e-08],
         ...,
         [1.2250e-08, 1.1552e-08, 8.8097e-06,  ..., 6.3550e-09,
          1.1045e-08, 8.6018e-09],
         [6.4687e-10, 6.0060e-10, 7.3058e-06,  ..., 6.0531e-10,
          6.2942e-10, 3.8176e-10],
         [3.9865e-09, 3.2792e-09, 4.4153e-05,  ..., 3.4500e-09,
          3.5043e-09, 2.3527e-09]]], device='cuda:0')
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:0')
accept_cnt:  tensor([0, 3, 0, 3], device='cuda:0')
target_prob_at_reject_idx:  tensor([[1.1230e-09, 1.8228e-09, 1.0333e-04,  ..., 9.9490e-10, 1.2976e-09,
         2.5505e-09],
        [3.1761e-08, 2.5621e-08, 9.5688e-06,  ..., 2.7811e-08, 2.6024e-08,
         3.4679e-08],
        [7.9550e-08, 6.5181e-08, 4.3613e-06,  ..., 1.0375e-07, 7.0477e-08,
         9.7466e-08],
        [1.1177e-09, 1.4749e-09, 2.2504e-05,  ..., 2.0558e-09, 2.6038e-09,
         1.4865e-09]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[1.2293e-08, 1.2197e-08, 3.7887e-04,  ..., 1.2486e-08, 1.1414e-08,
         1.0112e-08],
        [2.3511e-07, 2.3328e-07, 3.1170e-05,  ..., 2.3328e-07, 2.0993e-07,
         2.2522e-07],
        [4.2275e-07, 4.2275e-07, 1.5107e-05,  ..., 4.1946e-07, 3.9098e-07,
         3.7453e-07],
        [1.0167e-08, 1.0207e-08, 2.0351e-04,  ..., 1.0781e-08, 1.2312e-08,
         8.2338e-09]], device='cuda:0')
x_max_sum:  tensor([[0.3994],
        [0.5723],
        [0.4199],
        [0.2237]], device='cuda:0')
target_prob:  tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:0')
tensor(38971, device='cuda:0')
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:0')
tensor([9, 9, 9, 9], device='cuda:0')
tensor([[[1.1230e-09, 1.8228e-09, 1.0333e-04,  ..., 9.9490e-10,
          1.2976e-09, 2.5505e-09],
         [1.2962e-09, 1.2320e-09, 1.5862e-04,  ..., 8.9786e-10,
          7.2711e-10, 1.4348e-09],
         [3.3930e-09, 2.9479e-09, 8.6967e-07,  ..., 2.4824e-09,
          1.6601e-09, 4.6016e-09],
         ...,
         [6.2330e-09, 7.3157e-09, 2.2992e-04,  ..., 7.3730e-09,
          6.8456e-09, 6.1125e-09],
         [8.2343e-09, 7.7354e-09, 1.9695e-06,  ..., 7.2384e-09,
          8.7654e-09, 8.5624e-09],
         [9.8557e-09, 7.7359e-09, 2.9842e-05,  ..., 6.0483e-09,
          7.8577e-09, 9.7790e-09]],

        [[3.7515e-08, 3.2978e-08, 5.6130e-04,  ..., 4.1769e-08,
          5.6869e-08, 4.5606e-08],
         [6.5832e-09, 9.9600e-09, 9.0224e-04,  ..., 7.2302e-09,
          9.3565e-09, 1.7895e-08],
         [3.9408e-10, 6.3716e-10, 4.7677e-03,  ..., 3.8797e-10,
          4.6615e-10, 6.1036e-10],
         ...,
         [6.6518e-10, 7.6114e-10, 8.1230e-06,  ..., 8.1500e-10,
          9.0036e-10, 1.0202e-09],
         [1.7625e-08, 1.6950e-08, 1.5992e-05,  ..., 1.4107e-08,
          1.8615e-08, 2.6875e-08],
         [1.2015e-08, 1.4924e-08, 1.1696e-05,  ..., 1.2691e-08,
          1.5488e-08, 2.4702e-08]],

        [[7.9550e-08, 6.5181e-08, 4.3613e-06,  ..., 1.0375e-07,
          7.0477e-08, 9.7466e-08],
         [3.3641e-07, 2.5036e-07, 8.6127e-06,  ..., 2.5282e-07,
          3.4878e-07, 3.3087e-07],
         [5.1350e-08, 7.8605e-08, 7.1943e-06,  ..., 8.0156e-08,
          7.1292e-08, 8.6839e-08],
         ...,
         [1.3128e-09, 1.9478e-09, 5.2047e-06,  ..., 2.0493e-09,
          1.4531e-09, 1.8226e-09],
         [1.2696e-08, 1.4164e-08, 5.1321e-06,  ..., 1.0567e-08,
          1.3621e-08, 1.9742e-08],
         [2.1960e-08, 3.0667e-08, 5.6976e-06,  ..., 2.0033e-08,
          3.1764e-08, 2.3790e-08]],

        [[3.9428e-09, 3.8969e-09, 2.5024e-06,  ..., 3.8817e-09,
          4.0680e-09, 3.7257e-09],
         [2.0720e-08, 1.7482e-08, 2.6909e-07,  ..., 1.9013e-08,
          1.5886e-08, 2.0438e-08],
         [6.6107e-10, 7.2889e-10, 2.0494e-05,  ..., 8.5884e-10,
          1.1245e-09, 1.0279e-09],
         ...,
         [2.0342e-08, 1.9260e-08, 2.2095e-04,  ..., 2.1570e-08,
          2.4538e-08, 3.1878e-08],
         [2.6265e-09, 2.6061e-09, 3.6995e-04,  ..., 3.9894e-09,
          2.7742e-09, 2.5959e-09],
         [2.0264e-09, 1.9872e-09, 2.5090e-04,  ..., 1.7468e-09,
          1.9949e-09, 2.4827e-09]]], device='cuda:0')
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:0')
accept_cnt:  tensor([4, 9, 1, 3, 9], device='cuda:0')
target_prob_at_reject_idx:  tensor([[1.5460e-09, 1.8360e-09, 4.5499e-07,  ..., 1.6139e-09, 1.7656e-09,
         2.1718e-09],
        [3.8519e-09, 7.4538e-09, 9.5594e-04,  ..., 4.9460e-09, 5.6485e-09,
         6.2523e-09],
        [1.8026e-07, 1.5927e-07, 1.1401e-06,  ..., 1.9146e-07, 7.0160e-08,
         1.5138e-07],
        [3.2500e-08, 4.1285e-08, 3.9401e-07,  ..., 4.7288e-08, 3.6972e-08,
         4.2223e-08],
        [1.6147e-08, 1.4760e-08, 2.2696e-04,  ..., 1.2188e-08, 1.2724e-08,
         1.8878e-08]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[1.8432e-08, 1.8722e-08, 4.8957e-06,  ..., 1.9698e-08, 1.6980e-08,
         1.7726e-08],
        [4.3638e-08, 4.3638e-08, 1.8819e-03,  ..., 4.5554e-08, 4.0675e-08,
         4.4848e-08],
        [3.1505e-09, 3.1629e-09, 5.5752e-06,  ..., 3.0775e-09, 3.2379e-09,
         3.6121e-09],
        [7.7968e-09, 7.8120e-09, 2.3466e-06,  ..., 7.3963e-09, 7.8273e-09,
         9.8753e-09],
        [5.9567e-09, 5.8644e-09, 2.8053e-03,  ..., 5.8644e-09, 5.9104e-09,
         6.0980e-09]], device='cuda:0')
x_max_sum:  tensor([[0.6740],
        [0.4931],
        [0.6855],
        [0.4335],
        [0.4165]], device='cuda:0')
target_prob:  tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [2.5834e-07, 2.2771e-07, 0.0000e+00,  ..., 2.7479e-07, 9.7619e-08,
         2.1556e-07],
        [5.6988e-08, 7.7219e-08, 0.0000e+00,  ..., 9.2024e-08, 6.7233e-08,
         7.4622e-08],
        [2.4469e-08, 2.1359e-08, 0.0000e+00,  ..., 1.5185e-08, 1.6360e-08,
         3.0687e-08]], device='cuda:0')
tensor(47418, device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [2.5834e-07, 2.2771e-07, 0.0000e+00,  ..., 2.7479e-07, 9.7619e-08,
         2.1556e-07],
        [5.6988e-08, 7.7219e-08, 0.0000e+00,  ..., 9.2024e-08, 6.7233e-08,
         7.4622e-08],
        [2.4469e-08, 2.1359e-08, 0.0000e+00,  ..., 1.5185e-08, 1.6360e-08,
         3.0687e-08]], device='cuda:0')
tensor([9, 9, 9, 9, 9], device='cuda:0')
tensor([[[3.3120e-09, 2.9689e-09, 4.4291e-07,  ..., 2.3670e-09,
          2.6717e-09, 3.4440e-09],
         [2.3121e-09, 2.4231e-09, 9.6238e-07,  ..., 2.1805e-09,
          2.5295e-09, 2.2585e-09],
         [3.6134e-10, 3.6417e-10, 2.4760e-04,  ..., 1.7337e-10,
          3.3418e-10, 5.2574e-10],
         ...,
         [8.5641e-10, 7.8896e-10, 7.7859e-07,  ..., 5.9787e-10,
          6.6437e-10, 7.6768e-10],
         [7.4140e-10, 8.1745e-10, 1.4842e-04,  ..., 3.8916e-10,
          5.5096e-10, 1.2176e-09],
         [6.4534e-10, 8.4498e-10, 3.3379e-04,  ..., 6.6323e-10,
          8.0314e-10, 6.1820e-10]],

        [[3.8519e-09, 7.4538e-09, 9.5594e-04,  ..., 4.9460e-09,
          5.6485e-09, 6.2523e-09],
         [4.5787e-10, 1.0460e-09, 8.3812e-03,  ..., 5.6320e-10,
          8.4877e-10, 6.0659e-10],
         [3.0405e-09, 3.7325e-09, 2.3431e-01,  ..., 3.6036e-09,
          3.8360e-09, 3.2365e-09],
         ...,
         [6.0821e-10, 6.7323e-10, 5.7506e-06,  ..., 6.6539e-10,
          6.1779e-10, 6.3740e-10],
         [7.1813e-09, 7.8871e-09, 3.7133e-05,  ..., 7.1533e-09,
          8.3304e-09, 5.4846e-09],
         [1.1278e-08, 1.1727e-08, 4.9476e-07,  ..., 9.7981e-09,
          1.4145e-08, 1.1234e-08]],

        [[6.0278e-08, 4.3417e-08, 2.6900e-06,  ..., 7.7097e-08,
          2.2834e-08, 4.0390e-08],
         [1.8026e-07, 1.5927e-07, 1.1401e-06,  ..., 1.9146e-07,
          7.0160e-08, 1.5138e-07],
         [9.4182e-09, 1.3630e-08, 3.6463e-07,  ..., 1.2028e-08,
          7.3063e-09, 8.8217e-09],
         ...,
         [4.2050e-08, 3.3525e-08, 8.1635e-06,  ..., 3.7547e-08,
          2.1310e-08, 2.9014e-08],
         [1.7878e-09, 1.7260e-09, 2.7864e-06,  ..., 1.5593e-09,
          1.2978e-09, 1.3521e-09],
         [7.9604e-09, 4.7627e-09, 1.8696e-06,  ..., 7.7306e-09,
          3.9177e-09, 5.4818e-09]],

        [[3.0077e-11, 3.6707e-11, 3.7532e-06,  ..., 3.8770e-11,
          6.8310e-11, 3.4889e-11],
         [1.6137e-08, 2.3206e-08, 5.0717e-04,  ..., 3.8335e-08,
          3.4230e-08, 2.2891e-08],
         [2.3323e-09, 3.3638e-09, 5.2218e-07,  ..., 6.2383e-09,
          3.9820e-09, 3.6585e-09],
         ...,
         [7.4524e-09, 7.1950e-09, 1.9989e-06,  ..., 7.8867e-09,
          8.7298e-09, 9.4576e-09],
         [4.4713e-08, 4.1595e-08, 4.3169e-07,  ..., 4.1111e-08,
          4.4192e-08, 5.0174e-08],
         [4.1864e-08, 6.5605e-08, 2.8229e-05,  ..., 3.5948e-08,
          7.3761e-08, 1.1051e-07]],

        [[1.6147e-08, 1.4760e-08, 2.2696e-04,  ..., 1.2188e-08,
          1.2724e-08, 1.8878e-08],
         [1.4792e-08, 1.8772e-08, 2.7273e-05,  ..., 1.3390e-08,
          1.8809e-08, 1.6631e-08],
         [1.0956e-08, 8.3024e-09, 1.4131e-04,  ..., 6.8561e-09,
          7.3843e-09, 1.4345e-08],
         ...,
         [4.4373e-09, 3.9007e-09, 7.7283e-08,  ..., 3.4289e-09,
          3.7659e-09, 3.5240e-09],
         [4.4529e-15, 5.2879e-15, 9.7717e-13,  ..., 3.9605e-15,
          6.1102e-15, 4.0544e-15],
         [1.3124e-12, 1.8009e-12, 1.6940e-10,  ..., 1.3436e-12,
          1.3279e-12, 1.3279e-12]]], device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [1.1278e-08, 1.1727e-08, 4.9476e-07,  ..., 9.7981e-09, 1.4145e-08,
         1.1234e-08],
        [2.5834e-07, 2.2771e-07, 0.0000e+00,  ..., 2.7479e-07, 9.7619e-08,
         2.1556e-07],
        [5.6988e-08, 7.7219e-08, 0.0000e+00,  ..., 9.2024e-08, 6.7233e-08,
         7.4622e-08],
        [1.3124e-12, 1.8009e-12, 1.6940e-10,  ..., 1.3436e-12, 1.3279e-12,
         1.3279e-12]], device='cuda:0')
INFO:     127.0.0.1:45216 - "POST /generate HTTP/1.1" 200 OK
accept_cnt:  tensor([0, 9, 0, 0, 0], device='cuda:0')
target_prob_at_reject_idx:  tensor([[1.3774e-10, 2.3799e-10, 1.0222e-06,  ..., 1.4267e-10, 1.7075e-10,
         1.6421e-10],
        [4.8762e-09, 4.2865e-09, 1.5039e-06,  ..., 3.5955e-09, 4.3540e-09,
         4.0111e-09],
        [7.5942e-09, 3.3666e-09, 1.1181e-07,  ..., 3.9824e-09, 2.7802e-09,
         4.3398e-09],
        [1.0190e-09, 2.9085e-09, 7.8339e-05,  ..., 2.5667e-09, 3.0126e-09,
         4.2985e-09],
        [8.1332e-09, 6.3094e-09, 1.9502e-06,  ..., 1.0944e-08, 4.9912e-09,
         8.3914e-09]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[7.3556e-10, 7.3844e-10, 1.4495e-05,  ..., 7.5891e-10, 7.6188e-10,
         6.1699e-10],
        [2.6551e-09, 2.6344e-09, 2.4735e-06,  ..., 2.3248e-09, 3.0086e-09,
         2.3800e-09],
        [2.1994e-08, 2.2428e-08, 2.9988e-05,  ..., 2.2080e-08, 2.1569e-08,
         2.0824e-08],
        [2.3367e-09, 2.2826e-09, 4.9025e-04,  ..., 2.3367e-09, 2.4585e-09,
         2.5266e-09],
        [4.9594e-08, 4.9788e-08, 3.3181e-05,  ..., 5.2793e-08, 5.0969e-08,
         4.5333e-08]], device='cuda:0')
x_max_sum:  tensor([[0.3455],
        [0.1052],
        [0.6199],
        [0.0500],
        [0.6284]], device='cuda:0')
target_prob:  tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [2.1121e-08, 1.5709e-08, 0.0000e+00,  ..., 1.2082e-08, 1.2793e-08,
         1.5510e-08],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 1.2517e-08, 0.0000e+00,  ..., 4.5997e-09, 1.1081e-08,
         3.5436e-08],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
tensor(50639, device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [2.1121e-08, 1.5709e-08, 0.0000e+00,  ..., 1.2082e-08, 1.2793e-08,
         1.5510e-08],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 1.2517e-08, 0.0000e+00,  ..., 4.5997e-09, 1.1081e-08,
         3.5436e-08],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
tensor([9, 9, 9, 9, 9], device='cuda:0')
tensor([[[1.3774e-10, 2.3799e-10, 1.0222e-06,  ..., 1.4267e-10,
          1.7075e-10, 1.6421e-10],
         [1.1145e-09, 1.4939e-09, 1.2198e-06,  ..., 1.1189e-09,
          1.3979e-09, 1.3235e-09],
         [6.0926e-10, 5.2727e-10, 1.0089e-06,  ..., 3.7682e-10,
          2.4616e-10, 4.9726e-10],
         ...,
         [1.8160e-09, 1.7430e-09, 4.2337e-04,  ..., 1.0759e-09,
          2.3227e-09, 1.5114e-09],
         [8.4991e-09, 1.0639e-08, 2.9674e-06,  ..., 6.6320e-09,
          1.2103e-08, 9.7633e-09],
         [6.2908e-08, 5.9444e-08, 8.4689e-05,  ..., 4.0696e-08,
          4.4783e-08, 3.8455e-08]],

        [[4.8762e-09, 4.2865e-09, 1.5039e-06,  ..., 3.5955e-09,
          4.3540e-09, 4.0111e-09],
         [1.0195e-08, 8.2881e-09, 1.2941e-06,  ..., 7.7254e-09,
          7.2573e-09, 6.9521e-09],
         [7.8801e-09, 8.8945e-09, 5.4547e-07,  ..., 6.8197e-09,
          8.0986e-09, 7.6079e-09],
         ...,
         [3.7307e-09, 4.8279e-09, 1.1119e-06,  ..., 4.5177e-09,
          3.5047e-09, 3.9251e-09],
         [1.1808e-08, 1.0751e-08, 1.6129e-06,  ..., 1.3276e-08,
          9.4511e-09, 9.8276e-09],
         [7.6771e-09, 7.4119e-09, 1.1011e-06,  ..., 9.2966e-09,
          7.2970e-09, 8.9056e-09]],

        [[7.5942e-09, 3.3666e-09, 1.1181e-07,  ..., 3.9824e-09,
          2.7802e-09, 4.3398e-09],
         [7.6931e-09, 5.9448e-09, 1.3094e-04,  ..., 8.6496e-09,
          5.1649e-09, 4.8142e-09],
         [1.0261e-08, 7.1913e-09, 1.3584e-06,  ..., 9.7910e-09,
          6.9428e-09, 6.7292e-09],
         ...,
         [1.3365e-09, 1.2409e-09, 2.5875e-06,  ..., 1.1167e-09,
          8.9031e-10, 1.1255e-09],
         [2.0994e-08, 2.0468e-08, 2.9761e-06,  ..., 2.4023e-08,
          1.8028e-08, 2.9148e-08],
         [2.8073e-08, 2.7209e-08, 3.5899e-06,  ..., 3.1811e-08,
          2.3732e-08, 2.7854e-08]],

        [[1.0190e-09, 2.9085e-09, 7.8339e-05,  ..., 2.5667e-09,
          3.0126e-09, 4.2985e-09],
         [1.2755e-09, 1.6635e-09, 1.2370e-05,  ..., 1.8558e-09,
          1.2508e-09, 1.2705e-09],
         [8.5584e-09, 1.2259e-08, 1.7950e-05,  ..., 2.0331e-08,
          1.8584e-08, 1.2501e-08],
         ...,
         [2.6086e-08, 1.8936e-08, 1.1219e-05,  ..., 2.5782e-08,
          2.3751e-08, 1.8211e-08],
         [9.0668e-10, 8.3854e-10, 6.5207e-07,  ..., 1.0234e-09,
          1.1597e-09, 1.2393e-09],
         [4.8799e-09, 5.4867e-09, 1.7309e-05,  ..., 4.8799e-09,
          3.7857e-09, 3.8453e-09]],

        [[8.1332e-09, 6.3094e-09, 1.9502e-06,  ..., 1.0944e-08,
          4.9912e-09, 8.3914e-09],
         [4.5009e-09, 2.8056e-09, 2.6119e-04,  ..., 3.6592e-09,
          3.1177e-09, 2.6771e-09],
         [1.7354e-08, 1.5077e-08, 1.3549e-04,  ..., 1.8258e-08,
          1.6049e-08, 1.2597e-08],
         ...,
         [2.1247e-08, 1.1507e-08, 2.5267e-05,  ..., 1.4433e-08,
          1.2687e-08, 1.9497e-08],
         [4.3620e-09, 3.7456e-09, 9.5905e-04,  ..., 3.5880e-09,
          3.4913e-09, 3.8645e-09],
         [9.1502e-09, 1.2241e-08, 1.2415e-05,  ..., 1.0698e-08,
          1.1749e-08, 1.0429e-08]]], device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [7.6771e-09, 7.4119e-09, 1.1011e-06,  ..., 9.2966e-09, 7.2970e-09,
         8.9056e-09],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 1.2517e-08, 0.0000e+00,  ..., 4.5997e-09, 1.1081e-08,
         3.5436e-08],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
accept_cnt:  tensor([0, 1, 0, 2, 1], device='cuda:0')
target_prob_at_reject_idx:  tensor([[1.0332e-09, 1.4123e-09, 8.3711e-07,  ..., 1.0252e-09, 1.2366e-09,
         1.2033e-09],
        [1.2188e-09, 2.0017e-09, 8.3480e-07,  ..., 1.8013e-09, 1.6595e-09,
         1.2874e-09],
        [1.0635e-08, 1.0368e-08, 1.2996e-06,  ..., 1.2361e-08, 6.3505e-09,
         8.7996e-09],
        [3.5741e-08, 4.7767e-08, 3.0695e-07,  ..., 4.7767e-08, 3.7972e-08,
         3.7420e-08],
        [2.6681e-09, 2.2120e-09, 1.6038e-04,  ..., 3.0116e-09, 3.1809e-09,
         2.8849e-09]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[4.1190e-09, 4.0394e-09, 3.8793e-05,  ..., 4.3847e-09, 4.9106e-09,
         4.1190e-09],
        [3.9256e-09, 3.9256e-09, 3.1442e-06,  ..., 4.4136e-09, 3.7312e-09,
         4.1301e-09],
        [9.2393e-08, 9.2393e-08, 1.9432e-05,  ..., 9.0960e-08, 9.6449e-08,
         6.6289e-08],
        [6.0845e-09, 6.1083e-09, 4.5680e-06,  ..., 5.8286e-09, 5.8058e-09,
         7.7065e-09],
        [4.6871e-09, 4.6871e-09, 1.8622e-04,  ..., 4.3689e-09, 5.4159e-09,
         3.7957e-09]], device='cuda:0')
x_max_sum:  tensor([[0.2967],
        [0.2399],
        [0.3760],
        [0.3435],
        [0.3565]], device='cuda:0')
target_prob:  tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [8.6330e-08, 1.2127e-07, 0.0000e+00,  ..., 1.2208e-07, 9.3635e-08,
         8.6495e-08],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
tensor(33810, device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [8.6330e-08, 1.2127e-07, 0.0000e+00,  ..., 1.2208e-07, 9.3635e-08,
         8.6495e-08],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
tensor([9, 9, 9, 9, 9], device='cuda:0')
tensor([[[1.0332e-09, 1.4123e-09, 8.3711e-07,  ..., 1.0252e-09,
          1.2366e-09, 1.2033e-09],
         [1.5526e-09, 1.6207e-09, 3.5555e-06,  ..., 1.1009e-09,
          1.1538e-09, 1.2186e-09],
         [1.2971e-09, 1.2474e-09, 2.0858e-06,  ..., 7.8671e-10,
          9.1260e-10, 1.2770e-09],
         ...,
         [1.8924e-09, 2.0581e-09, 3.2594e-04,  ..., 1.2435e-09,
          2.4633e-09, 1.6897e-09],
         [6.2198e-09, 4.4799e-09, 1.3274e-06,  ..., 2.7172e-09,
          4.7133e-09, 6.3424e-09],
         [6.6379e-09, 5.2510e-09, 3.0592e-04,  ..., 3.6515e-09,
          6.3587e-09, 9.0023e-09]],

        [[1.6943e-09, 1.6167e-09, 2.7630e-07,  ..., 1.6421e-09,
          1.4156e-09, 1.4156e-09],
         [1.2188e-09, 2.0017e-09, 8.3480e-07,  ..., 1.8013e-09,
          1.6595e-09, 1.2874e-09],
         [8.8471e-09, 8.6084e-09, 1.7446e-06,  ..., 9.9082e-09,
          8.3762e-09, 6.9441e-09],
         ...,
         [1.5342e-09, 1.8362e-09, 2.1561e-06,  ..., 1.1312e-09,
          1.9622e-09, 1.2919e-09],
         [1.6280e-09, 2.2383e-09, 1.7036e-06,  ..., 1.4998e-09,
          2.2383e-09, 1.8959e-09],
         [9.9056e-09, 1.0837e-08, 8.3451e-07,  ..., 6.8614e-09,
          9.2691e-09, 5.7329e-09]],

        [[1.0635e-08, 1.0368e-08, 1.2996e-06,  ..., 1.2361e-08,
          6.3505e-09, 8.7996e-09],
         [8.8696e-09, 8.6304e-09, 3.2517e-06,  ..., 6.8673e-09,
          5.7043e-09, 8.7492e-09],
         [2.5672e-07, 2.2109e-07, 8.7497e-06,  ..., 3.4293e-07,
          1.2073e-07, 2.2766e-07],
         ...,
         [1.3602e-08, 1.2027e-08, 5.7435e-07,  ..., 1.4997e-08,
          9.7778e-09, 1.3897e-08],
         [3.0906e-07, 3.1270e-07, 3.8287e-05,  ..., 5.0956e-07,
          2.1200e-07, 2.6747e-07],
         [1.9760e-07, 2.2805e-07, 5.8315e-06,  ..., 3.1146e-07,
          1.8401e-07, 1.8010e-07]],

        [[7.6341e-09, 1.5957e-08, 1.6717e-04,  ..., 1.3689e-08,
          2.1161e-08, 1.1595e-08],
         [1.4089e-09, 2.1265e-09, 1.4075e-06,  ..., 2.9930e-09,
          3.1651e-09, 1.8336e-09],
         [3.5741e-08, 4.7767e-08, 3.0695e-07,  ..., 4.7767e-08,
          3.7972e-08, 3.7420e-08],
         ...,
         [2.3529e-08, 1.6234e-08, 1.4594e-05,  ..., 1.7553e-08,
          2.9397e-08, 2.3074e-08],
         [2.3213e-09, 2.5297e-09, 1.9713e-05,  ..., 2.1302e-09,
          3.0633e-09, 2.3857e-09],
         [9.2685e-09, 9.0715e-09, 4.8483e-06,  ..., 8.5887e-09,
          8.1157e-09, 8.1316e-09]],

        [[2.5331e-10, 2.6808e-10, 2.0443e-07,  ..., 2.0635e-10,
          2.3750e-10, 2.2399e-10],
         [2.6681e-09, 2.2120e-09, 1.6038e-04,  ..., 3.0116e-09,
          3.1809e-09, 2.8849e-09],
         [1.2232e-08, 8.8448e-09, 1.5094e-06,  ..., 1.1809e-08,
          1.2522e-08, 1.1763e-08],
         ...,
         [1.6300e-08, 1.7556e-08, 3.0471e-04,  ..., 2.3903e-08,
          1.3356e-08, 1.1424e-08],
         [1.8385e-08, 1.7271e-08, 7.4339e-06,  ..., 1.3824e-08,
          1.4318e-08, 1.1964e-08],
         [2.9426e-08, 2.4205e-08, 1.9156e-05,  ..., 2.9772e-08,
          2.4016e-08, 2.4205e-08]]], device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [8.6330e-08, 1.2127e-07, 0.0000e+00,  ..., 1.2208e-07, 9.3635e-08,
         8.6495e-08],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
accept_cnt:  tensor([6, 1, 3, 0, 2, 3], device='cuda:0')
target_prob_at_reject_idx:  tensor([[1.2797e-09, 1.2648e-09, 6.0950e-07,  ..., 1.0045e-09, 7.0672e-10,
         9.7355e-10],
        [6.2613e-09, 5.3765e-09, 1.0355e-06,  ..., 3.8575e-09, 5.7682e-09,
         5.3765e-09],
        [1.1021e-09, 1.2391e-09, 3.0443e-06,  ..., 1.1064e-09, 8.4831e-10,
         1.4318e-09],
        [3.0008e-09, 5.2358e-09, 5.2896e-06,  ..., 4.0380e-09, 2.8080e-09,
         2.6379e-09],
        [3.3685e-09, 2.9611e-09, 2.1484e-06,  ..., 3.6708e-09, 2.2615e-09,
         3.5998e-09],
        [7.2852e-09, 7.1443e-09, 5.4314e-07,  ..., 8.1590e-09, 1.1687e-08,
         5.0070e-09]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[4.6702e-09, 4.7068e-09, 1.1655e-05,  ..., 4.5442e-09, 5.2508e-09,
         5.7895e-09],
        [1.0030e-08, 1.0109e-08, 1.6190e-06,  ..., 1.1016e-08, 8.8861e-09,
         1.0148e-08],
        [3.0788e-09, 3.1151e-09, 4.6053e-06,  ..., 3.1518e-09, 3.0908e-09,
         4.1592e-09],
        [1.0121e-08, 9.9248e-09, 5.9183e-05,  ..., 9.8092e-09, 9.3235e-09,
         9.1075e-09],
        [1.6809e-08, 1.6809e-08, 8.5683e-06,  ..., 1.7208e-08, 1.5546e-08,
         1.3297e-08],
        [6.1788e-08, 6.1788e-08, 4.2396e-06,  ..., 6.0593e-08, 6.2273e-08,
         6.0593e-08]], device='cuda:0')
x_max_sum:  tensor([[0.3191],
        [0.5103],
        [0.2644],
        [0.2476],
        [0.5523],
        [0.4281]], device='cuda:0')
target_prob:  tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:0')
tensor(42998, device='cuda:0')
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:0')
tensor([9, 9, 9, 9, 9, 9], device='cuda:0')
tensor([[[4.2332e-10, 5.4996e-10, 4.7339e-07,  ..., 4.1352e-10,
          3.4148e-10, 4.5594e-10],
         [1.0561e-09, 1.3350e-09, 3.5051e-06,  ..., 7.1877e-10,
          9.8245e-10, 9.8629e-10],
         [1.8512e-09, 1.6336e-09, 1.9908e-06,  ..., 1.0303e-09,
          1.2923e-09, 1.5834e-09],
         ...,
         [1.5794e-09, 1.5794e-09, 5.2082e-07,  ..., 1.1069e-09,
          1.4048e-09, 1.0729e-09],
         [3.0863e-10, 5.1485e-10, 1.5496e-07,  ..., 2.1673e-10,
          2.5190e-10, 2.8994e-10],
         [4.9638e-10, 5.3672e-10, 4.3932e-07,  ..., 3.0225e-10,
          3.7911e-10, 3.8358e-10]],

        [[2.9695e-09, 3.1858e-09, 1.4865e-06,  ..., 3.5540e-09,
          3.3649e-09, 2.9928e-09],
         [6.2613e-09, 5.3765e-09, 1.0355e-06,  ..., 3.8575e-09,
          5.7682e-09, 5.3765e-09],
         [1.3127e-09, 1.3865e-09, 4.5474e-07,  ..., 1.0045e-09,
          1.5588e-09, 1.4445e-09],
         ...,
         [5.5761e-09, 6.8053e-09, 1.0974e-06,  ..., 4.1115e-09,
          7.5623e-09, 5.6639e-09],
         [4.7790e-09, 5.8325e-09, 9.1441e-06,  ..., 3.1097e-09,
          4.1846e-09, 5.2898e-09],
         [1.2199e-08, 1.5422e-08, 8.3740e-07,  ..., 1.4042e-08,
          1.4947e-08, 1.3987e-08]],

        [[5.4173e-09, 3.9172e-09, 1.4504e-05,  ..., 6.7025e-09,
          2.8050e-09, 4.0972e-09],
         [3.1281e-08, 2.1923e-08, 4.1839e-06,  ..., 3.3822e-08,
          2.4266e-08, 2.6966e-08],
         [4.9604e-10, 4.8835e-10, 4.5141e-07,  ..., 4.3605e-10,
          4.5698e-10, 5.5554e-10],
         ...,
         [2.5150e-09, 4.5497e-09, 6.2387e-07,  ..., 5.6511e-09,
          3.6952e-09, 4.6078e-09],
         [4.3295e-08, 4.3465e-08, 2.8312e-06,  ..., 5.7357e-08,
          2.7953e-08, 6.2504e-08],
         [1.1350e-08, 6.7248e-09, 2.0021e-07,  ..., 1.0249e-08,
          4.9975e-09, 6.7942e-09]],

        [[3.0008e-09, 5.2358e-09, 5.2896e-06,  ..., 4.0380e-09,
          2.8080e-09, 2.6379e-09],
         [1.6331e-08, 1.6173e-08, 1.5807e-04,  ..., 1.4554e-08,
          1.3355e-08, 8.6566e-09],
         [1.0687e-07, 8.7562e-08, 1.1116e-05,  ..., 1.3068e-07,
          1.5189e-07, 9.8449e-08],
         ...,
         [7.6948e-10, 6.4892e-10, 2.1619e-07,  ..., 8.2755e-10,
          1.0754e-09, 9.1602e-10],
         [3.0375e-08, 2.8092e-08, 1.3832e-07,  ..., 2.5578e-08,
          3.0345e-08, 3.2051e-08],
         [1.1214e-08, 9.3335e-09, 1.2815e-04,  ..., 1.3009e-08,
          9.9744e-09, 8.7680e-09]],

        [[1.1659e-09, 8.3974e-10, 1.9686e-06,  ..., 1.1038e-09,
          6.3635e-10, 6.6950e-10],
         [1.2138e-08, 1.1582e-08, 3.7952e-06,  ..., 1.8293e-08,
          1.3541e-08, 1.1403e-08],
         [3.3685e-09, 2.9611e-09, 2.1484e-06,  ..., 3.6708e-09,
          2.2615e-09, 3.5998e-09],
         ...,
         [2.1408e-09, 1.7679e-09, 8.3070e-06,  ..., 1.5847e-09,
          1.6414e-09, 1.6543e-09],
         [1.4417e-08, 1.3650e-08, 1.5999e-04,  ..., 2.3310e-08,
          1.2673e-08, 1.8225e-08],
         [5.8774e-09, 3.4823e-09, 3.3771e-05,  ..., 6.3302e-09,
          4.8916e-09, 5.0076e-09]],

        [[2.9566e-09, 3.1228e-09, 4.4137e-07,  ..., 3.3372e-09,
          3.8863e-09, 2.0241e-09],
         [5.0498e-10, 6.4336e-10, 8.1377e-06,  ..., 3.6945e-10,
          6.2601e-10, 2.7779e-10],
         [2.4303e-09, 2.5173e-09, 1.3076e-07,  ..., 1.5328e-09,
          2.3555e-09, 1.1170e-09],
         ...,
         [3.5798e-08, 4.9701e-08, 3.6444e-06,  ..., 6.3444e-08,
          5.5716e-08, 4.8077e-08],
         [1.9080e-07, 1.0871e-07, 1.8429e-04,  ..., 9.1189e-08,
          2.0271e-07, 1.6067e-07],
         [1.5567e-08, 1.1301e-08, 1.0037e-04,  ..., 9.0096e-09,
          1.1751e-08, 1.0657e-08]]], device='cuda:0')
tensor([[0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.],
        [0., 0., 0.,  ..., 0., 0., 0.]], device='cuda:0')
INFO:     127.0.0.1:45222 - "POST /generate HTTP/1.1" 200 OK
accept_cnt:  tensor([6, 2, 1, 3, 0, 1], device='cuda:0')
target_prob_at_reject_idx:  tensor([[5.3476e-09, 4.1810e-09, 1.8149e-06,  ..., 1.8698e-09, 3.8517e-09,
         4.7935e-09],
        [2.3005e-10, 3.1444e-10, 4.3341e-06,  ..., 1.5087e-10, 3.1690e-10,
         1.9146e-10],
        [2.6756e-08, 2.8482e-08, 5.8831e-06,  ..., 4.8449e-08, 2.7072e-08,
         3.5033e-08],
        [5.6129e-08, 6.6916e-08, 3.6899e-05,  ..., 6.2373e-08, 8.0874e-08,
         5.5475e-08],
        [1.2984e-08, 1.1822e-08, 9.4469e-07,  ..., 1.0474e-08, 1.7202e-08,
         1.0849e-08],
        [6.6751e-08, 5.6100e-08, 1.6558e-05,  ..., 4.0486e-08, 5.1080e-08,
         5.7206e-08]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[5.0579e-09, 5.1778e-09, 1.2396e-05,  ..., 4.8641e-09, 5.2593e-09,
         4.4288e-09],
        [2.9129e-10, 2.8455e-10, 1.3621e-06,  ..., 3.1620e-10, 2.7472e-10,
         3.0172e-10],
        [1.3686e-08, 1.3686e-08, 1.6891e-05,  ..., 1.2559e-08, 1.3369e-08,
         1.2364e-08],
        [2.3412e-07, 2.3688e-07, 3.0844e-05,  ..., 2.4202e-07, 2.0580e-07,
         2.1950e-07],
        [4.2697e-08, 4.2199e-08, 3.0523e-06,  ..., 4.0110e-08, 3.9488e-08,
         3.9334e-08],
        [2.1104e-08, 2.0777e-08, 3.9063e-05,  ..., 2.3269e-08, 2.1187e-08,
         1.9442e-08]], device='cuda:0')
x_max_sum:  tensor([[0.3371],
        [0.5817],
        [0.5315],
        [0.4544],
        [0.4508],
        [0.4500]], device='cuda:0')
target_prob:  tensor([[8.5940e-10, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         1.0819e-09],
        [0.0000e+00, 5.1390e-11, 5.1097e-06,  ..., 0.0000e+00, 7.2530e-11,
         0.0000e+00],
        [2.4594e-08, 2.7841e-08, 0.0000e+00,  ..., 6.7533e-08, 2.5784e-08,
         4.2656e-08],
        [0.0000e+00, 0.0000e+00, 1.3327e-05,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [1.0145e-07, 7.8504e-08, 0.0000e+00,  ..., 3.8264e-08, 6.6435e-08,
         8.3930e-08]], device='cuda:0')
tensor(98934, device='cuda:0')
tensor([[8.5940e-10, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         1.0819e-09],
        [0.0000e+00, 5.1390e-11, 5.1097e-06,  ..., 0.0000e+00, 7.2530e-11,
         0.0000e+00],
        [2.4594e-08, 2.7841e-08, 0.0000e+00,  ..., 6.7533e-08, 2.5784e-08,
         4.2656e-08],
        [0.0000e+00, 0.0000e+00, 1.3327e-05,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [1.0145e-07, 7.8504e-08, 0.0000e+00,  ..., 3.8264e-08, 6.6435e-08,
         8.3930e-08]], device='cuda:0')
tensor([9, 9, 9, 9, 9, 9], device='cuda:0')
tensor([[[2.7078e-09, 4.8272e-09, 1.0134e-06,  ..., 3.5873e-09,
          2.6451e-09, 3.9553e-09],
         [8.9911e-10, 1.3082e-09, 8.2130e-08,  ..., 7.8729e-10,
          7.2246e-10, 1.0308e-09],
         [3.5703e-10, 5.7613e-10, 2.7986e-06,  ..., 3.2827e-10,
          5.0645e-10, 4.2481e-10],
         ...,
         [2.0823e-09, 3.6119e-09, 1.3693e-04,  ..., 1.6666e-09,
          2.6737e-09, 3.8599e-09],
         [1.3988e-08, 1.3505e-08, 1.1947e-05,  ..., 7.7554e-09,
          1.0355e-08, 1.8971e-08],
         [4.9552e-09, 6.5135e-09, 2.7378e-06,  ..., 6.4881e-09,
          4.1402e-09, 6.0005e-09]],

        [[4.0786e-10, 4.9390e-10, 3.6440e-06,  ..., 2.9149e-10,
          4.2911e-10, 3.3945e-10],
         [1.8126e-09, 1.4451e-09, 1.0434e-06,  ..., 8.9031e-10,
          1.5443e-09, 9.2216e-10],
         [2.3005e-10, 3.1444e-10, 4.3341e-06,  ..., 1.5087e-10,
          3.1690e-10, 1.9146e-10],
         ...,
         [7.3452e-09, 1.1421e-08, 3.9720e-06,  ..., 5.9716e-09,
          1.2193e-08, 5.9716e-09],
         [3.0574e-10, 4.0189e-10, 4.1490e-06,  ..., 2.4376e-10,
          4.6620e-10, 3.0455e-10],
         [1.6091e-09, 1.4911e-09, 1.2494e-03,  ..., 1.2434e-09,
          2.1318e-09, 6.7079e-10]],

        [[1.1568e-08, 1.2606e-08, 5.0165e-06,  ..., 1.7467e-08,
          8.4302e-09, 1.6060e-08],
         [2.6756e-08, 2.8482e-08, 5.8831e-06,  ..., 4.8449e-08,
          2.7072e-08, 3.5033e-08],
         [6.0279e-08, 5.2782e-08, 5.0949e-06,  ..., 5.9694e-08,
          4.0391e-08, 5.4352e-08],
         ...,
         [8.2367e-10, 1.0211e-09, 7.5630e-06,  ..., 7.7984e-10,
          5.5732e-10, 1.1258e-09],
         [1.4999e-08, 9.8363e-09, 1.1305e-05,  ..., 8.8518e-09,
          7.6009e-09, 1.7399e-08],
         [1.8471e-07, 1.2281e-07, 4.2047e-05,  ..., 1.3781e-07,
          7.5511e-08, 1.5769e-07]],

        [[2.9744e-09, 4.1782e-09, 1.9106e-04,  ..., 4.9039e-09,
          4.3024e-09, 4.1457e-09],
         [7.7812e-10, 8.3765e-10, 1.5242e-06,  ..., 1.0766e-09,
          1.0079e-09, 8.9955e-10],
         [3.3044e-08, 3.4159e-08, 3.7669e-07,  ..., 3.6971e-08,
          2.9620e-08, 3.4495e-08],
         ...,
         [1.8650e-08, 1.8796e-08, 1.0509e-04,  ..., 2.0245e-08,
          2.1635e-08, 2.4707e-08],
         [1.2935e-07, 1.2247e-07, 2.5837e-04,  ..., 1.5123e-07,
          1.2835e-07, 1.5123e-07],
         [6.7555e-09, 5.9734e-09, 2.8781e-07,  ..., 1.0052e-08,
          8.1726e-09, 9.0022e-09]],

        [[1.2984e-08, 1.1822e-08, 9.4469e-07,  ..., 1.0474e-08,
          1.7202e-08, 1.0849e-08],
         [1.8844e-09, 1.6436e-09, 1.2521e-06,  ..., 1.1078e-09,
          2.3360e-09, 1.2951e-09],
         [1.0904e-08, 1.0284e-08, 9.2730e-07,  ..., 7.0404e-09,
          8.5924e-09, 4.4057e-09],
         ...,
         [3.9584e-09, 2.4868e-09, 2.6818e-07,  ..., 4.6278e-09,
          4.0207e-09, 1.7982e-09],
         [8.5217e-09, 9.2142e-09, 1.4400e-06,  ..., 1.3512e-08,
          1.5674e-08, 8.2273e-09],
         [1.4332e-09, 1.7560e-09, 5.8063e-05,  ..., 2.6258e-09,
          1.7906e-09, 1.3569e-09]],

        [[2.3794e-08, 2.6235e-08, 3.5458e-05,  ..., 2.2179e-08,
          3.5442e-08, 3.1770e-08],
         [6.6751e-08, 5.6100e-08, 1.6558e-05,  ..., 4.0486e-08,
          5.1080e-08, 5.7206e-08],
         [5.6518e-08, 5.6518e-08, 3.1811e-05,  ..., 8.4184e-08,
          4.7967e-08, 5.9000e-08],
         ...,
         [8.7358e-09, 8.4340e-09, 3.4974e-05,  ..., 6.6719e-09,
          8.0478e-09, 7.5898e-09],
         [2.6877e-09, 2.4187e-09, 4.3731e-06,  ..., 2.0209e-09,
          1.9359e-09, 2.0688e-09],
         [8.3483e-09, 7.1967e-09, 1.2649e-05,  ..., 7.8425e-09,
          9.4598e-09, 8.2510e-09]]], device='cuda:0')
tensor([[8.5940e-10, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         1.0819e-09],
        [0.0000e+00, 5.1390e-11, 5.1097e-06,  ..., 0.0000e+00, 7.2530e-11,
         0.0000e+00],
        [2.4594e-08, 2.7841e-08, 0.0000e+00,  ..., 6.7533e-08, 2.5784e-08,
         4.2656e-08],
        [0.0000e+00, 0.0000e+00, 1.3327e-05,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [1.0145e-07, 7.8504e-08, 0.0000e+00,  ..., 3.8264e-08, 6.6435e-08,
         8.3930e-08]], device='cuda:0')
accept_cnt:  tensor([0, 0, 0, 1, 0, 1], device='cuda:0')
target_prob_at_reject_idx:  tensor([[3.2964e-09, 3.3614e-09, 1.0063e-06,  ..., 2.0230e-09, 2.5975e-09,
         4.1185e-09],
        [4.6299e-09, 3.6913e-09, 7.4134e-07,  ..., 2.7863e-09, 4.3664e-09,
         3.5360e-09],
        [1.9429e-08, 2.3163e-08, 3.3335e-06,  ..., 1.9203e-08, 1.3723e-08,
         3.0987e-08],
        [2.1224e-08, 2.1141e-08, 6.0972e-04,  ..., 2.6935e-08, 2.7359e-08,
         1.8013e-08],
        [2.7897e-08, 3.5681e-08, 2.3319e-05,  ..., 3.6101e-08, 7.3355e-08,
         3.6742e-08],
        [3.2596e-08, 3.8898e-08, 3.6558e-05,  ..., 2.7262e-08, 2.8654e-08,
         3.1686e-08]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[4.3083e-08, 4.4451e-08, 7.9654e-06,  ..., 4.7133e-08, 4.4625e-08,
         4.0315e-08],
        [2.5238e-08, 2.5238e-08, 9.9639e-07,  ..., 2.4177e-08, 2.4271e-08,
         2.3802e-08],
        [1.8099e-08, 1.8028e-08, 1.3788e-05,  ..., 1.8893e-08, 1.7818e-08,
         1.6936e-08],
        [1.1748e-07, 1.1703e-07, 1.2222e-04,  ..., 1.2312e-07, 1.1933e-07,
         1.0531e-07],
        [4.7643e-08, 4.7457e-08, 9.8746e-06,  ..., 3.9885e-08, 4.7180e-08,
         3.4182e-08],
        [1.1652e-08, 1.1606e-08, 2.2034e-05,  ..., 1.2235e-08, 1.1382e-08,
         1.9210e-08]], device='cuda:0')
x_max_sum:  tensor([[0.3910],
        [0.4702],
        [0.4690],
        [0.3682],
        [0.6391],
        [0.3202]], device='cuda:0')
target_prob:  tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [2.8367e-09, 1.0949e-08, 0.0000e+00,  ..., 6.5953e-10, 0.0000e+00,
         2.9962e-08],
        [0.0000e+00, 0.0000e+00, 1.3240e-03,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 2.1037e-05,  ..., 0.0000e+00, 4.0957e-08,
         4.0047e-09],
        [6.5403e-08, 8.5224e-08, 4.5352e-05,  ..., 4.6924e-08, 5.3935e-08,
         3.8957e-08]], device='cuda:0')
tensor(67343, device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [2.8367e-09, 1.0949e-08, 0.0000e+00,  ..., 6.5953e-10, 0.0000e+00,
         2.9962e-08],
        [0.0000e+00, 0.0000e+00, 1.3240e-03,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 2.1037e-05,  ..., 0.0000e+00, 4.0957e-08,
         4.0047e-09],
        [6.5403e-08, 8.5224e-08, 4.5352e-05,  ..., 4.6924e-08, 5.3935e-08,
         3.8957e-08]], device='cuda:0')
tensor([9, 9, 9, 9, 9, 9], device='cuda:0')
tensor([[[3.2964e-09, 3.3614e-09, 1.0063e-06,  ..., 2.0230e-09,
          2.5975e-09, 4.1185e-09],
         [1.3959e-09, 2.3931e-09, 9.0367e-05,  ..., 1.4629e-09,
          1.8241e-09, 3.5229e-09],
         [2.7557e-09, 3.1595e-09, 6.7067e-04,  ..., 1.7044e-09,
          3.3371e-09, 2.2230e-09],
         ...,
         [2.3861e-10, 3.4448e-10, 5.1774e-02,  ..., 2.5203e-10,
          2.4715e-10, 3.2742e-10],
         [2.1229e-09, 2.1647e-09, 1.0941e-01,  ..., 1.5531e-09,
          2.4530e-09, 1.7599e-09],
         [1.4302e-08, 1.4246e-08, 5.0145e-07,  ..., 1.3124e-08,
          1.2425e-08, 1.2695e-08]],

        [[4.6299e-09, 3.6913e-09, 7.4134e-07,  ..., 2.7863e-09,
          4.3664e-09, 3.5360e-09],
         [2.9122e-08, 1.9551e-08, 1.0364e-06,  ..., 1.8367e-08,
          1.4304e-08, 1.3024e-08],
         [1.6690e-08, 1.0123e-08, 1.3467e-06,  ..., 1.1697e-08,
          1.3675e-08, 1.1743e-08],
         ...,
         [4.7964e-09, 6.2924e-09, 1.2570e-04,  ..., 3.9377e-09,
          5.4456e-09, 3.6991e-09],
         [7.3089e-10, 9.7969e-10, 3.3315e-07,  ..., 5.6922e-10,
          5.7368e-10, 5.8500e-10],
         [3.5778e-09, 5.0259e-09, 3.4650e-07,  ..., 5.3920e-09,
          3.7938e-09, 4.5228e-09]],

        [[1.9429e-08, 2.3163e-08, 3.3335e-06,  ..., 1.9203e-08,
          1.3723e-08, 3.0987e-08],
         [2.5857e-08, 2.9072e-08, 1.8794e-06,  ..., 1.8479e-08,
          2.0020e-08, 2.4673e-08],
         [1.2966e-08, 1.4212e-08, 1.6702e-06,  ..., 1.5948e-08,
          1.3883e-08, 2.4129e-08],
         ...,
         [6.3889e-11, 8.8010e-11, 4.1436e-07,  ..., 6.7744e-11,
          6.0018e-11, 8.5136e-11],
         [1.1837e-07, 9.0053e-08, 1.5996e-05,  ..., 1.7089e-07,
          6.5756e-08, 1.3052e-07],
         [8.5098e-08, 1.1518e-07, 1.4409e-05,  ..., 1.5319e-07,
          6.1294e-08, 1.0325e-07]],

        [[2.4807e-08, 3.1604e-08, 1.3416e-04,  ..., 3.5257e-08,
          5.0900e-08, 3.2863e-08],
         [2.1224e-08, 2.1141e-08, 6.0972e-04,  ..., 2.6935e-08,
          2.7359e-08, 1.8013e-08],
         [3.8914e-08, 4.4441e-08, 3.5245e-04,  ..., 4.7865e-08,
          4.9481e-08, 3.9066e-08],
         ...,
         [4.8728e-09, 4.5066e-09, 5.7554e-06,  ..., 5.5001e-09,
          7.0623e-09, 4.1517e-09],
         [4.5803e-09, 4.5447e-09, 6.2756e-06,  ..., 5.7226e-09,
          5.9042e-09, 3.1113e-09],
         [1.8416e-09, 2.1955e-09, 1.8317e-06,  ..., 1.3213e-09,
          2.9544e-09, 1.7368e-09]],

        [[2.7897e-08, 3.5681e-08, 2.3319e-05,  ..., 3.6101e-08,
          7.3355e-08, 3.6742e-08],
         [9.3743e-10, 1.0960e-09, 8.3101e-06,  ..., 7.8940e-10,
          9.0859e-10, 6.9122e-10],
         [2.2916e-09, 2.7320e-09, 5.6531e-05,  ..., 1.7917e-09,
          2.9082e-09, 1.4285e-09],
         ...,
         [1.0727e-10, 1.2940e-10, 2.2809e-07,  ..., 1.1828e-10,
          1.3041e-10, 1.5731e-10],
         [6.5633e-10, 8.7290e-10, 5.5518e-06,  ..., 6.1898e-10,
          7.2649e-10, 5.6358e-10],
         [2.7508e-09, 2.8941e-09, 8.8781e-07,  ..., 2.4852e-09,
          3.6301e-09, 2.3621e-09]],

        [[4.1069e-09, 5.5698e-09, 5.7500e-05,  ..., 3.4181e-09,
          4.6537e-09, 5.2323e-09],
         [3.2596e-08, 3.8898e-08, 3.6558e-05,  ..., 2.7262e-08,
          2.8654e-08, 3.1686e-08],
         [5.2601e-08, 5.9926e-08, 1.0496e-04,  ..., 4.3058e-08,
          4.3480e-08, 6.4322e-08],
         ...,
         [4.1743e-09, 6.2664e-09, 1.0814e-03,  ..., 7.0180e-09,
          4.1580e-09, 6.5928e-09],
         [2.8914e-08, 3.3606e-08, 6.1607e-04,  ..., 2.8410e-08,
          3.0301e-08, 2.7215e-08],
         [4.7873e-08, 6.3919e-08, 1.0965e-03,  ..., 5.2579e-08,
          6.6206e-08, 5.1361e-08]]], device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [2.8367e-09, 1.0949e-08, 0.0000e+00,  ..., 6.5953e-10, 0.0000e+00,
         2.9962e-08],
        [0.0000e+00, 0.0000e+00, 1.3240e-03,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 2.1037e-05,  ..., 0.0000e+00, 4.0957e-08,
         4.0047e-09],
        [6.5403e-08, 8.5224e-08, 4.5352e-05,  ..., 4.6924e-08, 5.3935e-08,
         3.8957e-08]], device='cuda:0')
accept_cnt:  tensor([7, 3, 0, 0, 1, 2], device='cuda:0')
target_prob_at_reject_idx:  tensor([[5.2692e-09, 5.1471e-09, 6.6379e-06,  ..., 4.2010e-09, 6.4812e-09,
         6.1603e-09],
        [3.6101e-09, 4.7084e-09, 5.9378e-07,  ..., 2.9008e-09, 5.5263e-09,
         3.6526e-09],
        [4.2353e-09, 4.0572e-09, 3.1673e-06,  ..., 2.5093e-09, 3.2728e-09,
         4.8939e-09],
        [7.7738e-08, 7.8195e-08, 4.2700e-05,  ..., 7.8501e-08, 7.2744e-08,
         7.0231e-08],
        [9.1403e-08, 1.0439e-07, 3.3444e-05,  ..., 8.9286e-08, 1.1991e-07,
         5.2182e-08],
        [1.0995e-08, 8.4961e-09, 7.3572e-05,  ..., 1.1388e-08, 4.7104e-09,
         7.9193e-09]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[1.4548e-08, 1.4720e-08, 9.6217e-06,  ..., 1.3667e-08, 1.2203e-08,
         1.4101e-08],
        [2.0148e-09, 2.0625e-09, 1.0463e-05,  ..., 2.0625e-09, 1.7642e-09,
         1.8202e-09],
        [1.9736e-08, 1.9582e-08, 1.3517e-05,  ..., 2.0602e-08, 1.9736e-08,
         1.7080e-08],
        [4.2674e-07, 4.2177e-07, 1.0656e-04,  ..., 4.2674e-07, 4.1849e-07,
         4.0089e-07],
        [1.0570e-07, 1.0325e-07, 4.8610e-04,  ..., 1.0487e-07, 1.0905e-07,
         8.6604e-08],
        [1.0959e-08, 1.0916e-08, 1.1661e-04,  ..., 1.0416e-08, 1.1001e-08,
         1.3116e-08]], device='cuda:0')
x_max_sum:  tensor([[0.3263],
        [0.4964],
        [0.2760],
        [0.5178],
        [0.7602],
        [0.4615]], device='cuda:0')
target_prob:  tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [3.2136e-09, 5.3299e-09, 0.0000e+00,  ..., 1.6885e-09, 7.5783e-09,
         3.6913e-09],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 1.4969e-09, 0.0000e+00,  ..., 0.0000e+00, 1.4287e-08,
         0.0000e+00],
        [7.8603e-11, 0.0000e+00, 0.0000e+00,  ..., 2.1069e-09, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
tensor(77817, device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [3.2136e-09, 5.3299e-09, 0.0000e+00,  ..., 1.6885e-09, 7.5783e-09,
         3.6913e-09],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 1.4969e-09, 0.0000e+00,  ..., 0.0000e+00, 1.4287e-08,
         0.0000e+00],
        [7.8603e-11, 0.0000e+00, 0.0000e+00,  ..., 2.1069e-09, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
tensor([9, 9, 9, 9, 9, 9], device='cuda:0')
tensor([[[1.4176e-09, 2.1615e-09, 8.4050e-05,  ..., 1.1937e-09,
          1.6284e-09, 2.2345e-09],
         [5.8712e-09, 7.2783e-09, 5.3602e-04,  ..., 3.9571e-09,
          7.9625e-09, 4.2454e-09],
         [7.7828e-09, 9.5544e-09, 3.7726e-06,  ..., 5.5404e-09,
          1.0774e-08, 8.0613e-09],
         ...,
         [5.2692e-09, 5.1471e-09, 6.6379e-06,  ..., 4.2010e-09,
          6.4812e-09, 6.1603e-09],
         [1.8337e-09, 2.6680e-09, 2.0797e-03,  ..., 2.2555e-09,
          2.6680e-09, 2.5658e-09],
         [4.1721e-09, 3.8889e-09, 4.4372e-02,  ..., 3.3919e-09,
          4.8587e-09, 2.7149e-09]],

        [[2.0597e-10, 2.2270e-10, 3.7906e-06,  ..., 1.4211e-10,
          1.8975e-10, 2.1003e-10],
         [6.6831e-09, 8.8536e-09, 9.2181e-07,  ..., 6.0613e-09,
          6.5795e-09, 3.5217e-09],
         [6.5096e-09, 7.3189e-09, 2.9121e-07,  ..., 4.7255e-09,
          7.4342e-09, 4.4915e-09],
         ...,
         [5.6112e-09, 6.2597e-09, 2.6856e-06,  ..., 3.7233e-09,
          6.5091e-09, 7.9751e-09],
         [8.3512e-09, 7.5446e-09, 2.3739e-06,  ..., 7.4567e-09,
          9.7254e-09, 8.6838e-09],
         [2.7344e-08, 2.9740e-08, 4.4877e-06,  ..., 2.8433e-08,
          3.6154e-08, 3.0090e-08]],

        [[4.2353e-09, 4.0572e-09, 3.1673e-06,  ..., 2.5093e-09,
          3.2728e-09, 4.8939e-09],
         [3.2929e-07, 3.2704e-07, 3.2281e-06,  ..., 4.9480e-07,
          2.0476e-07, 2.7299e-07],
         [5.6103e-09, 8.7918e-09, 8.5072e-07,  ..., 6.6494e-09,
          4.6693e-09, 6.0190e-09],
         ...,
         [1.2954e-09, 2.3457e-09, 2.5573e-06,  ..., 1.7161e-09,
          1.0951e-09, 2.2426e-09],
         [3.5689e-09, 3.0766e-09, 1.6772e-04,  ..., 2.8902e-09,
          2.8565e-09, 3.0766e-09],
         [2.1930e-09, 2.2982e-09, 8.6084e-07,  ..., 2.0925e-09,
          2.8158e-09, 2.4947e-09]],

        [[7.7738e-08, 7.8195e-08, 4.2700e-05,  ..., 7.8501e-08,
          7.2744e-08, 7.0231e-08],
         [3.4224e-07, 3.0897e-07, 3.3073e-09,  ..., 2.0824e-07,
          2.3470e-07, 3.8985e-07],
         [2.0726e-08, 2.0405e-08, 4.3811e-05,  ..., 1.8871e-08,
          3.3250e-08, 3.0572e-08],
         ...,
         [2.6056e-08, 2.0135e-08, 5.2865e-05,  ..., 2.6883e-08,
          3.1925e-08, 2.4192e-08],
         [6.2508e-08, 6.0822e-08, 1.2149e-04,  ..., 6.1779e-08,
          6.2508e-08, 8.8841e-08],
         [1.0266e-07, 1.5055e-07, 9.7434e-05,  ..., 1.8018e-07,
          1.6993e-07, 1.2120e-07]],

        [[2.1242e-08, 2.0912e-08, 5.0328e-06,  ..., 1.5541e-08,
          3.5712e-08, 1.6673e-08],
         [9.1403e-08, 1.0439e-07, 3.3444e-05,  ..., 8.9286e-08,
          1.1991e-07, 5.2182e-08],
         [6.3706e-10, 6.8347e-10, 2.1313e-05,  ..., 6.4457e-10,
          6.6764e-10, 4.2770e-10],
         ...,
         [4.8081e-09, 6.0072e-09, 1.4760e-06,  ..., 4.6239e-09,
          6.7541e-09, 6.6754e-09],
         [1.2320e-08, 1.7891e-08, 7.0221e-07,  ..., 6.9044e-09,
          1.0926e-08, 1.1174e-08],
         [1.2558e-10, 1.0391e-10, 8.6532e-07,  ..., 7.9359e-11,
          1.0111e-10, 8.5808e-11]],

        [[1.6146e-08, 1.3281e-08, 2.1033e-03,  ..., 9.6789e-09,
          1.6020e-08, 1.2974e-08],
         [1.4492e-09, 1.2991e-09, 1.5594e-02,  ..., 1.6104e-09,
          8.1611e-10, 1.0644e-09],
         [1.0995e-08, 8.4961e-09, 7.3572e-05,  ..., 1.1388e-08,
          4.7104e-09, 7.9193e-09],
         ...,
         [5.4871e-08, 4.9090e-08, 3.5036e-04,  ..., 5.2769e-08,
          3.9292e-08, 7.0456e-08],
         [1.9774e-09, 2.6197e-09, 4.4777e-03,  ..., 2.2760e-09,
          1.3380e-09, 2.6818e-09],
         [3.3864e-09, 3.6615e-09, 1.3852e-05,  ..., 3.0593e-09,
          2.0300e-09, 4.7199e-09]]], device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [3.2136e-09, 5.3299e-09, 0.0000e+00,  ..., 1.6885e-09, 7.5783e-09,
         3.6913e-09],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 1.4969e-09, 0.0000e+00,  ..., 0.0000e+00, 1.4287e-08,
         0.0000e+00],
        [7.8603e-11, 0.0000e+00, 0.0000e+00,  ..., 2.1069e-09, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
accept_cnt:  tensor([5, 0, 1, 0, 4, 0], device='cuda:0')
target_prob_at_reject_idx:  tensor([[8.8379e-09, 8.9771e-09, 1.7060e-05,  ..., 5.6397e-09, 6.1218e-09,
         7.2415e-09],
        [6.1098e-09, 4.9575e-09, 4.9012e-07,  ..., 4.7490e-09, 6.3408e-09,
         3.0187e-09],
        [1.0386e-07, 1.3786e-07, 7.6791e-06,  ..., 2.0736e-07, 9.1477e-08,
         1.9328e-07],
        [1.6903e-07, 7.5891e-08, 6.8593e-05,  ..., 4.8334e-08, 8.2701e-08,
         1.0661e-07],
        [1.6004e-08, 1.0093e-08, 1.4662e-06,  ..., 8.8036e-09, 1.5511e-08,
         1.0871e-08],
        [1.0330e-08, 6.3519e-09, 2.9619e-04,  ..., 6.0374e-09, 3.9905e-09,
         7.0861e-09]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[9.1339e-08, 9.3505e-08, 8.4348e-05,  ..., 9.2056e-08, 8.9223e-08,
         1.1774e-07],
        [3.5370e-09, 3.5927e-09, 1.0972e-05,  ..., 3.3751e-09, 3.8245e-09,
         2.6491e-09],
        [6.1886e-08, 6.1405e-08, 2.8807e-05,  ..., 5.9749e-08, 5.7685e-08,
         5.2934e-08],
        [2.4949e-07, 2.5318e-07, 4.5015e-05,  ..., 2.5817e-07, 2.3120e-07,
         2.1154e-07],
        [2.8172e-07, 2.7953e-07, 3.7841e-06,  ..., 2.8616e-07, 2.1940e-07,
         3.0342e-07],
        [1.0278e-08, 1.0278e-08, 1.3468e-03,  ..., 9.7311e-09, 1.1027e-08,
         9.4317e-09]], device='cuda:0')
x_max_sum:  tensor([[0.3983],
        [0.3371],
        [0.5067],
        [0.6844],
        [0.4075],
        [0.4388]], device='cuda:0')
target_prob:  tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [7.6330e-09, 4.0491e-09, 0.0000e+00,  ..., 4.0763e-09, 7.4656e-09,
         1.0964e-09],
        [8.2838e-08, 1.5089e-07, 0.0000e+00,  ..., 2.9132e-07, 6.6693e-08,
         2.7698e-07],
        [0.0000e+00, 0.0000e+00, 3.4450e-05,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [1.1919e-10, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
tensor(58268, device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [7.6330e-09, 4.0491e-09, 0.0000e+00,  ..., 4.0763e-09, 7.4656e-09,
         1.0964e-09],
        [8.2838e-08, 1.5089e-07, 0.0000e+00,  ..., 2.9132e-07, 6.6693e-08,
         2.7698e-07],
        [0.0000e+00, 0.0000e+00, 3.4450e-05,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [1.1919e-10, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
tensor([9, 9, 9, 9, 9, 9], device='cuda:0')
tensor([[[9.1264e-09, 7.7152e-09, 5.0276e-06,  ..., 5.3442e-09,
          6.2236e-09, 6.7294e-09],
         [3.1719e-09, 3.6509e-09, 4.0233e-06,  ..., 1.8647e-09,
          1.7932e-09, 3.0864e-09],
         [9.9927e-09, 1.1913e-08, 2.8819e-04,  ..., 9.6099e-09,
          1.0071e-08, 1.5297e-08],
         ...,
         [1.4727e-09, 1.5076e-09, 7.1837e-04,  ..., 6.6120e-10,
          1.6174e-09, 1.7695e-09],
         [3.5457e-10, 3.5457e-10, 2.4398e-02,  ..., 2.4850e-10,
          2.3344e-10, 3.8639e-10],
         [2.4281e-09, 2.2899e-09, 1.7306e-01,  ..., 1.4959e-09,
          2.4857e-09, 1.9587e-09]],

        [[6.1098e-09, 4.9575e-09, 4.9012e-07,  ..., 4.7490e-09,
          6.3408e-09, 3.0187e-09],
         [9.2777e-10, 1.0051e-09, 1.7372e-07,  ..., 9.9147e-10,
          1.0975e-09, 6.6305e-10],
         [5.9585e-10, 8.0809e-10, 9.3782e-07,  ..., 6.0879e-10,
          7.2154e-10, 6.2201e-10],
         ...,
         [6.1901e-09, 6.8385e-09, 1.0557e-04,  ..., 4.2049e-09,
          6.8787e-09, 3.9967e-09],
         [6.7628e-09, 6.9639e-09, 1.0867e-07,  ..., 3.7641e-09,
          5.7172e-09, 4.3240e-09],
         [2.3472e-09, 2.0116e-09, 5.8338e-07,  ..., 2.3702e-09,
          1.6290e-09, 1.3479e-09]],

        [[8.6973e-08, 7.6753e-08, 1.6755e-06,  ..., 1.0050e-07,
          4.7286e-08, 1.0288e-07],
         [1.0386e-07, 1.3786e-07, 7.6791e-06,  ..., 2.0736e-07,
          9.1477e-08, 1.9328e-07],
         [2.1540e-08, 1.5484e-08, 1.4241e-06,  ..., 7.8777e-09,
          6.7250e-09, 1.1218e-08],
         ...,
         [3.0120e-09, 3.6191e-09, 2.0630e-06,  ..., 1.9296e-09,
          2.4392e-09, 4.3314e-09],
         [5.2710e-10, 7.7901e-10, 5.2237e-05,  ..., 8.5390e-10,
          7.0653e-10, 1.2769e-09],
         [2.0518e-09, 2.1672e-09, 7.3204e-06,  ..., 1.9200e-09,
          1.5980e-09, 3.4903e-09]],

        [[1.6903e-07, 7.5891e-08, 6.8593e-05,  ..., 4.8334e-08,
          8.2701e-08, 1.0661e-07],
         [2.3354e-08, 2.1430e-08, 2.1524e-05,  ..., 3.4819e-08,
          2.5901e-08, 2.6283e-08],
         [6.1380e-08, 4.4210e-08, 2.5502e-04,  ..., 3.0385e-08,
          4.3355e-08, 5.2913e-08],
         ...,
         [1.0689e-08, 1.3407e-08, 6.3492e-05,  ..., 1.5431e-08,
          1.5252e-08, 1.5192e-08],
         [2.1937e-08, 2.4761e-08, 4.9854e-04,  ..., 2.5848e-08,
          2.0770e-08, 2.5447e-08],
         [1.5074e-08, 1.7487e-08, 5.9067e-05,  ..., 1.6751e-08,
          1.8326e-08, 2.3901e-08]],

        [[6.8394e-10, 7.8721e-10, 4.1915e-06,  ..., 5.0038e-10,
          8.5451e-10, 5.8729e-10],
         [3.5843e-09, 3.8304e-09, 1.2346e-05,  ..., 2.9715e-09,
          4.7485e-09, 1.6283e-09],
         [1.3291e-08, 1.0555e-08, 8.3360e-07,  ..., 1.2882e-08,
          1.3343e-08, 1.1280e-08],
         ...,
         [1.3061e-09, 1.4457e-09, 1.2444e-06,  ..., 1.0536e-09,
          1.4685e-09, 1.3112e-09],
         [1.4050e-08, 1.9017e-08, 2.6774e-06,  ..., 9.0891e-09,
          1.2668e-08, 1.2793e-08],
         [1.0832e-08, 1.9652e-08, 6.0365e-07,  ..., 1.0874e-08,
          1.4448e-08, 1.4476e-08]],

        [[1.0330e-08, 6.3519e-09, 2.9619e-04,  ..., 6.0374e-09,
          3.9905e-09, 7.0861e-09],
         [8.1928e-09, 5.8096e-09, 7.6549e-06,  ..., 5.0474e-09,
          3.2209e-09, 5.7419e-09],
         [1.2473e-08, 5.8801e-09, 1.5936e-02,  ..., 5.0295e-09,
          4.9516e-09, 6.3579e-09],
         ...,
         [3.0171e-09, 3.2368e-09, 3.5985e-06,  ..., 2.4338e-09,
          2.0414e-09, 1.9328e-09],
         [3.2945e-10, 4.0682e-10, 2.8032e-06,  ..., 3.2817e-10,
          2.1691e-10, 3.2434e-10],
         [2.0461e-08, 1.7986e-08, 4.8431e-06,  ..., 1.6831e-08,
          1.3524e-08, 1.5688e-08]]], device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [7.6330e-09, 4.0491e-09, 0.0000e+00,  ..., 4.0763e-09, 7.4656e-09,
         1.0964e-09],
        [8.2838e-08, 1.5089e-07, 0.0000e+00,  ..., 2.9132e-07, 6.6693e-08,
         2.7698e-07],
        [0.0000e+00, 0.0000e+00, 3.4450e-05,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [1.1919e-10, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
accept_cnt:  tensor([2, 9, 4, 1, 2, 0], device='cuda:0')
target_prob_at_reject_idx:  tensor([[1.5946e-09, 2.1126e-09, 2.1310e-03,  ..., 1.1003e-09, 1.9386e-09,
         1.9923e-09],
        [1.5281e-10, 1.6652e-10, 8.2482e-07,  ..., 1.2088e-10, 1.2569e-10,
         1.3276e-10],
        [1.8827e-08, 1.8463e-08, 2.0145e-06,  ..., 1.4605e-08, 1.0982e-08,
         3.0799e-08],
        [5.1796e-08, 4.9231e-08, 2.5807e-04,  ..., 5.5136e-08, 6.4210e-08,
         5.4070e-08],
        [7.1491e-09, 4.4563e-09, 1.5725e-06,  ..., 6.4335e-09, 4.3024e-09,
         5.6775e-09],
        [6.9530e-09, 5.1569e-09, 5.5044e-04,  ..., 5.4256e-09, 3.8174e-09,
         6.0055e-09]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[1.3795e-08, 1.3903e-08, 9.1620e-03,  ..., 1.3371e-08, 1.5033e-08,
         1.4067e-08],
        [6.2144e-10, 6.1420e-10, 1.9605e-06,  ..., 5.9998e-10, 7.5844e-10,
         3.6533e-10],
        [1.7718e-08, 1.7580e-08, 6.2774e-06,  ..., 1.7857e-08, 2.0715e-08,
         1.9999e-08],
        [4.4499e-07, 4.4499e-07, 3.6053e-04,  ..., 4.6544e-07, 4.6544e-07,
         5.3259e-07],
        [4.5082e-08, 4.5436e-08, 4.1625e-06,  ..., 5.2092e-08, 3.9015e-08,
         5.0687e-08],
        [1.7548e-08, 1.7480e-08, 1.8512e-03,  ..., 1.6550e-08, 1.9576e-08,
         1.8176e-08]], device='cuda:0')
x_max_sum:  tensor([[0.4663],
        [0.1554],
        [0.4245],
        [0.3532],
        [0.5126],
        [0.6438]], device='cuda:0')
target_prob:  tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [2.6109e-09, 2.0780e-09, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         2.5438e-08],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
tensor(49253, device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [2.6109e-09, 2.0780e-09, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         2.5438e-08],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
tensor([9, 9, 9, 9, 9, 9], device='cuda:0')
tensor([[[1.8425e-09, 4.2840e-09, 3.2733e-06,  ..., 2.2487e-09,
          2.7284e-09, 3.2432e-09],
         [6.2058e-11, 5.8526e-11, 3.2215e-07,  ..., 3.5917e-11,
          4.4178e-11, 7.8449e-11],
         [1.5946e-09, 2.1126e-09, 2.1310e-03,  ..., 1.1003e-09,
          1.9386e-09, 1.9923e-09],
         ...,
         [2.8965e-09, 4.1490e-09, 5.6421e-04,  ..., 3.2439e-09,
          4.4686e-09, 6.0132e-09],
         [6.0718e-09, 6.4634e-09, 6.0172e-04,  ..., 5.8620e-09,
          5.8392e-09, 7.4976e-09],
         [1.4639e-09, 1.2570e-09, 4.5389e-04,  ..., 6.8076e-10,
          8.6393e-10, 8.9835e-10]],

        [[1.5281e-10, 1.6652e-10, 8.2482e-07,  ..., 1.2088e-10,
          1.2569e-10, 1.3276e-10],
         [9.0668e-10, 1.1152e-09, 1.7659e-05,  ..., 7.4727e-10,
          8.8222e-10, 9.7082e-10],
         [2.9807e-09, 2.3213e-09, 2.3934e-07,  ..., 1.3383e-09,
          1.8653e-09, 1.5769e-09],
         ...,
         [6.4787e-09, 4.5406e-09, 3.9645e-07,  ..., 3.1823e-09,
          4.8524e-09, 3.7938e-09],
         [6.3808e-09, 6.1244e-09, 6.2562e-07,  ..., 4.9597e-09,
          6.1125e-09, 4.8923e-09],
         [1.7379e-09, 1.1442e-09, 1.8723e-07,  ..., 8.0818e-10,
          7.2445e-10, 6.3064e-10]],

        [[2.2216e-09, 2.9691e-09, 1.1001e-07,  ..., 3.1268e-09,
          1.0869e-09, 2.5998e-09],
         [1.3018e-07, 1.0501e-07, 3.0813e-05,  ..., 1.0941e-07,
          5.9136e-08, 1.1443e-07],
         [6.3497e-09, 7.8870e-09, 1.5815e-05,  ..., 5.8955e-09,
          4.1399e-09, 8.7471e-09],
         ...,
         [5.5230e-08, 3.9471e-08, 7.7455e-06,  ..., 4.3351e-08,
          2.3113e-08, 4.6146e-08],
         [1.5104e-09, 1.3434e-09, 2.4476e-07,  ..., 1.3330e-09,
          8.4068e-10, 1.1446e-09],
         [1.8921e-07, 1.8375e-07, 6.6841e-05,  ..., 1.7879e-07,
          1.1254e-07, 1.6216e-07]],

        [[8.9115e-08, 7.0633e-08, 5.6347e-04,  ..., 5.7537e-08,
          9.9609e-08, 8.5701e-08],
         [5.1796e-08, 4.9231e-08, 2.5807e-04,  ..., 5.5136e-08,
          6.4210e-08, 5.4070e-08],
         [1.8913e-08, 1.8547e-08, 4.4345e-04,  ..., 1.4388e-08,
          2.7842e-08, 2.1939e-08],
         ...,
         [2.9590e-08, 2.4340e-08, 1.2586e-04,  ..., 3.1621e-08,
          2.8015e-08, 2.7797e-08],
         [3.2776e-08, 2.3793e-08, 2.1776e-06,  ..., 1.6465e-08,
          1.6872e-08, 2.7519e-08],
         [5.9437e-10, 6.1084e-10, 1.1872e-06,  ..., 4.1332e-10,
          6.9217e-10, 5.6273e-10]],

        [[4.2352e-09, 4.7804e-09, 1.0284e-06,  ..., 3.9016e-09,
          4.0255e-09, 3.5943e-09],
         [4.5898e-09, 3.1300e-09, 8.0938e-07,  ..., 3.3059e-09,
          4.2118e-09, 4.0190e-09],
         [7.1491e-09, 4.4563e-09, 1.5725e-06,  ..., 6.4335e-09,
          4.3024e-09, 5.6775e-09],
         ...,
         [4.7885e-17, 6.4311e-17, 3.1760e-15,  ..., 4.6231e-17,
          6.2821e-17, 5.4049e-17],
         [1.7521e-12, 2.8551e-12, 1.1342e-08,  ..., 1.8362e-12,
          2.0246e-12, 2.0167e-12],
         [4.4011e-10, 5.7851e-10, 5.8674e-07,  ..., 4.6667e-10,
          4.6485e-10, 5.6732e-10]],

        [[6.9530e-09, 5.1569e-09, 5.5044e-04,  ..., 5.4256e-09,
          3.8174e-09, 6.0055e-09],
         [5.6589e-08, 5.0726e-08, 6.9152e-06,  ..., 6.2394e-08,
          5.0430e-08, 8.5116e-08],
         [1.6369e-09, 1.4333e-09, 1.2810e-03,  ..., 1.4788e-09,
          1.0652e-09, 1.6147e-09],
         ...,
         [3.2769e-09, 2.2086e-09, 1.6980e-04,  ..., 1.3714e-09,
          7.7228e-10, 1.6802e-09],
         [5.9012e-09, 3.6003e-09, 2.1341e-06,  ..., 3.2022e-09,
          1.9805e-09, 3.8101e-09],
         [3.3194e-08, 2.3219e-08, 3.3535e-05,  ..., 2.1642e-08,
          1.6020e-08, 2.2859e-08]]], device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [1.7379e-09, 1.1442e-09, 1.8723e-07,  ..., 8.0818e-10, 7.2445e-10,
         6.3064e-10],
        [2.6109e-09, 2.0780e-09, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         2.5438e-08],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
accept_cnt:  tensor([9, 0, 1, 0, 2, 1, 0], device='cuda:0')
target_prob_at_reject_idx:  tensor([[1.1349e-08, 1.1438e-08, 1.6043e-05,  ..., 1.0015e-08, 9.8599e-09,
         1.3113e-08],
        [3.0804e-09, 4.5436e-09, 4.3715e-06,  ..., 4.6152e-09, 3.6154e-09,
         2.9914e-09],
        [2.2392e-09, 2.5127e-09, 4.0644e-06,  ..., 1.5092e-09, 1.7644e-09,
         2.5572e-09],
        ...,
        [9.3660e-09, 7.8256e-09, 4.1973e-06,  ..., 5.5275e-09, 1.0088e-08,
         5.5927e-09],
        [3.4006e-08, 3.2512e-08, 7.5638e-04,  ..., 2.4589e-08, 3.0602e-08,
         4.3324e-08],
        [1.1996e-08, 8.2127e-09, 2.0899e-05,  ..., 8.6068e-09, 1.0463e-08,
         1.0545e-08]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[1.2210e-07, 1.2402e-07, 6.5478e-05,  ..., 1.1880e-07, 1.1788e-07,
         1.1204e-07],
        [4.6682e-09, 4.6500e-09, 4.3617e-06,  ..., 5.0278e-09, 4.1116e-09,
         6.9126e-09],
        [1.0487e-09, 1.0324e-09, 9.8477e-06,  ..., 1.2212e-09, 1.1473e-09,
         1.2899e-09],
        ...,
        [9.8905e-08, 9.7372e-08, 2.3730e-06,  ..., 9.6614e-08, 9.4745e-08,
         9.2913e-08],
        [3.8893e-08, 3.9045e-08, 4.6493e-03,  ..., 3.9352e-08, 4.2218e-08,
         3.2624e-08],
        [2.0975e-07, 2.0975e-07, 1.5962e-05,  ..., 2.1556e-07, 1.9023e-07,
         2.0569e-07]], device='cuda:0')
x_max_sum:  tensor([[0.4737],
        [0.3828],
        [0.3121],
        [0.5009],
        [0.3903],
        [0.4282],
        [0.2793]], device='cuda:0')
target_prob:  tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 2.5702e-08,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [3.8145e-09, 4.7429e-09, 0.0000e+00,  ..., 9.2264e-10, 1.9775e-09,
         4.0607e-09],
        ...,
        [0.0000e+00, 0.0000e+00, 4.6744e-06,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         2.4991e-08],
        [0.0000e+00, 0.0000e+00, 1.7678e-05,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
tensor(69607, device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 2.5702e-08,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [3.8145e-09, 4.7429e-09, 0.0000e+00,  ..., 9.2264e-10, 1.9775e-09,
         4.0607e-09],
        ...,
        [0.0000e+00, 0.0000e+00, 4.6744e-06,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         2.4991e-08],
        [0.0000e+00, 0.0000e+00, 1.7678e-05,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
tensor([9, 8, 8, 8, 8, 8, 8], device='cuda:0')
tensor([[[1.1349e-08, 1.1438e-08, 1.6043e-05,  ..., 1.0015e-08,
          9.8599e-09, 1.3113e-08],
         [1.4822e-09, 2.4726e-09, 9.6364e-03,  ..., 1.7262e-09,
          1.9182e-09, 2.5711e-09],
         [2.4691e-09, 2.3195e-09, 1.6467e-01,  ..., 1.5756e-09,
          2.6907e-09, 1.9229e-09],
         ...,
         [1.0610e-08, 1.0610e-08, 4.6283e-06,  ..., 1.2502e-08,
          8.5257e-09, 9.4740e-09],
         [5.9913e-09, 5.6064e-09, 3.3394e-06,  ..., 5.2053e-09,
          4.0224e-09, 3.9446e-09],
         [9.3536e-10, 2.0671e-09, 9.7320e-06,  ..., 1.9080e-09,
          1.1416e-09, 2.6542e-09]],

        [[3.0804e-09, 4.5436e-09, 4.3715e-06,  ..., 4.6152e-09,
          3.6154e-09, 2.9914e-09],
         [1.6156e-09, 1.6188e-09, 1.1462e-06,  ..., 1.7198e-09,
          1.2806e-09, 1.4230e-09],
         [3.2740e-10, 4.7729e-10, 9.5708e-07,  ..., 2.4425e-10,
          3.9724e-10, 2.1895e-10],
         ...,
         [4.0301e-08, 2.9085e-08, 2.1322e-06,  ..., 2.5567e-08,
          4.0936e-08, 1.2412e-08],
         [5.6731e-08, 3.6485e-08, 1.7114e-06,  ..., 4.2324e-08,
          6.3535e-08, 1.9226e-08],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]],

        [[5.4723e-09, 5.9285e-09, 1.7809e-06,  ..., 5.2936e-09,
          3.2549e-09, 1.0124e-08],
         [2.2392e-09, 2.5127e-09, 4.0644e-06,  ..., 1.5092e-09,
          1.7644e-09, 2.5572e-09],
         [1.3201e-07, 1.2179e-07, 1.1841e-06,  ..., 1.1810e-07,
          9.0153e-08, 1.3984e-07],
         ...,
         [1.4657e-07, 9.5375e-08, 3.2089e-06,  ..., 1.0015e-07,
          6.3534e-08, 1.5005e-07],
         [1.8893e-07, 1.7852e-07, 1.7771e-05,  ..., 1.9416e-07,
          1.2512e-07, 1.9645e-07],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]],

        ...,

        [[1.7848e-08, 1.4681e-08, 1.0723e-06,  ..., 7.4837e-09,
          1.4567e-08, 1.1636e-08],
         [8.1366e-09, 6.7455e-09, 4.1082e-06,  ..., 3.2113e-09,
          6.2875e-09, 4.4238e-09],
         [9.3660e-09, 7.8256e-09, 4.1973e-06,  ..., 5.5275e-09,
          1.0088e-08, 5.5927e-09],
         ...,
         [4.9976e-08, 2.6029e-08, 2.2721e-06,  ..., 3.9845e-08,
          4.4104e-08, 3.3422e-08],
         [7.5421e-08, 4.3992e-08, 5.3549e-06,  ..., 6.6558e-08,
          4.5745e-08, 7.1686e-08],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]],

        [[1.6259e-07, 1.4963e-07, 1.5161e-04,  ..., 1.0214e-07,
          1.3141e-07, 2.2617e-07],
         [3.4006e-08, 3.2512e-08, 7.5638e-04,  ..., 2.4589e-08,
          3.0602e-08, 4.3324e-08],
         [9.0567e-08, 6.3226e-08, 1.4767e-03,  ..., 6.8631e-08,
          3.6308e-08, 6.5488e-08],
         ...,
         [1.9833e-08, 1.5206e-08, 1.3426e-05,  ..., 1.8851e-08,
          1.1125e-08, 2.5169e-08],
         [1.9031e-08, 1.5143e-08, 1.9157e-03,  ..., 8.8850e-09,
          8.1215e-09, 7.9956e-09],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]],

        [[1.1996e-08, 8.2127e-09, 2.0899e-05,  ..., 8.6068e-09,
          1.0463e-08, 1.0545e-08],
         [5.6654e-08, 2.7828e-08, 3.3195e-04,  ..., 2.9392e-08,
          3.0089e-08, 3.8635e-08],
         [5.0408e-09, 5.2827e-09, 1.6247e-05,  ..., 5.1002e-09,
          6.7303e-09, 7.9303e-09],
         ...,
         [1.5727e-08, 1.1372e-08, 8.1726e-06,  ..., 1.2011e-08,
          1.6163e-08, 1.4042e-08],
         [8.1958e-09, 8.4890e-09, 1.6824e-05,  ..., 1.3148e-08,
          1.4554e-08, 9.6570e-09],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]]], device='cuda:0')
tensor([[9.3536e-10, 2.0671e-09, 9.7320e-06,  ..., 1.9080e-09, 1.1416e-09,
         2.6542e-09],
        [0.0000e+00, 0.0000e+00, 2.5702e-08,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [3.8145e-09, 4.7429e-09, 0.0000e+00,  ..., 9.2264e-10, 1.9775e-09,
         4.0607e-09],
        ...,
        [0.0000e+00, 0.0000e+00, 4.6744e-06,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         2.4991e-08],
        [0.0000e+00, 0.0000e+00, 1.7678e-05,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
accept_cnt:  tensor([1, 6, 0, 6, 1, 0, 0], device='cuda:0')
target_prob_at_reject_idx:  tensor([[7.1686e-09, 6.9752e-09, 3.6274e-06,  ..., 5.3481e-09, 5.2446e-09,
         5.4963e-09],
        [6.5954e-08, 4.2334e-08, 1.8080e-06,  ..., 4.9494e-08, 7.3433e-08,
         2.2571e-08],
        [3.9565e-07, 2.1978e-07, 1.2874e-05,  ..., 2.6718e-07, 1.1741e-07,
         3.0217e-07],
        ...,
        [1.1034e-08, 1.1295e-08, 1.1947e-05,  ..., 7.5537e-09, 1.3154e-08,
         5.1916e-09],
        [1.7606e-08, 1.3927e-08, 2.0552e-05,  ..., 1.4313e-08, 6.7611e-09,
         1.6346e-08],
        [7.0248e-10, 5.3651e-10, 8.9042e-05,  ..., 3.8643e-10, 3.5048e-10,
         4.3618e-10]], device='cuda:0')
draft_prob_at_reject_idx:  tensor([[8.2001e-09, 8.2644e-09, 8.7414e-06,  ..., 8.2644e-09, 8.3293e-09,
         8.7974e-09],
        [3.0930e-08, 3.1052e-08, 4.2621e-06,  ..., 3.3971e-08, 3.0930e-08,
         2.5945e-08],
        [4.1884e-08, 4.1721e-08, 1.7952e-05,  ..., 4.3894e-08, 3.6818e-08,
         4.3382e-08],
        ...,
        [7.5990e-08, 7.5105e-08, 4.7754e-06,  ..., 8.0891e-08, 7.0555e-08,
         7.9949e-08],
        [1.2809e-08, 1.2859e-08, 2.1716e-04,  ..., 1.3215e-08, 1.4975e-08,
         1.6066e-08],
        [2.6562e-09, 2.6253e-09, 1.8521e-04,  ..., 2.4662e-09, 3.1667e-09,
         2.4185e-09]], device='cuda:0')
x_max_sum:  tensor([[0.4405],
        [0.5304],
        [0.3728],
        [0.5202],
        [0.4460],
        [0.4611],
        [0.3025]], device='cuda:0')
target_prob:  tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [6.6036e-08, 2.1273e-08, 0.0000e+00,  ..., 2.9269e-08, 8.0139e-08,
         0.0000e+00],
        [9.4888e-07, 4.7760e-07, 0.0000e+00,  ..., 5.9893e-07, 2.1617e-07,
         6.9414e-07],
        ...,
        [0.0000e+00, 0.0000e+00, 1.6081e-05,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [1.0405e-08, 2.3175e-09, 0.0000e+00,  ..., 2.3817e-09, 0.0000e+00,
         6.0884e-10],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
tensor(93261, device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [6.6036e-08, 2.1273e-08, 0.0000e+00,  ..., 2.9269e-08, 8.0139e-08,
         0.0000e+00],
        [9.4888e-07, 4.7760e-07, 0.0000e+00,  ..., 5.9893e-07, 2.1617e-07,
         6.9414e-07],
        ...,
        [0.0000e+00, 0.0000e+00, 1.6081e-05,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [1.0405e-08, 2.3175e-09, 0.0000e+00,  ..., 2.3817e-09, 0.0000e+00,
         6.0884e-10],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
tensor([9, 8, 8, 8, 8, 8, 8], device='cuda:0')
tensor([[[1.3344e-08, 1.5847e-08, 3.0125e-06,  ..., 1.8311e-08,
          1.1020e-08, 1.7957e-08],
         [7.1686e-09, 6.9752e-09, 3.6274e-06,  ..., 5.3481e-09,
          5.2446e-09, 5.4963e-09],
         [1.4567e-10, 2.9774e-10, 2.5087e-06,  ..., 1.4174e-10,
          2.3007e-10, 2.7429e-10],
         ...,
         [9.4924e-10, 1.4645e-09, 1.6133e-02,  ..., 1.0756e-09,
          1.7804e-09, 1.4250e-09],
         [4.2734e-09, 3.6127e-09, 2.0677e-05,  ..., 3.2894e-09,
          3.7566e-09, 4.6388e-09],
         [1.4840e-11, 2.3575e-11, 2.1028e-05,  ..., 1.2018e-11,
          1.9736e-11, 2.5342e-11]],

        [[5.8908e-10, 5.8108e-10, 2.7893e-07,  ..., 3.5039e-10,
          3.3434e-10, 2.8991e-10],
         [3.3245e-09, 3.1660e-09, 4.5012e-07,  ..., 2.3666e-09,
          3.2602e-09, 2.2146e-09],
         [2.8882e-09, 1.8867e-09, 9.4913e-07,  ..., 1.7655e-09,
          1.9928e-09, 1.7863e-09],
         ...,
         [1.1645e-08, 1.2493e-08, 1.1008e-05,  ..., 8.3546e-09,
          1.8248e-08, 1.0479e-08],
         [2.3439e-09, 3.3444e-09, 1.5931e-05,  ..., 1.7762e-09,
          3.2733e-09, 2.9746e-09],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]],

        [[3.9565e-07, 2.1978e-07, 1.2874e-05,  ..., 2.6718e-07,
          1.1741e-07, 3.0217e-07],
         [2.5494e-07, 1.3461e-07, 1.2823e-05,  ..., 1.6687e-07,
          7.5952e-08, 1.7625e-07],
         [6.7293e-07, 4.7984e-07, 2.4633e-06,  ..., 5.9983e-07,
          2.8893e-07, 6.4676e-07],
         ...,
         [5.2385e-07, 3.7110e-07, 8.4158e-04,  ..., 2.5110e-07,
          1.4141e-07, 2.9848e-07],
         [9.5413e-08, 6.9127e-08, 1.0526e-03,  ..., 6.7658e-08,
          2.9500e-08, 4.9499e-08],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]],

        ...,

        [[5.1609e-09, 6.0219e-09, 4.3985e-07,  ..., 5.0463e-09,
          5.9576e-09, 4.6625e-09],
         [1.1034e-08, 1.1295e-08, 1.1947e-05,  ..., 7.5537e-09,
          1.3154e-08, 5.1916e-09],
         [9.5919e-10, 1.2268e-09, 1.3273e-05,  ..., 6.8017e-10,
          1.1391e-09, 6.0260e-10],
         ...,
         [1.0279e-09, 9.8469e-10, 4.0121e-06,  ..., 9.0714e-10,
          8.1634e-10, 9.6565e-10],
         [6.1164e-09, 4.4924e-09, 1.4545e-06,  ..., 3.9956e-09,
          4.7821e-09, 4.7449e-09],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]],

        [[1.7606e-08, 1.3927e-08, 2.0552e-05,  ..., 1.4313e-08,
          6.7611e-09, 1.6346e-08],
         [3.1361e-08, 4.0584e-08, 4.6937e-02,  ..., 2.7676e-08,
          1.9856e-08, 3.3253e-08],
         [1.0351e-08, 1.0032e-08, 1.5757e-06,  ..., 9.5729e-09,
          9.0634e-09, 9.1882e-09],
         ...,
         [1.4967e-08, 1.5026e-08, 4.1170e-07,  ..., 1.2702e-08,
          1.9521e-08, 1.5808e-08],
         [2.6848e-09, 2.7271e-09, 3.0086e-05,  ..., 1.5845e-09,
          2.1156e-09, 2.7809e-09],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]],

        [[7.0248e-10, 5.3651e-10, 8.9042e-05,  ..., 3.8643e-10,
          3.5048e-10, 4.3618e-10],
         [8.0835e-10, 9.9818e-10, 2.3128e-06,  ..., 6.8337e-10,
          7.6833e-10, 9.7126e-10],
         [6.6289e-10, 8.5117e-10, 6.0561e-07,  ..., 6.0357e-10,
          1.0929e-09, 9.1674e-10],
         ...,
         [1.8664e-10, 1.9407e-10, 1.0415e-06,  ..., 1.3816e-10,
          1.2629e-10, 1.6407e-10],
         [3.7285e-10, 4.4624e-10, 1.5797e-06,  ..., 2.6751e-10,
          2.8144e-10, 3.9845e-10],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]]], device='cuda:0')
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [6.6036e-08, 2.1273e-08, 0.0000e+00,  ..., 2.9269e-08, 8.0139e-08,
         0.0000e+00],
        [9.4888e-07, 4.7760e-07, 0.0000e+00,  ..., 5.9893e-07, 2.1617e-07,
         6.9414e-07],
        ...,
        [0.0000e+00, 0.0000e+00, 1.6081e-05,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00],
        [1.0405e-08, 2.3175e-09, 0.0000e+00,  ..., 2.3817e-09, 0.0000e+00,
         6.0884e-10],
        [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
         0.0000e+00]], device='cuda:0')
INFO:     127.0.0.1:45186 - "POST /generate HTTP/1.1" 500 Internal Server Error
INFO:     127.0.0.1:45240 - "POST /generate HTTP/1.1" 500 Internal Server Error
INFO:     127.0.0.1:45208 - "POST /generate HTTP/1.1" 500 Internal Server Error
INFO:     127.0.0.1:45198 - "POST /generate HTTP/1.1" 500 Internal Server Error
INFO:     127.0.0.1:45224 - "POST /generate HTTP/1.1" 500 Internal Server Error
INFO:     127.0.0.1:45244 - "POST /generate HTTP/1.1" 500 Internal Server Error
INFO:     127.0.0.1:45170 - "POST /generate HTTP/1.1" 500 Internal Server Error
